{"version":3,"file":"Grid-legacy-CGVfThtl.js","sources":["../../node_modules/.pnpm/@lightningtv+solid@2.0.0_solid-js@1.8.20/node_modules/@lightningtv/solid/src/primitives/createInfiniteItems.ts","../../src/pages/gridStyles.ts","../../src/pages/Grid.tsx"],"sourcesContent":["import {\n  type Accessor,\n  batch,\n  type Setter,\n  createComputed,\n  createResource,\n  createSignal,\n} from 'solid-js';\n\n// Adopted from https://github.com/solidjs-community/solid-primitives/blob/main/packages/pagination/src/index.ts\n// As we don't have intersection observer in Lightning, we can't use the original implementation\n\n/**\n * Provides an easy way to implement infinite items.\n *\n * ```ts\n * const [items, loader, { item, setItem, setItems, end, setEnd }] = createInfiniteScroll(fetcher);\n * ```\n * @param fetcher `(item: number) => Promise<T[]>`\n * @return `items()` is an accessor contains array of contents\n * @property `items.loading` is a boolean indicator for the loading state\n * @property `items.error` contains any error encountered\n * @method `page` is an accessor that contains page number\n * @method `setPage` allows to manually change the page number\n * @method `setItems` allows to manually change the contents of the item\n * @method `end` is a boolean indicator for end of the item\n * @method `setEnd` allows to manually change the end\n */\nexport function createInfiniteItems<T>(\n  fetcher: (item: number) => Promise<T[]>,\n): [\n  items: Accessor<T[]>,\n  options: {\n    page: Accessor<number>;\n    setPage: Setter<number>;\n    setItems: Setter<T[]>;\n    end: Accessor<boolean>;\n    setEnd: Setter<boolean>;\n  },\n] {\n  const [items, setItems] = createSignal<T[]>([]);\n  const [page, setPage] = createSignal(0);\n  const [end, setEnd] = createSignal(false);\n\n  const [contents] = createResource(page, fetcher);\n\n  createComputed(() => {\n    const content = contents();\n    if (!content) return;\n    batch(() => {\n      if (content.length === 0) setEnd(true);\n      setItems((p) => [...p, ...content]);\n    });\n  });\n\n  return [\n    items,\n    {\n      page,\n      setPage,\n      setItems,\n      end,\n      setEnd,\n    },\n  ];\n}\n","import {\n  IntrinsicNodeStyleProps,\n  IntrinsicTextNodeStyleProps,\n  hexColor,\n} from \"@lightningtv/solid\";\nimport theme from \"theme\";\n\nconst ROW_HEIGHT = 50;\nexport default {\n  ProductRow: {\n    width: 500,\n    display: \"flex\",\n    flexDirection: \"row\",\n    gap: 40,\n    height: ROW_HEIGHT,\n    borderRadius: 16,\n    color: 0xffffff0d,\n    border: { color: 0x008085ff, width: 0 },\n    active: {\n      color: 0x39393cff,\n    },\n    focus: {\n      color: 0xf6f6f9ff,\n      border: { color: 0x008085ff, width: 6 },\n    },\n    transition: {\n      // leave easing blank to use default linear\n      x: { duration: 300 },\n      width: { duration: 300 },\n      alpha: { duration: 300 },\n    },\n  },\n  ProductText: {\n    fontSize: 20,\n    fontWeight: 600,\n    lineHeight: 24,\n    color: \"#f6f6f6\",\n    focus: {\n      color: 0x141417ff,\n    },\n  },\n  itemsContainer: {\n    width: theme.layout.screenW,\n    height: 600,\n    y: 180,\n    x: 180,\n    zIndex: 2,\n  },\n} as const;\n","import {\n  createEffect,\n  on,\n  createSignal,\n  createSelector,\n  Index,\n  onMount,\n} from \"solid-js\";\nimport { type ElementNode, View, Text } from \"@lightningtv/solid\";\nimport { Column, Row } from \"@lightningtv/solid-ui\";\nimport styles from \"./gridStyles\";\nimport { setGlobalBackground } from \"../state\";\nimport { createInfiniteItems } from \"@lightningtv/solid/primitives\";\n\ninterface ProductsResponse {\n  limit: number;\n  products: any[]; // You can replace 'any' with the actual type of your products\n  skip: number;\n  total: number;\n}\n\ninterface Product {\n  brand: string;\n  category: string;\n  description: string;\n  discountPercentage: number;\n  id: number;\n  images: string[];\n  price: number;\n  rating: number;\n  stock: number;\n  thumbnail: string;\n  title: string;\n}\n\nfunction ProductRow(props) {\n  return (\n    <View\n      y={props.y}\n      autofocus={props.autofocus}\n      style={styles.ProductRow}\n      forwardStates\n    >\n      <Text style={styles.ProductText}>{props.item.id}</Text>\n      <Text style={styles.ProductText}>{props.item.title}</Text>\n      <Text style={styles.ProductText}>{props.item.price}</Text>\n    </View>\n  );\n}\n\nconst Grid = () => {\n  let totalProducts = 100;\n  const [columnY, setcolumnY] = createSignal(0);\n  const isFirst = createSelector(() => 0);\n  const [rowIndex, setRowIndex] = createSignal(0);\n  const [items, setItems] = createSignal<Product[]>([]);\n  const [products, { setPage }] = createInfiniteItems<Product>((page) => {\n    return fetch(`https://dummyjson.com/products?limit=20&skip=${20 * page}`)\n      .then((res) => res.json())\n      .then((data: ProductsResponse) => {\n        totalProducts = data.total;\n        return data.products;\n      });\n  });\n\n  const EXTRA = 8;\n  // When rowIndex changes we create a sub array for the UI\n  createEffect(\n    on(\n      [products, rowIndex],\n      ([products, index]) => {\n        if (items().length - EXTRA > index) return;\n\n        setItems(products.slice(0, index + EXTRA));\n        if (index > products.length - 5) {\n          // Load more products\n          setPage((p) => p + 1);\n        }\n      },\n      { defer: true }\n    )\n  );\n\n  onMount(() => {\n    setGlobalBackground(\"#000000\");\n  });\n\n  function changeRow(elm, active, selectedIndex, lastSelectedIndex) {\n    setcolumnY((active.y || 0) * -1 + 50);\n    setRowIndex(selectedIndex);\n  }\n\n  return (\n    <View clipping style={styles.itemsContainer}>\n      <Column plinko y={columnY()} scroll=\"none\" onSelectedChanged={changeRow}>\n        <Index each={items()}>\n          {(item, i) => (\n            <ProductRow y={i * 50} item={item()} autofocus={isFirst(i)} />\n          )}\n        </Index>\n      </Column>\n    </View>\n  );\n};\n\nexport default Grid;\n"],"names":["createInfiniteItems","fetcher","_createSignal","createSignal","_createSignal2","_slicedToArray","items","setItems","_createSignal3","_createSignal4","page","setPage","_createSignal5","_createSignal6","end","setEnd","_createResource","createResource","_createResource2","contents","createComputed","content","batch","length","p","ROW_HEIGHT","styles","ProductRow","width","display","flexDirection","gap","height","borderRadius","color","border","active","focus","transition","x","duration","alpha","ProductText","fontSize","fontWeight","lineHeight","itemsContainer","theme","layout","screenW","y","zIndex","props","_$createComponent","View","autofocus","style","forwardStates","children","Text","item","id","title","price","Grid","_createSignal7","_createSignal8","columnY","setcolumnY","isFirst","createSelector","_createSignal9","_createSignal10","rowIndex","setRowIndex","_createSignal11","_createSignal12","_createInfiniteItems","fetch","then","res","json","data","total","products","_createInfiniteItems2","EXTRA","on","index","slice","defer","onMount","setGlobalBackground","changeRow","elm","selectedIndex","lastSelectedIndex","clipping","Column","plinko","scroll","onSelectedChanged","Index","each","i"],"mappings":"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","x_google_ignoreList":[0]}