var Mr=Object.defineProperty;var Nr=(r,n,e)=>n in r?Mr(r,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[n]=e;var d=(r,n,e)=>(Nr(r,typeof n!="symbol"?n+"":n,e),e);import{a as A,E as We,g as Br,m as zn,b as at,i as Qn,c as xt,d as Ce,T as Zn,e as $r,f as Dr,h as Or,j as Vt,S as Mn,k as Jn,B as Yr,l as Ur,n as Wr,o as tn,W as Nn,p as jr,q as Xr,C as Hr}from"./CoreExtension-3fd98810.js";function sa(){import.meta.url,import("_").catch(()=>1);async function*r(){}}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();const er=(r,n)=>r===n,Mt=Symbol("solid-proxy"),Gr=Symbol("solid-track"),Nt={equals:er};let tr=ar;const xe=1,Bt=2,nr={owned:null,cleanups:null,context:null,owner:null},nn={};var B=null;let rn=null,Vr=null,$=null,re=null,be=null,Kt=0;function et(r,n){const e=$,t=B,i=r.length===0,o=n===void 0?t:n,s=i?nr:{owned:null,cleanups:null,context:o?o.context:null,owner:o},l=i?r:()=>r(()=>oe(()=>Qt(s)));B=s,$=null;try{return Te(l,!0)}finally{$=e,B=t}}function D(r,n){n=n?Object.assign({},Nt,n):Nt;const e={value:r,observers:null,observerSlots:null,comparator:n.equals||void 0},t=i=>(typeof i=="function"&&(i=i(e.value)),sr(e,i));return[or.bind(e),t]}function cn(r,n,e){const t=vt(r,n,!0,xe);je(t)}function _e(r,n,e){const t=vt(r,n,!1,xe);je(t)}function ye(r,n,e){tr=ni;const t=vt(r,n,!1,xe);(!e||!e.render)&&(t.user=!0),be?be.push(t):je(t)}function ee(r,n,e){e=e?Object.assign({},Nt,e):Nt;const t=vt(r,n,!0,0);return t.observers=null,t.observerSlots=null,t.comparator=e.equals||void 0,je(t),or.bind(t)}function Kr(r){return r&&typeof r=="object"&&"then"in r}function Oe(r,n,e){let t,i,o;arguments.length===2&&typeof n=="object"||arguments.length===1?(t=!0,i=r,o=n||{}):(t=r,i=n,o=e||{});let s=null,l=nn,c=!1,u="initialValue"in o,h=typeof t=="function"&&ee(t);const f=new Set,[v,_]=(o.storage||D)(o.initialValue),[x,y]=D(void 0),[T,S]=D(void 0,{equals:!1}),[p,m]=D(u?"ready":"unresolved");function g(b,w,R,L){return s===b&&(s=null,L!==void 0&&(u=!0),(b===l||w===l)&&o.onHydrated&&queueMicrotask(()=>o.onHydrated(L,{value:w})),l=nn,C(w,R)),w}function C(b,w){Te(()=>{w===void 0&&_(()=>b),m(w!==void 0?"errored":u?"ready":"unresolved"),y(w);for(const R of f.keys())R.decrement();f.clear()},!1)}function E(){const b=Jr,w=v(),R=x();if(R!==void 0&&!s)throw R;return $&&!$.user&&b&&cn(()=>{T(),s&&(b.resolved||f.has(b)||(b.increment(),f.add(b)))}),w}function I(b=!0){if(b!==!1&&c)return;c=!1;const w=h?h():t;if(w==null||w===!1){g(s,oe(v));return}const R=l!==nn?l:oe(()=>i(w,{value:v(),refetching:b}));return Kr(R)?(s=R,"value"in R?(R.status==="success"?g(s,R.value,void 0,w):g(s,void 0,void 0,w),R):(c=!0,queueMicrotask(()=>c=!1),Te(()=>{m(u?"refreshing":"pending"),S()},!1),R.then(L=>g(R,L,void 0,w),L=>g(R,void 0,cr(L),w)))):(g(s,R,void 0,w),R)}return Object.defineProperties(E,{state:{get:()=>p()},error:{get:()=>x()},loading:{get(){const b=p();return b==="pending"||b==="refreshing"}},latest:{get(){if(!u)return E();const b=x();if(b&&!s)throw b;return v()}}}),h?cn(()=>I(!1)):I(!1),[E,{refetch:I,mutate:_}]}function rr(r,n=er,e){const t=new Map,i=vt(o=>{const s=r();for(const[l,c]of t.entries())if(n(l,s)!==n(l,o))for(const u of c.values())u.state=xe,u.pure?re.push(u):be.push(u);return s},void 0,!0,xe);return je(i),o=>{const s=$;if(s){let l;(l=t.get(o))?l.add(s):t.set(o,l=new Set([s])),Pe(()=>{l.delete(s),!l.size&&t.delete(o)})}return n(o,i.value)}}function qr(r){return Te(r,!1)}function oe(r){if($===null)return r();const n=$;$=null;try{return r()}finally{$=n}}function Fe(r,n,e){const t=Array.isArray(r);let i,o=e&&e.defer;return s=>{let l;if(t){l=Array(r.length);for(let u=0;u<r.length;u++)l[u]=r[u]()}else l=r();if(o){o=!1;return}const c=oe(()=>n(l,i,s));return i=l,c}}function yt(r){ye(()=>oe(r))}function Pe(r){return B===null||(B.cleanups===null?B.cleanups=[r]:B.cleanups.push(r)),r}function qt(){return B}function Qr(r,n){const e=B,t=$;B=r,$=null;try{return Te(n,!0)}catch(i){Cn(i)}finally{B=e,$=t}}function Zr(r){const n=$,e=B;return Promise.resolve().then(()=>{$=n,B=e;let t;return Te(r,!1),$=B=null,t?t.done:void 0})}function ir(r,n){const e=Symbol("context");return{id:e,Provider:ri(e),defaultValue:r}}function bn(r){return B&&B.context&&B.context[r.id]!==void 0?B.context[r.id]:r.defaultValue}function Tn(r){const n=ee(r),e=ee(()=>un(n()));return e.toArray=()=>{const t=e();return Array.isArray(t)?t:t!=null?[t]:[]},e}let Jr;function or(){if(this.sources&&this.state)if(this.state===xe)je(this);else{const r=re;re=null,Te(()=>Dt(this),!1),re=r}if($){const r=this.observers?this.observers.length:0;$.sources?($.sources.push(this),$.sourceSlots.push(r)):($.sources=[this],$.sourceSlots=[r]),this.observers?(this.observers.push($),this.observerSlots.push($.sources.length-1)):(this.observers=[$],this.observerSlots=[$.sources.length-1])}return this.value}function sr(r,n,e){let t=r.value;return(!r.comparator||!r.comparator(t,n))&&(r.value=n,r.observers&&r.observers.length&&Te(()=>{for(let i=0;i<r.observers.length;i+=1){const o=r.observers[i],s=rn&&rn.running;s&&rn.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?re.push(o):be.push(o),o.observers&&lr(o)),s||(o.state=xe)}if(re.length>1e6)throw re=[],new Error},!1)),n}function je(r){if(!r.fn)return;Qt(r);const n=Kt;ei(r,r.value,n)}function ei(r,n,e){let t;const i=B,o=$;$=B=r;try{t=r.fn(n)}catch(s){return r.pure&&(r.state=xe,r.owned&&r.owned.forEach(Qt),r.owned=null),r.updatedAt=e+1,Cn(s)}finally{$=o,B=i}(!r.updatedAt||r.updatedAt<=e)&&(r.updatedAt!=null&&"observers"in r?sr(r,t):r.value=t,r.updatedAt=e)}function vt(r,n,e,t=xe,i){const o={fn:r,state:t,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:n,owner:B,context:B?B.context:null,pure:e};return B===null||B!==nr&&(B.owned?B.owned.push(o):B.owned=[o]),o}function $t(r){if(r.state===0)return;if(r.state===Bt)return Dt(r);if(r.suspense&&oe(r.suspense.inFallback))return r.suspense.effects.push(r);const n=[r];for(;(r=r.owner)&&(!r.updatedAt||r.updatedAt<Kt);)r.state&&n.push(r);for(let e=n.length-1;e>=0;e--)if(r=n[e],r.state===xe)je(r);else if(r.state===Bt){const t=re;re=null,Te(()=>Dt(r,n[0]),!1),re=t}}function Te(r,n){if(re)return r();let e=!1;n||(re=[]),be?e=!0:be=[],Kt++;try{const t=r();return ti(e),t}catch(t){e||(be=null),re=null,Cn(t)}}function ti(r){if(re&&(ar(re),re=null),r)return;const n=be;be=null,n.length&&Te(()=>tr(n),!1)}function ar(r){for(let n=0;n<r.length;n++)$t(r[n])}function ni(r){let n,e=0;for(n=0;n<r.length;n++){const t=r[n];t.user?r[e++]=t:$t(t)}for(n=0;n<e;n++)$t(r[n])}function Dt(r,n){r.state=0;for(let e=0;e<r.sources.length;e+=1){const t=r.sources[e];if(t.sources){const i=t.state;i===xe?t!==n&&(!t.updatedAt||t.updatedAt<Kt)&&$t(t):i===Bt&&Dt(t,n)}}}function lr(r){for(let n=0;n<r.observers.length;n+=1){const e=r.observers[n];e.state||(e.state=Bt,e.pure?re.push(e):be.push(e),e.observers&&lr(e))}}function Qt(r){let n;if(r.sources)for(;r.sources.length;){const e=r.sources.pop(),t=r.sourceSlots.pop(),i=e.observers;if(i&&i.length){const o=i.pop(),s=e.observerSlots.pop();t<i.length&&(o.sourceSlots[s]=t,i[t]=o,e.observerSlots[t]=s)}}if(r.owned){for(n=r.owned.length-1;n>=0;n--)Qt(r.owned[n]);r.owned=null}if(r.cleanups){for(n=r.cleanups.length-1;n>=0;n--)r.cleanups[n]();r.cleanups=null}r.state=0}function cr(r){return r instanceof Error?r:new Error(typeof r=="string"?r:"Unknown error",{cause:r})}function Cn(r,n=B){throw cr(r)}function un(r){if(typeof r=="function"&&!r.length)return un(r());if(Array.isArray(r)){const n=[];for(let e=0;e<r.length;e++){const t=un(r[e]);Array.isArray(t)?n.push.apply(n,t):n.push(t)}return n}return r}function ri(r,n){return function(t){let i;return _e(()=>i=oe(()=>(B.context={...B.context,[r]:t.value},Tn(()=>t.children))),void 0),i}}const ii=Symbol("fallback");function Bn(r){for(let n=0;n<r.length;n++)r[n]()}function oi(r,n,e={}){let t=[],i=[],o=[],s=0,l=n.length>1?[]:null;return Pe(()=>Bn(o)),()=>{let c=r()||[],u,h;return c[Gr],oe(()=>{let v=c.length,_,x,y,T,S,p,m,g,C;if(v===0)s!==0&&(Bn(o),o=[],t=[],i=[],s=0,l&&(l=[])),e.fallback&&(t=[ii],i[0]=et(E=>(o[0]=E,e.fallback())),s=1);else if(s===0){for(i=new Array(v),h=0;h<v;h++)t[h]=c[h],i[h]=et(f);s=v}else{for(y=new Array(v),T=new Array(v),l&&(S=new Array(v)),p=0,m=Math.min(s,v);p<m&&t[p]===c[p];p++);for(m=s-1,g=v-1;m>=p&&g>=p&&t[m]===c[g];m--,g--)y[g]=i[m],T[g]=o[m],l&&(S[g]=l[m]);for(_=new Map,x=new Array(g+1),h=g;h>=p;h--)C=c[h],u=_.get(C),x[h]=u===void 0?-1:u,_.set(C,h);for(u=p;u<=m;u++)C=t[u],h=_.get(C),h!==void 0&&h!==-1?(y[h]=i[u],T[h]=o[u],l&&(S[h]=l[u]),h=x[h],_.set(C,h)):o[u]();for(h=p;h<v;h++)h in y?(i[h]=y[h],o[h]=T[h],l&&(l[h]=S[h],l[h](h))):i[h]=et(f);i=i.slice(0,s=v),t=c.slice(0)}return i});function f(v){if(o[h]=v,l){const[_,x]=D(h);return l[h]=x,n(c[h],_)}return n(c[h])}}}function ur(r,n){return oe(()=>r(n||{}))}function Ct(){return!0}const hn={get(r,n,e){return n===Mt?e:r.get(n)},has(r,n){return n===Mt?!0:r.has(n)},set:Ct,deleteProperty:Ct,getOwnPropertyDescriptor(r,n){return{configurable:!0,enumerable:!0,get(){return r.get(n)},set:Ct,deleteProperty:Ct}},ownKeys(r){return r.keys()}};function on(r){return(r=typeof r=="function"?r():r)?r:{}}function si(){for(let r=0,n=this.length;r<n;++r){const e=this[r]();if(e!==void 0)return e}}function Rn(...r){let n=!1;for(let o=0;o<r.length;o++){const s=r[o];n=n||!!s&&Mt in s,r[o]=typeof s=="function"?(n=!0,ee(s)):s}if(n)return new Proxy({get(o){for(let s=r.length-1;s>=0;s--){const l=on(r[s])[o];if(l!==void 0)return l}},has(o){for(let s=r.length-1;s>=0;s--)if(o in on(r[s]))return!0;return!1},keys(){const o=[];for(let s=0;s<r.length;s++)o.push(...Object.keys(on(r[s])));return[...new Set(o)]}},hn);const e={},t={},i=new Set;for(let o=r.length-1;o>=0;o--){const s=r[o];if(!s)continue;const l=Object.getOwnPropertyNames(s);for(let c=0,u=l.length;c<u;c++){const h=l[c];if(h==="__proto__"||h==="constructor")continue;const f=Object.getOwnPropertyDescriptor(s,h);if(!i.has(h))f.get?(i.add(h),Object.defineProperty(e,h,{enumerable:!0,configurable:!0,get:si.bind(t[h]=[f.get.bind(s)])})):(f.value!==void 0&&i.add(h),e[h]=f.value);else{const v=t[h];v?f.get?v.push(f.get.bind(s)):f.value!==void 0&&v.push(()=>f.value):e[h]===void 0&&(e[h]=f.value)}}}return e}function ai(r,...n){if(Mt in r){const i=new Set(n.length>1?n.flat():n[0]),o=n.map(s=>new Proxy({get(l){return s.includes(l)?r[l]:void 0},has(l){return s.includes(l)&&l in r},keys(){return s.filter(l=>l in r)}},hn));return o.push(new Proxy({get(s){return i.has(s)?void 0:r[s]},has(s){return i.has(s)?!1:s in r},keys(){return Object.keys(r).filter(s=>!i.has(s))}},hn)),o}const e={},t=n.map(()=>({}));for(const i of Object.getOwnPropertyNames(r)){const o=Object.getOwnPropertyDescriptor(r,i),s=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let l=!1,c=0;for(const u of n)u.includes(i)&&(l=!0,s?t[c][i]=o.value:Object.defineProperty(t[c],i,o)),++c;l||(s?e[i]=o.value:Object.defineProperty(e,i,o))}return[...t,e]}const li=r=>"Stale read from <".concat(r,">.");function Zt(r){const n="fallback"in r&&{fallback:()=>r.fallback};return ee(oi(()=>r.each,r.children,n||void 0))}function Ie(r){const n=r.keyed,e=ee(()=>r.when,void 0,{equals:(t,i)=>n?t===i:!t==!i});return ee(()=>{const t=e();if(t){const i=r.children;return typeof i=="function"&&i.length>0?oe(()=>i(n?t:()=>{if(!oe(e))throw li("Show");return r.when})):i}return r.fallback},void 0,void 0)}const ci=void 0,[Ot,Yt]=D(null);class hr{constructor(n){d(this,"releaseCallback");this.releaseCallback=n}}class ui extends hr{constructor(e,t){var i,o;super(e);d(this,"textureMap",new Map);d(this,"zeroReferenceTextureSet",new Set);d(this,"options");this.options={textureCleanupIntervalMs:(i=t.textureCleanupIntervalMs)!=null?i:1e4,textureCleanupAgeThreadholdMs:(o=t.textureCleanupAgeThreadholdMs)!=null?o:6e4},setInterval(()=>{const s=Date.now(),l=this.options.textureCleanupAgeThreadholdMs;for(const c of this.zeroReferenceTextureSet)s-c.lastUpdate>l&&(this.releaseCallback(c.id),this.textureMap.delete(c.id),this.zeroReferenceTextureSet.delete(c))},this.options.textureCleanupIntervalMs)}registerTexture(e){var i;const t=(i=e.options)==null?void 0:i.id;if(A(t,"Texture must have an id to be registered"),!this.textureMap.has(t)){const o={id:t,nodeRefCount:0,lastUpdate:Date.now()};this.textureMap.set(t,o),this.zeroReferenceTextureSet.add(o)}}incrementTextureRefCount(e){var o;const t=(o=e.options)==null?void 0:o.id;A(t,"Texture must have an id to be registered");let i=this.textureMap.get(t);i||(this.registerTexture(e),i=this.textureMap.get(t)),A(i,"Texture must have been registered"),e.txType==="SubTexture"&&this.incrementTextureRefCount(e.props.texture),i.nodeRefCount++,i.lastUpdate=Date.now(),this.zeroReferenceTextureSet.has(i)&&this.zeroReferenceTextureSet.delete(i)}decrementTextureRefCount(e){var o;const t=(o=e.options)==null?void 0:o.id;A(t,"Texture must have an id to be registered");const i=this.textureMap.get(t);A(i,"Texture must have been registered"),i.nodeRefCount--,i.lastUpdate=Date.now(),i.nodeRefCount===0&&this.zeroReferenceTextureSet.add(i),e.txType==="SubTexture"&&this.decrementTextureRefCount(e.props.texture)}}class hi extends hr{constructor(e){super(e);d(this,"registry");this.registry=new FinalizationRegistry(e)}registerTexture(e){var t,i;A((t=e.options)==null?void 0:t.id,"Texture must have an ID to be registered"),this.registry.register(e,(i=e.options)==null?void 0:i.id)}incrementTextureRefCount(){}decrementTextureRefCount(){}}class di extends We{constructor(e,t,i){var T,S;super();d(this,"root",null);d(this,"driver");d(this,"canvas");d(this,"settings");d(this,"nodes",new Map);d(this,"nextTextureId",1);d(this,"textureTracker");const o={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:(T=e.clearColor)!=null?T:0,coreExtensionModule:e.coreExtensionModule||null,experimental_FinalizationRegistryTextureUsageTracker:(S=e.experimental_FinalizationRegistryTextureUsageTracker)!=null?S:!1,textureCleanupOptions:e.textureCleanupOptions||{},fpsUpdateInterval:e.fpsUpdateInterval||0};this.settings=o;const{appWidth:s,appHeight:l,deviceLogicalPixelRatio:c,devicePhysicalPixelRatio:u}=o,h=p=>{this.driver.releaseTexture(p)},f=o.experimental_FinalizationRegistryTextureUsageTracker&&typeof FinalizationRegistry=="function";this.textureTracker=f?new hi(h):new ui(h,this.settings.textureCleanupOptions);const v=s*c,_=l*c;this.driver=i;const x=document.createElement("canvas");this.canvas=x,x.width=v*u,x.height=_*u,x.style.width="".concat(v,"px"),x.style.height="".concat(_,"px");let y;if(typeof t=="string"?y=document.getElementById(t):y=t,!y)throw new Error("Could not find target element");i.onCreateNode=p=>{this.nodes.set(p.id,p)},i.onBeforeDestroyNode=p=>{this.nodes.delete(p.id)},i.onFpsUpdate=p=>{this.emit("fpsUpdate",p)},y.appendChild(x)}async init(){await this.driver.init(this,this.settings,this.canvas),this.root=this.driver.getRootNode()}createNode(e){return this.driver.createNode(this.resolveNodeDefaults(e))}createTextNode(e){var t,i,o,s,l,c,u,h,f,v,_,x,y,T;return this.driver.createTextNode({...this.resolveNodeDefaults(e),text:(t=e.text)!=null?t:"",textRendererOverride:(i=e.textRendererOverride)!=null?i:null,fontSize:(o=e.fontSize)!=null?o:16,fontFamily:(s=e.fontFamily)!=null?s:"sans-serif",fontStyle:(l=e.fontStyle)!=null?l:"normal",fontWeight:(c=e.fontWeight)!=null?c:"normal",fontStretch:(u=e.fontStretch)!=null?u:"normal",textAlign:(h=e.textAlign)!=null?h:"left",contain:(f=e.contain)!=null?f:"none",scrollable:(v=e.scrollable)!=null?v:!1,scrollY:(_=e.scrollY)!=null?_:0,offsetY:(x=e.offsetY)!=null?x:0,letterSpacing:(y=e.letterSpacing)!=null?y:0,debug:(T=e.debug)!=null?T:{}})}resolveNodeDefaults(e){var c,u,h,f,v,_,x,y,T,S,p,m,g,C,E,I,b,w,R,L,k,z,Y,W,te,Q,ce,me,rt,_t,St,Ne,ve,he,Z,O,ke,se,Le,bt,Tt,Be,$e,De,it;const t=(c=e.color)!=null?c:4294967295,i=(f=(h=(u=e.colorTl)!=null?u:e.colorTop)!=null?h:e.colorLeft)!=null?f:t,o=(x=(_=(v=e.colorTr)!=null?v:e.colorTop)!=null?_:e.colorRight)!=null?x:t,s=(S=(T=(y=e.colorBl)!=null?y:e.colorBottom)!=null?T:e.colorLeft)!=null?S:t,l=(g=(m=(p=e.colorBr)!=null?p:e.colorBottom)!=null?m:e.colorRight)!=null?g:t;return{x:(C=e.x)!=null?C:0,y:(E=e.y)!=null?E:0,width:(I=e.width)!=null?I:0,height:(b=e.height)!=null?b:0,alpha:(w=e.alpha)!=null?w:1,clipping:(R=e.clipping)!=null?R:!1,color:t,colorTop:(L=e.colorTop)!=null?L:t,colorBottom:(k=e.colorBottom)!=null?k:t,colorLeft:(z=e.colorLeft)!=null?z:t,colorRight:(Y=e.colorRight)!=null?Y:t,colorBl:s,colorBr:l,colorTl:i,colorTr:o,zIndex:(W=e.zIndex)!=null?W:0,zIndexLocked:(te=e.zIndexLocked)!=null?te:0,parent:(Q=e.parent)!=null?Q:null,texture:(ce=e.texture)!=null?ce:null,shader:(me=e.shader)!=null?me:null,src:(rt=e.src)!=null?rt:"",scale:(_t=e.scale)!=null?_t:null,scaleX:(Ne=(St=e.scaleX)!=null?St:e.scale)!=null?Ne:1,scaleY:(he=(ve=e.scaleY)!=null?ve:e.scale)!=null?he:1,mount:(Z=e.mount)!=null?Z:0,mountX:(ke=(O=e.mountX)!=null?O:e.mount)!=null?ke:0,mountY:(Le=(se=e.mountY)!=null?se:e.mount)!=null?Le:0,pivot:(bt=e.pivot)!=null?bt:.5,pivotX:(Be=(Tt=e.pivotX)!=null?Tt:e.pivot)!=null?Be:.5,pivotY:(De=($e=e.pivotY)!=null?$e:e.pivot)!=null?De:.5,rotation:(it=e.rotation)!=null?it:0}}destroyNode(e){return this.driver.destroyNode(e)}createTexture(e,t,i){const o=this.nextTextureId++,s={descType:"texture",txType:e,props:t,options:{...i,id:o}};return this.textureTracker.registerTexture(s),s}createShader(e,t){return{descType:"shader",shType:e,props:t}}getNodeById(e){return this.nodes.get(e)||null}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}rerender(){throw new Error("Not implemented")}}class fi extends We{constructor(e,t,i){super();d(this,"node");d(this,"props");d(this,"settings");d(this,"propStartValues",{});d(this,"restoreValues",{});d(this,"progress",0);d(this,"timingFunction");d(this,"propsList");this.node=e,this.props=t,this.settings=i,this.propStartValues={},this.propsList=Object.keys(t),this.propsList.forEach(o=>{this.propStartValues[o]=e[o]}),this.timingFunction=o=>o,i.easing&&typeof i.easing=="string"&&(this.timingFunction=Br(i.easing))}reset(){this.progress=0,this.update(0)}restore(){this.reset(),Object.keys(this.props).forEach(e=>{this.node[e]=this.propStartValues[e]})}reverse(){this.progress=0,Object.keys(this.props).forEach(e=>{const t=this.props[e],i=this.propStartValues[e];this.props[e]=i,this.propStartValues[e]=t}),this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,t,i){return(this.timingFunction(e)||e)*(i-t)+t}update(e){const{duration:t,loop:i,easing:o,stopMethod:s}=this.settings;if(!t){this.emit("finished",{});return}if(this.progress+=e/t,this.progress>1&&(this.progress=i?0:1,s)){this.emit("finished",{});return}for(let l=0;l<this.propsList.length;l++){const c=this.propsList[l],u=this.props[c],h=this.propStartValues[c],f=u;if(c.indexOf("color")!==-1){if(h===f){this.node[c]=h;continue}if(o){const v=this.timingFunction(this.progress)||this.progress,_=zn(h,f,v);this.node[c]=_;continue}this.node[c]=zn(h,f,this.progress);continue}if(o){this.node[c]=this.applyEasing(this.progress,h,f);continue}this.node[c]=h+(f-h)*this.progress}this.progress===1&&this.emit("finished",{})}}class pi{constructor(n,e){d(this,"manager");d(this,"animation");d(this,"stoppedPromise",null);d(this,"stoppedResolve",null);d(this,"state");this.manager=n,this.animation=e,this.state="stopped"}start(){return this.makeStoppedPromise(),this.animation.once("finished",this.finished.bind(this)),this.manager.activeAnimations.has(this.animation)||this.manager.registerAnimation(this.animation),this.state="running",this}stop(){return this.manager.unregisterAnimation(this.animation),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null),this.animation.reset(),this.state="stopped",this}pause(){return this.manager.unregisterAnimation(this.animation),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){this.makeStoppedPromise();const n=this.stoppedPromise;return A(n),n}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(n=>{this.stoppedResolve=n}))}finished(){A(this.stoppedResolve);const{loop:n,stopMethod:e}=this.animation.settings;if(e==="reverse"){this.animation.reverse(),this.start();return}this.stoppedResolve(),this.stoppedResolve=null,!n&&this.manager.unregisterAnimation(this.animation)}}const H=0,G=3,ie=6,j=1,V=4,ae=7,de=2,fe=5,pe=8;class ge{constructor(n){d(this,"data");n?(this.data=new Float32Array(9),this.data[H]=n[0],this.data[G]=n[3],this.data[ie]=n[6],this.data[j]=n[1],this.data[V]=n[4],this.data[ae]=n[7],this.data[de]=n[2],this.data[fe]=n[5],this.data[pe]=n[8]):this.data=new Float32Array(9)}static get temp(){return gi}static multiply(n,e,t){const i=n.data[H]*e.data[H]+n.data[G]*e.data[j]+n.data[ie]*e.data[de],o=n.data[H]*e.data[G]+n.data[G]*e.data[V]+n.data[ie]*e.data[fe],s=n.data[H]*e.data[ie]+n.data[G]*e.data[ae]+n.data[ie]*e.data[pe],l=n.data[j]*e.data[H]+n.data[V]*e.data[j]+n.data[ae]*e.data[de],c=n.data[j]*e.data[G]+n.data[V]*e.data[V]+n.data[ae]*e.data[fe],u=n.data[j]*e.data[ie]+n.data[V]*e.data[ae]+n.data[ae]*e.data[pe],h=n.data[de]*e.data[H]+n.data[fe]*e.data[j]+n.data[pe]*e.data[de],f=n.data[de]*e.data[G]+n.data[fe]*e.data[V]+n.data[pe]*e.data[fe],v=n.data[de]*e.data[ie]+n.data[fe]*e.data[ae]+n.data[pe]*e.data[pe];return t||(t=new ge),t.data[H]=i,t.data[G]=o,t.data[ie]=s,t.data[j]=l,t.data[V]=c,t.data[ae]=u,t.data[de]=h,t.data[fe]=f,t.data[pe]=v,t}static identity(n){return n||(n=new ge),n.data[H]=1,n.data[G]=0,n.data[ie]=0,n.data[j]=0,n.data[V]=1,n.data[ae]=0,n.data[de]=0,n.data[fe]=0,n.data[pe]=1,n}static translate(n,e,t){return t||(t=new ge),t.data[H]=1,t.data[G]=0,t.data[ie]=n,t.data[j]=0,t.data[V]=1,t.data[ae]=e,t.data[de]=0,t.data[fe]=0,t.data[pe]=1,t}static scale(n,e,t){return t||(t=new ge),t.data[H]=n,t.data[G]=0,t.data[ie]=0,t.data[j]=0,t.data[V]=e,t.data[ae]=0,t.data[de]=0,t.data[fe]=0,t.data[pe]=1,t}static rotate(n,e){const t=Math.cos(n),i=Math.sin(n);return e||(e=new ge),e.data[H]=t,e.data[G]=-i,e.data[ie]=0,e.data[j]=i,e.data[V]=t,e.data[ae]=0,e.data[de]=0,e.data[fe]=0,e.data[pe]=1,e}static copy(n,e,t){return e||(e=new ge),e.data[0]=n.data[0],e.data[1]=n.data[1],e.data[2]=n.data[2],e.data[3]=n.data[3],e.data[4]=n.data[4],e.data[5]=n.data[5],e.data[6]=n.data[6],e.data[7]=n.data[7],e.data[8]=n.data[8],e}translate(n,e){return this.data[ie]=this.data[H]*n+this.data[G]*e+this.data[ie],this.data[ae]=this.data[j]*n+this.data[V]*e+this.data[ae],this}scale(n,e){return this.data[H]=this.data[H]*n,this.data[G]=this.data[G]*e,this.data[j]=this.data[j]*n,this.data[V]=this.data[V]*e,this}rotate(n){if(n===0||!(n%Math.PI*2))return this;const e=Math.cos(n),t=Math.sin(n),i=this.data[H]*e+this.data[G]*t,o=this.data[G]*e-this.data[H]*t,s=this.data[j]*e+this.data[V]*t,l=this.data[V]*e-this.data[j]*t;return this.data[H]=i,this.data[G]=o,this.data[j]=s,this.data[V]=l,this}multiply(n){return ge.multiply(this,n,this)}get tx(){return this.data[ie]}get ty(){return this.data[ae]}get ta(){return this.data[H]}get tb(){return this.data[G]}get tc(){return this.data[j]}get td(){return this.data[V]}transformPoint(n,e){return[this.data[H]*n+this.data[G]*e+this.data[ie],this.data[j]*n+this.data[V]*e+this.data[j]]}}const gi=new ge;var F;(function(r){r[r.Children=1]="Children",r[r.ScaleRotate=2]="ScaleRotate",r[r.Local=4]="Local",r[r.Global=8]="Global",r[r.Clipping=16]="Clipping",r[r.CalculatedZIndex=32]="CalculatedZIndex",r[r.ZIndexSortedChildren=64]="ZIndexSortedChildren",r[r.PremultipliedColors=128]="PremultipliedColors",r[r.WorldAlpha=256]="WorldAlpha",r[r.None=0]="None",r[r.All=511]="All"})(F||(F={}));class En extends We{constructor(e,t){super();d(this,"stage");d(this,"children",[]);d(this,"props");d(this,"updateType",F.All);d(this,"globalTransform");d(this,"scaleRotateTransform");d(this,"localTransform");d(this,"clippingRect",null);d(this,"isRenderable",!1);d(this,"parentClippingRect",null);d(this,"worldAlpha",1);d(this,"premultipliedColorTl",0);d(this,"premultipliedColorTr",0);d(this,"premultipliedColorBl",0);d(this,"premultipliedColorBr",0);d(this,"calcZIndex",0);d(this,"isComplex",!1);d(this,"onTextureLoaded",(e,t)=>{this.stage.requestRender(),this.emit("loaded",{type:"texture",dimensions:t})});d(this,"onTextureFailed",(e,t)=>{this.emit("failed",{type:"texture",error:t})});this.stage=e,this.props={...t,parent:null},this.parent=t.parent,this.updateScaleRotateTransform()}loadTexture(e,t,i=null){this.props.texture&&this.unloadTexture();const{txManager:o}=this.stage,s=o.loadTexture(e,t,i);this.props.texture=s,this.props.textureOptions=i,this.checkIsRenderable(),queueMicrotask(()=>{s.state==="loaded"?this.onTextureLoaded(s,s.dimensions):s.state==="failed"&&this.onTextureFailed(s,s.error),s.on("loaded",this.onTextureLoaded),s.on("failed",this.onTextureFailed)})}unloadTexture(){this.props.texture&&(this.props.texture.off("loaded",this.onTextureLoaded),this.props.texture.off("failed",this.onTextureFailed)),this.props.texture=null,this.props.textureOptions=null,this.checkIsRenderable()}loadShader(e,t){const i=this.stage.renderer.getShaderManager();A(i);const{shader:o,props:s}=i.loadShader(e,t);this.props.shader=o,this.props.shaderProps=s,this.checkIsRenderable()}setUpdateType(e){this.updateType|=e;const t=this.props.parent;t&&!(t.updateType&F.Children)&&t.setUpdateType(F.Children)}sortChildren(){this.children.sort((e,t)=>e.calcZIndex-t.calcZIndex)}updateScaleRotateTransform(){this.scaleRotateTransform=ge.rotate(this.props.rotation,this.scaleRotateTransform).scale(this.props.scaleX,this.props.scaleY)}updateLocalTransform(){A(this.scaleRotateTransform);const e=this.props.pivotX*this.props.width,t=this.props.pivotY*this.props.height,i=this.props.mountX*this.props.width,o=this.props.mountY*this.props.height;this.localTransform=ge.translate(e-i+this.props.x,t-o+this.props.y,this.localTransform).multiply(this.scaleRotateTransform).translate(-e,-t),this.setUpdateType(F.Global)}update(e,t=null){this.updateType&F.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(F.Local)),this.updateType&F.Local&&(this.updateLocalTransform(),this.setUpdateType(F.Global));const i=this.props.parent;let o=F.None;this.updateType&F.Global&&(A(this.localTransform),this.globalTransform=ge.copy((i==null?void 0:i.globalTransform)||this.localTransform,this.globalTransform),i&&this.globalTransform.multiply(this.localTransform),this.setUpdateType(F.Clipping|F.Children),o|=F.Global),this.updateType&F.Clipping&&(this.calculateClippingRect(t),this.checkIsRenderable(),this.setUpdateType(F.Children),o|=F.Clipping),this.updateType&F.WorldAlpha&&(i?this.worldAlpha=i.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(F.Children|F.PremultipliedColors),o|=F.WorldAlpha),this.updateType&F.PremultipliedColors&&(this.premultipliedColorTl=at(this.props.colorTl,this.worldAlpha,!0),this.premultipliedColorTr=at(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=at(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=at(this.props.colorBr,this.worldAlpha,!0),this.checkIsRenderable(),this.setUpdateType(F.Children),o|=F.PremultipliedColors),i&&this.updateType&F.CalculatedZIndex&&(this.calculateZIndex(),i.setUpdateType(F.ZIndexSortedChildren)),this.updateType&F.Children&&this.children.length&&this.children.forEach(s=>{s.setUpdateType(o),s.updateType!==0&&s.update(e,this.clippingRect)}),this.updateType&F.ZIndexSortedChildren&&this.sortChildren(),this.updateType=0}checkIsRenderable(){return this.props.texture?this.isRenderable=!0:this.props.shader?this.isRenderable=!0:this.props.clipping?this.isRenderable=!0:["color","colorTop","colorBottom","colorLeft","colorRight","colorTl","colorTr","colorBl","colorBr"].some(t=>this.props[t]!==0)?this.isRenderable=!0:this.isRenderable=!1}calculateClippingRect(e=null){if(A(this.globalTransform),this.parentClippingRect===e&&this.clippingRect)return;const t=this.globalTransform,i=t.tb!==0||t.tc!==0;let o=this.props.clipping&&!i?{x:t.tx,y:t.ty,width:this.width*t.ta,height:this.height*t.td}:null;e&&o?o=Qn(e,o):e&&(o=e),this.parentClippingRect=e,this.clippingRect=o}calculateZIndex(){var s,l;const e=this.props,t=e.zIndex||0,i=((s=e.parent)==null?void 0:s.zIndex)||0;let o=t;(l=e.parent)!=null&&l.zIndexLocked&&(o=t<i?t:i),this.calcZIndex=o}renderQuads(e){const{width:t,height:i,texture:o,textureOptions:s,shader:l,shaderProps:c}=this.props,{premultipliedColorTl:u,premultipliedColorTr:h,premultipliedColorBl:f,premultipliedColorBr:v}=this,{zIndex:_,worldAlpha:x,globalTransform:y,clippingRect:T}=this;A(y),e.addQuad({width:t,height:i,colorTl:u,colorTr:h,colorBl:f,colorBr:v,texture:o,textureOptions:s,zIndex:_,shader:l,shaderProps:c,alpha:x,clippingRect:T,tx:y.tx,ty:y.ty,ta:y.ta,tb:y.tb,tc:y.tc,td:y.td})}get id(){return this.props.id}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(F.Local))}get absX(){var e,t,i;return this.props.x+(((e=this.props.parent)==null?void 0:e.absX)||((i=(t=this.props.parent)==null?void 0:t.globalTransform)==null?void 0:i.tx)||0)}get absY(){var e,t;return this.props.y+((t=(e=this.props.parent)==null?void 0:e.absY)!=null?t:0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(F.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(F.Local))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(F.Local))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(F.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(F.ScaleRotate))}get mount(){return this.props.mount}set mount(e){(this.props.mountX!==e||this.props.mountY!==e)&&(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(F.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(F.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(F.Local))}get pivot(){return this.props.pivot}set pivot(e){(this.props.pivotX!==e||this.props.pivotY!==e)&&(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(F.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(F.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(F.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(F.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(F.PremultipliedColors|F.WorldAlpha)}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(F.Clipping)}get color(){return this.props.color}set color(e){(this.props.colorTl!==e||this.props.colorTr!==e||this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorTl=e,this.colorTr=e,this.colorBl=e,this.colorBr=e),this.props.color=e,this.setUpdateType(F.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){(this.props.colorTl!==e||this.props.colorTr!==e)&&(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(F.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){(this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(F.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){(this.props.colorTl!==e||this.props.colorBl!==e)&&(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(F.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){(this.props.colorTr!==e||this.props.colorBr!==e)&&(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(F.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(F.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(F.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(F.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(F.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(F.CalculatedZIndex|F.Children),this.children.forEach(t=>{t.setUpdateType(F.CalculatedZIndex)})}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(F.CalculatedZIndex|F.Children),this.children.forEach(t=>{t.setUpdateType(F.CalculatedZIndex)})}get parent(){return this.props.parent}set parent(e){const t=this.props.parent;if(t!==e){if(this.props.parent=e,t){const i=t.children.indexOf(this);A(i!==-1,"CoreNode.parent: Node not found in old parent's children!"),t.children.splice(i,1)}e&&(e.children.push(this),this.setUpdateType(F.All),e.setUpdateType(F.Children|F.ZIndexSortedChildren)),this.updateScaleRotateTransform()}}}let mi=1;function In(){return mi++}class dn extends We{constructor(e,t,i,o){var s;super();d(this,"rendererMain");d(this,"stage");d(this,"id");d(this,"coreNode");d(this,"_children",[]);d(this,"_src","");d(this,"_parent",null);d(this,"_texture",null);d(this,"_shader",null);d(this,"onTextureLoaded",(e,t)=>{this.emit("loaded",t)});d(this,"onTextureFailed",(e,t)=>{this.emit("failed",t)});this.rendererMain=t,this.stage=i,this.id=(s=o==null?void 0:o.id)!=null?s:In(),this.coreNode=o||new En(this.stage,{id:this.id,x:e.x,y:e.y,width:e.width,height:e.height,alpha:e.alpha,clipping:e.clipping,color:e.color,colorTop:e.colorTop,colorBottom:e.colorBottom,colorLeft:e.colorLeft,colorRight:e.colorRight,colorTl:e.colorTl,colorTr:e.colorTr,colorBl:e.colorBl,colorBr:e.colorBr,zIndex:e.zIndex,zIndexLocked:e.zIndexLocked,scaleX:e.scaleX,scaleY:e.scaleY,mountX:e.mountX,mountY:e.mountY,mount:e.mount,pivot:e.pivot,pivotX:e.pivotX,pivotY:e.pivotY,rotation:e.rotation,parent:null,shader:null,shaderProps:null,texture:null,textureOptions:null}),this.coreNode.on("loaded",this.onTextureLoaded),this.coreNode.on("failed",this.onTextureFailed),this.parent=e.parent,this.shader=e.shader,this.texture=e.texture,this.src=e.src}get x(){return this.coreNode.x}set x(e){this.coreNode.x=e}get y(){return this.coreNode.y}set y(e){this.coreNode.y=e}get width(){return this.coreNode.width}set width(e){this.coreNode.width=e}get height(){return this.coreNode.height}set height(e){this.coreNode.height=e}get alpha(){return this.coreNode.alpha}set alpha(e){this.coreNode.alpha=e}get clipping(){return this.coreNode.clipping}set clipping(e){this.coreNode.clipping=e}get color(){return this.coreNode.color}set color(e){this.coreNode.color=e}get colorTop(){return this.coreNode.colorTop}set colorTop(e){this.coreNode.colorTop=e}get colorBottom(){return this.coreNode.colorBottom}set colorBottom(e){this.coreNode.colorBottom=e}get colorLeft(){return this.coreNode.colorLeft}set colorLeft(e){this.coreNode.colorLeft=e}get colorRight(){return this.coreNode.colorRight}set colorRight(e){this.coreNode.colorRight=e}get colorTl(){return this.coreNode.colorTl}set colorTl(e){this.coreNode.colorTl=e}get colorTr(){return this.coreNode.colorTr}set colorTr(e){this.coreNode.colorTr=e}get colorBl(){return this.coreNode.colorBl}set colorBl(e){this.coreNode.colorBl=e}get colorBr(){return this.coreNode.colorBr}set colorBr(e){this.coreNode.colorBr=e}get scale(){return this.scaleX!==this.scaleY?null:this.coreNode.scaleX}set scale(e){e!==null&&(this.coreNode.scaleX=e,this.coreNode.scaleY=e)}get scaleX(){return this.coreNode.scaleX}set scaleX(e){this.coreNode.scaleX=e}get scaleY(){return this.coreNode.scaleY}set scaleY(e){this.coreNode.scaleY=e}get mount(){return this.coreNode.mount}set mount(e){this.coreNode.mount=e}get mountX(){return this.coreNode.mountX}set mountX(e){this.coreNode.mountX=e}get mountY(){return this.coreNode.mountY}set mountY(e){this.coreNode.mountY=e}get pivot(){return this.coreNode.pivot}set pivot(e){this.coreNode.pivot=e}get pivotX(){return this.coreNode.pivotX}set pivotX(e){this.coreNode.pivotX=e}get pivotY(){return this.coreNode.pivotY}set pivotY(e){this.coreNode.pivotY=e}get rotation(){return this.coreNode.rotation}set rotation(e){this.coreNode.rotation=e}get parent(){return this._parent}set parent(e){var i;const t=this._parent;if(this._parent=e,this.coreNode.parent=(i=e==null?void 0:e.coreNode)!=null?i:null,t){const o=t.children.indexOf(this);A(o!==-1,"MainOnlyNode.parent: Node not found in old parent's children!"),t.children.splice(o,1)}e&&e.children.push(this)}get children(){return this._children}get zIndex(){return this.coreNode.zIndex}set zIndex(e){this.coreNode.zIndex=e}get zIndexLocked(){return this.coreNode.zIndexLocked}set zIndexLocked(e){this.coreNode.zIndexLocked=e}get src(){return this._src}set src(e){if(this._src!==e){if(this._src=e,!e){this.texture=null;return}this.texture=this.rendererMain.createTexture("ImageTexture",{src:e})}}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this.rendererMain.textureTracker.decrementTextureRefCount(this._texture),e&&this.rendererMain.textureTracker.incrementTextureRefCount(e),this._texture=e,e?this.coreNode.loadTexture(e.txType,e.props,e.options):this.coreNode.unloadTexture())}get shader(){return this._shader}set shader(e){this._shader!==e&&(this._shader=e,e&&this.coreNode.loadShader(e.shType,e.props))}destroy(){this.emit("beforeDestroy",{}),this.parent=null,this.texture=null,this.emit("afterDestroy",{}),this.removeAllListeners()}flush(){}animate(e,t){const i=new fi(this.coreNode,e,t);return new pi(this.stage.animationManager,i)}}const xi=r=>{const n=()=>{if(r.updateAnimations(),!r.hasSceneUpdates()){setTimeout(n,16.666666666666668);return}r.drawFrame(),requestAnimationFrame(n)};requestAnimationFrame(n)},yi=()=>performance?performance.now():Date.now();class dr extends xt{constructor(n){super({renderer:n,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(n){const{gl:e}=this;e.getParameter(e.TEXTURE_BINDING_2D)!==n[0].ctxTexture&&(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,n[0].ctxTexture))}}d(dr,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "});class fr extends xt{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});d(this,"supportsIndexedTextures",!0)}bindTextures(e){const{renderer:t,gl:i}=this;if(e.length>t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error("DefaultShaderBatched: Cannot bind more than ".concat(t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS," textures"));e.forEach((s,l)=>{i.activeTexture(i.TEXTURE0+l),i.bindTexture(i.TEXTURE_2D,s.ctxTexture)});const o=Array.from(Array(e.length).keys());this.setUniform("u_textures[0]",o)}}d(fr,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:e=>"\n      #define txUnits ".concat(e,"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[").concat(e,"], int idx, vec2 uv) {\n        ").concat(Array.from(Array(e).keys()).map(t=>"\n          ".concat(t!==0?"else ":"","if (idx == ").concat(t,") {\n            return texture2D(textures[").concat(t,"], uv);\n          }\n        ")).join(""),"\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    ")});class ne{constructor(n){d(this,"priority",1);d(this,"name","");d(this,"ref");d(this,"target");d(this,"passParameters","");d(this,"declaredUniforms","");d(this,"uniformInfo",{});const{ref:e,target:t,props:i={}}=n;this.ref=e,this.target=t;const o={},s=[];let l="";const c=this.constructor.uniforms||{};for(const u in c){const h=c[u],f=h.type,v="".concat(e,"_").concat(u);let _="";h.size&&(_="[".concat(h.size(i),"]")),s.push(v),l+="uniform ".concat(f," ").concat(v).concat(_,";"),o[u]={name:v,uniform:c[u].method}}this.passParameters=s.join(","),this.declaredUniforms=l,this.uniformInfo=o}static getEffectKey(n){return""}static getMethodParameters(n,e){const t=[];for(const i in n){const o=n[i];let s="";o.size&&(s="[".concat(o.size(e),"]")),t.push("".concat(o.type," ").concat(i).concat(s))}return t.join(",")}static resolveDefaults(n){return{}}static makeEffectKey(n){return!1}}d(ne,"uniforms",{}),d(ne,"methods"),d(ne,"onShaderMask"),d(ne,"onColorize"),d(ne,"onEffectMask");const Re=class Re extends xt{constructor(e,t,i){const o=Re.createShader(t,i);super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...o.uniforms],shaderSources:{vertex:o.vertex,fragment:o.fragment}});d(this,"effects",[]);this.effects=o.effects}bindTextures(e){const{gl:t}=this;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e[0].ctxTexture)}bindProps(e){var i;const t=this.renderer.shManager.getRegisteredEffects();(i=e.effects)==null||i.forEach((o,s)=>{var f;const l=this.effects[s],c=t[l.name],u=(f=o.props)!=null?f:{},h=l.uniformInfo;Object.keys(u).forEach(v=>{const _=c.uniforms[v],x=h[v];let y=_.validator?_.validator(u[v],u):u[v];Array.isArray(y)&&(y=new Float32Array(y)),this.setUniform(x.name,y)})})}static createShader(e,t){const i={},o={};let s="";const l=[],c=[],u=e.effects.map(x=>{const y=t[x.type],T=y.getEffectKey(x.props||{});i[T]=i[T]?++i[T]:1;const S=i[T];S===1&&c.push({key:T,type:x.type,props:x.props});const p=new y({ref:"".concat(T).concat(S===1?"":S),target:T,props:x.props});return s+=p.declaredUniforms,l.push(...Object.values(p.uniformInfo)),p});let h="";c==null||c.forEach(x=>{var I;const y=t[x.type],T=y.resolveDefaults((I=x.props)!=null?I:{}),S=[];for(const b in y.methods){let w=b;const R=y.methods[b];o[b]&&o[b]!==R&&(w=Re.resolveMethodDuplicate(b,R,o)),o[w]=R.replace("function",w),S.push({m:b,cm:w})}let p=y.onShaderMask instanceof Function?y.onShaderMask(T):y.onShaderMask,m=y.onColorize instanceof Function?y.onColorize(T):y.onColorize,g=y.onEffectMask instanceof Function?y.onEffectMask(T):y.onEffectMask;S.forEach(b=>{const{m:w,cm:R}=b,L=new RegExp("\\$".concat(w),"g");p&&(p=p.replace(L,R)),m&&(m=m.replace(L,R)),g&&(g=g.replace(L,R))});const C=y.getMethodParameters(y.uniforms,T),E=C.length>0?", ".concat(C):"";p&&(h+="\n        float fx_".concat(x.key,"_onShaderMask(float shaderMask ").concat(E,") {\n          ").concat(p,"\n        }\n        ")),m&&(h+="\n          vec4 fx_".concat(x.key,"_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(E,") {\n            ").concat(m,"\n          }\n        ")),g&&(h+="\n          vec4 fx_".concat(x.key,"_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(E,") {\n            ").concat(g,"\n          }\n        "))});let f="";for(const x in o)f+=o[x];let v="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",_="\n\n    ";for(let x=0;x<u.length;x++){const y=u[x],T=y.passParameters.length>0?", ".concat(y.passParameters):"",S=t[y.name];S.onShaderMask&&(_+="\n        shaderMask = fx_".concat(y.target,"_onShaderMask(shaderMask ").concat(T,");\n        ")),S.onColorize&&(_+="\n        maskColor = fx_".concat(y.target,"_onColorize(shaderMask, maskColor, shaderColor").concat(T,");\n        ")),S.onEffectMask&&(v="fx_".concat(y.target,"_onEffectMask(shaderMask, maskColor, shaderColor").concat(T,")"));const p=u[x+1];(p===void 0||t[p.name].onEffectMask)&&(_+="\n          shaderColor = ".concat(v,";\n        "))}return{effects:u,uniforms:l,fragment:Re.fragment(s,f,h,_),vertex:Re.vertex()}}static resolveMethodDuplicate(e,t,i,o=0){const s=e+(o>0?o:"");return i[s]&&i[s]!==t?this.resolveMethodDuplicate(e,t,i,++o):s}static resolveDefaults(e,t){var i;return{effects:((i=e.effects)!=null?i:[]).map(o=>({type:o.type,props:t[o.type].resolveDefaults(o.props||{})})),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,t){var o;let i="";return(o=e.effects)==null||o.forEach(s=>{const c=t[s.type].getEffectKey(s.props||{});i+=",".concat(c)}),"DynamicShader".concat(i)}};d(Re,"z$__type__Props"),d(Re,"vertex",()=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  "),d(Re,"fragment",(e,t,i,o)=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ".concat(e,"\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n\n    ").concat(t,"\n\n    ").concat(i,"\n\n    void main() {\n      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ").concat(o,"\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  "));let Je=Re;class fn extends xt{constructor(n){super({renderer:n,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(n){return{radius:n.radius||10,$dimensions:{width:0,height:0}}}bindTextures(n){const{gl:e}=this;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,n[0].ctxTexture)}bindProps(n){this.setUniform("u_radius",n.radius)}canBatchShaderProps(n,e){return n.radius===e.radius&&n.$dimensions.width===e.$dimensions.width&&n.$dimensions.height===e.$dimensions.height}}d(fn,"z$__type__Props"),d(fn,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "});const vi=new Float32Array([1,0,0,0,1,0,0,0,1]),Gt=class Gt extends xt{constructor(n){super({renderer:n,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(n){const{gl:e}=this;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,n[0].ctxTexture)}bindProps(n){const e=Gt.resolveDefaults(n);for(const t in e)if(t==="transform")this.setUniform("u_transform",!1,e[t]);else if(t==="scrollY")this.setUniform("u_scrollY",e[t]);else if(t==="color"){const i=Ce(e.color);this.setUniform("u_color",i)}else t==="size"?this.setUniform("u_size",e[t]):t==="distanceRange"?this.setUniform("u_distanceRange",e[t]):t==="debug"&&this.setUniform("u_debug",e[t]?1:0)}static resolveDefaults(n={}){var e,t,i,o,s,l;return{transform:(e=n.transform)!=null?e:vi,scrollY:(t=n.scrollY)!=null?t:0,color:(i=n.color)!=null?i:4294967295,size:(o=n.size)!=null?o:16,distanceRange:(s=n.distanceRange)!=null?s:1,debug:(l=n.debug)!=null?l:!1}}};d(Gt,"shaderSources",{vertex:"\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n        gl_Position = vec4((transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1), 0, 1);\n        v_texcoord = a_textureCoordinate;\n      }\n    ",fragment:"\n      precision highp float;\n\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "});let pn=Gt;class Xe extends ne{constructor(){super(...arguments);d(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){var t;return{radius:(t=e.radius)!=null?t:10}}}d(Xe,"z$__type__Props"),d(Xe,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",validator:e=>{let t=e;return Array.isArray(t)?t.length===2?t=[t[0],t[1],t[0],t[1]]:t.length===3?t=[t[0],t[1],t[2],t[0]]:t.length!==4&&(t=[t[0],t[0],t[0],t[0]]):typeof t=="number"&&(t=[t,t,t,t]),t}}}),d(Xe,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),d(Xe,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);\n  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);\n  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  "),d(Xe,"onEffectMask","\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  ");class lt extends ne{constructor(){super(...arguments);d(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){var t,i;return{width:(t=e.width)!=null?t:10,color:(i=e.color)!=null?i:4294967295}}}d(lt,"z$__type__Props"),d(lt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Ce(e),method:"uniform4fv",type:"vec4"}}),d(lt,"onEffectMask","\n  float mask = clamp(shaderMask + width, 0.0, 1.0) - clamp(shaderMask, 0.0, 1.0);\n  return mix(shaderColor, maskColor, mask);\n  "),d(lt,"onColorize","\n    return color;\n  ");class He extends ne{constructor(){super(...arguments);d(this,"name","linearGradient")}static getEffectKey(e){return"linearGradient".concat(e.colors.length)}static resolveDefaults(e){var o,s;const t=(o=e.colors)!=null?o:[4278190080,4294967295];let i=e.stops;if(!i){i=[];const l=t.length-1;for(let c=0;c<t.length;c++)i.push(c*(1/l))}return{colors:t,stops:i,angle:(s=e.angle)!=null?s:0}}}d(He,"z$__type__Props"),d(He,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.map(i=>Ce(i)).reduce((i,o)=>i.concat(o),[]),size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],validator:(e,t)=>{var l;const i=(l=t.colors)!=null?l:[];let o=e;const s=e;if(o.length===0||o&&o.length!==i.length){for(let c=0;c<i.length;c++)o[c]?(s[c]=o[c],o[c-1]===void 0&&s[c-2]!==void 0&&(s[c-1]=s[c-2]+(o[c]-s[c-2])/2)):s[c]=c*(1/(i.length-1));o=s}return s},size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),d(He,"methods",{fromLinear:"\n      vec4 function(vec4 linearRGB) {\n        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);\n        vec4 lower = linearRGB * vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",toLinear:"\n      vec4 function(vec4 sRGB) {\n        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));\n        vec4 lower = sRGB/vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "}),d(He,"ColorLoop",e=>{let t="";for(let i=2;i<e;i++)t+="colorOut = mix(colorOut, colors[".concat(i,"], clamp((dist - stops[").concat(i-1,"]) / (stops[").concat(i,"] - stops[").concat(i-1,"]), 0.0, 1.0));");return t}),d(He,"onColorize",e=>{const t=e.colors.length||1;return"\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));\n      for(int i = 1; i < ".concat(t,"-1; i++) {\n        stopCalc = (dist - stops[i]) / (stops[i + 1] - stops[i]);\n        colorOut = mix(colorOut, colors[i + 1], clamp(stopCalc, 0.0, 1.0));\n      }\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});class pr extends ne{constructor(){super(...arguments);d(this,"name","grayscale")}static getEffectKey(){return"grayscale"}}d(pr,"onColorize","\n    vec3 color = pow(maskColor.rgb, vec3(2.0));\n    float gray = dot(color, vec3(0.2126, 0.7152, 0.0722));\n    float gammaGray = sqrt(gray);\n    return vec4(gammaGray, gammaGray, gammaGray, 1.0);\n  ");class Ge extends ne{constructor(){super(...arguments);d(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){var t,i;return{width:(t=e.width)!=null?t:10,color:(i=e.color)!=null?i:4294967295}}}d(Ge,"z$__type__Props"),d(Ge,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Ce(e),method:"uniform4fv",type:"vec4"}}),d(Ge,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),d(Ge,"onEffectMask","\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),d(Ge,"onColorize","\n    return color;\n  ");class Ve extends ne{constructor(){super(...arguments);d(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){var t,i;return{width:(t=e.width)!=null?t:10,color:(i=e.color)!=null?i:4294967295}}}d(Ve,"z$__type__Props"),d(Ve,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Ce(e),method:"uniform4fv",type:"vec4"}}),d(Ve,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),d(Ve,"onEffectMask","\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),d(Ve,"onColorize","\n    return color;\n  ");class Ke extends ne{constructor(){super(...arguments);d(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){var t,i;return{width:(t=e.width)!=null?t:10,color:(i=e.color)!=null?i:4294967295}}}d(Ke,"z$__type__Props"),d(Ke,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Ce(e),method:"uniform4fv",type:"vec4"}}),d(Ke,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),d(Ke,"onEffectMask","\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),d(Ke,"onColorize","\n    return color;\n  ");class qe extends ne{constructor(){super(...arguments);d(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){var t,i;return{width:(t=e.width)!=null?t:10,color:(i=e.color)!=null?i:4294967295}}}d(qe,"z$__type__Props"),d(qe,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Ce(e),method:"uniform4fv",type:"vec4"}}),d(qe,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),d(qe,"onEffectMask","\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),d(qe,"onColorize","\n    return color;\n  ");class ct extends ne{constructor(){super(...arguments);d(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){var t,i,o,s,l;return{amplitude:(t=e.amplitude)!=null?t:.2,narrowness:(i=e.narrowness)!=null?i:4,blockiness:(o=e.blockiness)!=null?o:2,minimizer:(s=e.minimizer)!=null?s:8,time:(l=e.time)!=null?l:Date.now()}}}d(ct,"z$__type__Props"),d(ct,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",validator:e=>(Date.now()-e)%1e3,type:"float"}}),d(ct,"methods",{rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "}),d(ct,"onColorize","\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ");class kt extends ne{constructor(){super(...arguments);d(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){var t;return{fade:(t=e.fade)!=null?t:10}}}d(kt,"z$__type__Props"),d(kt,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:e=>{let t=e;return Array.isArray(t)?t.length===2?t=[t[0],t[1],t[0],t[1]]:t.length===3?t=[t[0],t[1],t[2],t[0]]:t.length!==4&&(t=[t[0],t[0],t[0],t[0]]):typeof t=="number"&&(t=[t,t,t,t]),t}}}),d(kt,"onColorize","\n  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ");class Lt extends ne{constructor(){super(...arguments);d(this,"name","radialGradient")}static getEffectKey(e){return"radialGradient".concat(e.colors.length)}static resolveDefaults(e){var o,s,l,c,u;const t=(o=e.colors)!=null?o:[4278190080,4294967295];let i=e.stops;if(!i){i=[];const h=t.length-1;for(let f=0;f<t.length;f++)i.push(f*(1/h))}return{colors:t,stops:i,width:(s=e.width)!=null?s:0,height:(c=(l=e.height)!=null?l:e.width)!=null?c:0,pivot:(u=e.pivot)!=null?u:[.5,.5]}}}d(Lt,"z$__type__Props"),d(Lt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.map(i=>Ce(i)).reduce((i,o)=>i.concat(o),[]),size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],validator:(e,t)=>{var l;const i=(l=t.colors)!=null?l:[];let o=e;const s=e;if(o.length===0||o&&o.length!==i.length){for(let c=0;c<i.length;c++)o[c]?(s[c]=o[c],o[c-1]===void 0&&s[c-2]!==void 0&&(s[c-1]=s[c-2]+(o[c]-s[c-2])/2)):s[c]=c*(1/(i.length-1));o=s}return s},size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),d(Lt,"onColorize",e=>{const t=e.colors.length||1;return"\n      vec2 point = v_textureCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = mix(colors[0], colors[1], stopCalc);\n      for(int i = 1; i < ".concat(t,"-1; i++) {\n        stopCalc = (dist - stops[i]) / (stops[i + 1] - stops[i]);\n        colorOut = mix(colorOut, colors[i + 1], clamp(stopCalc, 0.0, 1.0));\n      }\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});class Qe extends ne{constructor(){super(...arguments);d(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){var t,i,o,s,l,c,u;return{width:(t=e.width)!=null?t:10,progress:(i=e.progress)!=null?i:.5,offset:(o=e.offset)!=null?o:0,range:(s=e.range)!=null?s:Math.PI*2,rounded:(l=e.rounded)!=null?l:!1,radius:(c=e.radius)!=null?c:1,color:(u=e.color)!=null?u:4294967295}}}d(Qe,"z$__type__Props"),d(Qe,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Ce(e),method:"uniform4fv",type:"vec4"}}),d(Qe,"methods",{rotateUV:"\n    vec2 function(vec2 uv, float d) {\n      float s = sin(d);\n      float c = cos(d);\n      mat2 rotMatrix = mat2(c, -s, s, c);\n      return uv * rotMatrix;\n    }\n    ",drawDot:"\n    float function(vec2 uv, vec2 p, float r) {\n      uv += p;\n      float circle = length(uv) - r;\n      return clamp(-circle, 0.0, 1.0);\n    }\n    "}),d(Qe,"onEffectMask","\n    float outerRadius = radius * u_dimensions.y * 0.5;\n\n    float endAngle = range * progress - 0.0005;\n\n    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;\n\n    uv = $rotateUV(uv, -(offset));\n    float linewidth = width * u_pixelRatio;\n    float circle = length(uv) - (outerRadius - linewidth) ;\n    circle = abs(circle) - linewidth;\n    circle = clamp(-circle, 0.0, 1.0);\n\n    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);\n    float p = endAngle / (PI * 2.);\n\n    circle *= step(fract(angle), fract(p));\n\n    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));\n    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));\n\n    return mix(shaderColor, maskColor, circle);\n  "),d(Qe,"onColorize","\n    return color;\n  ");class wi{constructor(){d(this,"shCache",new Map);d(this,"shConstructors",{});d(this,"attachedShader",null);d(this,"effectConstructors",{});d(this,"renderer");this.registerShaderType("DefaultShader",dr),this.registerShaderType("DefaultShaderBatched",fr),this.registerShaderType("RoundedRectangle",fn),this.registerShaderType("DynamicShader",Je),this.registerShaderType("SdfShader",pn),this.registerEffectType("border",lt),this.registerEffectType("borderBottom",Ke),this.registerEffectType("borderLeft",qe),this.registerEffectType("borderRight",Ge),this.registerEffectType("borderTop",Ve),this.registerEffectType("fadeOut",kt),this.registerEffectType("linearGradient",He),this.registerEffectType("radialGradient",Lt),this.registerEffectType("grayscale",pr),this.registerEffectType("glitch",ct),this.registerEffectType("radius",Xe),this.registerEffectType("radialProgress",Qe)}registerShaderType(n,e){this.shConstructors[n]=e}registerEffectType(n,e){this.effectConstructors[n]=e}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(n,e){if(!this.renderer)throw new Error("Renderer is not been defined");const t=this.shConstructors[n];if(!t)throw new Error('Shader type "'.concat(n,'" is not registered'));if(n==="DynamicShader")return this.loadDynamicShader(e);const i=t.resolveDefaults(e),o=t.makeCacheKey(i)||t.name;if(o&&this.shCache.has(o))return{shader:this.shCache.get(o),props:i};const s=new t(this.renderer,e);return o&&this.shCache.set(o,s),{shader:s,props:i}}loadDynamicShader(n){if(!this.renderer)throw new Error("Renderer is not been defined");const e=Je.resolveDefaults(n,this.effectConstructors),t=Je.makeCacheKey(e,this.effectConstructors);if(t&&this.shCache.has(t))return{shader:this.shCache.get(t),props:e};const i=new Je(this.renderer,n,this.effectConstructors);return t&&this.shCache.set(t,i),{shader:i,props:e}}useShader(n){this.attachedShader!==n&&(this.attachedShader&&this.attachedShader.detach(),n.attach(),this.attachedShader=n)}}class _i{constructor(){d(this,"activeAnimations",new Set)}registerAnimation(n){this.activeAnimations.add(n)}unregisterAnimation(n){this.activeAnimations.delete(n)}update(n){this.activeAnimations.forEach(e=>{e.update(n)})}}const ft=class ft extends Zn{constructor(e,t){super(e);d(this,"props");this.props=ft.resolveDefaults(t)}async getTextureData(){const{src:e,premultiplyAlpha:t}=this.props;if(!e)return{data:null};if(e instanceof ImageData)return{data:e,premultiplyAlpha:t};const o=await(await fetch(e)).blob();return{data:await createImageBitmap(o,{premultiplyAlpha:t?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"})}}static makeCacheKey(e){const t=ft.resolveDefaults(e);return t.src instanceof ImageData?!1:"ImageTexture,".concat(t.src,",").concat(t.premultiplyAlpha)}static resolveDefaults(e){var t,i;return{src:(t=e.src)!=null?t:"",premultiplyAlpha:(i=e.premultiplyAlpha)!=null?i:!0}}};d(ft,"z$__type__Props");let gn=ft;const pt=class pt extends Zn{constructor(e,t){super(e);d(this,"props");this.props=pt.resolveDefaults(t)}async getTextureData(){const{width:e,height:t}=this.props,i=e*t*4,o=new Uint8ClampedArray(i);for(let s=0;s<i;s+=4){const l=Math.floor(Math.random()*256);o[s]=l,o[s+1]=l,o[s+2]=l,o[s+3]=255}return{data:new ImageData(o,e,t)}}static makeCacheKey(e){const t=pt.resolveDefaults(e);return"NoiseTexture,".concat(t.width,",").concat(t.height,",").concat(t.cacheId)}static resolveDefaults(e){var t,i,o;return{width:(t=e.width)!=null?t:128,height:(i=e.height)!=null?i:128,cacheId:(o=e.cacheId)!=null?o:0}}};d(pt,"z$__type__Props");let mn=pt;class Si{constructor(){d(this,"usedMemory",0);d(this,"txConstructors",{});d(this,"textureKeyCache",new Map);d(this,"textureIdCache",new Map);d(this,"ctxTextureCache",new WeakMap);d(this,"textureRefCountMap",new WeakMap);d(this,"renderer");this.registerTextureType("ImageTexture",gn),this.registerTextureType("ColorTexture",$r),this.registerTextureType("NoiseTexture",mn),this.registerTextureType("SubTexture",Dr)}registerTextureType(n,e){this.txConstructors[n]=e}loadTexture(n,e,t=null){var s;const i=this.txConstructors[n];if(!i)throw new Error('Texture type "'.concat(n,'" is not registered'));let o;if((t==null?void 0:t.id)!==void 0&&this.textureIdCache.has(t.id)&&(o=this.textureIdCache.get(t.id)),!o){const l=t==null?void 0:t.id,c=(s=t==null?void 0:t.cacheKey)!=null?s:i.makeCacheKey(e);c&&this.textureKeyCache.has(c)?o=this.textureKeyCache.get(c):o=new i(this,e),l&&this.addTextureIdToCache(l,c,o)}return t!=null&&t.preload&&this.getCtxTexture(o).load(),o}addTextureIdToCache(n,e,t){const{textureIdCache:i,textureRefCountMap:o}=this;i.set(n,t),o.has(t)?o.get(t).count++:(o.set(t,{cacheKey:e,count:1}),e&&this.textureKeyCache.set(e,t))}removeTextureIdFromCache(n){const{textureIdCache:e,textureRefCountMap:t}=this,i=e.get(n);if(i&&(e.delete(n),t.has(i))){const o=t.get(i);A(o),o.count--,o.count===0&&(t.delete(i),o.cacheKey&&this.textureKeyCache.delete(o.cacheKey))}}getDebugInfo(){return{keyCacheSize:this.textureKeyCache.size,idCacheSize:this.textureIdCache.size}}getCtxTexture(n){if(this.ctxTextureCache.has(n))return this.ctxTextureCache.get(n);const e=this.renderer.createCtxTexture(n);return this.ctxTextureCache.set(n,e),e}}class gr{constructor(n){d(this,"textRenderers");this.textRenderers=n}addFontFace(n){for(const e in this.textRenderers){const t=this.textRenderers[e];t&&t.isFontFaceSupported(n)&&t.addFontFace(n)}}static resolveFontFace(n,e){const t=[];return n.reduce((o,s)=>{if(o)return o;const l=s[e.fontFamily];if(!l)return;const c=new Set(l);for(const u of c)(u.descriptors.stretch!==e.fontStretch||u.descriptors.style!==e.fontStyle||u.descriptors.weight!==e.fontWeight)&&c.delete(u);return c.values().next().value},void 0)||t[0]}}const bi={x:(r,n)=>{r.props.x=n},y:(r,n)=>{r.props.y=n},width:(r,n)=>{r.props.width=n},height:(r,n)=>{r.props.height=n},color:(r,n)=>{r.props.color=n},zIndex:(r,n)=>{r.props.zIndex=n},fontFamily:(r,n)=>{r.props.fontFamily=n},fontWeight:(r,n)=>{r.props.fontWeight=n},fontStyle:(r,n)=>{r.props.fontStyle=n},fontStretch:(r,n)=>{r.props.fontStretch=n},fontSize:(r,n)=>{r.props.fontSize=n},text:(r,n)=>{r.props.text=n},textAlign:(r,n)=>{r.props.textAlign=n},contain:(r,n)=>{r.props.contain=n},offsetY:(r,n)=>{r.props.offsetY=n},scrollable:(r,n)=>{r.props.scrollable=n},scrollY:(r,n)=>{r.props.scrollY=n},letterSpacing:(r,n)=>{r.props.letterSpacing=n},debug:(r,n)=>{r.props.debug=n}};class mr{constructor(n){d(this,"stage");d(this,"set");this.stage=n;const e={...bi,...this.getPropertySetters()};this.set=Object.freeze(Object.fromEntries(Object.entries(e).map(([t,i])=>[t,(o,s)=>{o.props[t]!==s&&i(o,s)}])))}setStatus(n,e,t){n.status!==e&&(n.status=e,n.emitter.emit(e,t))}scheduleUpdateState(n){n.updateScheduled||(n.updateScheduled=!0,queueMicrotask(()=>{n.updateScheduled=!1,this.updateState(n)}))}}const Ti=24;function Ci(r,n,e,t,i,o,s){let l=0;i&&(l=Math.min(Math.max(Math.floor(i.y1/r),0),o.length));const c=0,u=n/e+l*t;if(!(s&&u>=s/e))return{x:c,y:u,lineIndex:l}}class At{constructor(n,e=0){d(this,"iterator");d(this,"peekBuffer",[]);d(this,"_lastIndex");this.iterator=n,this.iterator=n,this._lastIndex=e-1,this.peekBuffer=[]}next(){const n=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return n.done?this._lastIndex=-1:this._lastIndex++,n}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const n=this.iterator.next();return this.peekBuffer.push(n),n}get lastIndex(){return this._lastIndex}}function*Pt(r,n=0){let e=n;for(;e<r.length;){const t=r.codePointAt(e);if(t===void 0)throw new Error("Invalid Unicode code point");yield t,e+=t<=65535?1:2}}function Ri(r,n,e){const t=e.shapeText(n,new At(Pt(r,0),0));let i=0;for(const o of t)o.mapped&&(i+=o.xAdvance);return i}function Ei(r,n,e,t,i,o,s,l,c,u,h,f,v,_,x,y){A(_,"Font face must be loaded"),A(_.loaded,"Font face must be loaded"),A(_.data,"Font face must be loaded"),A(_.shaper,"Font face must be loaded");const T=_.data.info.size,S=l/T,p=o/S,m=c/S,g=f[r],C=(g==null?void 0:g.codepointIndex)||0,E=(g==null?void 0:g.maxX)||0,I=(g==null?void 0:g.maxY)||0;let b=E,w=I,R=n,L=e,k=0;const z={codepointIndex:-1,bufferOffset:-1,xStart:-1},Y=_.shaper,W={letterSpacing:m};let te=Y.shapeText(W,new At(Pt(t,C),C)),Q,ce=-1;const me=[],rt="...",_t=s/S,St=Ri(rt,W,Y);let Ne=!0;for(;Ne;){const ve=h!=="both"||y||L+T+T<=_t,he=ve?p:p-St;let Z=0;for(;(Q=te.next())&&!Q.done;){const O=Q.value;if(r===f.length)f.push({codepointIndex:O.cluster,maxY:w,maxX:b});else if(r>f.length)throw new Error("Unexpected lineCache length");if(O.codepoint===32||O.codepoint===10?z.codepointIndex!==-1&&(z.codepointIndex=-1,Z=R):z.codepointIndex===-1&&(z.codepointIndex=O.cluster,z.bufferOffset=k,z.xStart=Z),O.mapped){const ke=R+O.xOffset+O.width;if(h!=="none"&&ke>=he&&z.codepointIndex!==-1&&z.codepointIndex<O.cluster&&z.xStart>0)if(ve){te=Y.shapeText(W,new At(Pt(t,z.codepointIndex),z.codepointIndex)),k=z.bufferOffset;break}else te=Y.shapeText(W,new At(Pt(rt,0),0)),R=z.xStart,k=z.bufferOffset;else{const se=R+O.xOffset,Le=L+O.yOffset,bt=v?L+T>=v.y1/S:!0,Tt=v?L<=v.y2/S:!0;if(bt&&Tt){ce===-1&&(ce=k);const Be=_.getAtlasEntry(O.glyphId),$e=Be.x/_.data.common.scaleW,De=Be.y/_.data.common.scaleH,it=Be.width/_.data.common.scaleW,Pn=Be.height/_.data.common.scaleH;u[k++]=se,u[k++]=Le,u[k++]=$e,u[k++]=De,u[k++]=se+O.width,u[k++]=Le,u[k++]=$e+it,u[k++]=De,u[k++]=se,u[k++]=Le+O.height,u[k++]=$e,u[k++]=De+Pn,u[k++]=se+O.width,u[k++]=Le+O.height,u[k++]=$e+it,u[k++]=De+Pn}w=Math.max(w,Le+O.height),R+=O.xAdvance,b=Math.max(b,R)}}else if(O.codepoint===10)break}ce!==-1&&(me.push({bufferStart:ce,bufferEnd:k}),ce=-1),R=0,L+=T,r++,z.codepointIndex=-1,Z=0,(!x&&h==="both"&&v&&L>v.y2/S||Q&&Q.done||h==="both"&&!y&&!ve)&&(Ne=!1)}if(i==="center"){const ve=h==="none"?b:p;for(let he=0;he<me.length;he++){const Z=me[he],O=u[Z.bufferEnd-4]-u[Z.bufferStart],ke=(ve-O)/2;for(let se=Z.bufferStart;se<Z.bufferEnd;se+=4)u[se]+=ke}}else if(i==="right"){const ve=h==="none"?b:p;for(let he=0;he<me.length;he++){const Z=me[he],O=Z.bufferEnd===Z.bufferStart?0:u[Z.bufferEnd-4]-u[Z.bufferStart],ke=ve-O;for(let se=Z.bufferStart;se<Z.bufferEnd;se+=4)u[se]+=ke}}return A(Q),{bufferNumFloats:k,bufferNumQuads:k/16,layoutNumCharacters:Q.done?t.length-C:Q.value.cluster-C+1,fullyProcessed:!!Q.done,maxX:b,maxY:w}}function Ii(r,n,e,t,i,o){const s=t*i,l=o.x1-r,c=o.y1-n;return Or(o)?{x1:l,y1:c+e-s,x2:l+(o.x2-o.x1),y2:c+e+(o.y2-o.y1)+s}:{x1:0,y1:0,x2:0,y2:0}}const Fi=Vt(0,0,0,0);class ki extends mr{constructor(e){super(e);d(this,"ssdfFontFamilies",{});d(this,"msdfFontFamilies",{});d(this,"sdfShader");d(this,"rendererBounds");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,t)=>{e.props.fontFamily=t,e.trFontFace=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,t)=>{e.props.fontWeight=t,e.trFontFace=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,t)=>{e.props.fontStyle=t,e.trFontFace=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,t)=>{e.props.fontStretch=t,e.trFontFace=void 0,this.invalidateLayoutCache(e)},fontSize:(e,t)=>{e.props.fontSize=t,this.invalidateLayoutCache(e)},text:(e,t)=>{e.props.text=t,this.invalidateLayoutCache(e)},textAlign:(e,t)=>{e.props.textAlign=t,this.invalidateLayoutCache(e)},color:(e,t)=>{e.props.color=t},x:(e,t)=>{e.props.x=t,this.invalidateVisibleWindowCache(e)},y:(e,t)=>{e.props.y=t,this.invalidateVisibleWindowCache(e)},contain:(e,t)=>{e.props.contain=t,this.invalidateLayoutCache(e)},width:(e,t)=>{e.props.width=t,this.invalidateLayoutCache(e)},height:(e,t)=>{e.props.height=t,this.invalidateLayoutCache(e)},offsetY:(e,t)=>{e.props.offsetY=t,this.invalidateLayoutCache(e)},scrollable:(e,t)=>{e.props.scrollable=t,this.invalidateLayoutCache(e)},scrollY:(e,t)=>{e.props.scrollY=t,this.scheduleUpdateState(e)},letterSpacing:(e,t)=>{e.props.letterSpacing=t,this.invalidateLayoutCache(e)},debug:(e,t)=>{e.props.debug=t}}}canRenderFont(e){const{fontFamily:t}=e;return t in this.ssdfFontFamilies||t in this.msdfFontFamilies||t==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(e){return e instanceof Mn}addFontFace(e){A(e instanceof Mn);const t=e.fontFamily,i=e.type==="ssdf"?this.ssdfFontFamilies:e.type==="msdf"?this.msdfFontFamilies:void 0;if(!i){console.warn("Invalid font face type: ".concat(e.type));return}let o=i[t];o||(o=new Set,i[t]=o),o.add(e)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new We,lineCache:[],forceFullLayoutCalc:!1,renderWindow:void 0,visibleWindow:{x1:0,y1:0,x2:0,y2:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){let{trFontFace:t}=e;const{textH:i,lineCache:o,debugData:s,forceFullLayoutCalc:l}=e;if(s.updateCount++,e.status==="initialState"&&this.setStatus(e,"loading"),!t&&(t=this.resolveFontFace(e.props),e.trFontFace=t,!t)){const k="SdfTextRenderer: Could not resolve font face for family: '".concat(e.props.fontFamily,"'");console.error(k),this.setStatus(e,"failed",new Error(k));return}if(!t.loaded){t.once("loaded",()=>{this.scheduleUpdateState(e)});return}A(t.data,"Font face data should be loaded");const{text:c,fontSize:u,x:h,y:f,contain:v,width:_,height:x,scrollable:y}=e.props,T=v==="both"&&y?e.props.scrollY:0;let{renderWindow:S}=e;const p=t.data.info.size,m=u/p;e.distanceRange=m*t.data.distanceField.distanceRange;const g=c.length*Ti;let C=e.vertexBuffer;(!C||C.length<g)&&(C=new Float32Array(g*2));const E=e.visibleWindow;if(!E.valid){const k=Vt(h,f,v!=="none"?h+_:1/0,v==="both"?f+x:1/0,Fi);Jn(this.rendererBounds,k,e.visibleWindow),E.valid=!0}if(!l&&S){if(h+S.x1<=E.x1&&h+S.x2>=E.x2&&f-T+S.y1<=E.y1&&f-T+S.y2>=E.y2){this.setStatus(e,"loaded");return}S=e.renderWindow=void 0,this.setStatus(e,"loading")}const{offsetY:I,textAlign:b}=e.props;if(!S){const k=E.y2-E.y1,z=Math.ceil(k/p);S=Ii(h,f,T,p,z,E)}const w=Ci(u,I,m,p,S,o,i);if(!w){this.setStatus(e,"loaded");return}const{letterSpacing:R}=e.props,L=Ei(w.lineIndex,w.x,w.y,c,b,_,x,u,R,C,v,o,S,t,l,y);e.bufferUploaded=!1,e.bufferNumFloats=L.bufferNumFloats,e.bufferNumQuads=L.bufferNumQuads,e.vertexBuffer=C,e.renderWindow=S,s.lastLayoutNumCharacters=L.layoutNumCharacters,s.bufferSize=C.byteLength,L.fullyProcessed&&(e.textW=L.maxX*m,e.textH=L.maxY*m),this.setStatus(e,"loaded")}renderQuads(e,t,i,o){var b,w,R;if(!e.vertexBuffer)return;performance.now();const{renderer:s}=this.stage;this.stage.options;const{fontSize:l,color:c,contain:u,scrollable:h,zIndex:f,debug:v}=e.props,_=u==="both"&&h?e.props.scrollY:0,{textW:x=0,textH:y=0,distanceRange:T,vertexBuffer:S,bufferUploaded:p,trFontFace:m}=e;let{webGlBuffers:g}=e;if(!g){const L=s.gl,k=4*Float32Array.BYTES_PER_ELEMENT,z=L.createBuffer();A(z),e.webGlBuffers=new Yr([{buffer:z,attributes:{a_position:{name:"a_position",size:2,type:L.FLOAT,normalized:!1,stride:k,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:L.FLOAT,normalized:!1,stride:k,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,A(e.webGlBuffers),g=e.webGlBuffers}if(!p){const L=s.gl,k=(b=g==null?void 0:g.getBuffer("a_textureCoordinate"))!=null?b:null;L.bindBuffer(L.ARRAY_BUFFER,k),L.bufferData(L.ARRAY_BUFFER,S,L.STATIC_DRAW),e.bufferUploaded=!0}A(m);const C=new Ur(s.gl,s.options,g,this.sdfShader,{transform:t.data,color:Wr(c,o),size:l/(((w=m.data)==null?void 0:w.info.size)||0),scrollY:_,distanceRange:T,debug:v.sdfShaderDebug},o,i,{height:y,width:x},0,f),E=(R=e.trFontFace)==null?void 0:R.texture;A(E);const I=this.stage.txManager.getCtxTexture(E);C.addTexture(I),C.length=e.bufferNumFloats,C.numQuads=e.bufferNumQuads,s.addRenderOp(C)}resolveFontFace(e){return gr.resolveFontFace([this.msdfFontFamilies,this.ssdfFontFamilies],e)}invalidateVisibleWindowCache(e){e.visibleWindow.valid=!1,this.scheduleUpdateState(e)}invalidateLayoutCache(e){e.visibleWindow.valid=!1,e.renderWindow=void 0,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}}const $n=2048;class Li{constructor(n,e){d(this,"_canvas");d(this,"_context");d(this,"_settings");d(this,"renderInfo");this._canvas=n,this._context=e,this._settings=this.mergeDefaults({})}set settings(n){this._settings=this.mergeDefaults(n)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const n=[this._settings.fontFace],e=[];for(let t=0,i=n.length;t<i;t++)n[t]==="serif"||n[t]==="sans-serif"?e.push(n[t]):e.push('"'.concat(n[t],'"'));return"".concat(this._settings.fontStyle," ").concat(this._settings.fontSize*this.getPrecision(),"px ").concat(e.join(","))}_load(){if(document.fonts){const n=this._getFontSetting();try{if(!document.fonts.check(n,this._settings.text))return document.fonts.load(n,this._settings.text).catch(e=>{console.warn("[Lightning] Font load error",e,n)}).then(()=>{document.fonts.check(n,this._settings.text)||console.warn("[Lightning] Font not found",n)})}catch(e){console.warn("[Lightning] Can't check font loading for "+n)}}}calculateRenderInfo(){const n={},e=this.getPrecision(),t=this._settings.paddingLeft*e,i=this._settings.paddingRight*e,o=this._settings.fontSize*e;let s=this._settings.offsetY===null?null:this._settings.offsetY*e,l=(this._settings.lineHeight||o)*e;const c=this._settings.w*e,u=this._settings.h*e;let h=this._settings.wordWrapWidth*e;const f=this._settings.cutSx*e,v=this._settings.cutEx*e,_=this._settings.cutSy*e,x=this._settings.cutEy*e,y=(this._settings.letterSpacing||0)*e,T=this._settings.textIndent*e;this.setFontProperties();let S=c||2048/this.getPrecision(),p=S-t;if(p<10&&(S+=10-p,p=10),h||(h=p),this._settings.textOverflow&&!this._settings.wordWrap){let b;switch(this._settings.textOverflow){case"clip":b="";break;case"ellipsis":b=this._settings.maxLinesSuffix;break;default:b=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,h-T,b)}let m;if(this._settings.wordWrap)m=this.wrapText(this._settings.text,h,y,T);else{m={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const b=m.l.length;for(let w=0;w<b-1;w++)m.n.push(w)}let g=m.l;if(this._settings.maxLines&&g.length>this._settings.maxLines){const b=g.slice(0,this._settings.maxLines);let w=null;if(this._settings.maxLinesSuffix){const Y=this._settings.maxLinesSuffix?this.measureText(this._settings.maxLinesSuffix):0,W=this.wrapText(b[b.length-1],h-Y,y,T);b[b.length-1]="".concat(W.l[0]).concat(this._settings.maxLinesSuffix),w=[W.l.length>1?W.l[1]:""]}else w=[""];let R;const L=g.length;let k=0;const z=m.n.length;for(R=this._settings.maxLines;R<L;R++)w[k]+="".concat(w[k]?" ":"").concat(g[R]),R+1<z&&m.n[R+1]&&k++;n.remainingText=w.join("\n"),n.moreTextLines=!0,g=b}else n.moreTextLines=!1,n.remainingText="";let C=0;const E=[];for(let b=0;b<g.length;b++){const w=this.measureText(g[b],y)+(b===0?T:0);E.push(w),C=Math.max(C,w)}n.lineWidths=E,c||(S=C+t+i,p=C),l=l||o;let I;if(u)I=u;else{const b=this._settings.textBaseline!="bottom"?.5*o:0;I=l*(g.length-1)+b+Math.max(l,o)+(s||0)}return s===null&&(s=o),n.w=S,n.h=I,n.lines=g,n.precision=e,S||(S=1),I||(I=1),(f||v)&&(S=Math.min(S,v-f)),(_||x)&&(I=Math.min(I,x-_)),n.width=S,n.innerWidth=p,n.height=I,n.fontSize=o,n.cutSx=f,n.cutSy=_,n.cutEx=v,n.cutEy=x,n.lineHeight=l,n.lineWidths=E,n.offsetY=s,n.paddingLeft=t,n.paddingRight=i,n.letterSpacing=y,n.textIndent=T,n}draw(n,e){const t=this.getPrecision(),i=(e==null?void 0:e.lines)||n.lines,o=(e==null?void 0:e.lineWidths)||n.lineWidths,s=e?e.lines.length*n.lineHeight:n.height;this._canvas.width=Math.min(Math.ceil(n.width+this._settings.textRenderIssueMargin),$n),this._canvas.height=Math.min(Math.ceil(s),$n),this.setFontProperties(),n.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(n.cutSx||n.cutSy)&&this._context.translate(-n.cutSx,-n.cutSy);let l,c;const u=[];for(let f=0,v=i.length;f<v;f++)l=f===0?n.textIndent:0,c=f*n.lineHeight+n.offsetY,this._settings.verticalAlign=="middle"?c+=(n.lineHeight-n.fontSize)/2:this._settings.verticalAlign=="bottom"&&(c+=n.lineHeight-n.fontSize),this._settings.textAlign==="right"?l+=n.innerWidth-o[f]:this._settings.textAlign==="center"&&(l+=(n.innerWidth-o[f])/2),l+=n.paddingLeft,u.push({text:i[f],x:l,y:c,w:o[f]});if(this._settings.highlight){const f=this._settings.highlightColor,v=this._settings.highlightHeight*t||n.fontSize*1.5,_=this._settings.highlightOffset*t,x=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*t:n.paddingLeft,y=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*t:n.paddingRight;this._context.fillStyle=tn(f);for(let T=0;T<u.length;T++){const S=u[T];this._context.fillRect(S.x-x,S.y-n.offsetY+_,S.w+y+x,v)}}let h=null;this._settings.shadow&&(h=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=tn(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*t,this._context.shadowOffsetY=this._settings.shadowOffsetY*t,this._context.shadowBlur=this._settings.shadowBlur*t),this._context.fillStyle=tn(this._settings.textColor);for(let f=0,v=u.length;f<v;f++){const _=u[f];if(n.letterSpacing===0)this._context.fillText(_.text,_.x,_.y);else{const x=_.text.split("");let y=_.x;for(let T=0,S=x.length;T<S;T++)this._context.fillText(x[T],y,_.y),y+=this.measureText(x[T],n.letterSpacing)}}h&&(this._context.shadowColor=h[0],this._context.shadowOffsetX=h[1],this._context.shadowOffsetY=h[2],this._context.shadowBlur=h[3]),(n.cutSx||n.cutSy)&&this._context.translate(n.cutSx,n.cutSy),this.renderInfo=n}wrapWord(n,e,t){const i=this._context.measureText(t).width,o=n.length,s=this._context.measureText(n).width;if(s<=e)return n;let l=Math.floor(e*o/s),c=this._context.measureText(n.substring(0,l)).width+i;if(c>e)for(;l>0&&(c=this._context.measureText(n.substring(0,l)).width+i,c>e);)l-=1;else for(;l<o;)if(c=this._context.measureText(n.substring(0,l)).width+i,c<e)l+=1;else{l-=1;break}return n.substring(0,l)+(e>=i?t:"")}wrapText(n,e,t,i=0){const o=n.split(/\r?\n/g);let s=[];const l=[];for(let c=0;c<o.length;c++){const u=[];let h="",f=e-i;const v=o[c].split(" ");for(let _=0;_<v.length;_++){const x=this.measureText(v[_],t),y=x+this.measureText(" ",t);_===0||y>f?(_>0&&(u.push(h),h=""),h+=v[_],f=e-x-(_===0?i:0)):(f-=y,h+=" ".concat(v[_]))}u.push(h),h="",s=s.concat(u),c<o.length-1&&l.push(s.length)}return{l:s,n:l}}measureText(n,e=0){return e?n.split("").reduce((t,i)=>t+this._context.measureText(i).width+e,0):this._context.measureText(n).width}mergeDefaults(n){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxLinesSuffix:"..",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...n}}}const Dn=typeof self>"u"?globalThis:self;var qn;const On=((qn=Dn.document)==null?void 0:qn.fonts)||Dn.fonts;function Ai(r){const{fontFamily:n,fontStyle:e,fontWeight:t,fontStretch:i,fontSize:o}=r;return[e,t,i,"".concat(o,"px"),n].join(" ")}const Pi=Vt(0,0,0,0);class zi extends mr{constructor(e){super(e);d(this,"canvas");d(this,"context");d(this,"rendererBounds");typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let t=this.canvas.getContext("2d");t||(this.canvas=document.createElement("canvas"),t=this.canvas.getContext("2d")),A(t),this.context=t,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,t)=>{e.props.fontFamily=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,t)=>{e.props.fontWeight=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,t)=>{e.props.fontStyle=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,t)=>{e.props.fontStretch=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,t)=>{e.props.fontSize=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,t)=>{e.props.text=t,this.invalidateLayoutCache(e)},textAlign:(e,t)=>{e.props.textAlign=t,this.invalidateLayoutCache(e)},color:(e,t)=>{e.props.color=t,this.invalidateLayoutCache(e)},x:(e,t)=>{e.props.x=t,this.invalidateVisibleWindowCache(e)},y:(e,t)=>{e.props.y=t,this.invalidateVisibleWindowCache(e)},contain:(e,t)=>{e.props.contain=t,this.invalidateLayoutCache(e)},width:(e,t)=>{e.props.width=t,this.invalidateLayoutCache(e)},height:(e,t)=>{e.props.height=t,this.invalidateLayoutCache(e)},offsetY:(e,t)=>{e.props.offsetY=t,this.invalidateLayoutCache(e)},scrollY:(e,t)=>{e.props.scrollY=t},letterSpacing:(e,t)=>{e.props.letterSpacing=t,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof Nn}addFontFace(e){A(e instanceof Nn),On.add(e.fontFace)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new We,canvasPages:void 0,lightning2TextRenderer:new Li(this.canvas,this.context),renderWindow:void 0,visibleWindow:{x1:0,y1:0,x2:0,y2:0,valid:!1},renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,fontFaceLoadedHandler:void 0,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){if(e.status==="initialState"&&this.setStatus(e,"loading"),!e.fontInfo){const x=Ai(e.props);if(e.fontInfo={cssString:x,loaded:!1},!e.fontInfo.loaded){On.load(x).then(this.onFontLoaded.bind(this,e,x)).catch(this.onFontLoadError.bind(this,e,x));return}}if(!e.fontInfo.loaded)return;e.renderInfo||(e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFace:e.props.fontFamily,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:Ce(e.props.color),offsetY:e.props.fontSize+e.props.offsetY,wordWrap:e.props.contain!=="none",wordWrapWidth:e.props.contain==="none"?void 0:e.props.width,letterSpacing:e.props.letterSpacing},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,e.renderWindow=void 0);const{x:t,y:i,width:o,height:s,scrollY:l,contain:c}=e.props,{visibleWindow:u}=e;let{renderWindow:h,canvasPages:f}=e;if(!u.valid){const x=Vt(t,i,c!=="none"?t+o:1/0,c==="both"?i+s:1/0,Pi);Jn(this.rendererBounds,x,u),u.valid=!0}const v=u.y2-u.y1,_=Math.ceil(v/e.renderInfo.lineHeight);if(v===0){f=void 0,h=void 0,this.setStatus(e,"loaded");return}else if(h&&f){const x=t+h.x1,y=i-l+h.y1,T=t+h.x2,S=i-l+h.y2;if(x<=u.x1&&T>=u.x2&&y<=u.y1&&S>=u.y2){this.setStatus(e,"loaded");return}S<u.y2?(h.y1+=_*e.renderInfo.lineHeight,h.y2+=_*e.renderInfo.lineHeight,f.push(f.shift()),f[2].lineNumStart=f[1].lineNumStart+_,f[2].lineNumEnd=f[2].lineNumStart+_,f[2].valid=!1):y>u.y1&&(h.y1-=_*e.renderInfo.lineHeight,h.y2-=_*e.renderInfo.lineHeight,f.unshift(f.pop()),f[0].lineNumStart=f[1].lineNumStart-_,f[0].lineNumEnd=f[0].lineNumStart+_,f[0].valid=!1)}else{const x=e.renderInfo.lineHeight*_,y=Math.ceil(l/x),T=y*_,S=T-_,p=T+_;f=[{texture:f==null?void 0:f[0].texture,lineNumStart:S,lineNumEnd:S+_,valid:!1},{texture:f==null?void 0:f[1].texture,lineNumStart:T,lineNumEnd:T+_,valid:!1},{texture:f==null?void 0:f[2].texture,lineNumStart:p,lineNumEnd:p+_,valid:!1}],e.canvasPages=f;const m=y*x;h={x1:0,y1:m-x,x2:o,y2:m+x*2}}e.renderWindow=h,performance.now();for(const x of f)if(!x.valid){if(x.lineNumStart<0){x.texture=this.stage.txManager.loadTexture("ImageTexture",{src:""}),x.valid=!0;continue}e.lightning2TextRenderer.draw(e.renderInfo,{lines:e.renderInfo.lines.slice(x.lineNumStart,x.lineNumEnd),lineWidths:e.renderInfo.lineWidths.slice(x.lineNumStart,x.lineNumEnd)}),this.canvas.width===0||this.canvas.height===0||(x.texture=this.stage.txManager.loadTexture("ImageTexture",{src:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)},{preload:!0})),x.valid=!0}this.setStatus(e,"loaded")}renderQuads(e,t,i,o){var b,w,R,L,k,z,Y,W,te,Q,ce,me;const{stage:s}=this,{canvasPages:l,textW:c=0,textH:u=0,renderWindow:h}=e;if(!l||!h)return;const{x:f,y:v,scrollY:_,contain:x,width:y,height:T}=e.props,S={x:f,y:v,width:x!=="none"?y:c,height:x==="both"?T:u};Qn({x:0,y:0,width:s.options.appWidth,height:s.options.appHeight},S),A(l,"canvasPages is not defined"),A(h,"renderWindow is not defined");const m=(h.y2-h.y1)/3,{zIndex:g,color:C}=e.props,E=o*jr(C),I=at(4294967295,E);l[0].valid&&this.stage.renderer.addQuad({alpha:E,clippingRect:i,colorBl:I,colorBr:I,colorTl:I,colorTr:I,width:((w=(b=l[0].texture)==null?void 0:b.dimensions)==null?void 0:w.width)||0,height:((L=(R=l[0].texture)==null?void 0:R.dimensions)==null?void 0:L.height)||0,texture:l[0].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:g,tx:t.tx,ty:t.ty-_+h.y1,ta:t.ta,tb:t.tb,tc:t.tc,td:t.td}),l[1].valid&&this.stage.renderer.addQuad({alpha:E,clippingRect:i,colorBl:I,colorBr:I,colorTl:I,colorTr:I,width:((z=(k=l[1].texture)==null?void 0:k.dimensions)==null?void 0:z.width)||0,height:((W=(Y=l[1].texture)==null?void 0:Y.dimensions)==null?void 0:W.height)||0,texture:l[1].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:g,tx:t.tx,ty:t.ty-_+h.y1+m,ta:t.ta,tb:t.tb,tc:t.tc,td:t.td}),l[2].valid&&this.stage.renderer.addQuad({alpha:E,clippingRect:i,colorBl:I,colorBr:I,colorTl:I,colorTr:I,width:((Q=(te=l[2].texture)==null?void 0:te.dimensions)==null?void 0:Q.width)||0,height:((me=(ce=l[2].texture)==null?void 0:ce.dimensions)==null?void 0:me.height)||0,texture:l[2].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:g,tx:t.tx,ty:t.ty-_+h.y1+m+m,ta:t.ta,tb:t.tb,tc:t.tc,td:t.td})}invalidateVisibleWindowCache(e){e.visibleWindow.valid=!1,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}invalidateLayoutCache(e){e.renderInfo=void 0,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,t){var i;t!==((i=e.fontInfo)==null?void 0:i.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,t,i){var o;t!==((o=e.fontInfo)==null?void 0:o.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,console.error("CanvasTextRenderer: Error loading font '".concat(e.fontInfo.cssString,"'"),i),this.scheduleUpdateState(e))}}const Mi=2e6;class Ni extends We{constructor(e){super();d(this,"options");d(this,"animationManager");d(this,"txManager");d(this,"fontManager");d(this,"textRenderers");d(this,"shManager");d(this,"renderer");d(this,"root");d(this,"deltaTime",0);d(this,"lastFrameTime",0);d(this,"currentFrameTime",0);d(this,"fpsNumFrames",0);d(this,"fpsElapsedTime",0);d(this,"renderRequested",!1);this.options=e;const{canvas:t,clearColor:i,rootId:o,debug:s,appWidth:l,appHeight:c}=e;this.txManager=new Si,this.shManager=new wi,this.animationManager=new _i,s!=null&&s.monitorTextureCache&&setInterval(()=>{A(this.txManager);const h=this.txManager.getDebugInfo();console.log("Texture ID Cache Size: ",h.idCacheSize),console.log("Texture Key Cache Size: ",h.keyCacheSize)},1e3),this.renderer=new Xr({stage:this,canvas:t,pixelRatio:e.devicePhysicalPixelRatio*e.deviceLogicalPixelRatio,clearColor:i!=null?i:4278190080,bufferMemory:Mi,txManager:this.txManager,shManager:this.shManager}),this.txManager.renderer=this.renderer,this.textRenderers={canvas:new zi(this),sdf:new ki(this)},this.fontManager=new gr(this.textRenderers);const u=new En(this,{id:o,x:0,y:0,width:l,height:c,alpha:1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null});this.root=u,xi(this)}updateAnimations(){const{animationManager:e}=this;this.root&&(this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=yi(),this.deltaTime=this.lastFrameTime?this.currentFrameTime-this.lastFrameTime:100/6,e.update(this.deltaTime))}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested}drawFrame(){const{renderer:e,renderRequested:t}=this;this.root.updateType!==0&&this.root.update(this.deltaTime),e==null||e.reset(),this.addQuads(this.root),e==null||e.render(),t&&(this.renderRequested=!1);const{fpsUpdateInterval:i}=this.options;if(i&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=i)){const o=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.emit("fpsUpdate",o)}}addQuads(e){A(this.renderer&&e.globalTransform),e.isRenderable&&e.renderQuads(this.renderer);for(let t=0;t<e.children.length;t++){const i=e.children[t];i&&(i==null?void 0:i.worldAlpha)!==0&&this.addQuads(i)}}requestRender(){this.renderRequested=!0}resolveTextRenderer(e,t=null){let i=t,o=!1;if(i){const l=this.textRenderers[i];l?l.canRenderFont(e)||(console.warn("Cannot use override text renderer '".concat(i,"' for font"),e),i=null,o=!0):(console.warn("Text renderer override '".concat(i,"' not found.")),i=null,o=!0)}if(!i){for(const[l,c]of Object.entries(this.textRenderers))if(l!=="canvas"&&c.canRenderFont(e)){i=l;break}i||(i="canvas")}o&&console.warn("Falling back to text renderer ".concat(String(i)));const s=this.textRenderers[i];return A(s,"resolvedTextRenderer undefined"),s}}class Bi extends En{constructor(e,t){super(e,t);d(this,"textRenderer");d(this,"trState");d(this,"_textRendererOverride",null);d(this,"onTextLoaded",()=>{const{contain:e}=this,t=this.trState.props.width,i=this.trState.props.height,o=this.trState.textW||0,s=this.trState.textH||0;e==="both"?(this.props.width=t,this.props.height=i):e==="width"?(this.props.width=t,this.props.height=s):e==="none"&&(this.props.width=o,this.props.height=s),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});d(this,"onTextFailed",(e,t)=>{this.emit("failed",{type:"text",error:t})});this._textRendererOverride=t.textRendererOverride;const{resolvedTextRenderer:i,textRendererState:o}=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:t.width,height:t.height,textAlign:t.textAlign,color:t.color,zIndex:t.zIndex,contain:t.contain,scrollable:t.scrollable,scrollY:t.scrollY,offsetY:t.offsetY,letterSpacing:t.letterSpacing,debug:t.debug,fontFamily:t.fontFamily,fontSize:t.fontSize,fontStretch:t.fontStretch,fontStyle:t.fontStyle,fontWeight:t.fontWeight,text:t.text},void 0);this.textRenderer=i,this.trState=o}get width(){return this.trState.props.width}set width(e){this.textRenderer.set.width(this.trState,e)}get height(){return this.trState.props.height}set height(e){this.textRenderer.set.height(this.trState,e)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e),this.checkIsRenderable()}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e;const{resolvedTextRenderer:t,textRendererState:i}=this.resolveTextRendererAndState(this.trState.props,this.trState);this.textRenderer=t,this.trState=i}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,t=null){super.update(e,t),A(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkIsRenderable(){return super.checkIsRenderable()?!0:this.trState.props.text!==""?this.isRenderable=!0:this.isRenderable=!1}renderQuads(e){A(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha)}resolveTextRendererAndState(e,t){const i=this.stage.resolveTextRenderer(e,this._textRendererOverride),o=i.createState(e);return t&&["loading","loaded","failed"].forEach(l=>{t.emitter.off(l)}),o.emitter.on("loaded",this.onTextLoaded),o.emitter.on("failed",this.onTextFailed),i.scheduleUpdateState(o),{resolvedTextRenderer:i,textRendererState:o}}}class $i extends dn{constructor(n,e,t){super(n,e,t,new Bi(t,{id:In(),x:n.x,y:n.y,width:n.width,height:n.height,alpha:n.alpha,clipping:n.clipping,color:n.color,colorTop:n.colorTop,colorBottom:n.colorBottom,colorLeft:n.colorLeft,colorRight:n.colorRight,colorTl:n.colorTl,colorTr:n.colorTr,colorBl:n.colorBl,colorBr:n.colorBr,zIndex:n.zIndex,zIndexLocked:n.zIndexLocked,scaleX:n.scaleX,scaleY:n.scaleY,mountX:n.mountX,mountY:n.mountY,mount:n.mount,pivot:n.pivot,pivotX:n.pivotX,pivotY:n.pivotY,rotation:n.rotation,text:n.text,fontSize:n.fontSize,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontStretch:n.fontStretch,fontStyle:n.fontStyle,contain:n.contain,scrollable:n.scrollable,letterSpacing:n.letterSpacing,textAlign:n.textAlign,scrollY:n.scrollY,offsetY:n.offsetY,textRendererOverride:n.textRendererOverride,debug:n.debug,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null}))}get text(){return this.coreNode.text}set text(n){this.coreNode.text=n}get textRendererOverride(){return this.coreNode.textRendererOverride}set textRendererOverride(n){this.coreNode.textRendererOverride=n}get fontSize(){return this.coreNode.fontSize}set fontSize(n){this.coreNode.fontSize=n}get fontFamily(){return this.coreNode.fontFamily}set fontFamily(n){this.coreNode.fontFamily=n}get fontWeight(){return this.coreNode.fontWeight}set fontWeight(n){this.coreNode.fontWeight=n}get fontStretch(){return this.coreNode.fontStretch}set fontStretch(n){this.coreNode.fontStretch=n}get fontStyle(){return this.coreNode.fontStyle}set fontStyle(n){this.coreNode.fontStyle=n}get textAlign(){return this.coreNode.textAlign}set textAlign(n){this.coreNode.textAlign=n}get contain(){return this.coreNode.contain}set contain(n){this.coreNode.contain=n}get scrollable(){return this.coreNode.scrollable}set scrollable(n){this.coreNode.scrollable=n}get scrollY(){return this.coreNode.scrollY}set scrollY(n){this.coreNode.scrollY=n}get offsetY(){return this.coreNode.offsetY}set offsetY(n){this.coreNode.offsetY=n}get letterSpacing(){return this.coreNode.letterSpacing}set letterSpacing(n){this.coreNode.letterSpacing=n}get debug(){return this.coreNode.debug}set debug(n){this.coreNode.debug=n}}const Di="modulepreload",Oi=function(r){return"/solid-demo-app/"+r},Yn={},Yi=function(n,e,t){if(!e||e.length===0)return n();const i=document.getElementsByTagName("link");return Promise.all(e.map(o=>{if(o=Oi(o),o in Yn)return;Yn[o]=!0;const s=o.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(!!t)for(let h=i.length-1;h>=0;h--){const f=i[h];if(f.href===o&&(!s||f.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(o,'"]').concat(l)))return;const u=document.createElement("link");if(u.rel=s?"stylesheet":Di,s||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),s)return new Promise((h,f)=>{u.addEventListener("load",h),u.addEventListener("error",()=>f(new Error("Unable to preload CSS for ".concat(o))))})})).then(()=>n()).catch(o=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o})};function Ui(r){return r.prototype instanceof Hr}async function Wi(r,n){let e;try{console.log("Loading core extension",r),e=await Yi(()=>import(r),[])}catch(i){console.error("The core extension module at '".concat(r,"' could not be loaded.")),console.error(i);return}if(!e.default){console.error("The core extension module at '".concat(r,"' does not have a default export."));return}const t=e.default;if(Ui(t)){const i=new t;try{await i.run(n)}catch(o){console.error("The core extension at '".concat(r,"' threw an error.")),console.error(o)}}else console.error("The core extension at '".concat(r,"' does not extend CoreExtension."))}class ji{constructor(){d(this,"root",null);d(this,"stage",null);d(this,"rendererMain",null)}async init(n,e,t){this.stage=new Ni({rootId:In(),appWidth:e.appWidth,appHeight:e.appHeight,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio,clearColor:e.clearColor,canvas:t,fpsUpdateInterval:e.fpsUpdateInterval,debug:{monitorTextureCache:!1}}),this.rendererMain=n,A(this.stage.root);const i=new dn(n.resolveNodeDefaults({}),this.rendererMain,this.stage,this.stage.root);this.root=i,i.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,i)),this.onCreateNode(i),e.coreExtensionModule&&await Wi(e.coreExtensionModule,this.stage),this.stage.on("fpsUpdate",(o,s)=>{this.onFpsUpdate(s)})}createNode(n){A(this.rendererMain),A(this.stage);const e=new dn(n,this.rendererMain,this.stage);return e.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,e)),this.onCreateNode(e),e}createTextNode(n){A(this.rendererMain),A(this.stage);const e=new $i(n,this.rendererMain,this.stage);return e.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,e)),this.onCreateNode(e),e}destroyNode(n){n.destroy()}releaseTexture(n){const{stage:e}=this;A(e),e.txManager.removeTextureIdFromCache(n)}getRootNode(){return A(this.root),this.root}onCreateNode(n){throw new Error("Method not implemented.")}onBeforeDestroyNode(n){throw new Error("Method not implemented.")}onFpsUpdate(n){throw new Error("Method not implemented.")}}let Se,Fn;function Xi(r={}){const n=new ji;return Se=new di(r,r.rootId||"app",n),Fn=Se.createShader.bind(Se),Se}class Hi extends Array{constructor(n){super(),this._parent=n}get selected(){return this[this._parent.selected||0]}get firstChild(){return this[0]}insert(n,e){if(e){const t=this.indexOf(e);this.splice(t,0,n)}else this.push(n);n.parent=this._parent,this._parent._isDirty=!0}remove(n){const e=this.indexOf(n);e>=0&&this.splice(e,1)}}import.meta.env={BASE_URL:"/solid-demo-app/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1};const Ee={debug:!1,animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100}};function Gi(r,n,...e){}function Ze(r){return typeof r=="function"}function xr(r){return Array.isArray(r)}function Vi(r){return typeof r=="string"}function Ki(r){return typeof r=="number"}function qi(r){return Number.isInteger(r)}function Qi(r,n){for(const e of n)if(e in r)return!0;return!1}class Un extends Array{constructor(n,e={}){var t=(...i)=>{super(...i)};return xr(e)?t(...e):Vi(e)?t(e):t(...Object.entries(e).filter(([i,o])=>o).map(([i])=>i)),this.onChange=n,this}has(n){return this.indexOf(n)>=0}is(n){return this.indexOf(n)>=0}add(n){this.push(n),this.onChange()}toggle(n){this.has(n)?this.remove(n):this.add(n)}remove(n){const e=this.indexOf(n);e>=0&&(this.splice(e,1),this.onChange())}}function Zi(r){const n=[];for(let p=0;p<r.children.length;p++){const m=r.children[p];if(m.name!=="TextNode"){if(m.name==="text"&&!(m.width||m.height))return!1;n.push(m)}}const e=n.length,i=(r.flexDirection||"row")==="row",o=i?"width":"height",s=i?"height":"width",l=i?"marginLeft":"marginTop",c=i?"marginRight":"marginBottom",u=i?"x":"y",h=i?"y":"x",f=r[o]||0,v=r[s]||0,_=r.gap||0,x=r.justifyContent||"flexStart",y=r.alignItems;let T=0;["center","spaceBetween","spaceEvenly"].includes(x)&&(T=n.reduce((p,m)=>p+(m[o]||0),0));const S=v&&y?p=>{y==="flexStart"?p[h]=0:y==="center"?p[h]=(v-(p[s]||0))/2:y==="flexEnd"&&(p[h]=v-(p[s]||0))}:p=>p;if(x==="flexStart"){let p=0;if(n.forEach(m=>{m[u]=p+(m[l]||0),p+=(m[o]||0)+_+(m[l]||0)+(m[c]||0),S(m)}),r._autosized){const m=p-_;if(m!==r[o])return r[o]=m,!0}}else if(x==="flexEnd"){let p=f;for(let m=e-1;m>=0;m--){const g=n[m];A(g),g[u]=p-(g[o]||0)-(g[c]||0),p-=(g[o]||0)+_+(g[l]||0)+(g[c]||0),S(g)}}else if(x==="center"){let p=(f-(T+_*(e-1)))/2;n.forEach(m=>{m[u]=p,p+=(m[o]||0)+_,S(m)})}else if(x==="spaceBetween"){const p=(f-T)/(e-1);let m=0;n.forEach(g=>{g[u]=m,m+=(g[o]||0)+p,S(g)})}else if(x==="spaceEvenly"){const p=(f-T)/(e+1);let m=p;n.forEach(g=>{g[u]=m,m+=(g[o]||0)+p,S(g)})}return!1}const{animationSettings:Ji}=Ee;function eo(r){const n=[];for(const[e,t]of Object.entries(r))n.push({type:e,props:t});return Fn("DynamicShader",{effects:n})}function ot(r=""){return{set(n){Ki(n)&&(n={width:n,color:255}),this.effects={...this.effects||{},["border".concat(r)]:n},this["_border".concat(r)]=n},get(){return this["_border".concat(r)]}}}const to=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","width","worldX","worldY","x","y","zIndex","zIndexLocked"],no=["clipping","contain","fontFamily","src","text","textAlign","texture","maxLines","maxLinesSuffix","textBaseline","textOverflow","verticalAlign","wordWrap"];class Ye extends Object{constructor(n){super(),this.lng=null,this._parent=null,this.name=n,this.rendered=!1,this.autofocus=!1,this._renderProps={x:0,y:0},this.children=new Hi(this);for(const e of to)Object.defineProperty(this,e,{get(){return this["_".concat(e)]||this.lng&&this.lng[e]},set(t){this["_".concat(e)]=t,this._sendToLightningAnimatable(e,t)}});for(const e of no)Object.defineProperty(this,e,{get(){return this["_".concat(e)]||this.lng&&this.lng[e]},set(t){this["_".concat(e)]=t,this._sendToLightning(e,t)}});Object.defineProperties(this,{borderRadius:{set(e){this._borderRadius=e,this.effects={...this.effects||{},radius:{radius:e}}},get(){return this._borderRadius}},border:ot(),borderLeft:ot("Left"),borderRight:ot("Right"),borderTop:ot("Top"),borderBottom:ot("Bottom")}),Object.defineProperties(this,{linearGradient:{set(e={}){this._linearGradient=e,this.effects={...this.effects||{},linearGradient:e}},get(){return this._linearGradient}}})}get effects(){return this._effects}set effects(n){this._effects=n,this.shader=eo(n)}get parent(){return this._parent}set parent(n){var e;this._parent=n,this.rendered&&this.lng&&(this.lng.parent=(e=n==null?void 0:n.lng)!=null?e:null)}get shader(){return this._shader}set shader(n){xr(n)?this._shader=Fn(...n):this._shader=n,this._sendToLightning("shader",this._shader)}_sendToLightningAnimatable(n,e){if(this.rendered&&this.lng){if(this.transition&&this.transition[n]){const t=this.transition[n]===!0?void 0:this.transition[n];return this.animate({[n]:e},t).start()}this.lng[n]=e}else this._renderProps[n]=e}_sendToLightning(n,e){this.rendered&&this.lng?this.lng[n]=e:this._renderProps[n]=e}animate(n,e){return A(this.lng,"Node must be rendered before animating"),this.lng.animate(n,e||this.animationSettings)}setFocus(){this.rendered?queueMicrotask(()=>Yt(this)):this.autofocus=!0}isTextNode(){return this.name==="text"}_resizeOnTextLoad(){this.lng.once("loaded",(n,e)=>{if(e.type==="text"){const{dimensions:t}=e;this.width=t.width,this.height=t.height,this.parent.updateLayout(this,t)}})}getText(){return this.children.map(n=>n.text).join("")}destroy(){this.lng&&Se.destroyNode(this.lng)}set style(n){for(const e in n)this[e]||(this[e]=n[e]);this._style=n}get style(){return this._style}get hasChildren(){return this.children.length>0}set states(n){this._states=new Un(this._stateChanged.bind(this),n),this.rendered&&this._stateChanged()}get states(){return this._states=this._states||new Un(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||Ji}set animationSettings(n){this._animationSettings=n}updateLayout(n,e){var t;this.hasChildren&&(Ze(this.onBeforeLayout)&&this.onBeforeLayout.call(this,n,e),this.display==="flex"&&Zi(this)&&((t=this.parent)==null||t.updateLayout()),Ze(this.onLayout)&&this.onLayout.call(this,n,e))}_stateChanged(){var e;if(Gi("State Changed: ",this,this.states),this.forwardStates){const t=this.states.slice();this.children.forEach(i=>i.states=t)}const n=((e=Ee.stateMapperHook)==null?void 0:e.call(Ee,this,this.states))||this.states;if(this._undoStates||this.style&&Qi(this.style,n)){this._undoStates=this._undoStates||{};let t={};for(const[o,s]of Object.entries(this._undoStates))n.includes(o)||(t={...t,...s});const i=n.reduce((o,s)=>{const l=this.style[s];return l&&(o={...o,...l},this._undoStates&&!this._undoStates[s]&&(this._undoStates[s]={},Object.keys(l).forEach(c=>{this._undoStates[s][c]=this[c]}))),o},{});i.transition!==void 0&&(this.transition=i.transition),Object.assign(this,{...t,...i})}}render(){const n=this,e=this.parent;e._isDirty&&(e.updateLayout(),e._isDirty=!1),n.updateLayout(),this.states.length&&this._stateChanged();let t=n._renderProps;e.lng&&(t.parent=e.lng),n.isTextNode()?(t={...Ee.fontSettings,...t,text:n.getText()},t.contain&&(t.width||(t.width=(e.width||0)-t.x-(t.marginRight||0),n._width=t.width,n._autosized=!0),!t.height&&t.contain==="both"&&(t.height=(e.height||0)-t.y-(t.marginBottom||0),n._height=t.height,n._autosized=!0)),n.lng=Se.createTextNode(t),Ze(this.onCreate)&&this.onCreate.call(this,n),Ze(n.onLoad)&&n.lng.on("loaded",n.onLoad),(!n.width||!n.height)&&(n._autosized=!0,n._resizeOnTextLoad())):(t.src||t.texture||(isNaN(t.width)&&(t.width=(e.width||0)-t.x,n._width=t.width,n._autosized=!0),isNaN(t.height)&&(t.height=(e.height||0)-t.y,n._height=t.height,n._autosized=!0),t.color||(n._color=t.color=0)),n.lng=Se.createNode(t),n.onFail&&n.lng.on("failed",n.onFail),n.onLoad&&n.lng.on("loaded",n.onLoad),Ze(this.onCreate)&&this.onCreate.call(this,n)),n.rendered=!0,n.autofocus&&n.setFocus(),delete this._renderProps}}const P=r=>(()=>{const n=ze("text");return tt(n,r,!1),n})(),M=r=>(()=>{const n=ze("node");return tt(n,r,!1),n})();function yr(r){r.name!=="TextNode"&&(A(r instanceof Ye),r.render(),r.children.forEach(n=>yr(n)))}const ro=r=>{const n=Xi(r.options),e=n.init();let t;return ye(()=>{e.then(()=>{A(t),t.lng=n.root,t.children.forEach(yr),Ze(r.onFirstRender)&&r.onFirstRender(t)}).catch(console.error)}),(()=>{const i=ze("canvas"),o=t;return typeof o=="function"?Ln(o,i):t=i,wt(i,()=>r.children),i})()};function io({createElement:r,createTextNode:n,isTextNode:e,replaceText:t,insertNode:i,removeNode:o,setProperty:s,getParentNode:l,getFirstChild:c,getNextSibling:u}){function h(p,m,g,C){if(g!==void 0&&!C&&(C=[]),typeof m!="function")return f(p,m,C,g);_e(E=>f(p,m(),E,g),C)}function f(p,m,g,C,E){for(;typeof g=="function";)g=g();if(m===g)return g;const I=typeof m,b=C!==void 0;if(I==="string"||I==="number")if(I==="number"&&(m=m.toString()),b){let w=g[0];w&&e(w)?t(w,m):w=n(m),g=x(p,g,C,w)}else g!==""&&typeof g=="string"?t(c(p),g=m):(x(p,g,C,n(m)),g=m);else if(m==null||I==="boolean")g=x(p,g,C);else{if(I==="function")return _e(()=>{let w=m();for(;typeof w=="function";)w=w();g=f(p,w,g,C)}),()=>g;if(Array.isArray(m)){const w=[];if(v(w,m,E))return _e(()=>g=f(p,w,g,C,!0)),()=>g;if(w.length===0){const R=x(p,g,C);if(b)return g=R}else Array.isArray(g)?g.length===0?y(p,w,C):_(p,g,w):g==null||g===""?y(p,w):_(p,b&&g||[c(p)],w);g=w}else{if(Array.isArray(g)){if(b)return g=x(p,g,C,m);x(p,g,null,m)}else g==null||g===""||!c(p)?i(p,m):T(p,m,c(p));g=m}}return g}function v(p,m,g){let C=!1;for(let E=0,I=m.length;E<I;E++){let b=m[E],w;if(!(b==null||b===!0||b===!1))if(Array.isArray(b))C=v(p,b)||C;else if((w=typeof b)=="string"||w==="number")p.push(n(b));else if(w==="function")if(g){for(;typeof b=="function";)b=b();C=v(p,Array.isArray(b)?b:[b])||C}else p.push(b),C=!0;else p.push(b)}return C}function _(p,m,g){let C=g.length,E=m.length,I=C,b=0,w=0,R=u(m[E-1]),L=null;for(;b<E||w<I;){if(m[b]===g[w]){b++,w++;continue}for(;m[E-1]===g[I-1];)E--,I--;if(E===b){const k=I<C?w?u(g[w-1]):g[I-w]:R;for(;w<I;)i(p,g[w++],k)}else if(I===w)for(;b<E;)(!L||!L.has(m[b]))&&o(p,m[b]),b++;else if(m[b]===g[I-1]&&g[w]===m[E-1]){const k=u(m[--E]);i(p,g[w++],u(m[b++])),i(p,g[--I],k),m[E]=g[I]}else{if(!L){L=new Map;let z=w;for(;z<I;)L.set(g[z],z++)}const k=L.get(m[b]);if(k!=null)if(w<k&&k<I){let z=b,Y=1,W;for(;++z<E&&z<I&&!((W=L.get(m[z]))==null||W!==k+Y);)Y++;if(Y>k-w){const te=m[b];for(;w<k;)i(p,g[w++],te)}else T(p,g[w++],m[b++])}else b++;else o(p,m[b++])}}}function x(p,m,g,C){if(g===void 0){let I;for(;I=c(p);)o(p,I);return C&&i(p,C),""}const E=C||n("");if(m.length){let I=!1;for(let b=m.length-1;b>=0;b--){const w=m[b];if(E!==w){const R=l(w)===p;!I&&!b?R?T(p,E,w):i(p,E,g):R&&o(p,w)}else I=!0}}else i(p,E,g);return[E]}function y(p,m,g){for(let C=0,E=m.length;C<E;C++)i(p,m[C],g)}function T(p,m,g){i(p,m,g),o(p,g)}function S(p,m,g={},C){return m||(m={}),C||_e(()=>g.children=f(p,m.children,g.children)),_e(()=>m.ref&&m.ref(p)),_e(()=>{for(const E in m){if(E==="children"||E==="ref")continue;const I=m[E];I!==g[E]&&(s(p,E,I,g[E]),g[E]=I)}}),g}return{render(p,m){let g;return et(C=>{g=C,h(m,p())}),g},insert:h,spread(p,m,g){typeof m=="function"?_e(C=>S(p,m(),C,g)):S(p,m,void 0,g)},createElement:r,createTextNode:n,insertNode:i,setProp(p,m,g,C){return s(p,m,g,C),g},mergeProps:Rn,effect:_e,memo:ee,createComponent:ur,use(p,m,g){return oe(()=>p(m,g))}}}function oo(r){const n=io(r);return n.mergeProps=Rn,n}const so={createElement(r){const n=new Ye(r);return Se.root&&ye(()=>n.render()),n},createTextNode(r){return{name:"TextNode",text:r,parent:null}},replaceText(r,n){r.text=n;const e=r.parent;A(e),e._autosized&&e._resizeOnTextLoad(),e.text=e.getText()},setProperty(r,n,e=!0){r[n]=e},insertNode(r,n,e){r&&(r.children.insert(n,e),n.name==="TextNode"&&r.isTextNode()&&(r._autosized&&r._resizeOnTextLoad(),r.text=r.getText()))},isTextNode(r){return r.isTextNode()},removeNode(r,n){r.children.remove(n),n instanceof Ye&&n.destroy()},getParentNode(r){var n;return(n=r.parent)!=null?n:void 0},getFirstChild(r){return r.children[0]},getNextSibling(r){if(r.parent){const n=r.parent.children||[],e=n.indexOf(r)+1;if(e<n.length)return n[e]}}},vr=oo(so),ao=vr.render,{effect:la,memo:kn,createComponent:a,createElement:ze,createTextNode:ca,insertNode:ua,insert:wt,spread:tt,setProp:gt,mergeProps:U,use:Ln}=vr;function N(r=""){return qi(r)?r:typeof r=="string"?r.startsWith("#")?+(r.replace("#","0x")+(r.length===7?"ff":"")):r.startsWith("0x")?Number(r):+("0x"+(r.length===6?r+"ff":r)):0}function lo(r){return r*Math.PI/180}const Wn="_$DX_DELEGATE";function co(r,n=window.document){const e=n[Wn]||(n[Wn]=new Set);for(let t=0,i=r.length;t<i;t++){const o=r[t];e.has(o)||(e.add(o),n.addEventListener(o,uo))}}function uo(r){const n="$$".concat(r.type);let e=r.composedPath&&r.composedPath()[0]||r.target;for(r.target!==e&&Object.defineProperty(r,"target",{configurable:!0,value:e}),Object.defineProperty(r,"currentTarget",{configurable:!0,get(){return e||document}});e;){const t=e[n];if(t&&!e.disabled){const i=e["".concat(n,"Data")];if(i!==void 0?t.call(e,i,r):t.call(e,r),r.cancelBubble)return}e=e._$host||e.parentNode||e.host}}const ho=!1;function fo(){let r=new Set;function n(i){return r.add(i),()=>r.delete(i)}let e=!1;function t(i,o){if(e)return!(e=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const l of r)l.listener({...s,from:l.location,retry:c=>{c&&(e=!0),l.navigate(i,{...o,resolve:!1})}});return!s.defaultPrevented}return{subscribe:n,confirm:t}}const po=/^(?:[a-z0-9]+:)?\/\//i,go=/^\/+|(\/)\/+$/g;function ut(r,n=!1){const e=r.replace(go,"$1");return e?n||/^[?#]/.test(e)?e:"/"+e:""}function zt(r,n,e){if(po.test(n))return;const t=ut(r),i=e&&ut(e);let o="";return!i||n.startsWith("/")?o=t:i.toLowerCase().indexOf(t.toLowerCase())!==0?o=t+i:o=i,(o||"/")+ut(n,!o)}function mo(r,n){if(r==null)throw new Error(n);return r}function xo(r,n){return ut(r).replace(/\/*(\*.*)?$/g,"")+ut(n)}function wr(r){const n={};return r.searchParams.forEach((e,t)=>{n[t]=e}),n}function yo(r,n,e){const[t,i]=r.split("/*",2),o=t.split("/").filter(Boolean),s=o.length;return l=>{const c=l.split("/").filter(Boolean),u=c.length-s;if(u<0||u>0&&i===void 0&&!n)return null;const h={path:s?"":"/",params:{}},f=v=>e===void 0?void 0:e[v];for(let v=0;v<s;v++){const _=o[v],x=c[v],y=_[0]===":",T=y?_.slice(1):_;if(y&&sn(x,f(T)))h.params[T]=x;else if(y||!sn(x,_))return null;h.path+="/".concat(x)}if(i){const v=u?c.slice(-u).join("/"):"";if(sn(v,f(i)))h.params[i]=v;else return null}return h}}function sn(r,n){const e=t=>t.localeCompare(r,void 0,{sensitivity:"base"})===0;return n===void 0?!0:typeof n=="string"?e(n):typeof n=="function"?n(r):Array.isArray(n)?n.some(e):n instanceof RegExp?n.test(r):!1}function vo(r){const[n,e]=r.pattern.split("/*",2),t=n.split("/").filter(Boolean);return t.reduce((i,o)=>i+(o.startsWith(":")?2:3),t.length-(e===void 0?0:1))}function _r(r){const n=new Map,e=qt();return new Proxy({},{get(t,i){return n.has(i)||Qr(e,()=>n.set(i,ee(()=>r()[i]))),n.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(r())}})}function Sr(r){let n=/(\/?\:[^\/]+)\?/.exec(r);if(!n)return[r];let e=r.slice(0,n.index),t=r.slice(n.index+n[0].length);const i=[e,e+=n[1]];for(;n=/^(\/\:[^\/]+)\?/.exec(t);)i.push(e+=n[1]),t=t.slice(n[0].length);return Sr(t).reduce((o,s)=>[...o,...i.map(l=>l+s)],[])}const wo=100,br=ir(),Jt=ir(),Tr=()=>mo(bn(br),"Make sure your app is wrapped in a <Router />"),_o=()=>bn(Jt)||Tr().base,nt=()=>Tr().navigatorFactory(),An=()=>_o().params;function So(r,n=""){const{component:e,load:t,children:i,metadata:o}=r,s=!i||Array.isArray(i)&&!i.length,l={key:r,component:e,load:t,metadata:o};return Cr(r.path).reduce((c,u)=>{for(const h of Sr(u)){const f=xo(n,h),v=s?f:f.split("/*",1)[0];c.push({...l,originalPath:h,pattern:v,matcher:yo(v,!s,r.matchFilters)})}return c},[])}function bo(r,n=0){return{routes:r,score:vo(r[r.length-1])*1e4-n,matcher(e){const t=[];for(let i=r.length-1;i>=0;i--){const o=r[i],s=o.matcher(e);if(!s)return null;t.unshift({...s,route:o})}return t}}}function Cr(r){return Array.isArray(r)?r:[r]}function Rr(r,n="",e=[],t=[]){const i=Cr(r);for(let o=0,s=i.length;o<s;o++){const l=i[o];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const c=So(l,n);for(const u of c){e.push(u);const h=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!h)Rr(l.children,u.pattern,e,t);else{const f=bo([...e],t.length);t.push(f)}e.pop()}}}return e.length?t:t.sort((o,s)=>s.score-o.score)}function Er(r,n){for(let e=0,t=r.length;e<t;e++){const i=r[e].matcher(n);if(i)return i}return[]}function To(r,n){const e=new URL("http://sar"),t=ee(c=>{const u=r();try{return new URL(u,e)}catch(h){return console.error("Invalid path ".concat(u)),c}},e,{equals:(c,u)=>c.href===u.href}),i=ee(()=>t().pathname),o=ee(()=>t().search,!0),s=ee(()=>t().hash),l=()=>"";return{get pathname(){return i()},get search(){return o()},get hash(){return s()},get state(){return n()},get key(){return l()},query:_r(Fe(o,()=>wr(t())))}}let Ae;function Co(r,n,e={}){const{signal:[t,i],utils:o={}}=r,s=o.parsePath||(w=>w),l=o.renderPath||(w=>w),c=o.beforeLeave||fo(),u=zt("",e.base||"");if(u===void 0)throw new Error("".concat(u," is not a valid base path"));u&&!t().value&&i({value:u,replace:!0,scroll:!1});const[h,f]=D(!1),v=async w=>{f(!0);try{await Zr(w)}finally{f(!1)}},[_,x]=D(t().value),[y,T]=D(t().state),S=To(_,y),p=[],m=D([]),g={pattern:u,params:{},path:()=>u,outlet:()=>null,resolvePath(w){return zt(u,w)}};return _e(()=>{const{value:w,state:R}=t();oe(()=>{w!==_()&&v(()=>{Ae="native",x(w),T(R),m[1]([])}).then(()=>{Ae=void 0})})}),{base:g,location:S,isRouting:h,renderPath:l,parsePath:s,navigatorFactory:E,beforeLeave:c,preloadRoute:b,submissions:m};function C(w,R,L){oe(()=>{if(typeof R=="number"){R&&(o.go?c.confirm(R,L)&&o.go(R):console.warn("Router integration does not support relative routing"));return}const{replace:k,resolve:z,scroll:Y,state:W}={replace:!1,resolve:!0,scroll:!0,...L},te=z?w.resolvePath(R):zt("",R);if(te===void 0)throw new Error("Path '".concat(R,"' is not a routable path"));if(p.length>=wo)throw new Error("Too many redirects");const Q=_();if((te!==Q||W!==y())&&!ho){if(c.confirm(te,L)){const ce=p.push({value:Q,replace:k,scroll:Y,state:y()});v(()=>{Ae="navigate",x(te),T(W),m[1]([])}).then(()=>{p.length===ce&&(Ae=void 0,I({value:te,state:W}))})}}})}function E(w){return w=w||bn(Jt)||g,(R,L)=>C(w,R,L)}function I(w){const R=p[0];R&&((w.value!==R.value||w.state!==R.state)&&i({...w,replace:R.replace,scroll:R.scroll}),p.length=0)}function b(w,R){const L=Er(n(),w.pathname),k=Ae;Ae="preload";for(let z in L){const{route:Y,params:W}=L[z];Y.component&&Y.component.preload&&Y.component.preload(),R&&Y.load&&Y.load({params:W,location:{pathname:w.pathname,search:w.search,hash:w.hash,query:wr(w),state:null,key:""},intent:"preload"})}Ae=k}}function Ro(r,n,e,t,i){const{base:o,location:s}=r,{pattern:l,component:c,load:u}=t().route,h=ee(()=>t().path);c&&c.preload&&c.preload();const f=u?u({params:i,location:s,intent:Ae||"initial"}):void 0;return{parent:n,pattern:l,path:h,params:i,outlet:()=>c?ur(c,{params:i,location:s,data:f,get children(){return e()}}):e(),resolvePath(_){return zt(o.path(),_,h())}}}const Eo=r=>n=>{const{base:e}=n,t=Tn(()=>n.children),i=ee(()=>Rr(n.root?{component:n.root,children:t()}:t(),n.base||"")),o=Co(r,i,{base:e});return r.create&&r.create(o),a(br.Provider,{value:o,get children(){return a(Io,{routerState:o,get branches(){return i()}})}})};function Io(r){const n=ee(()=>Er(r.branches,r.routerState.location.pathname)),e=_r(()=>{const s=n(),l={};for(let c=0;c<s.length;c++)Object.assign(l,s[c].params);return l}),t=[];let i;const o=ee(Fe(n,(s,l,c)=>{let u=l&&s.length===l.length;const h=[];for(let f=0,v=s.length;f<v;f++){const _=l&&l[f],x=s[f];c&&_&&x.route.key===_.route.key?h[f]=c[f]:(u=!1,t[f]&&t[f](),et(y=>{t[f]=y,h[f]=Ro(r.routerState,h[f-1]||r.routerState.base,Fo(()=>o()[f+1]),()=>n()[f],e)}))}return t.splice(s.length).forEach(f=>f()),c&&u?c:(i=h[0],h)}));return a(Ie,{get when(){return o()&&i},keyed:!0,children:s=>a(Jt.Provider,{value:s,get children(){return s.outlet()}})})}const Fo=r=>()=>a(Ie,{get when(){return r()},keyed:!0,children:n=>a(Jt.Provider,{value:n,get children(){return n.outlet()}})}),ue=r=>{const n=Tn(()=>r.children);return Rn(r,{get children(){return n()}})};function ko([r,n],e,t){return[e?()=>e(r()):r,t?i=>n(t(i)):n]}function Lo(r){if(r==="#")return null;try{return document.querySelector(r)}catch(n){return null}}function Ao(r){let n=!1;const e=i=>typeof i=="string"?{value:i}:i,t=ko(D(e(r.get()),{equals:(i,o)=>i.value===o.value}),void 0,i=>(!n&&r.set(i),i));return r.init&&Pe(r.init((i=r.get())=>{n=!0,t[1](e(i)),n=!1})),Eo({signal:t,create:r.create,utils:r.utils})}function Po(r,n,e){return r.addEventListener(n,e),()=>r.removeEventListener(n,e)}function zo(r,n){const e=Lo("#".concat(r));e?e.scrollIntoView():n&&window.scrollTo(0,0)}const Mo=new Map;function No(r=!0,n=!1,e="/_server"){return t=>{const i=t.base.path(),o=t.navigatorFactory(t.base);let s={};function l(x){return x.namespaceURI==="http://www.w3.org/2000/svg"}function c(x){if(x.defaultPrevented||x.button!==0||x.metaKey||x.altKey||x.ctrlKey||x.shiftKey)return;const y=x.composedPath().find(C=>C instanceof Node&&C.nodeName.toUpperCase()==="A");if(!y||n&&!y.getAttribute("link"))return;const T=l(y),S=T?y.href.baseVal:y.href;if((T?y.target.baseVal:y.target)||!S&&!y.hasAttribute("state"))return;const m=(y.getAttribute("rel")||"").split(/\s+/);if(y.hasAttribute("download")||m&&m.includes("external"))return;const g=T?new URL(S,document.baseURI):new URL(S);if(!(g.origin!==window.location.origin||i&&g.pathname&&!g.pathname.toLowerCase().startsWith(i.toLowerCase())))return[y,g]}function u(x){const y=c(x);if(!y)return;const[T,S]=y,p=t.parsePath(S.pathname+S.search+S.hash),m=T.getAttribute("state");x.preventDefault(),o(p,{resolve:!1,replace:T.hasAttribute("replace"),scroll:!T.hasAttribute("noscroll"),state:m&&JSON.parse(m)})}function h(x){const y=c(x);if(!y)return;const[T,S]=y;s[S.pathname]||t.preloadRoute(S,T.getAttribute("preload")!=="false")}function f(x){const y=c(x);if(!y)return;const[T,S]=y;s[S.pathname]||(s[S.pathname]=setTimeout(()=>{t.preloadRoute(S,T.getAttribute("preload")!=="false"),delete s[S.pathname]},200))}function v(x){const y=c(x);if(!y)return;const[,T]=y;s[T.pathname]&&(clearTimeout(s[T.pathname]),delete s[T.pathname])}function _(x){let y=x.submitter&&x.submitter.hasAttribute("formaction")?x.submitter.formAction:x.target.action;if(!y)return;if(!y.startsWith("action:")){const S=new URL(y);if(y=t.parsePath(S.pathname+S.search),!y.startsWith(e))return}if(x.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const T=Mo.get(y);if(T){x.preventDefault();const S=new FormData(x.target);T.call(t,S)}}co(["click","submit"]),document.addEventListener("click",u),r&&(document.addEventListener("mouseover",f),document.addEventListener("mouseout",v),document.addEventListener("focusin",h),document.addEventListener("touchstart",h)),document.addEventListener("submit",_),Pe(()=>{document.removeEventListener("click",u),r&&(document.removeEventListener("mouseover",f),document.removeEventListener("mouseout",v),document.removeEventListener("focusin",h),document.removeEventListener("touchstart",h)),document.removeEventListener("submit",_)})}}function Bo(r){const n=r.replace(/^.*?#/,"");if(!n.startsWith("/")){const[,e="/"]=window.location.hash.split("#",2);return"".concat(e,"#").concat(n)}return n}function $o(r){return Ao({get:()=>window.location.hash.slice(1),set({value:n,replace:e,scroll:t,state:i}){e?window.history.replaceState(i,"","#"+n):window.location.hash=n;const o=n.indexOf("#"),s=o>=0?n.slice(o+1):"";zo(s,t)},init:n=>Po(window,"hashchange",()=>n()),create:No(r.preload,r.explicitLinks,r.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>"#".concat(n),parsePath:Bo}})(r)}var Do=!!ci,Oo=Do?r=>qt()?Pe(r):r:Pe;function Yo(r,n,e,t){return r.addEventListener(n,e,t),Oo(r.removeEventListener.bind(r,n,e,t))}function Uo(r,n=qt()){let e=0,t,i;return()=>(e++,Pe(()=>{e--,queueMicrotask(()=>{!e&&i&&(i(),i=t=void 0)})}),i||et(o=>t=r(i=o),n),t)}var Wo=Uo(()=>{const[r,n]=D(null);return Yo(window,"keydown",e=>{n(e),setTimeout(()=>n(null))}),r});function Rt(r){return typeof r=="function"}function jn(r,n){if(!r)throw new Error(n||"Assertion failed")}let an={Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Enter:"Enter",Last:"l"};const[Ut,jo]=D([]),Xo=(r={})=>{const n=Wo();an={...an,...r};const e=Object.entries(an);return ye(Fe(Ot,(t,i,o=[])=>{var c;let s=t;const l=[];for(;s;)s.states.has("focus")||(s.states.add("focus"),Rt(s.onFocus)&&s.onFocus.call(s,t,i!=null?i:null)),l.push(s),s=(c=s.parent)!=null?c:null;return o.forEach(u=>{l.includes(u)||(u.states.remove("focus"),Rt(u.onBlur)&&u.onBlur.call(u,t,i!=null?i:null))}),jo(l),l},{defer:!0})),ye(()=>{const t=n();if(t){const i=e.find(([o,s])=>s===t.key);oe(()=>{const o=Ut();for(const s of o){const l=i?i[0]:void 0;if(l){const c=s["on".concat(l)];if(Rt(c)&&c.call(s,t,s)===!0)break}else console.log("Unhandled key event: ".concat(t.key));if(Rt(s.onKeyPress)&&s.onKeyPress.call(s,t,l,s)===!0)break}return!1})}}),Ut};function Ir(r,n){const e=n();let t,i,o,s;Array.isArray(e)?e.length===2?(t=s=e[0],i=o=e[1]):e.length===3?(t=e[0],i=o=e[1],s=e[2]):[t,o,s,i]=e:t=o=s=i=e,r.onBeforeLayout=(l,c)=>{if(c){r.width=r.children.reduce((f,v)=>f+(v.width||0),0)+i+o;const u=r.children[0];u&&(u.x=i,u.marginLeft=i);let h=0;r.children.forEach(f=>{f.y=(f.y||0)+t,f.marginTop=t,h=Math.max(h,f.height||0)}),r.height=h+t+s}}}function Ho(r=[]){const n=[];let e;for(e=0;e<r.length;e++){const t=r[e];if(typeof t=="string"&&!t.includes("PAUSE-"))n.push(r[e]);else break}return[n.join(",\b ")].concat(r.slice(e))}function Xn(r){return new Promise(n=>{setTimeout(n,r)})}function Go(r,n,e="en-US"){const t=window.speechSynthesis;return new Promise((i,o)=>{const s=new SpeechSynthesisUtterance(r);s.lang=e,s.onend=()=>{i()},s.onerror=l=>{o(l)},n.push(s),t.speak(s)})}function xn(r,n,e=!0){const t=window.speechSynthesis,i=Ho(Array.isArray(r)?r:[r]),o=[],s=[];let l=!0;return{series:(async()=>{try{for(;l&&i.length;){const u=await Promise.resolve(i.shift());if(l){if(typeof u=="string"&&u.includes("PAUSE-")){let h=Number(u.split("PAUSE-")[1])*1e3;isNaN(h)&&(h=0),await Xn(h)}else if(typeof u=="string"&&u.length){let f=3;for(;l&&f>0;)try{await Go(u,s,n),f=0}catch(v){if(v instanceof SpeechSynthesisErrorEvent)if(v.error==="network")f--,console.warn("Speech synthesis network error. Retries left: ".concat(f)),await Xn(500*(3-f));else if(v.error==="canceled"||v.error==="interrupted")f=0;else throw new Error("SpeechSynthesisErrorEvent: ".concat(v.error));else throw v}}else if(typeof u=="function"){const h=xn(u(),n,!1);o.push(h),await h.series}else if(Array.isArray(u)){const h=xn(u,n,!1);o.push(h),await h.series}}else break}}finally{l=!1}})(),get active(){return l},append:u=>{i.push(u)},cancel:()=>{l&&(e&&t.cancel(),o.forEach(u=>{u.cancel()}),l=!1)}}}let Et;function Vo(r,n="en-US"){return Et&&Et.cancel(),Et=xn(r,n),Et}var Ko=(r,n)=>{let e;const t=()=>clearTimeout(e);return qt()&&Pe(t),Object.assign((...o)=>{e!==void 0&&t(),e=setTimeout(()=>r(...o),n)},{clear:t})};let yn,ht=[],we,vn=!1;const qo=3e5;function Hn(r,n){const e=Ko(r,n);let t;const i=o=>{t=o,e(o)};return i.flush=()=>{e.clear(),r(t)},i.clear=e.clear,i}function st(r){return r.id||r.name}function Qo(r=[]){if(!J.onFocusChange||!J.enabled)return;const n=r.every(o=>!o.loading),e=r.filter(o=>!ht.includes(o));if(yn(),!n&&J.onFocusChange){J.onFocusChange([]);return}ht=r.slice(0);const t=[],i=e.reduce((o,s)=>(s.announce?(o.push([st(s),"Announce",s.announce]),t.push(s.announce)):s.title?(o.push([st(s),"Title",s.title]),t.push(s.title)):o.push([st(s),"No Announce",""]),o),[]);if(e.reverse().reduce((o,s)=>(s.announceContext?(o.push([st(s),"Context",s.announceContext]),t.push(s.announceContext)):o.push([st(s),"No Context",""]),o),i),J.debug&&console.table(i),t.length)return J.speak(t.reduce((o,s)=>o.concat(s),[]))}function Zo(r){if(!vn)return we=Vo(r)}const J={debug:!1,enabled:!0,cancel:function(){we&&we.cancel()},clearPrevFocus:function(r=0){ht=ht.slice(0,r),yn()},speak:function(r,{append:n=!1,notification:e=!1}={}){return J.onFocusChange&&J.enabled&&(J.onFocusChange.flush(),n&&we&&we.active?we.append(r):(J.cancel(),Zo(r)),e&&(vn=!0,we==null||we.series.finally(()=>{vn=!1,J.refresh()}).catch(console.error))),we},refresh:function(r=0){J.clearPrevFocus(r),J.onFocusChange&&J.onFocusChange(oe(()=>Ut()))},setupTimers:function({focusDebounce:r=400,focusChangeTimeout:n=qo}={}){J.onFocusChange=Hn(Qo,r),yn=Hn(()=>{ht=[]},n)}},Jo=()=>(J.setupTimers(),ye(Fe(Ut,J.onFocusChange,{defer:!0})),J);function Wt(r){return function(){var o,s;const n=this.children.length,e=this.wrap,t=this.selected;if(r==="right"||r==="down")do if(this.selected=(this.selected||0)%n+1,this.selected>=n){if(!e){this.selected=null;break}this.selected=0}while((o=this.children[this.selected])!=null&&o.skipFocus);else if(r==="left"||r==="up")do if(this.selected=(this.selected||0)%n-1,this.selected<0){if(!e){this.selected=null;break}this.selected=n-1}while((s=this.children[this.selected])!=null&&s.skipFocus);if(this.selected===null)return this.selected=t,!1;const i=this.children[this.selected];if(jn(i instanceof Ye),this.onSelectedChanged&&this.onSelectedChanged.call(this,this,i,this.selected,t),this.plinko&&t!==null){const l=this.children[t];jn(l instanceof Ye);const c=l.selected;i.selected=c}return Yt(i),!0}}function X(r){const n=Wt("left"),e=Wt("right"),t={display:"flex",justifyContent:"flexStart"};return(()=>{const i=ze("node");return gt(i,"onLeft",n),gt(i,"onRight",e),tt(i,U({get selected(){return r.selected||0},get onFocus(){return r.onFocus||(o=>{if(!o||o.selected===null)return;let s=o.children[o.selected];for(;s!=null&&s.skipFocus;)o.selected++,s=o.children[o.selected];s instanceof Ye&&s.setFocus()})},get style(){return r.style||t}},r),!0),wt(i,()=>r.children),i})()}function K(r){const n=Wt("up"),e=Wt("down"),t={display:"flex",flexDirection:"column",justifyContent:"flexStart"};return(()=>{const i=ze("node");return gt(i,"onUp",n),gt(i,"onDown",e),tt(i,U({get onFocus(){return r.onFocus||(o=>{if(!o||o.selected===null)return;let s=o.children[o.selected];for(;s!=null&&s.skipFocus;)o.selected++,s=o.children[o.selected];s instanceof Ye&&s.setFocus()})},get selected(){return r.selected||0},get style(){return r.style||t}},r),!0),wt(i,()=>r.children),i})()}function es(r,n){const e=Se.createTexture("ImageTexture",{src:r});return n.reduce((t,i)=>{const{x:o,y:s,width:l,height:c}=i;return t[i.name]=Se.createTexture("SubTexture",{texture:e,x:o,y:s,width:l,height:c}),t},{})}const[ts,Me]=D(""),ns={display:"flex",flexDirection:"row",justifyContent:"flexStart"},rs={display:"flex",flexDirection:"column",justifyContent:"flexStart"},is={screenW:1920,screenH:1080,marginX:120,marginY:120,gutterX:24,gutterY:72,focusScale:1.1},os={primary:"#00315c",focus:"#bdbdbd",container:"#004882"},ss={display1:{fontFamily:"Ubuntu",fontSize:72,lineHeight:88,fontStyle:"600",verticalAlign:"middle",textBaseline:"bottom",maxLineSuffix:"..."},display2:{fontFamily:"Ubuntu",fontSize:56,lineHeight:72},headline1:{fontFamily:"Ubuntu",fontSize:36,fontStyle:"600",lineHeight:48,verticalAlign:"middle",textBaseline:"bottom",maxLineSuffix:"..."},headline2:{fontFamily:"Ubuntu",fontSize:32,lineHeight:44},headline3:{fontFamily:"Ubuntu",fontSize:28,lineHeight:40},body1:{fontFamily:"Ubuntu",fontSize:32,lineHeight:40},body2:{fontFamily:"Ubuntu",fontSize:28,lineHeight:34},button1:{fontFamily:"Ubuntu",fontSize:32,lineHeight:40}},q={flexRow:ns,flexColumn:rs,layout:is,color:os,typography:ss};function as(){let r,n,e=0;const t=1,i={duration:1e3,easing:"ease-in-out"},o={alpha:t,color:4294967295,transition:{alpha:i}};return ye(Fe(ts,s=>{if(s.startsWith("#")){r.color=s,r.src="",r.alpha=1,e=1,n.alpha=0;return}else r.color=4294967295;if(e===0){r.src=s,e=1;return}if(e===1){n.src=s,e=2,n.animate({alpha:t},i).start(),r.animate({alpha:0},i).start();return}e===2&&(r.src=s,e=1,r.alpha=t,n.alpha=0)},{defer:!0})),a(M,{width:1920,height:1080,zIndex:-5,get children(){return[a(M,{ref(s){const l=r;typeof l=="function"?l(s):r=s},style:o}),a(M,{ref(s){const l=n;typeof l=="function"?l(s):n=s},style:o,alpha:0}),a(M,{get effects(){return{radialGradient:{colors:[124,124,N(q.color.container)],stops:[0,.4,.9],height:800,width:1920,pivot:[.8,0]}}}})]}})}const wn={Column:{...q.flexColumn,width:320,height:600,y:360,gap:20,zIndex:101,transition:{x:{duration:250,easing:"ease-in-out"}},x:8,focus:{x:q.layout.marginX}},Gradient:{zIndex:99,linearGradient:{angle:lo(270),stops:[0,.4,.8],colors:[N(q.color.primary),N(q.color.primary),N("#00000000")]},alpha:0,focus:{width:1600,alpha:1},width:100,height:1080,transition:{alpha:!0}},NavButton:{zIndex:102,height:70,width:100,borderRadius:8,focus:{color:N(q.color.container)},active:{width:328,height:70}}},ls="/solid-demo-app/",cs=[{name:"experiment",width:81,height:100,x:0,y:0},{name:"trending",width:100,height:56,x:81,y:0},{name:"tv",width:100,height:68,x:181,y:0},{name:"movie",width:94,height:100,x:282,y:0}];function us(r){const n=es(ls+"assets/icons_white.png",cs);return a(M,U(r,{get texture(){return n[r.name]},get width(){return n[r.name].props.width},get height(){return n[r.name].props.height},get x(){return(100-(n[r.name].props.width||0))/2},get y(){return(100-(n[r.name].props.height||0))/2}}))}function It(r){return a(M,U(r,{forwardStates:!0,get style(){return wn.NavButton},get children(){return[a(M,{y:-16,get children(){return a(us,{scale:.5,get name(){return r.icon}})}}),a(P,{get style(){return{...q.typography.button1,fontSize:38,x:116,y:16,height:50,alpha:0,active:{alpha:1}}},get children(){return r.children}})]}}))}function hs(r){let n;const e=nt();function t(){n.states.add("focus"),this.children.forEach(o=>o.states.add("active")),this.children.selected.setFocus()}function i(){n.states.remove("focus"),this.selected=0,this.children.forEach(o=>o.states.remove("active"))}return[a(K,U(r,{onFocus:t,onBlur:i,get style(){return wn.Column},get children(){return[a(It,{onEnter:()=>e("/browse/all"),icon:"trending",children:"Trending"}),a(It,{icon:"movie",onEnter:()=>e("/browse/movie"),children:"Movies"}),a(It,{icon:"tv",onEnter:()=>e("/browse/tv"),children:"TV"}),a(It,{icon:"experiment",onEnter:()=>e("/examples"),children:"Examples"})]}})),a(M,{ref(o){const s=n;typeof s=="function"?s(o):n=o},get style(){return wn.Gradient}})]}const le={Page:{width:1920,height:1080},headlineText:{width:1200,height:240,x:360,y:455,contain:"both",fontSize:66,textAlign:"center"},headlineSubText:{width:960,height:170,x:530,y:655,contain:"both",fontSize:48,textAlign:"center"},itemsContainer:{width:q.layout.screenW,height:600,y:560,x:0,zIndex:2},Thumbnail:{borderRadius:16,width:185,height:278,scale:1,zIndex:2,transition:{scale:{duration:250,easing:"ease-in-out"}},focus:{scale:1.1}},FocusRing:{borderRadius:16,width:194,height:286,y:-5,x:-5,zIndex:-1},showHeadline:{x:70,y:20},headlineBlur:{width:1920,height:150,x:0,y:0,zIndex:14,alpha:.9,color:N("#000000")},RowTitle:{height:60,width:300,marginTop:20,fontSize:36,color:N("#f0f0f0"),zIndex:2},Row:{display:"flex",justifyContent:"spaceBetween",height:300},Column:{display:"flex",flexDirection:"column",justifyContent:"flexStart",gap:20,width:q.layout.screenW-2*q.layout.marginX,x:q.layout.marginX+q.layout.gutterX,y:48,transition:{y:{duration:250,easing:"ease-in-out"}},zIndex:2},Rect:{width:250,height:100,y:10,x:300,color:N("#0000ff")},peopleBio:{...q.typography.body1,contain:"both",width:1500,height:400}},jt={width:120,height:40,color:N("#000000"),borderRadius:8,border:{width:2,color:N("#3333ff")},scale:1,focus:{scale:1.1,border:{width:5,color:N("#333333")}},transition:{scale:!0,color:!0}},ds={color:N("#00A699"),height:8,y:2,x:-4,width:jt.width+8},fs={fontSize:12,y:12,contain:"width",textAlign:"center",color:N("#F6F6F9"),height:jt.height,width:jt.width},Xt={container:jt,topBar:ds,text:fs},Gn={width:386,height:136,color:N("#715cab"),focus:{color:N("#5a39a2")},disabled:{color:N("#291d43")}},ps={fontSize:32,contain:"width",textAlign:"center",mountY:-.35,color:N("#FFFFFF"),height:Gn.height,width:Gn.width,focus:{fontSize:40},disabled:{color:N("#909090")}};function gs(r){return a(M,U(r,{get style(){return le.Thumbnail}}))}function ms(r){return a(M,U(r,{get style(){return le.FocusRing}}))}function Ht(r){const[n,e]=ai(r,["items"]);return a(X,U(e,{get style(){return le.Row},get children(){return a(Zt,{get each(){return n.items},children:t=>a(gs,t)})}}))}function xs(r){return a(M,U(r,{forwardStates:!0,get style(){return Xt.container},get children(){return a(P,{get style(){return Xt.text},get children(){return r.children}})}}))}const ys=r=>{Xo({Menu:"m",Escape:"Escape"});const n=Jo();n.enabled=!1;const e=nt();let t,i,o;return ye(Fe(Ot,s=>{A(s),setTimeout(()=>{s.heroContent?(t.parent=s.parent,t.alpha=0,t.scale=1,t.x=s.x-5,t.y=s.y-5,t.width=s.width+10,t.height=s.height+10,t.animate({scale:1.1,alpha:1}).start()):t.alpha=0},10)},{defer:!0})),a(M,{ref(s){const l=window.APP;typeof l=="function"?l(s):window.APP=s},onLast:()=>history.back(),onMenu:()=>e("/"),style:{width:1920,height:1080},onLeft:()=>{if(i.states.has("focus"))return!1;o=Ot(),i.setFocus()},onRight:()=>i.states.has("focus")&&o.setFocus(),get children(){return[a(as,{}),a(ms,{get color(){return N(q.color.focus)},ref(s){const l=t;typeof l=="function"?l(s):t=s}}),kn(()=>r.children),a(hs,{ref(s){const l=i;typeof l=="function"?l(s):i=s}})]}})},vs="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyZDE4YjEwMTA0YjdiZTlkNjFiMWYwYjVlMGEwNzM2OCIsInN1YiI6IjYwZTVjMTdlNGNhNjc2MDA3NTA4Njc3MSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.D_nqH9kd-bhhWzeVsTDPYhHnsUaNAuyAa6YATmKHqsA",ws="https://api.themoviedb.org/3";let Fr,kr;const _s="w185",Ss={headers:{"Content-Type":"application/json",Authorization:"Bearer "+vs}};function dt(r,n=_s){return kr+n+r}function bs(r,n={}){return Fr?_n(r,n):Lr().then(()=>_n(r,n))}function _n(r,n={}){return fetch(ws+r,{...Ss,...n}).then(e=>e.json())}function Lr(){return _n("/configuration").then(r=>{var n;return Fr=r,kr=(n=r.images)==null?void 0:n.secure_base_url,r})}const Ue={get:bs,loadConfig:Lr};function Ts(r,n){return r.length>n?r.substring(0,n-3)+"...":r}function Cs(r,n=7){let e=[];for(let t=0,i=r.length;t<i;t+=n)e.push(r.slice(t,t+n));return e}function mt(r=[]){return r.map(n=>({src:dt(n.poster_path||n.profile_path),tileSrc:dt(n.backdrop_path||n.profile_path,"w300"),backdrop:dt(n.backdrop_path,"w1280"),href:"/entity/".concat(n.media_type||"people","/").concat(n.id),shortTitle:Ts(n.title||n.name,30),title:n.title||n.name,data:n,entityInfo:{type:n.media_type||"people",id:n.id},heroContent:{title:n.title||n.name,description:n.overview}}))}let ln=new Map;const Ft=new Map;function Rs(r){return n=>{const e="/trending/".concat(r,"/week?page=").concat(n);if(ln.has(e))return ln.get(e);let t=Ue.get(e).then(i=>{let o=i.results.filter(c=>!c.adult),s=(Ft.has(r)?Ft.get(r):[]).concat(mt(o)),l=Cs(s);return l[l.length-1].length<7?Ft.set(r,l.pop()):Ft.delete(r),l});return ln.set(e,t),t}}function Es(r){const[n,e]=D([]),[t,i]=D(1),[o,s]=D(!1),[l]=Oe(t,r);return cn(()=>{const c=l();c&&qr(()=>{c.length===0&&s(!0),e(u=>[...u,...c])})}),{pages:n,page:t,setPage:i,setPages:e,end:o,setEnd:s}}const en=1100,Is={...q.typography.display2,width:en,height:58,contain:"both"},Fs=r=>a(P,U(r,{style:Is,get children(){return r.children}})),ks={...q.typography.body1,width:en,height:72,contain:"both"},Ls={fontSize:20,lineHeight:20},As=r=>a(P,U(r,{style:ks,get children(){return r.children}}));function Ps(r){return[a(Ie,{get when(){return(r==null?void 0:r.rtCrit)&&(r==null?void 0:r.rtCrit)!=="0"},get children(){return[a(M,{src:"https://upload.wikimedia.org/wikipedia/commons/b/b6/Tomato-Torrent-Icon.png",title:"Rotten Tomatoes Rating",style:{width:30,height:30,marginRight:-6}}),a(P,{style:Sn,get children(){return r.rtCrit+"%"}})]}}),a(Ie,{get when(){return(r==null?void 0:r.rtFan)&&(r==null?void 0:r.rtFan)!=="0"},get children(){return[a(M,{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/Rotten_Tomatoes_positive_audience.svg/80px-Rotten_Tomatoes_positive_audience.svg.png",title:"Rotten Tomatoes Rating",style:{width:24,height:30,marginRight:-6}}),a(P,{style:Sn,get children(){return r.rtFan+"%"}})]}})]}const zs=r=>(()=>{const n=ze("node");return Ln(Ir,n,()=>[8,15,13,15]),tt(n,U(r,{style:{color:"0x00000099",borderRadius:8,border:{width:3,color:"0xffffffff"}}}),!0),wt(n,a(P,{style:Ls,get children(){return r.children}})),n})(),Sn=q.typography.body2,Ms=r=>a(M,{get style(){return{...q.flexRow,gap:12,width:en,height:48}},get children(){return[a(P,{style:Sn,get children(){return r.metaText}}),a(Zt,{get each(){return r.badges},children:n=>a(zs,{y:-5,children:n})}),kn(()=>Ps(r.reviews))]}}),Ar=r=>a(M,U(r,{get style(){return{...q.flexColumn,width:en,height:160,gap:16}},get children(){return[a(Fs,{get children(){return r.title}}),a(As,{get children(){return r.description}}),a(Ms,{get metaText(){return r.metaText},get badges(){return r.badges},get reviews(){return r.reviews}})]}}));function Ns(r){const n=Math.floor(r/60),e=r%60;return n+"h "+(e<10?"0":"")+e+"m"}function Vn(r){return r.split("-")[0]}function Bs({type:r,id:n}){return Ue.get("/".concat(r,"/").concat(n,"/recommendations")).then(({results:e})=>e.length?mt(e.slice(0,7)):Ue.get("/trending/".concat(r,"/week?page=1")).then(({results:t})=>mt(t.slice(0,7))))}function $s({type:r,id:n}){return Ue.get("/".concat(r,"/").concat(n,"/credits")).then(({cast:e})=>mt(e.slice(0,7)))}function Pr({type:r,id:n}){let e=r==="movie"?{rtCrit:86,rtFan:92}:{};return Ue.get("/".concat(r,"/").concat(n)).then(t=>({backgroundImage:dt(t.backdrop_path,"original"),heroContent:{title:t.title||t.name,description:t.overview,badges:["HD"],metaText:r==="movie"?Ns(t.runtime)+" - "+t.release_date:"".concat(Vn(t.first_air_date)," - ").concat(Vn(t.last_air_date)),reviews:e},...t}))}const Kn=()=>{const r=An(),[n,e]=D(0),[t,i]=D();Oe(t,Pr);const[o,s]=D({}),l=nt(),c=rr(()=>0),u=ee(()=>Es(Rs(r.filter||"all")));ye(Fe(Ot,v=>{v.backdrop&&Me(v.backdrop),v.heroContent&&s(v.heroContent)},{defer:!0}));function h(){var _;(_=this.children.selected)==null||_.setFocus(),e((this.y||0)*-1+24);let v=u().pages().length;(v===0||this.parent.selected&&this.parent.selected>=v-2)&&u().setPage(x=>x+1)}function f(){let v=this.children.selected;A(v&&v.href),l(v.href)}return a(Ie,{get when(){return u().pages().length},get children(){return[a(Ar,U({y:360,x:150},o)),a(M,{clipping:!0,get style(){return le.itemsContainer},get children(){return a(K,{plinko:!0,announce:"All Trending - Week",get y(){return n()},get style(){return le.Column},get children(){return a(Zt,{get each(){return u().pages()},children:(v,_)=>a(Ht,{get autofocus(){return c(_())},items:v,onFocus:h,onEnter:f})})}})}})]}})},Ds=()=>{const r=nt(),n=rr(()=>0);function e(){let c=this.children.selected;A(c&&c.id),r("/"+c.id)}const t=[{title:"Flex Row",id:"flex",description:"Flex Row Implementation"},{title:"Flex Column",id:"flexcolumn",description:"Flex Column Implementation"},{title:"Flex Row Vertical Align",id:"flexsize",description:"Flex Row Vertical Align Implementation"},{title:"Flex Column Vertical Align",id:"flexcolumnsize",description:"Flex Column Vertical Align Implementation"},{title:"Buttons",id:"buttons",description:"Demo a few buttons"},{title:"Text",id:"text",description:"Text layout with flexbox"}];function i(c){const u={width:370,height:320,borderRadius:6,scale:1,color:405488895,transition:{color:!0,scale:!0},focus:{scale:1.1,color:4294967295}},[h,f]=D(4294967295);return a(M,U(c,{onFocus:()=>f(255),onBlur:()=>f(4294967295),style:u,get children(){return a(M,{x:30,get children(){return[a(P,{y:30,fontSize:84,get color(){return h()},get children(){return c.index}}),a(P,{y:140,fontSize:42,width:340,height:42,contain:"both",get color(){return h()},get children(){return c.title}}),a(P,{y:200,fontSize:28,width:330,contain:"width",get color(){return h()},get children(){return c.description}})]}})}}))}const[o,s]=D(140);function l(c){s(c.selected*-400+140)}return a(M,{colorTop:1147903743,colorBottom:743406847,get children(){return[a(M,{x:120,get children(){return[a(M,{src:"/assets/solidjs.png",width:101,height:90,y:40}),a(P,{fontSize:90,x:110,y:40,children:"Examples"}),a(M,{y:140,height:1,width:1800,color:3906468351})]}}),a(X,{onSelectedChanged:l,onEnter:e,transition:{x:{delay:20,duration:300}},get x(){return o()},y:300,width:4400,get style(){return le.Row},justifyContent:"flexStart",gap:40,get children(){return a(Zt,{each:t,children:(c,u)=>a(i,U({get autofocus(){return n(u())},get index(){return u()}},c))})}})]}})},Os=()=>{const r={width:900,height:500,y:350,x:150,gap:25,display:"flex",flexDirection:"column",justifyContent:"flexStart",color:N("00000000")},n={width:900,height:36,gap:6,display:"flex",flexDirection:"row",justifyContent:"flexStart",color:N("00000000")},e={fontSize:42},t={width:r.width,fontSize:26,contain:"width"},i={fontSize:26};return yt(()=>{Me("0x000000ff")}),a(M,{autofocus:!0,style:r,get children(){return[a(P,{style:e,children:"Title of the Page"}),a(P,{style:t,children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer vel tempor tellus. Sed eu leo purus. Vestibulum sollicitudin eget tellus a varius. Phasellus est turpis, volutpat sed blandit sit amet, rutrum sit amet mauris. In dignissim elit orci, a sollicitudin ipsum faucibus et. Quisque vel quam rutrum, faucibus augue sed, scelerisque nunc."}),a(M,{style:n,get children(){return[a(P,{style:i,children:"Subline Text"}),a(M,{width:28,height:28,src:"/assets/rt-popcorn.png"}),a(P,{style:i,children:"More Text"})]}})]}})},Ys=()=>{function r(i,o){this.states.toggle("disabled")}const n={display:"flex",justifyContent:"flexStart",width:1500,height:300,color:N("00000000"),gap:26,y:400};function e(i){return a(M,U(i,{forwardStates:!0,get style(){return Xt.container},get children(){return a(P,{get style(){return Xt.text},get children(){return i.children}})}}))}const t=i=>(()=>{const o=ze("node");return Ln(Ir,o,()=>[10,15]),tt(o,U(i,{get style(){return{color:N("#000000be"),borderRadius:8,border:{width:2,color:N("#ffffff")}}}}),!0),wt(o,a(P,{style:{fontSize:20},get children(){return i.children}})),o})();return[a(X,{x:100,y:200,gap:5,style:n,get children(){return[a(t,{children:"HD"}),a(t,{children:"PG13"}),a(t,{children:"NC17"}),a(P,{fontSize:30,children:"I like bananas"}),a(t,{children:"DOLBY"})]}}),a(X,{x:100,gap:40,style:n,get children(){return[a(e,{autofocus:!0,onEnter:r,children:"TV Shows"}),a(e,{states:{active:!0,disabled:!1},children:"Movies"}),a(e,{states:"active",children:"Sports"}),a(e,{states:"disabled",children:"News"})]}})]},Us=()=>{const r={display:"flex",justifyContent:"flexStart",width:1600,height:110,color:N("#4dabf5")},n={fontSize:44,marginTop:25,marginBottom:-20,skipFocus:!0};function e(l){return a(M,U(l,{style:{width:200,height:100,y:5,color:392801023}}))}const[t,i]=D(50);function o(){var l;(l=this.children.selected)==null||l.setFocus(),i(150+(this.y||0)*-1)}yt(()=>{Me("#333333")});const s=50;return a(K,{x:160,get y(){return t()},gap:30,height:850,get width(){return r.width},get style(){return le.Column},get children(){return[a(P,{style:n,children:"Flex Start"}),a(X,{gap:s,style:r,onFocus:o,get children(){return[a(e,{autofocus:!0}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(P,{style:n,children:"Flex Start - Margin Left"}),a(X,{gap:s,style:r,onFocus:o,get children(){return[a(e,{marginLeft:100}),a(e,{}),a(e,{marginLeft:100}),a(e,{}),a(e,{})]}}),a(P,{style:n,children:"Flex End"}),a(X,{gap:s,justifyContent:"flexEnd",style:r,onFocus:o,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(P,{style:n,children:"Flex End - Margin Right"}),a(X,{gap:s,justifyContent:"flexEnd",style:r,onFocus:o,get children(){return[a(e,{}),a(e,{marginRight:100}),a(e,{}),a(e,{}),a(e,{marginRight:100})]}}),a(P,{style:n,children:"Center - No Margin Support"}),a(X,{gap:s,justifyContent:"center",style:r,onFocus:o,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(P,{style:n,children:"Space Between - No Margin Support"}),a(X,{gap:s,justifyContent:"spaceBetween",style:r,onFocus:o,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(P,{style:n,children:"Space Evenly - No Margin Support"}),a(X,{gap:s,justifyContent:"spaceEvenly",style:r,onFocus:o,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}})]}})},Ws=()=>{const r={display:"flex",justifyContent:"flexStart",width:1600,height:110,color:N("#4dabf5")},n={fontSize:44,marginTop:25,marginBottom:-20,skipFocus:!0};function e(c){return a(M,U(c,{style:{width:200,height:100,y:5,color:392801023}}))}function t(){return Math.floor(Math.random()*91)+10}const[i,o]=D(50);function s(){var c;(c=this.children.selected)==null||c.setFocus(),o(150+(this.y||0)*-1)}yt(()=>{Me("#333333")});const l=50;return a(K,{x:160,get y(){return i()},gap:30,height:850,get width(){return r.width},get style(){return le.Column},get children(){return[a(P,{style:n,children:"Flex Start - AlignItems: center"}),a(X,{alignItems:"center",gap:l,style:r,onFocus:s,get children(){return[a(e,{autofocus:!0,get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}})]}}),a(P,{style:n,children:"Flex Start - Margin Left - AlignItems: flexStart"}),a(X,{gap:l,alignItems:"flexStart",style:r,onFocus:s,get children(){return[a(e,{marginLeft:100,get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{marginLeft:100,get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}})]}}),a(P,{style:n,children:"Flex End - AlignItems: flexEnd"}),a(X,{gap:l,justifyContent:"flexEnd",alignItems:"flexEnd",style:r,onFocus:s,get children(){return[a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}})]}}),a(P,{style:n,children:"Flex End - Margin Right"}),a(X,{gap:l,justifyContent:"flexEnd",style:r,onFocus:s,get children(){return[a(e,{get height(){return t()}}),a(e,{marginRight:100,get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{marginRight:100,get height(){return t()}})]}}),a(P,{style:n,children:"Center - No Margin Support"}),a(X,{gap:l,justifyContent:"center",style:r,onFocus:s,get children(){return[a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}})]}}),a(P,{style:n,children:"Space Between - No Margin Support"}),a(X,{gap:l,justifyContent:"spaceBetween",style:r,onFocus:s,get children(){return[a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}})]}}),a(P,{style:n,children:"Space Evenly - No Margin Support"}),a(X,{gap:l,justifyContent:"spaceEvenly",style:r,onFocus:s,get children(){return[a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}}),a(e,{get height(){return t()}})]}})]}})},js=()=>{const r={display:"flex",justifyContent:"spaceEvenly",width:1920,y:100,height:880,color:N("00000000")},n={display:"flex",flexDirection:"column",justifyContent:"flexStart",color:N("#4dabf5"),height:850,width:80},e={fontSize:44,y:20,x:150};function t(u){const h={width:i(),height:80,x:5,color:N("#1769aa")};return a(M,U(u,{style:h}))}function i(){return Math.floor(Math.random()*61)+10}const[o,s]=D(50);function l(){var u;(u=this.children.selected)==null||u.setFocus(),s(150+(this.y||0)*-1)}yt(()=>{Me("#333333")});const c=50;return[a(P,{style:e,children:"Start, MarginTop, End, MarginBottom, Center, Between, Evenly"}),a(X,{gap:c,style:r,onFocus:l,get children(){return[a(K,{gap:30,style:n,alignItems:"center",get children(){return[a(t,{autofocus:!0}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(K,{gap:c,style:n,onFocus:l,alignItems:"flexStart",get children(){return[a(t,{marginTop:100}),a(t,{}),a(t,{marginTop:100}),a(t,{}),a(t,{})]}}),a(K,{gap:c,alignItems:"flexEnd",justifyContent:"flexEnd",style:n,onFocus:l,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(K,{gap:c,justifyContent:"flexEnd",style:n,onFocus:l,get children(){return[a(t,{}),a(t,{marginBottom:100}),a(t,{}),a(t,{}),a(t,{marginBottom:100})]}}),a(K,{gap:c,justifyContent:"center",style:n,onFocus:l,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(K,{gap:c,justifyContent:"spaceBetween",style:n,onFocus:l,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(K,{gap:c,justifyContent:"spaceEvenly",style:n,onFocus:l,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}})]}})]},Xs=()=>{const r={display:"flex",justifyContent:"spaceEvenly",width:1920,y:100,height:880,color:N("00000000")},n={display:"flex",flexDirection:"column",justifyContent:"flexStart",color:N("#4dabf5"),height:850,width:60},e={fontSize:44,y:20,x:150};function t(c){const u={width:50,height:80,x:5,color:N("#1769aa")};return a(M,U(c,{style:u}))}const[i,o]=D(50);function s(){var c;(c=this.children.selected)==null||c.setFocus(),o(150+(this.y||0)*-1)}yt(()=>{Me("#333333")});const l=50;return[a(P,{style:e,children:"Start, MarginTop, End, MarginBottom, Center, Between, Evenly"}),a(X,{gap:l,style:r,onFocus:s,get children(){return[a(K,{gap:30,style:n,get children(){return[a(t,{autofocus:!0}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(K,{gap:l,style:n,onFocus:s,get children(){return[a(t,{marginTop:100}),a(t,{}),a(t,{marginTop:100}),a(t,{}),a(t,{})]}}),a(K,{gap:l,justifyContent:"flexEnd",style:n,onFocus:s,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(K,{gap:l,justifyContent:"flexEnd",style:n,onFocus:s,get children(){return[a(t,{}),a(t,{marginBottom:100}),a(t,{}),a(t,{}),a(t,{marginBottom:100})]}}),a(K,{gap:l,justifyContent:"center",style:n,onFocus:s,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(K,{gap:l,justifyContent:"spaceBetween",style:n,onFocus:s,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(K,{gap:l,justifyContent:"spaceEvenly",style:n,onFocus:s,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}})]}})]},Hs=()=>{function r(o,s){this.states.toggle("disabled")}const n={display:"flex",justifyContent:"flexStart",width:1500,height:300,color:N("00000000"),gap:26,y:400,x:100},e={width:386,height:136,color:"0x715cabff",focus:{color:"0x5a39a2ff"},disabled:{color:"0x291d43ff"}},t=["RoundedRectangle",{radius:65}];function i(o){return a(M,U(o,{forwardStates:!0,style:e,shader:t,get children(){return a(P,{style:ps,get children(){return o.children}})}}))}return a(X,{style:n,get children(){return[a(i,{autofocus:!0,onEnter:r,children:"Focused"}),a(i,{states:{active:!0,disabled:!1},children:"Normal"}),a(i,{states:"disabled",children:"Disabled"})]}})},Gs="https://storage.googleapis.com/shaka-demo-assets/angel-one/dash.mpd";function Vs(){shaka.polyfill.installAll(),shaka.Player.isBrowserSupported()?Ks():console.error("Browser not supported!")}async function Ks(){const r=document.getElementById("video"),n=new shaka.Player;await n.attach(r),window.player=n,n.addEventListener("error",qs);try{await n.load(Gs),console.log("The video has now been loaded!")}catch(e){zr(e)}}function qs(r){zr(r.detail)}function zr(r){console.error("Error code",r.code,"object",r)}function Qs(){const r=document.getElementById("video");return r.hidden=!1,setTimeout(()=>r.play(),50),r.focus(),r}function Zs(){const r=document.getElementById("video");return r.hidden=!0,r.pause(),r}document.addEventListener("DOMContentLoaded",Vs);const Js=()=>{const r=An(),n=nt(),[e]=Oe(()=>({...r}),Pr),[t]=Oe(()=>({...r}),$s),[i]=Oe(()=>({...r}),Bs),[o,s]=D(0);ye(Fe(e,S=>{Me(S.backgroundImage)},{defer:!0}));const l=600,c={color:N("#000000"),alpha:0,width:1900,height:890,x:10,y:l,borderRadius:30};function u(){var S;(S=this.children.selected)==null||S.setFocus(),x.y=l,y.y=l,y.alpha=0}function h(){var S;(S=this.children.selected)==null||S.setFocus(),x.y=200,y.y=160,y.alpha=.9}function f(){let S=this.children.selected;A(S&&S.href),n(S.href)}function v(){Zs(),document.getElementsByTagName("canvas")[0].focus(),Yt(T),s(0)}function _(){const S=Qs();Yt(S),s(.9)}let x,y,T;return a(Ie,{get when(){return e()},keyed:!0,get children(){return[a(M,{onUp:()=>T.setFocus(),onEscape:v,get children(){return[a(Ar,U({y:360,x:150},()=>e().heroContent)),a(xs,{autofocus:!0,ref(S){const p=T;typeof p=="function"?p(S):T=S},y:560,x:150,onDown:()=>x.setFocus(),onEnter:_,children:"Watch Trailer"}),a(K,{ref(S){const p=x;typeof p=="function"?p(S):x=S},y:l,x:140,get style(){return le.Column},zIndex:5,get children(){return a(Ie,{get when(){return kn(()=>!!i())()&&t()},get children(){return[a(P,{skipFocus:!0,get style(){return le.RowTitle},children:"Recommendations"}),a(Ht,{onFocus:u,onEnter:f,get items(){return i()}}),a(P,{skipFocus:!0,get style(){return le.RowTitle},children:"Cast and Crew"}),a(Ht,{onFocus:h,onEnter:f,get items(){return t()}})]}})}}),a(M,{ref(S){const p=y;typeof p=="function"?p(S):y=S},style:c,transition:{alpha:!0,y:!0}})]}}),a(M,{get alpha(){return o()},get color(){return N("#000000")},zIndex:200,transition:{alpha:!0}})]}})};function ea({id:r}){return Ue.get("/person/".concat(r,"/combined_credits")).then(({cast:n})=>mt(n.slice(0,7)))}function ta({id:r}){return Ue.get("/person/".concat(r)).then(n=>({backgroundImage:dt(n.profile_path,"original"),heroContent:{title:n.title||n.name,description:n.biography},...n}))}const na=()=>{const r=An(),n=nt(),[e]=Oe(()=>({...r}),ta),[t]=Oe(()=>({...r}),ea);ye(Fe(e,s=>{Me(s.backgroundImage)},{defer:!0}));const i={color:N("#000000"),alpha:.8,width:1540,height:440,x:130,y:180,borderRadius:30};function o(){let s=this.children.selected;A(s&&s.href),n(s.href)}return a(Ie,{get when(){return e()},keyed:!0,get children(){return[a(M,{x:150,y:200,get style(){return le.Column},zIndex:3,get children(){return[a(P,{get style(){return q.typography.display2},get children(){return e().name}}),a(P,{get style(){return le.peopleBio},get children(){return e().biography}})]}}),a(M,{style:i}),a(K,{y:670,x:140,get style(){return le.Column},get children(){return a(Ie,{get when(){return t()},get children(){return[a(P,{skipFocus:!0,get style(){return le.RowTitle},children:"Credits"}),a(Ht,{autofocus:!0,onEnter:o,get items(){return t()}})]}})}})]}})},ra=()=>(()=>{const r=ze("node");return gt(r,"style",{width:1920,height:1080,color:868483072}),r})(),ia=new URL("AppCoreExtensions-2d11dd42.js",import.meta.url).href;Ee.debug=!1;Ee.fontSettings.fontFamily="Ubuntu";Ee.fontSettings.color=N("#ffffff");Ee.fontSettings.fontSize=100;ao(()=>a(ro,{options:{coreExtensionModule:ia,threadXCoreWorkerUrl:void 0},get children(){return a($o,{root:ys,get children(){return[a(ue,{path:"",component:Kn}),a(ue,{path:"examples",component:Ds}),a(ue,{path:"browse/:filter",component:Kn}),a(ue,{path:"text",component:Os}),a(ue,{path:"buttons",component:Ys}),a(ue,{path:"flex",component:Us}),a(ue,{path:"flexsize",component:Ws}),a(ue,{path:"flexcolumnsize",component:js}),a(ue,{path:"flexcolumn",component:Xs}),a(ue,{path:"buttonsmaterial",component:Hs}),a(ue,{path:"entity/people/:id",component:na}),a(ue,{path:"entity/:type/:id",component:Js}),a(ue,{path:"*all",component:ra})]}})}}));export{sa as __vite_legacy_guard};
//# sourceMappingURL=index-d22c12b3.js.map
