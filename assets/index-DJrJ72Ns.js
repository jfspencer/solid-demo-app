var Ai=Object.defineProperty;var Ti=(n,t,e)=>t in n?Ai(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var c=(n,t,e)=>Ti(n,typeof t!="symbol"?t+"":t,e);function au(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();const wi="modulepreload",Si=function(n){return"/solid-demo-app/"+n},Pn={},xe=function(t,e,r){let s=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.all(e.map(a=>{if(a=Si(a),a in Pn)return;Pn[a]=!0;const l=a.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(document.querySelector('link[href="'.concat(a,'"]').concat(h)))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":wi,l||(d.as="script",d.crossOrigin=""),d.href=a,o&&d.setAttribute("nonce",o),document.head.appendChild(d),l)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error("Unable to preload CSS for ".concat(a))))})}))}return s.then(()=>t()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};function _i(n,t){const e={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},r=n.getContext("webgl",e)||n.getContext("experimental-webgl",e);if(!r)throw new Error("Unable to create WebGL context");return t?new Proxy(r,{get(s,i){const o=s[i];return typeof o=="function"?(t.increment(String(i)),o.bind(s)):o}}):r}function L(n,t){if(!fn()&&!n)throw new Error(t||"Assertion failed")}function Nn(n,t,e){const r=Math.trunc(n>>>24),s=Math.trunc(n>>>16&255),i=Math.trunc(n>>>8&255),o=Math.trunc(n&255),a=Math.trunc(t>>>24),l=Math.trunc(t>>>16&255),h=Math.trunc(t>>>8&255),d=Math.trunc(t&255),f=Math.round(a*e+r*(1-e)),p=Math.round(l*e+s*(1-e)),v=Math.round(h*e+i*(1-e)),y=Math.round(d*e+o*(1-e));return(f<<24|p<<16|v<<8|y)>>>0}function Ri(n,t){const e=n>>>24,r=n>>>16&255,s=n>>>8&255,i=Math.trunc((n&255)*t);return(e<<24|r<<16|s<<8|i)>>>0}let hs=!0;function Ci(n){hs=n==="webgl"}function Ft(n,t,e=!1){const r=(n&255)/255*t,s=hs?r:1,i=Math.trunc((n>>>24)*s),o=Math.trunc((n>>>16&255)*s),a=Math.trunc((n>>>8&255)*s),l=Math.trunc(r*255);return e?(l<<24|a<<16|o<<8|i)>>>0:(i<<24|o<<16|a<<8|l)>>>0}function Gr(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function fn(){return{BASE_URL:"/solid-demo-app/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1}&&!0}let Ei=1;function Ii(){return Ei++}class He{constructor(){c(this,"eventListeners",{})}on(t,e){let r=this.eventListeners[t];r||(r=[]),r.push(e),this.eventListeners[t]=r}off(t,e){const r=this.eventListeners[t];if(!r)return;if(!e){delete this.eventListeners[t];return}const s=r.indexOf(e);s>=0&&r.splice(s,1)}once(t,e){const r=(s,i)=>{this.off(t,r),e(s,i)};this.on(t,r)}emit(t,e){const r=this.eventListeners[t];r&&[...r].forEach(s=>{s(this,e)})}removeAllListeners(){this.eventListeners={}}}const Bi=/^(data|ftps?|https?):/,Et=n=>{const t=n>>>24,e=n>>>16&255,r=n>>>8&255,s=n&255;return[t/255,e/255,r/255,s/255]},Fi=n=>{const t=n>>>24,e=n>>>16&255,r=n>>>8&255,s=n&255;return[t,e,r,s]};function Mi(n){return(n&255)/255}function Er(n){const t=Math.floor(n[0]*255),e=Math.floor(n[1]*255),r=Math.floor(n[2]*255),s=Math.floor(n[3]*255);return"rgba(".concat(t,",").concat(e,",").concat(r,",").concat(s.toFixed(4),")")}function Mt(n,t,e,r,s){return s?(s.x1=n,s.y1=t,s.x2=e,s.y2=r,s):{x1:n,y1:t,x2:e,y2:r}}function Ir(n,t){return n.x1<t.x2&&n.x2>t.x1&&n.y1<t.y2&&n.y2>t.y1}function Li(n,t){return t?(t.x=n.x1,t.y=n.y1,t.width=n.x2-n.x1,t.height=n.y2-n.y1,t):{x:n.x1,y:n.y1,width:n.x2-n.x1,height:n.y2-n.y1}}function us(n,t,e){const r=Math.max(n.x,t.x),s=Math.max(n.y,t.y),i=Math.min(n.x+n.width,t.x+t.width)-r,o=Math.min(n.y+n.height,t.y+t.height)-s;return i>0&&o>0?e?(e.x=r,e.y=s,e.width=i,e.height=o,e):{x:r,y:s,width:i,height:o}:e?(e.x=0,e.y=0,e.width=0,e.height=0,e):{x:0,y:0,width:0,height:0}}function ds(n,t){return t?(t.x=n.x,t.y=n.y,t.width=n.width,t.height=n.height,t):{x:n.x,y:n.y,width:n.width,height:n.height}}function ki(n,t){return n===t?!0:n===null||t===null?!1:n.x===t.x&&n.y===t.y&&n.width===t.width&&n.height===t.height}function Dn(n,t){return n.x1<=t.x2&&n.y1<=t.y2&&n.x2>=t.x1&&n.y2>=t.y1}function Pi(n){return n.x1<n.x2&&n.y1<n.y2}function Ni(n){if(self.location.protocol==="file:"&&!Bi.test(n)){const e=self.location.pathname.split("/");e.pop();const r=e.join("/"),s=self.location.protocol+"//"+r;return n.charAt(0)==="."&&(n=n.slice(1)),n.charAt(0)==="/"&&(n=n.slice(1)),s+"/"+n}return new URL(n,self.location.href).href}class pe{constructor(){c(this,"ta");c(this,"tb");c(this,"tx");c(this,"tc");c(this,"td");c(this,"ty");c(this,"_floatArr",null);c(this,"mutation");this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return Di}static multiply(t,e,r){const s=t.ta*e.ta+t.tb*e.tc,i=t.ta*e.tb+t.tb*e.td,o=t.ta*e.tx+t.tb*e.ty+t.tx,a=t.tc*e.ta+t.td*e.tc,l=t.tc*e.tb+t.td*e.td,h=t.tc*e.tx+t.td*e.ty+t.ty;return r||(r=new pe),r.ta=s,r.tb=i,r.tx=o,r.tc=a,r.td=l,r.ty=h,r.mutation=!0,r}static identity(t){return t||(t=new pe),t.ta=1,t.tb=0,t.tx=0,t.tc=0,t.td=1,t.ty=0,t.mutation=!0,t}static translate(t,e,r){return r||(r=new pe),r.ta=1,r.tb=0,r.tx=t,r.tc=0,r.td=1,r.ty=e,r.mutation=!0,r}static scale(t,e,r){return r||(r=new pe),r.ta=t,r.tb=0,r.tx=0,r.tc=0,r.td=e,r.ty=0,r.mutation=!0,r}static rotate(t,e){const r=Math.cos(t),s=Math.sin(t);return e||(e=new pe),e.ta=r,e.tb=-s,e.tx=0,e.tc=s,e.td=r,e.ty=0,e.mutation=!0,e}static copy(t,e){return e||(e=new pe),e.ta=t.ta,e.tc=t.tc,e.tb=t.tb,e.td=t.td,e.tx=t.tx,e.ty=t.ty,e.mutation=!0,e}translate(t,e){return this.tx=this.ta*t+this.tb*e+this.tx,this.ty=this.tc*t+this.td*e+this.ty,this.mutation=!0,this}scale(t,e){return this.ta=this.ta*t,this.tb=this.tb*e,this.tc=this.tc*t,this.td=this.td*e,this.mutation=!0,this}rotate(t){if(t===0||!(t%Math.PI*2))return this;const e=Math.cos(t),r=Math.sin(t),s=this.ta*e+this.tb*r,i=this.tb*e-this.ta*r,o=this.tc*e+this.td*r,a=this.td*e-this.tc*r;return this.ta=s,this.tb=i,this.tc=o,this.td=a,this.mutation=!0,this}multiply(t){return pe.multiply(this,t,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}const Di=new pe,Lt=0,kt=2,Pt=4,Nt=6,Dt=1,Ot=3,Ut=5,zt=7;class tr{constructor(t){c(this,"data");this.data=new Float32Array(8),t&&(this.data[Lt]=t[Lt],this.data[kt]=t[kt],this.data[Pt]=t[Pt],this.data[Nt]=t[Nt],this.data[Dt]=t[Dt],this.data[Ot]=t[Ot],this.data[Ut]=t[Ut],this.data[zt]=t[zt])}static translate(t,e,r,s,i,o,a,l,h){return h||(h=new tr),h.data[Lt]=t,h.data[kt]=r,h.data[Pt]=i,h.data[Nt]=a,h.data[Dt]=e,h.data[Ot]=s,h.data[Ut]=o,h.data[zt]=l,h}get x1(){return this.data[Lt]}get x2(){return this.data[kt]}get x3(){return this.data[Pt]}get x4(){return this.data[Nt]}get y1(){return this.data[Dt]}get y2(){return this.data[Ot]}get y3(){return this.data[Ut]}get y4(){return this.data[zt]}}const On=n=>n&&!(n&n-1),fs=(n,t,e,r)=>{const s=3*n,i=3*(e-n)-s,o=1-s-i,a=3*t,l=3*(r-t)-a,h=1-a-l;return function(d){if(d>=1)return 1;if(d<=0)return 0;let f=.5,p,v,y;for(let S=0;S<20;S++){if(p=f*(f*(f*o+i)+s),y=d-p,y>-1e-8&&y<1e-8)return f*(f*(f*h+l)+a);if(v=f*(f*(3*o)+2*i)+s,v>1e-10&&v<1e-10)break;f+=y/v}let m=0,A=1;for(let S=0;S<20;S++){if(f=.5*(m+A),p=f*(f*(f*o+i)+s),y=d-p,y>-1e-8&&y<1e-8)return f*(f*(f*h+l)+a);y<0?A=f:m=f}}},jt={},Oi={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},qt=n=>n,Ui=n=>{const t=/-?\d*\.?\d+/g,e=n.match(t);if(e){const[r,s,i,o]=e,a=parseFloat(r||"0.42"),l=parseFloat(s||"0"),h=parseFloat(i||"1"),d=parseFloat(o||"1"),f=fs(a,l,h,d);return jt[n]=f,f}return console.warn("Unknown cubic-bezier timing: "+n),qt},zi=n=>{if(n==="linear")return qt;if(jt[n]!==void 0)return jt[n]||qt;if(n==="step-start")return()=>1;if(n==="step-end")return e=>e===1?1:0;const t=Oi[n];if(t!==void 0){const[e,r,s,i]=t,o=fs(e,r,s,i);return jt[n]=o,o}return n.startsWith("cubic-bezier")?Ui(n):(console.warn("Unknown timing function: "+n),qt)};function Un(n){return(n/1024/1024).toFixed(2)}class Wi extends He{constructor(e,r,s){var a,l,h,d,f,p;super();c(this,"node");c(this,"props");c(this,"settings");c(this,"progress",0);c(this,"delayFor",0);c(this,"timingFunction");c(this,"propValuesMap",{});c(this,"dynPropValuesMap");this.node=e,this.props=r;for(const v in r)if(v!=="shaderProps")this.propValuesMap.props===void 0&&(this.propValuesMap.props={}),this.propValuesMap.props[v]={start:e[v],target:r[v]};else if(e.shader.type!=="DynamicShader"){this.propValuesMap.shaderProps={};for(const y in r.shaderProps)this.propValuesMap.shaderProps[y]={start:e.shader.props[y],target:r.shaderProps[y]}}else{const y=Object.keys(r.shaderProps),m=y.length;this.dynPropValuesMap={};for(let A=0;A<m;A++){const S=y[A],x=r.shaderProps[S];this.dynPropValuesMap[S]={};const b=Object.entries(x),g=b.length;for(let T=0;T<g;T++){const[_,C]=b[T];this.dynPropValuesMap[S][_]={start:e.shader.props[S][_],target:C}}}}const i=s.easing||"linear",o=(a=s.delay)!=null?a:0;this.settings={duration:(l=s.duration)!=null?l:0,delay:o,easing:i,loop:(h=s.loop)!=null?h:!1,repeat:(d=s.repeat)!=null?d:0,repeatDelay:(f=s.repeatDelay)!=null?f:0,stopMethod:(p=s.stopMethod)!=null?p:!1},this.timingFunction=zi(i),this.delayFor=o}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(e,r){const s=Object.entries(r),i=s.length;for(let o=0;o<i;o++){const[a,l]=s[o];e[a]=l.start}}restore(){if(this.reset(),this.propValuesMap.props!==void 0&&this.restoreValues(this.node,this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),r=e.length;if(r>0)for(let s=0;s<r;s++){const i=e[s];this.restoreValues(this.node.shader.props[i],this.dynPropValuesMap[i])}}}reverseValues(e){const r=Object.entries(e),s=r.length;for(let i=0;i<s;i++){const[o,a]=r[i];e[o]={start:a.target,target:a.start}}}reverse(){if(this.progress=0,this.propValuesMap.props!==void 0&&this.reverseValues(this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.reverseValues(this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),r=e.length;if(r>0)for(let s=0;s<r;s++){const i=e[s];this.reverseValues(this.dynPropValuesMap[i])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,r,s){return(this.timingFunction(e)||e)*(s-r)+r}updateValue(e,r,s,i){if(this.progress===1)return r;if(this.progress===0)return s;const o=r;if(e.indexOf("color")!==-1){if(s===o)return s;if(i){const a=this.timingFunction(this.progress)||this.progress;return Nn(s,o,a)}return Nn(s,o,this.progress)}return i?this.applyEasing(this.progress,s,o):s+(o-s)*this.progress}updateValues(e,r,s){const i=Object.entries(r),o=i.length;for(let a=0;a<o;a++){const[l,h]=i[a];e[l]=this.updateValue(l,h.target,h.start,s)}}update(e){const{duration:r,loop:s,easing:i,stopMethod:o}=this.settings,{delayFor:a}=this;if(r===0&&a===0){this.emit("finished",{});return}if(this.delayFor>0){if(this.delayFor-=e,this.delayFor>=0)return;e=-this.delayFor,this.delayFor=0}if(r===0){this.emit("finished",{});return}if(this.progress===0&&this.emit("animating",{}),this.progress+=e/r,this.progress>1&&(this.progress=s?0:1,o)){this.emit("finished",{});return}if(this.propValuesMap.props!==void 0&&this.updateValues(this.node,this.propValuesMap.props,i),this.propValuesMap.shaderProps!==void 0&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,i),this.dynPropValuesMap!==void 0){const l=Object.keys(this.dynPropValuesMap),h=l.length;if(h>0)for(let d=0;d<h;d++){const f=l[d];this.updateValues(this.node.shader.props[f],this.dynPropValuesMap[f],i)}}this.progress===1&&this.emit("finished",{})}}class Hi extends He{constructor(e,r){super();c(this,"manager");c(this,"animation");c(this,"stoppedPromise");c(this,"stoppedResolve",null);c(this,"state");this.manager=e,this.animation=r,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this)}start(){return this.state!=="running"&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="running"),this}stop(){return this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating)}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(e=>{this.stoppedResolve=e}))}onFinished(){L(this.stoppedResolve);const{loop:e,stopMethod:r}=this.animation.settings;if(r==="reverse"){this.animation.reverse();return}e||(this.unregisterAnimation(),this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this),this.state="stopped")}onAnimating(){this.emit("animating",this)}}var we;(function(n){n[n.Init=0]="Init",n[n.OutOfBounds=2]="OutOfBounds",n[n.InBounds=4]="InBounds",n[n.InViewport=8]="InViewport"})(we||(we={}));const It=new Map;It.set(we.Init,"init");It.set(we.OutOfBounds,"outOfBounds");It.set(we.InBounds,"inBounds");It.set(we.InViewport,"inViewport");var F;(function(n){n[n.Children=1]="Children",n[n.ScaleRotate=2]="ScaleRotate",n[n.Local=4]="Local",n[n.Global=8]="Global",n[n.Clipping=16]="Clipping",n[n.CalculatedZIndex=32]="CalculatedZIndex",n[n.ZIndexSortedChildren=64]="ZIndexSortedChildren",n[n.PremultipliedColors=128]="PremultipliedColors",n[n.WorldAlpha=256]="WorldAlpha",n[n.RenderState=512]="RenderState",n[n.IsRenderable=1024]="IsRenderable",n[n.RenderTexture=2048]="RenderTexture",n[n.ParentRenderTexture=4096]="ParentRenderTexture",n[n.None=0]="None",n[n.All=8191]="All"})(F||(F={}));class Yr extends He{constructor(e,r){super();c(this,"stage");c(this,"children",[]);c(this,"_id",Ii());c(this,"props");c(this,"updateType",F.All);c(this,"globalTransform");c(this,"scaleRotateTransform");c(this,"localTransform");c(this,"renderCoords");c(this,"renderBound");c(this,"strictBound");c(this,"preloadBound");c(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1});c(this,"isRenderable",!1);c(this,"renderState",we.Init);c(this,"worldAlpha",1);c(this,"premultipliedColorTl",0);c(this,"premultipliedColorTr",0);c(this,"premultipliedColorBl",0);c(this,"premultipliedColorBr",0);c(this,"calcZIndex",0);c(this,"hasRTTupdates",!1);c(this,"parentHasRenderTexture",!1);c(this,"onTextureLoaded",(e,r)=>{var s,i;this.autosizeNode(r),this.stage.requestRender(),this.parentHasRenderTexture&&this.setRTTUpdates(1),this.emit("loaded",{type:"texture",dimensions:r}),((i=(s=this.props.textureOptions)==null?void 0:s.resizeMode)==null?void 0:i.type)==="contain"&&this.setUpdateType(F.Local)});c(this,"onTextureFailed",(e,r)=>{this.emit("failed",{type:"texture",error:r})});c(this,"onTextureFreed",()=>{this.emit("freed",{type:"texture"})});this.stage=e,this.props={...r,parent:null,texture:null,src:null,rtt:!1},this.parent=r.parent,this.texture=r.texture,this.src=r.src,this.rtt=r.rtt,this.updateScaleRotateTransform()}loadTexture(){const{texture:e}=this.props;L(e),queueMicrotask(()=>{this.textureOptions.preload&&e.ctxTexture.load(),e.state==="loaded"?(L(e.dimensions),this.onTextureLoaded(e,e.dimensions)):e.state==="failed"?(L(e.error),this.onTextureFailed(e,e.error)):e.state==="freed"&&this.onTextureFreed(e),e.on("loaded",this.onTextureLoaded),e.on("failed",this.onTextureFailed),e.on("freed",this.onTextureFreed)})}unloadTexture(){this.texture&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this,!1))}autosizeNode(e){this.autosize&&(this.width=e.width,this.height=e.height)}setUpdateType(e){this.updateType|=e;const r=this.props.parent;r&&!(r.updateType&F.Children)&&r.setUpdateType(F.Children),this.parentHasRenderTexture&&this.setRTTUpdates(e)}sortChildren(){this.children.sort((e,r)=>e.calcZIndex-r.calcZIndex)}updateScaleRotateTransform(){const{rotation:e,scaleX:r,scaleY:s}=this.props;if(e===0&&r===1&&s===1){this.scaleRotateTransform=void 0;return}this.scaleRotateTransform=pe.rotate(e,this.scaleRotateTransform).scale(r,s)}updateLocalTransform(){var h,d;const{x:e,y:r,width:s,height:i}=this.props,o=this.props.mountX*s,a=this.props.mountY*i;if(this.scaleRotateTransform){const f=this.props.pivotX*s,p=this.props.pivotY*i;this.localTransform=pe.translate(e-o+f,r-a+p,this.localTransform).multiply(this.scaleRotateTransform).translate(-f,-p)}else this.localTransform=pe.translate(e-o,r-a,this.localTransform);const l=this.props.texture;if(l&&l.dimensions&&((d=(h=this.props.textureOptions)==null?void 0:h.resizeMode)==null?void 0:d.type)==="contain"){let f=1,p=1,v=0,y=0;const{width:m,height:A}=l.dimensions,S=m/A,x=s/i;if(S>x){const b=s/m,g=A*b;y=(i-g)/2,p=g/i}else{const b=i/A,g=m*b;v=(s-g)/2,f=g/s}this.localTransform.translate(v,y).scale(f,p)}this.setUpdateType(F.Global)}update(e,r){var o;this.updateType&F.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(F.Local)),this.updateType&F.Local&&(this.updateLocalTransform(),this.setUpdateType(F.Global));const s=this.props.parent;let i=F.None;if(this.updateType&F.ParentRenderTexture){let a=this.parent;for(;a;)a.rtt&&(this.parentHasRenderTexture=!0),a=a.parent}this.updateType^F.All&&this.updateType&F.RenderTexture&&this.children.forEach(a=>{a.setUpdateType(F.All)}),this.updateType&F.Global&&(L(this.localTransform),this.globalTransform=pe.copy((s==null?void 0:s.globalTransform)||this.localTransform,this.globalTransform),this.parentHasRenderTexture&&((o=this.props.parent)!=null&&o.rtt)&&(this.globalTransform=pe.identity()),s&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(F.Clipping|F.RenderState|F.Children),i|=F.Global),this.updateType&F.Clipping&&(this.calculateClippingRect(r),this.setUpdateType(F.Children),i|=F.Clipping),this.updateType&F.WorldAlpha&&(s?this.worldAlpha=s.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(F.Children|F.PremultipliedColors|F.IsRenderable),i|=F.WorldAlpha),this.updateType&F.PremultipliedColors&&(this.premultipliedColorTl=Ft(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=Ft(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=Ft(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=Ft(this.props.colorBr,this.worldAlpha,!0))),this.updateType&F.RenderState&&(this.updateRenderState(r),this.setUpdateType(F.IsRenderable)),this.updateType&F.IsRenderable&&this.updateIsRenderable(),s&&this.updateType&F.CalculatedZIndex&&(this.calculateZIndex(),s.setUpdateType(F.ZIndexSortedChildren)),this.updateType&F.Children&&this.children.length&&!this.rtt&&this.children.forEach(a=>{a.setUpdateType(i),a.updateType!==0&&a.update(e,this.clippingRect)}),this.updateType&F.ZIndexSortedChildren&&this.sortChildren(),this.updateType=0}checkRenderProps(){return this.props.texture?!0:!this.props.width||!this.props.height?!1:!!(this.props.shader!==this.stage.defShaderCtr||this.props.clipping||this.props.color!==0||this.props.colorTop!==0||this.props.colorBottom!==0||this.props.colorLeft!==0||this.props.colorRight!==0||this.props.colorTl!==0||this.props.colorTr!==0||this.props.colorBl!==0||this.props.colorBr!==0)}checkRenderBounds(e){L(this.renderBound);const r=e.width||this.stage.root.width,s=e.height||this.stage.root.height;if(this.strictBound=Mt(e.x,e.y,e.x+r,e.y+s,this.strictBound),Dn(this.renderBound,this.strictBound))return we.InViewport;const i=this.stage.boundsMargin;return this.preloadBound=Mt(this.strictBound.x1-i[3],this.strictBound.y1-i[0],this.strictBound.x2+i[1],this.strictBound.y2+i[2],this.preloadBound),Dn(this.renderBound,this.preloadBound)?we.InBounds:we.OutOfBounds}updateRenderState(e){const r=this.checkRenderBounds(e);if(r===this.renderState)return;const s=this.renderState;this.renderState=r;const i=It.get(r);L(i),this.emit(i,{previous:s,current:r})}updateIsRenderable(){let e;this.worldAlpha===0||!this.checkRenderProps()?e=!1:e=this.renderState>we.OutOfBounds,this.isRenderable!==e&&(this.isRenderable=e,this.onChangeIsRenderable(e))}onChangeIsRenderable(e){var r;(r=this.texture)==null||r.setRenderableOwner(this,e)}calculateRenderCoords(){const{width:e,height:r,globalTransform:s}=this;L(s);const{tx:i,ty:o,ta:a,tb:l,tc:h,td:d}=s;if(l===0&&h===0){const f=i,p=i+e*a,v=o,y=o+r*d;this.renderCoords=tr.translate(f,v,p,v,p,y,f,y,this.renderCoords)}else this.renderCoords=tr.translate(i,o,i+e*a,o+e*h,i+e*a+r*l,o+e*h+r*d,i+r*l,o+r*d,this.renderCoords)}updateBoundingRect(){const{renderCoords:e,globalTransform:r}=this;L(r),L(e);const{tb:s,tc:i}=r,{x1:o,y1:a,x3:l,y3:h}=e;if(s===0||i===0)this.renderBound=Mt(o,a,l,h,this.renderBound);else{const{x2:d,x4:f,y2:p,y4:v}=e;this.renderBound=Mt(Math.min(o,d,l,f),Math.min(a,p,h,v),Math.max(o,d,l,f),Math.max(a,p,h,v),this.renderBound)}}calculateClippingRect(e){L(this.globalTransform);const{clippingRect:r,props:s,globalTransform:i}=this,{clipping:o}=s,a=i.tb!==0||i.tc!==0;o&&!a?(r.x=i.tx,r.y=i.ty,r.width=this.width*i.ta,r.height=this.height*i.td,r.valid=!0):r.valid=!1,e.valid&&r.valid?us(e,r,r):e.valid&&(ds(e,r),r.valid=!0)}calculateZIndex(){var o,a;const e=this.props,r=e.zIndex||0,s=((o=e.parent)==null?void 0:o.zIndex)||0;let i=r;(a=e.parent)!=null&&a.zIndexLocked&&(i=r<s?r:s),this.calcZIndex=i}destroy(){this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,delete this.renderCoords,delete this.renderBound,delete this.strictBound,delete this.preloadBound,delete this.globalTransform,delete this.scaleRotateTransform,delete this.localTransform,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;const e=[...this.children];for(let r=0;r<e.length;r++)e[r].destroy();this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}renderQuads(e){const{texture:r,width:s,height:i,textureOptions:o,rtt:a,shader:l}=this.props;if(this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode))return;const{premultipliedColorTl:h,premultipliedColorTr:d,premultipliedColorBl:f,premultipliedColorBr:p}=this,{zIndex:v,worldAlpha:y,globalTransform:m,clippingRect:A,renderCoords:S}=this;L(m),L(S),e.addQuad({width:s,height:i,colorTl:h,colorTr:d,colorBl:f,colorBr:p,texture:r,textureOptions:o,zIndex:v,shader:l.shader,shaderProps:l.getResolvedProps(),alpha:y,clippingRect:A,tx:m.tx,ty:m.ty,ta:m.ta,tb:m.tb,tc:m.tc,td:m.td,renderCoords:S,rtt:a,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions})}get id(){return this._id}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(F.Local))}get absX(){var e,r,s;return this.props.x+(((e=this.props.parent)==null?void 0:e.absX)||((s=(r=this.props.parent)==null?void 0:r.globalTransform)==null?void 0:s.tx)||0)}get absY(){var e,r;return this.props.y+((r=(e=this.props.parent)==null?void 0:e.absY)!=null?r:0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(F.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(F.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(F.RenderTexture)))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(F.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(F.RenderTexture)))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(F.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(F.ScaleRotate))}get mount(){return this.props.mount}set mount(e){(this.props.mountX!==e||this.props.mountY!==e)&&(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(F.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(F.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(F.Local))}get pivot(){return this.props.pivot}set pivot(e){(this.props.pivotX!==e||this.props.pivotY!==e)&&(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(F.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(F.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(F.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(F.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(F.PremultipliedColors|F.WorldAlpha)}get autosize(){return this.props.autosize}set autosize(e){this.props.autosize=e}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(F.Clipping)}get color(){return this.props.color}set color(e){this.colorTop=e,this.colorBottom=e,this.colorLeft=e,this.colorRight=e,this.props.color=e,this.setUpdateType(F.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){(this.props.colorTl!==e||this.props.colorTr!==e)&&(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(F.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){(this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(F.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){(this.props.colorTl!==e||this.props.colorBl!==e)&&(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(F.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){(this.props.colorTr!==e||this.props.colorBr!==e)&&(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(F.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(F.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(F.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(F.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(F.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(F.CalculatedZIndex|F.Children),this.children.forEach(r=>{r.setUpdateType(F.CalculatedZIndex)})}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(F.CalculatedZIndex|F.Children),this.children.forEach(r=>{r.setUpdateType(F.CalculatedZIndex)})}get parent(){return this.props.parent}set parent(e){const r=this.props.parent;if(r!==e){if(this.props.parent=e,r){const s=r.children.indexOf(this);L(s!==-1,"CoreNode.parent: Node not found in old parent's children!"),r.children.splice(s,1),r.setUpdateType(F.Children|F.ZIndexSortedChildren)}e&&(e.children.push(this),this.setUpdateType(F.All),e.setUpdateType(F.Children|F.ZIndexSortedChildren),(e.rtt||e.parentHasRenderTexture)&&this.setRTTUpdates(F.All)),this.updateScaleRotateTransform()}}get rtt(){return this.props.rtt}set rtt(e){var r,s;if(this.props.rtt===!0&&(this.props.rtt=e,e===!1&&this.texture!==null)){this.unloadTexture(),this.setUpdateType(F.All),this.children.forEach(i=>{i.parentHasRenderTexture=!1}),(r=this.stage.renderer)==null||r.removeRTTNode(this);return}e!==!1&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.props.rtt=!0,this.hasRTTupdates=!0,this.setUpdateType(F.All),this.children.forEach(i=>{i.setUpdateType(F.All)}),(s=this.stage.renderer)==null||s.renderToTexture(this))}get shader(){return this.props.shader}set shader(e){this.props.shader!==e&&(this.props.shader=e,this.setUpdateType(F.IsRenderable))}get src(){return this.props.src}set src(e){if(this.props.src!==e){if(this.props.src=e,!e){this.texture=null;return}this.texture=this.stage.txManager.loadTexture("ImageTexture",{src:e})}}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){let e=this.parent;for(;e;){if(e.rtt)return e;e=e.parent}return null}get texture(){return this.props.texture}set texture(e){if(this.props.texture===e)return;const r=this.props.texture;r&&(r.setRenderableOwner(this,!1),this.unloadTexture()),this.props.texture=e,e&&(e.setRenderableOwner(this,this.isRenderable),this.loadTexture()),this.setUpdateType(F.IsRenderable)}set textureOptions(e){this.props.textureOptions=e}get textureOptions(){return this.props.textureOptions}setRTTUpdates(e){var r;this.hasRTTupdates=!0,(r=this.parent)==null||r.setRTTUpdates(e)}animate(e,r){const s=new Wi(this,e,r);return new Hi(this.stage.animationManager,s)}flush(){}}const Wt={alpha:n=>n===1?null:{prop:"opacity",value:"".concat(n)},x:n=>({prop:"left",value:"".concat(n,"px")}),y:n=>({prop:"top",value:"".concat(n,"px")}),width:n=>n===0?null:{prop:"width",value:"".concat(n,"px")},height:n=>n===0?null:{prop:"height",value:"".concat(n,"px")},zIndex:()=>"zIndex",fontFamily:()=>"font-family",fontSize:()=>"font-size",fontStyle:()=>"font-style",fontWeight:()=>"font-weight",fontStretch:()=>"font-stretch",lineHeight:()=>"line-height",letterSpacing:()=>"letter-spacing",textAlign:()=>"text-align",overflowSuffix:()=>"overflow-suffix",maxLines:()=>"max-lines",contain:()=>"contain",verticalAlign:()=>"vertical-align",clipping:n=>n===!1?null:{prop:"overflow",value:n?"hidden":"visible"},rotation:n=>n===0?null:{prop:"transform",value:"rotate(".concat(n,"rad)")},scale:n=>n===1?null:{prop:"transform",value:"scale(".concat(n,")")},scaleX:n=>n===1?null:{prop:"transform",value:"scaleX(".concat(n,")")},scaleY:n=>n===1?null:{prop:"transform",value:"scaleY(".concat(n,")")},color:n=>n===0?null:{prop:"color",value:ps(n)}},ps=n=>{const t=(n&255)/255,e=n>>8&255,r=n>>16&255,s=n>>24&255;return"rgba(".concat(s,",").concat(r,",").concat(e,",").concat(t,")")},zn={id:"id"};class Vi{constructor(t,e){c(this,"root",null);c(this,"canvas",null);c(this,"height",1080);c(this,"width",1920);c(this,"scaleX",1);c(this,"scaleY",1);var i,o,a,l,h,d;if(fn())return;if(!e)throw new Error("settings is required");this.height=Math.ceil((o=e.appHeight)!=null?o:1080/((i=e.deviceLogicalPixelRatio)!=null?i:1)),this.width=Math.ceil((l=e.appWidth)!=null?l:1900/((a=e.deviceLogicalPixelRatio)!=null?a:1)),this.scaleX=(h=e.deviceLogicalPixelRatio)!=null?h:1,this.scaleY=(d=e.deviceLogicalPixelRatio)!=null?d:1,this.canvas=t,this.root=document.createElement("div"),this.setRootPosition(),document.body.appendChild(this.root),new MutationObserver(this.setRootPosition.bind(this)).observe(t,{attributes:!0,childList:!1,subtree:!1}),new ResizeObserver(this.setRootPosition.bind(this)).observe(t),window.addEventListener("resize",this.setRootPosition.bind(this)),console.warn("Inspector is enabled, this will impact performance")}setRootPosition(){if(this.root===null||this.canvas===null)return;const t=this.canvas.getBoundingClientRect(),e=document.documentElement.scrollTop+t.top,r=document.documentElement.scrollLeft+t.left;this.root.id="root",this.root.style.left="".concat(r,"px"),this.root.style.top="".concat(e,"px"),this.root.style.width="".concat(this.width,"px"),this.root.style.height="".concat(this.height,"px"),this.root.style.position="absolute",this.root.style.transformOrigin="0 0 0",this.root.style.transform="scale(".concat(this.scaleX,", ").concat(this.scaleY,")"),this.root.style.overflow="hidden",this.root.style.zIndex="65534"}createDiv(t,e){const r=document.createElement("div");r.style.position="absolute",r.id=t.toString();for(const s in e)this.updateNodeProperty(r,s,e[s]);return r}createNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,this.createProxy(t,e)}createTextNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,this.createProxy(t,e)}createProxy(t,e){return new Proxy(t,{set:(r,s,i)=>(this.updateNodeProperty(e,s,i),Reflect.set(r,s,i)),get:(r,s,i)=>(s==="destroy"&&this.destroyNode(r.id),s==="animate"?(o,a)=>{const l=r.animate(o,a);return new Proxy(l,{get:(h,d,f)=>(d==="start"&&this.animateNode(e,o,a),Reflect.get(h,d,f))})}:Reflect.get(r,s,i))})}destroyNode(t){const e=document.getElementById(t.toString());e==null||e.remove()}updateNodeProperty(t,e,r){var s;if(!(this.root===null||r===void 0||r===null)){if(e==="parent"){const i=r.id;if(i===1){this.root.appendChild(t);return}const o=document.getElementById(i.toString());o==null||o.appendChild(t);return}if(e==="text"){t.innerHTML=String(r),t.style.visibility="hidden";return}if(e==="src"&&r){t.setAttribute("data-src",String(r));return}if(Wt[e]){const i=(s=Wt[e])==null?void 0:s.call(Wt,r);if(i===null)return;if(typeof i=="string"){t.style.setProperty(i,String(r));return}typeof i=="object"&&t.style.setProperty(i.prop,i.value);return}if(zn[e]){const i=zn[e];if(!i)return;t.setAttribute(String(i),String(r));return}if(e==="data"){for(const i in r){const o=r[i];o===void 0?t.removeAttribute("data-".concat(i)):t.setAttribute("data-".concat(i),String(o))}return}}}animateNode(t,e,r){const{duration:s=1e3,delay:i=0}=r,{x:o,y:a,width:l,height:h,alpha:d=1,rotation:f=0,scale:p=1,color:v}=e;function y(){setTimeout(()=>{t.style.top="".concat(a,"px"),t.style.left="".concat(o,"px"),t.style.width="".concat(l,"px"),t.style.height="".concat(h,"px"),t.style.opacity="".concat(d),t.style.rotate="".concat(f,"rad"),t.style.scale="".concat(p),t.style.color=ps(v)},s)}setTimeout(y,i)}}const Xi=n=>{let t=!1;const e=()=>{if(n.updateFrameTime(),n.updateAnimations(),!n.hasSceneUpdates()){n.calculateFps(),setTimeout(e,16.666666666666668),t||(n.txMemManager.checkCleanup()&&n.txMemManager.cleanup(),n.eventBus.emit("idle"),t=!0),n.flushFrameEvents();return}t=!1,n.drawFrame(),n.flushFrameEvents(),requestAnimationFrame(e)};requestAnimationFrame(e)},$i=()=>performance?performance.now():Date.now();class gs{constructor(t,e){c(this,"textureSource");c(this,"memManager");this.memManager=t,this.textureSource=e}setTextureMemUse(t){this.memManager.setTextureMemUse(this.textureSource,t)}get renderable(){return this.textureSource.renderable}}class ms{constructor(t){c(this,"options");c(this,"mode");c(this,"stage");c(this,"txManager");c(this,"txMemManager");c(this,"shManager");c(this,"rttNodes",[]);this.options=t,this.stage=t.stage,this.txManager=t.txManager,this.txMemManager=t.txMemManager,this.shManager=t.shManager}}class Gi{}class xs{static makeCacheKey(t){return!1}static resolveDefaults(t){return{}}}function Wn(n,t,e){const r=n.createShader(t);if(!r)throw new Error;if(n.shaderSource(r,e),n.compileShader(r),n.getShaderParameter(r,n.COMPILE_STATUS))return r;console.log(n.getShaderInfoLog(r)),n.deleteShader(r)}function Yi(n,t,e){const r=n.createProgram();if(!r)throw new Error;if(n.attachShader(r,t),n.attachShader(r,e),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS))return r;console.log(n.getProgramInfoLog(r)),n.deleteProgram(r)}function Ki(n){return self.WebGL2RenderingContext&&n instanceof self.WebGL2RenderingContext}class Ve extends xs{constructor(e){super();c(this,"boundBufferCollection",null);c(this,"buffersBound",!1);c(this,"program");c(this,"vao");c(this,"renderer");c(this,"glw");c(this,"attributeBuffers");c(this,"attributeLocations");c(this,"attributeNames");c(this,"uniformLocations");c(this,"uniformTypes");c(this,"supportsIndexedTextures");const r=this.renderer=e.renderer,s=this.glw=this.renderer.glw;this.supportsIndexedTextures=e.supportsIndexedTextures||!1;const i=s.isWebGl2(),o=i&&e.webgl2Extensions||!i&&e.webgl1Extensions||[],a=i?"2.0":"1.0";o.forEach(m=>{if(!s.getExtension(m))throw new Error('Shader "'.concat(this.constructor.name,'" requires extension "').concat(m,'" for WebGL ').concat(a," but wasn't found"))});const l=e.shaderSources||this.constructor.shaderSources;if(l)i&&(l!=null&&l.webGl2)&&(l.fragment=l.webGl2.fragment,l.vertex=l.webGl2.vertex,delete l.webGl2);else throw new Error('Shader "'.concat(this.constructor.name,'" is missing shaderSources.'));const h=r.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,d=l.vertex instanceof Function?l.vertex(h):l.vertex,f=l.fragment instanceof Function?l.fragment(h):l.fragment,p=Wn(s,s.VERTEX_SHADER,d),v=Wn(s,s.FRAGMENT_SHADER,f);if(!p||!v)throw new Error;const y=Yi(s,p,v);if(!y)throw new Error;if(this.program=y,i){const m=s.createVertexArray();if(!m)throw new Error;this.vao=m,s.bindVertexArray(this.vao)}this.attributeLocations={},this.attributeBuffers={},this.attributeNames=[],[...e.attributes].forEach(m=>{const A=s.getAttribLocation(this.program,m);if(A<0)throw new Error("".concat(this.constructor.name,': Vertex shader must have an attribute "').concat(m,'"!'));const S=s.createBuffer();if(!S)throw new Error("".concat(this.constructor.name,': Could not create buffer for attribute "').concat(m,'"'));this.attributeLocations[m]=A,this.attributeBuffers[m]=S,this.attributeNames.push(m)}),this.uniformLocations={},this.uniformTypes={},e.uniforms.forEach(m=>{const A=s.getUniformLocation(this.program,m.name);if(this.uniformTypes[m.name]=m.uniform,!A){console.warn('Shader "'.concat(this.constructor.name,'" could not get uniform location for "').concat(m.name,'"'));return}this.uniformLocations[m.name]=A})}bindBufferAttribute(e,r,s){const{glw:i}=this;i.enableVertexAttribArray(e),i.vertexAttribPointer(r,e,s.size,s.type,s.normalized,s.stride,s.offset)}disableAttribute(e){this.glw.disableVertexAttribArray(e)}disableAttributes(){for(const e in this.attributeLocations)this.disableAttribute(this.attributeLocations[e]);this.boundBufferCollection=null}canBatchShaderProps(e,r){return!1}bindRenderOp(e,r){this.bindBufferCollection(e.buffers),e.textures.length>0&&this.bindTextures(e.textures);const{glw:s,parentHasRenderTexture:i,renderToTexture:o}=e;if(!(o&&i)){if(i){const{width:a,height:l}=e.framebufferDimensions||{};this.setUniform("u_pixelRatio",1),this.setUniform("u_resolution",new Float32Array([a!=null?a:0,l!=null?l:0]))}else this.setUniform("u_pixelRatio",e.options.pixelRatio),this.setUniform("u_resolution",new Float32Array([s.canvas.width,s.canvas.height]));if(r){if(Gr(r,"$dimensions")){let a=r.$dimensions;a||(a=e.dimensions),this.setUniform("u_dimensions",[a.width,a.height])}if(Gr(r,"$alpha")){let a=r.$alpha;a||(a=e.alpha),this.setUniform("u_alpha",a)}this.bindProps(r)}}}setUniform(e,...r){this.glw.setUniform(this.uniformTypes[e],this.uniformLocations[e],...r)}bindBufferCollection(e){if(this.boundBufferCollection!==e){for(const r in this.attributeLocations){const s=e.getBuffer(r),i=e.getAttributeInfo(r);L(s,'Buffer for "'.concat(r,'" not found')),L(i),this.bindBufferAttribute(this.attributeLocations[r],s,i)}this.boundBufferCollection=e}}bindProps(e){}bindTextures(e){}attach(){this.glw.useProgram(this.program),this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}c(Ve,"shaderSources");class ys extends Gi{constructor(e,r,s,i,o,a,l,h,d,f,p,v,y){super();c(this,"glw");c(this,"options");c(this,"buffers");c(this,"shader");c(this,"shaderProps");c(this,"alpha");c(this,"clippingRect");c(this,"dimensions");c(this,"bufferIdx");c(this,"zIndex");c(this,"renderToTexture");c(this,"parentHasRenderTexture");c(this,"framebufferDimensions");c(this,"length",0);c(this,"numQuads",0);c(this,"textures",[]);c(this,"maxTextures");this.glw=e,this.options=r,this.buffers=s,this.shader=i,this.shaderProps=o,this.alpha=a,this.clippingRect=l,this.dimensions=h,this.bufferIdx=d,this.zIndex=f,this.renderToTexture=p,this.parentHasRenderTexture=v,this.framebufferDimensions=y,this.maxTextures=i.supportsIndexedTextures?e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(e){const{textures:r,maxTextures:s}=this,i=r.findIndex(a=>a===e);if(i!==-1)return i;const o=r.length;return o>=s?4294967295:(this.textures.push(e),o)}draw(){const{glw:e,shader:r,shaderProps:s,options:i}=this,{shManager:o}=i;o.useShader(r),r.bindRenderOp(this,s);const a=this.bufferIdx/24*6*2;if(this.clippingRect.valid){const{x:l,y:h,width:d,height:f}=this.clippingRect,p=i.pixelRatio,v=i.canvas.height,y=Math.round(l*p),m=Math.round(d*p),A=Math.round(f*p),S=Math.round(v-A-h*p);e.setScissorTest(!0),e.scissor(y,S,m,A)}else e.setScissorTest(!1);e.drawElements(e.TRIANGLES,6*this.numQuads,e.UNSIGNED_SHORT,a)}}function Qi(n){const t={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(t).forEach(r=>{t[r]=n.getParameter(n[r])}),t}function ji(n){const t={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(t).forEach(r=>{t[r]=n.getExtension(r)}),t}function qi(n,t){const e=~~(t/80),r=new Uint16Array(e*6);for(let i=0,o=0;i<e;i+=6,o+=4)r[i]=o,r[i+1]=o+1,r[i+2]=o+2,r[i+3]=o+2,r[i+4]=o+1,r[i+5]=o+3;const s=n.createBuffer();n.elementArrayBufferData(s,r,n.STATIC_DRAW)}function Zi(n){return n!==null&&typeof n=="object"&&n.constructor&&n.constructor.name==="HTMLImageElement"}const Br=new Uint8Array([0,0,0,0]);class rr extends gs{constructor(e,r,s){super(r,s);c(this,"glw");c(this,"_nativeCtxTexture",null);c(this,"_state","freed");c(this,"_w",0);c(this,"_h",0);this.glw=e}get ctxTexture(){return this._state==="freed"&&this.load(),L(this._nativeCtxTexture),this._nativeCtxTexture}get w(){return this._w}get h(){return this._h}load(){this._state==="loading"||this._state==="loaded"||(this._state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),this.onLoadRequest().then(({width:e,height:r})=>{this._state!=="freed"&&(this._state="loaded",this._w=e,this._h=r,this.textureSource.setState("loaded",{width:e,height:r}))}).catch(e=>{this._state!=="freed"&&(this._state="failed",this.textureSource.setState("failed",e),console.error(e))}))}async onLoadRequest(){var o,a;const{glw:e}=this;e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(Br.byteLength);const r=await((o=this.textureSource)==null?void 0:o.getTextureData());if(!this._nativeCtxTexture)return L(this._state==="freed"),{width:0,height:0};let s=0,i=0;if(L(this._nativeCtxTexture),e.activeTexture(0),r.data instanceof ImageBitmap||r.data instanceof ImageData||Zi(r.data)){const l=r.data;s=l.width,i=l.height,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!r.premultiplyAlpha),e.texImage2D(0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l),this.setTextureMemUse(s*i*4),(e.isWebGl2()||On(s)&&On(i))&&e.generateMipmap()}else if(r.data===null)s=0,i=0,e.bindTexture(this._nativeCtxTexture),e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,Br),this.setTextureMemUse(Br.byteLength);else if("mipmaps"in r.data&&r.data.mipmaps){const{mipmaps:l,width:h=0,height:d=0,type:f,glInternalFormat:p}=r.data,v=f==="ktx"?new DataView((a=l[0])!=null?a:new ArrayBuffer(0)):l[0];e.bindTexture(this._nativeCtxTexture),e.compressedTexImage2D(0,p,h,d,0,v),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),this.setTextureMemUse(v.byteLength)}else console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",r);return{width:s,height:i}}free(){if(this._state==="freed"||(this._state="freed",this.textureSource.setState("freed"),this._w=0,this._h=0,!this._nativeCtxTexture))return;const{glw:e}=this;e.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null}createNativeCtxTexture(){const{glw:e}=this,r=e.createTexture();if(!r)throw new Error("Could not create WebGL Texture");return e.activeTexture(0),e.bindTexture(r),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r}}class ct extends He{constructor(e){super();c(this,"txManager");c(this,"dimensions",null);c(this,"error",null);c(this,"state","freed");c(this,"renderableOwners",new Set);c(this,"renderable",!1);c(this,"lastRenderableChangeTime",0);this.txManager=e}setRenderableOwner(e,r){var i,o;const s=this.renderableOwners.size;if(r){this.renderableOwners.add(e);const a=this.renderableOwners.size;a>s&&a===1&&(this.renderable=!0,this.lastRenderableChangeTime=this.txManager.frameTime,(i=this.onChangeIsRenderable)==null||i.call(this,!0))}else{this.renderableOwners.delete(e);const a=this.renderableOwners.size;a<s&&a===0&&(this.renderable=!1,this.lastRenderableChangeTime=this.txManager.frameTime,(o=this.onChangeIsRenderable)==null||o.call(this,!1))}}get ctxTexture(){const e=this.txManager.renderer.createCtxTexture(this);return Object.defineProperty(this,"ctxTexture",{value:e}),e}setState(e,...r){if(this.state!==e){if(this.state=e,e==="loaded"){const s=r;this.dimensions=s[0]}else if(e==="failed"){const s=r;this.error=s[0]}this.emit(e,...r)}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}}const wt=class wt extends ct{constructor(e,r){super(e);c(this,"props");this.props=wt.resolveDefaults(r||{})}get color(){return this.props.color}set color(e){this.props.color=e}async getTextureData(){const e=new Uint32Array([this.color]),r=new Uint8ClampedArray(e.buffer);return{data:new ImageData(r,1,1),premultiplyAlpha:!0}}static makeCacheKey(e){const r=wt.resolveDefaults(e);return"ColorTexture,".concat(r.color)}static resolveDefaults(e){return{color:e.color||4294967295}}};c(wt,"z$__type__Props");let nr=wt;const yr=class yr extends ct{constructor(e,r){super(e);c(this,"props");c(this,"parentTexture");c(this,"onParentTxLoaded",()=>{this.setState("loaded",{width:this.props.width,height:this.props.height})});c(this,"onParentTxFailed",(e,r)=>{this.setState("failed",r)});this.props=yr.resolveDefaults(r||{}),this.parentTexture=this.props.texture,queueMicrotask(()=>{const s=this.parentTexture;s.state==="loaded"?this.onParentTxLoaded(s,s.dimensions):s.state==="failed"&&this.onParentTxFailed(s,s.error),s.on("loaded",this.onParentTxLoaded),s.on("failed",this.onParentTxFailed)})}onChangeIsRenderable(e){this.parentTexture.setRenderableOwner(this,e)}async getTextureData(){return{data:this.props}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{texture:e.texture,x:e.x||0,y:e.y||0,width:e.width||0,height:e.height||0}}};c(yr,"z$__type__Props");let lt=yr;class Ji extends rr{constructor(t,e,r){super(t,e,r)}async onLoadRequest(){var e,r;const t=await this.textureSource.getTextureData();return{width:((e=t.data)==null?void 0:e.width)||0,height:((r=t.data)==null?void 0:r.height)||0}}}class vs extends Ve{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}}c(vs,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio;\n        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);\n\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);\n        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "});class bs extends Ve{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});c(this,"supportsIndexedTextures",!0)}bindTextures(e){const{renderer:r,glw:s}=this;if(e.length>r.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error("DefaultShaderBatched: Cannot bind more than ".concat(r.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS," textures"));e.forEach((o,a)=>{s.activeTexture(a),s.bindTexture(o.ctxTexture)});const i=Array.from(Array(e.length).keys());this.setUniform("u_textures[0]",i)}}c(bs,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:e=>"\n      #define txUnits ".concat(e,"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[").concat(e,"], int idx, vec2 uv) {\n        ").concat(Array.from(Array(e).keys()).map(r=>"\n          ".concat(r!==0?"else ":"","if (idx == ").concat(r,") {\n            return texture2D(textures[").concat(r,"], uv);\n          }\n        ")).join(""),"\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    ")});class se{constructor(t){c(this,"priority",1);c(this,"name","");c(this,"ref");c(this,"target");c(this,"passParameters","");c(this,"declaredUniforms","");c(this,"uniformInfo",{});const{ref:e,target:r,props:s={}}=t;this.ref=e,this.target=r;const i={},o=[];let a="";const l=this.constructor.uniforms||{};for(const h in l){const d=l[h],f=d.type,p="".concat(e,"_").concat(h);let v="";d.size&&(v="[".concat(d.size(s),"]")),o.push(p),a+="uniform ".concat(f," ").concat(p).concat(v,";"),i[h]={name:p,uniform:l[h].method}}this.passParameters=o.join(","),this.declaredUniforms=a,this.uniformInfo=i}static getEffectKey(t){return""}static getMethodParameters(t,e){const r=[];for(const s in t){const i=t[s];let o="";i.size&&(o="[".concat(i.size(e),"]")),r.push("".concat(i.type," ").concat(s).concat(o))}return r.join(",")}static resolveDefaults(t){return{}}static makeEffectKey(t){return!1}}c(se,"uniforms",{}),c(se,"methods"),c(se,"onShaderMask"),c(se,"onColorize"),c(se,"onEffectMask");const Fr=new Map,eo=(n,t)=>{const e=JSON.stringify(n);if(Fr.has(e))return Fr.get(e);n=n!=null?n:[];const r=[],s=n.length;let i=0;for(;i<s;i++){const{name:o,type:a,props:l}=n[i],h={name:o,type:a,props:{}},d=t[a],f=d.resolveDefaults(l),p=d.uniforms,v=Object.keys(p),y=v.length;let m=0;for(;m<y;m++){const A=v[m],S=p[A],x={value:f[A],programValue:void 0,updateOnBind:S.updateOnBind||!1,hasValidator:S.validator!==void 0,hasProgramValueUpdater:S.updateProgramValue!==void 0},b=x.hasValidator&&S.validator(f[A],f)||f[A];f[A]!==b&&(x.validatedValue=b),x.hasProgramValueUpdater&&S.updateProgramValue(x),x.programValue===void 0&&(x.programValue=x.value),h.props[A]=x}r.push(h)}return Fr.set(e,r),r},ke=class ke extends Ve{constructor(e,r,s){const i=ke.createShader(r,s);super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...i.uniforms],shaderSources:{vertex:i.vertex,fragment:i.fragment}});c(this,"effects",[]);this.effects=i.effects}bindTextures(e){const{glw:r}=this;r.activeTexture(0),r.bindTexture(e[0].ctxTexture)}bindProps(e){var o;const r=e.effects,s=r.length;let i=0;for(;i<s;i++){const a=r[i],l=this.effects[i].uniformInfo,h=Object.keys(a.props),d=h.length;let f=0;for(;f<d;f++){const p=h[f];if(a.props[p].updateOnBind===!0){const y=(o=this.renderer.shManager.getRegisteredEffects()[a.type])==null?void 0:o.uniforms[p];y==null||y.updateProgramValue(a.props[p],e)}this.setUniform(l[p].name,a.props[p].programValue)}}}canBatchShaderProps(e,r){if(e.$dimensions.width!==r.$dimensions.width||e.$dimensions.height!==r.$dimensions.height||e.effects.length!==r.effects.length)return!1;const s=e.effects.length;let i=0;for(;i<s;i++){const o=e.effects[i],a=r.effects[i];if(o.type!==a.type)return!1;for(const l in o.props)if(a.props&&!a.props[l]||o.props[l].value!==a.props[l].value)return!1}return!0}static createShader(e,r){const s={},i={};let o="";const a=[],l=[],h=e.effects.map(y=>{const m=r[y.type],A=m.getEffectKey(y.props||{});s[A]=s[A]?++s[A]:1;const S=s[A];S===1&&l.push({key:A,type:y.type,props:y.props});const x=new m({ref:"".concat(A).concat(S===1?"":S),target:A,props:y.props});return o+=x.declaredUniforms,a.push(...Object.values(x.uniformInfo)),x});let d="";l==null||l.forEach(y=>{var C;const m=r[y.type],A=m.resolveDefaults((C=y.props)!=null?C:{}),S=[];for(const I in m.methods){let R=I;const B=m.methods[I];i[I]&&i[I]!==B&&(R=ke.resolveMethodDuplicate(I,B,i)),i[R]=B.replace("function",R),S.push({m:I,cm:R})}let x=m.onShaderMask instanceof Function?m.onShaderMask(A):m.onShaderMask,b=m.onColorize instanceof Function?m.onColorize(A):m.onColorize,g=m.onEffectMask instanceof Function?m.onEffectMask(A):m.onEffectMask;S.forEach(I=>{const{m:R,cm:B}=I,w=new RegExp("\\$".concat(R),"g");x&&(x=x.replace(w,B)),b&&(b=b.replace(w,B)),g&&(g=g.replace(w,B))});const T=m.getMethodParameters(m.uniforms,A),_=T.length>0?", ".concat(T):"";x&&(d+="\n        float fx_".concat(y.key,"_onShaderMask(float shaderMask ").concat(_,") {\n          ").concat(x,"\n        }\n        ")),b&&(d+="\n          vec4 fx_".concat(y.key,"_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(_,") {\n            ").concat(b,"\n          }\n        ")),g&&(d+="\n          vec4 fx_".concat(y.key,"_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(_,") {\n            ").concat(g,"\n          }\n        "))});let f="";for(const y in i)f+=i[y];let p="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",v="\n\n    ";for(let y=0;y<h.length;y++){const m=h[y],A=m.passParameters.length>0?", ".concat(m.passParameters):"",S=r[m.name];S.onShaderMask&&(v+="\n        shaderMask = fx_".concat(m.target,"_onShaderMask(shaderMask ").concat(A,");\n        ")),S.onColorize&&(v+="\n        maskColor = fx_".concat(m.target,"_onColorize(shaderMask, maskColor, shaderColor").concat(A,");\n        ")),S.onEffectMask&&(p="fx_".concat(m.target,"_onEffectMask(shaderMask, maskColor, shaderColor").concat(A,")"));const x=h[y+1];(x===void 0||r[x.name].onEffectMask)&&(v+="\n          shaderColor = ".concat(p,";\n        "))}return{effects:h,uniforms:a,fragment:ke.fragment(o,f,d,v),vertex:ke.vertex()}}static resolveMethodDuplicate(e,r,s,i=0){const o=e+(i>0?i:"");return s[o]&&s[o]!==r?this.resolveMethodDuplicate(e,r,s,++i):o}static resolveDefaults(e,r){var s;return L(r),{effects:eo((s=e.effects)!=null?s:[],r),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,r){var i;let s="";return(i=e.effects)==null||i.forEach(o=>{const l=r[o.type].getEffectKey(o.props||{});s+=",".concat(l)}),"DynamicShader".concat(s)}};c(ke,"z$__type__Props"),c(ke,"vertex",()=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  "),c(ke,"fragment",(e,r,s,i)=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ".concat(e,"\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n\n    ").concat(r,"\n\n    ").concat(s,"\n\n    void main() {\n      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ").concat(i,"\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  "));let at=ke;class Kr extends Ve{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(t){return{radius:t.radius||10,$dimensions:{width:0,height:0}}}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=Math.min(t.$dimensions.width,t.$dimensions.height)/(2*t.radius);this.setUniform("u_radius",t.radius*Math.min(e,1))}canBatchShaderProps(t,e){return t.radius===e.radius&&t.$dimensions.width===e.$dimensions.width&&t.$dimensions.height===e.$dimensions.height}}c(Kr,"z$__type__Props"),c(Kr,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "});const to=new Float32Array([1,0,0,0,1,0,0,0,1]),vr=class vr extends Ve{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=vr.resolveDefaults(t);for(const r in e)if(r==="transform")this.setUniform("u_transform",!1,e[r]);else if(r==="scrollY")this.setUniform("u_scrollY",e[r]);else if(r==="color"){const s=Et(e.color);this.setUniform("u_color",s)}else r==="size"?this.setUniform("u_size",e[r]):r==="distanceRange"?this.setUniform("u_distanceRange",e[r]):r==="debug"&&this.setUniform("u_debug",e[r]?1:0)}static resolveDefaults(t={}){var e,r,s,i,o,a;return{transform:(e=t.transform)!=null?e:to,scrollY:(r=t.scrollY)!=null?r:0,color:(s=t.color)!=null?s:4294967295,size:(i=t.size)!=null?i:16,distanceRange:(o=t.distanceRange)!=null?o:1,debug:(a=t.debug)!=null?a:!1}}};c(vr,"shaderSources",{vertex:"\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n\n        // Calculate screen space with pixel ratio\n        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);\n\n        gl_Position = vec4(screenSpace, 0.0, 1.0);\n        v_texcoord = a_textureCoordinate;\n\n      }\n    ",fragment:"\n      precision highp float;\n\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "});let Qr=vr;const ht=n=>{n.programValue===void 0&&(n.programValue=new Float32Array(4));const t=n.value,e=n.programValue;e[0]=(t>>>24)/255,e[1]=(t>>>16&255)/255,e[2]=(t>>>8&255)/255,e[3]=(t&255)/255},ro=n=>{const t=n.validatedValue||n.value;if(n.programValue instanceof Float32Array){const e=n.programValue;e[0]=t[0],e[1]=t[1]}else n.programValue=new Float32Array(t)},no=n=>{const t=n.validatedValue||n.value;if(n.programValue instanceof Float32Array){const e=n.programValue;e[0]=t[0],e[1]=t[1],e[2]=t[1],e[3]=t[1]}else n.programValue=new Float32Array(t)},As=n=>{const t=n.validatedValue||n.value;if(n.programValue instanceof Float32Array){const e=t.length,r=n.programValue;for(let s=0;s<e;s++)r[s]=t[s]}else n.programValue=new Float32Array(t)},pn=n=>{const t=Array.isArray(n);if(t){if(t&&n.length===4)return n;if(t&&n.length===2)return[n[0],n[1],n[0],n[1]];if(t&&n.length===3)return[n[0],n[1],n[2],n[0]]}else return[n,n,n,n];return[n[0],n[0],n[0],n[0]]},Ts=(n,t)=>{n.programValue===void 0&&(n.programValue=new Float32Array(4));const e=n.programValue,r=n.validatedValue||n.value;if(t===void 0&&n.$dimensions===void 0){e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3];return}let s=n.$dimensions;if(t!==void 0){const{$dimensions:p}=t;if(s!==void 0&&(s.width===p.width||s.height===p.height))return;s===void 0&&(s={width:p==null?void 0:p.width,height:p==null?void 0:p.height},n.$dimensions=s)}const{width:i,height:o}=s,[a,l,h,d]=r,f=Math.min(Math.min(Math.min(i/Math.max(i,a+l),i/Math.max(i,h+d)),Math.min(o/Math.max(o,a+h),o/Math.max(o,l+d))),1);e[0]=a*f,e[1]=l*f,e[2]=h*f,e[3]=d*f};class et extends se{constructor(){super(...arguments);c(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){var r;return{radius:(r=e.radius)!=null?r:10}}}c(et,"z$__type__Props"),c(et,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:pn,updateProgramValue:Ts}}),c(et,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),c(et,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);\n  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);\n  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  "),c(et,"onEffectMask","\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  ");class gt extends se{constructor(){super(...arguments);c(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){var r,s;return{width:(r=e.width)!=null?r:10,color:(s=e.color)!=null?s:4294967295}}}c(gt,"z$__type__Props"),c(gt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ht,method:"uniform4fv",type:"vec4"}}),c(gt,"onEffectMask","\n  float intR = shaderMask + 1.0;\n  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);\n  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);\n  "),c(gt,"onColorize","\n    return color;\n  ");const Oe=class Oe extends se{constructor(){super(...arguments);c(this,"name","linearGradient")}static getEffectKey(e){return"linearGradient".concat(e.colors.length)}static resolveDefaults(e){var i,o;const r=(i=e.colors)!=null?i:[4278190080,4294967295];let s=e.stops||[];if(s.length===0||s.length!==r.length){const a=r.length;let l=0;const h=s;for(;l<a;l++)s[l]?(h[l]=s[l],s[l-1]===void 0&&h[l-2]!==void 0&&(h[l-1]=h[l-2]+(s[l]-h[l-2])/2)):h[l]=l*(1/(r.length-1));s=h}return{colors:r,stops:s,angle:(o=e.angle)!=null?o:0}}};c(Oe,"z$__type__Props"),c(Oe,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.reduce((r,s)=>r.concat(Et(s)),[]),updateProgramValue:As,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),c(Oe,"methods",{fromLinear:"\n      vec4 function(vec4 linearRGB) {\n        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);\n        vec4 lower = linearRGB * vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",toLinear:"\n      vec4 function(vec4 sRGB) {\n        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));\n        vec4 lower = sRGB/vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "}),c(Oe,"ColorLoop",e=>{let r="";for(let s=2;s<e;s++)r+="colorOut = mix(colorOut, colors[".concat(s,"], clamp((dist - stops[").concat(s-1,"]) / (stops[").concat(s,"] - stops[").concat(s-1,"]), 0.0, 1.0));");return r}),c(Oe,"onColorize",e=>{const r=e.colors.length||1;return"\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));\n      ".concat(Oe.ColorLoop(r),"\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});let jr=Oe;class qr extends se{constructor(){super(...arguments);c(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(e){var r;return{amount:(r=e.amount)!=null?r:1}}}c(qr,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),c(qr,"onColorize","\n    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;\n    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);\n  ");class tt extends se{constructor(){super(...arguments);c(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){var r,s;return{width:(r=e.width)!=null?r:10,color:(s=e.color)!=null?s:4294967295}}}c(tt,"z$__type__Props"),c(tt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ht,method:"uniform4fv",type:"vec4"}}),c(tt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),c(tt,"onEffectMask","\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),c(tt,"onColorize","\n    return color;\n  ");class rt extends se{constructor(){super(...arguments);c(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){var r,s;return{width:(r=e.width)!=null?r:10,color:(s=e.color)!=null?s:4294967295}}}c(rt,"z$__type__Props"),c(rt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ht,method:"uniform4fv",type:"vec4"}}),c(rt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),c(rt,"onEffectMask","\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),c(rt,"onColorize","\n    return color;\n  ");class nt extends se{constructor(){super(...arguments);c(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){var r,s;return{width:(r=e.width)!=null?r:10,color:(s=e.color)!=null?s:4294967295}}}c(nt,"z$__type__Props"),c(nt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ht,method:"uniform4fv",type:"vec4"}}),c(nt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),c(nt,"onEffectMask","\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),c(nt,"onColorize","\n    return color;\n  ");class st extends se{constructor(){super(...arguments);c(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){var r,s;return{width:(r=e.width)!=null?r:10,color:(s=e.color)!=null?s:4294967295}}}c(st,"z$__type__Props"),c(st,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ht,method:"uniform4fv",type:"vec4"}}),c(st,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),c(st,"onEffectMask","\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),c(st,"onColorize","\n    return color;\n  ");class mt extends se{constructor(){super(...arguments);c(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){var r,s,i,o,a;return{amplitude:(r=e.amplitude)!=null?r:.2,narrowness:(s=e.narrowness)!=null?s:4,blockiness:(i=e.blockiness)!=null?i:2,minimizer:(o=e.minimizer)!=null?o:8,time:(a=e.time)!=null?a:Date.now()}}}c(mt,"z$__type__Props"),c(mt,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:e=>{const r=e.value=(Date.now()-e.value)%1e3;e.programValue=r},type:"float"}}),c(mt,"methods",{rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "}),c(mt,"onColorize","\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ");class Zt extends se{constructor(){super(...arguments);c(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){var r;return{fade:(r=e.fade)!=null?r:10}}}c(Zt,"z$__type__Props"),c(Zt,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:pn,updateProgramValue:no}}),c(Zt,"onColorize","\n  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ");const Qe=class Qe extends se{constructor(){super(...arguments);c(this,"name","radialGradient")}static getEffectKey(e){return"radialGradient".concat(e.colors.length)}static resolveDefaults(e){var i,o,a,l,h;const r=(i=e.colors)!=null?i:[4278190080,4294967295];let s=e.stops||[];if(s.length===0||s.length!==r.length){const d=r.length;let f=0;const p=s;for(;f<d;f++)s[f]?(p[f]=s[f],s[f-1]===void 0&&p[f-2]!==void 0&&(p[f-1]=p[f-2]+(s[f]-p[f-2])/2)):p[f]=f*(1/(r.length-1));s=p}return{colors:r,stops:s,width:(o=e.width)!=null?o:0,height:(l=(a=e.height)!=null?a:e.width)!=null?l:0,pivot:(h=e.pivot)!=null?h:[.5,.5]}}};c(Qe,"z$__type__Props"),c(Qe,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:ro,method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.reduce((r,s)=>r.concat(Et(s)),[]),updateProgramValue:As,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),c(Qe,"ColorLoop",e=>{let r="";for(let s=2;s<e;s++)r+="colorOut = mix(colorOut, colors[".concat(s,"], clamp((dist - stops[").concat(s-1,"]) / (stops[").concat(s,"] - stops[").concat(s-1,"]), 0.0, 1.0));");return r}),c(Qe,"onColorize",e=>{const r=e.colors.length||1;return"\n      vec2 point = v_textureCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = mix(colors[0], colors[1], stopCalc);\n      ".concat(Qe.ColorLoop(r),"\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});let Zr=Qe;class it extends se{constructor(){super(...arguments);c(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){var r,s,i,o,a,l,h;return{width:(r=e.width)!=null?r:10,progress:(s=e.progress)!=null?s:.5,offset:(i=e.offset)!=null?i:0,range:(o=e.range)!=null?o:Math.PI*2,rounded:(a=e.rounded)!=null?a:!1,radius:(l=e.radius)!=null?l:1,color:(h=e.color)!=null?h:4294967295}}}c(it,"z$__type__Props"),c(it,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ht,method:"uniform4fv",type:"vec4"}}),c(it,"methods",{rotateUV:"\n    vec2 function(vec2 uv, float d) {\n      float s = sin(d);\n      float c = cos(d);\n      mat2 rotMatrix = mat2(c, -s, s, c);\n      return uv * rotMatrix;\n    }\n    ",drawDot:"\n    float function(vec2 uv, vec2 p, float r) {\n      uv += p;\n      float circle = length(uv) - r;\n      return clamp(-circle, 0.0, 1.0);\n    }\n    "}),c(it,"onEffectMask","\n    float outerRadius = radius * u_dimensions.y * 0.5;\n\n    float endAngle = range * progress - 0.0005;\n\n    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;\n\n    uv = $rotateUV(uv, -(offset));\n    float linewidth = width * u_pixelRatio;\n    float circle = length(uv) - (outerRadius - linewidth) ;\n    circle = abs(circle) - linewidth;\n    circle = clamp(-circle, 0.0, 1.0);\n\n    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);\n    float p = endAngle / (PI * 2.);\n\n    circle *= step(fract(angle), fract(p));\n\n    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));\n    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));\n\n    return mix(shaderColor, maskColor, circle);\n  "),c(it,"onColorize","\n    return color;\n  ");class ot extends se{constructor(){super(...arguments);c(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(e){var r;return{x:e.x||0,y:e.y||0,width:e.width||50,height:e.height||50,radius:(r=e.radius)!=null?r:0}}}c(ot,"z$__type__Props"),c(ot,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:pn,updateProgramValue:Ts}}),c(ot,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),c(ot,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  vec2 size = vec2(width, height) * 0.5;\n  vec2 basePos = v_textureCoordinate.xy * u_dimensions.xy - vec2(x, y);\n  vec2 pos = basePos - size;\n  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);\n  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);\n  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);\n  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);\n  return $boxDist(pos, size, r);\n  "),c(ot,"onEffectMask","\n  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));\n  ");const ws="RoundedRectangle";class gn extends xs{constructor(e){super();c(this,"shType");this.shType=e,e!==ws&&console.warn("Unsupported shader:",e)}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class so{constructor(t,e,r,s){c(this,"type");c(this,"shader");c(this,"resolvedProps");c(this,"props");this.type=t,this.shader=e,this.resolvedProps=r;const i=Object.keys(r),o=i.length,a={};for(let l=0;l<o;l++){const h=i[l];Object.defineProperty(a,h,{get:()=>this.resolvedProps[h],set:d=>{this.resolvedProps[h]=d,s.requestRender()}})}this.props=a}getResolvedProps(){return this.resolvedProps}}class io{constructor(t,e,r){c(this,"shader");c(this,"resolvedProps");c(this,"props");c(this,"type");this.shader=t,this.type="DynamicShader",this.resolvedProps=e;const s=r.getRegisteredEffects(),i={},o=e.effects,a=o.length;for(let l=0;l<a;l++){const{name:h,props:d,type:f}=o[l];if(h===void 0)continue;const p={},v=Object.keys(d),y=v.length;for(let m=0;m<y;m++){const A=v[m];Object.defineProperty(p,A,{get:()=>this.resolvedProps.effects[l].props[A].value,set:S=>{var b,g;const x=this.resolvedProps.effects[l].props[A];x.value=S,x.hasValidator&&(S=x.validatedValue=(b=s[f].uniforms[A])==null?void 0:b.validator(S,d)),x.hasProgramValueUpdater?(g=s[f].uniforms[A])==null||g.updateProgramValue(x):x.programValue=S,r.renderer.stage.requestRender()}})}Object.defineProperty(i,h,{get:()=>p})}this.props=i}getResolvedProps(){return this.resolvedProps}}class oo{constructor(){c(this,"shCache",new Map);c(this,"shConstructors",{});c(this,"attachedShader",null);c(this,"effectConstructors",{});c(this,"renderer");this.registerShaderType("DefaultShader",vs),this.registerShaderType("DefaultShaderBatched",bs),this.registerShaderType("RoundedRectangle",Kr),this.registerShaderType("DynamicShader",at),this.registerShaderType("SdfShader",Qr),this.registerEffectType("border",gt),this.registerEffectType("borderBottom",nt),this.registerEffectType("borderLeft",st),this.registerEffectType("borderRight",tt),this.registerEffectType("borderTop",rt),this.registerEffectType("fadeOut",Zt),this.registerEffectType("linearGradient",jr),this.registerEffectType("radialGradient",Zr),this.registerEffectType("grayscale",qr),this.registerEffectType("glitch",mt),this.registerEffectType("radius",et),this.registerEffectType("radialProgress",it),this.registerEffectType("holePunch",ot)}registerShaderType(t,e){this.shConstructors[t]=e}registerEffectType(t,e){this.effectConstructors[t]=e}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(t,e){if(!this.renderer)throw new Error("Renderer is not been defined");const r=this.shConstructors[t];if(!r)throw new Error('Shader type "'.concat(t,'" is not registered'));if(this.renderer.mode==="canvas"&&r.prototype instanceof Ve)return this._createShaderCtr(t,new gn(t),e);if(t==="DynamicShader")return this.loadDynamicShader(e);const s=r.resolveDefaults(e),i=r.makeCacheKey(s)||r.name;if(i&&this.shCache.has(i))return this._createShaderCtr(t,this.shCache.get(i),s);const o=new r(this.renderer,e);return i&&this.shCache.set(i,o),this._createShaderCtr(t,o,s)}loadDynamicShader(t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=at.resolveDefaults(t,this.effectConstructors),r=at.makeCacheKey(e,this.effectConstructors);if(r&&this.shCache.has(r))return this._createDynShaderCtr(this.shCache.get(r),e);const s=new at(this.renderer,t,this.effectConstructors);return r&&this.shCache.set(r,s),this._createDynShaderCtr(s,e)}_createShaderCtr(t,e,r){return new so(t,e,r,this.renderer.stage)}_createDynShaderCtr(t,e){return new io(t,e,this)}useShader(t){this.attachedShader!==t&&(this.attachedShader&&this.attachedShader.detach(),t.attach(),this.attachedShader=t)}}class Ss{constructor(t){c(this,"config");this.config=t}getBuffer(t){var e;return(e=this.config.find(r=>r.attributes[t]))==null?void 0:e.buffer}getAttributeInfo(t){var e;return(e=this.config.find(r=>r.attributes[t]))==null?void 0:e.attributes[t]}}class ao{constructor(t){c(this,"gl");c(this,"activeTextureUnit",0);c(this,"texture2dUnits");c(this,"texture2dParams",new WeakMap);c(this,"scissorEnabled");c(this,"scissorX");c(this,"scissorY");c(this,"scissorWidth");c(this,"scissorHeight");c(this,"blendEnabled");c(this,"blendSrcRgb");c(this,"blendDstRgb");c(this,"blendSrcAlpha");c(this,"blendDstAlpha");c(this,"boundArrayBuffer");c(this,"boundElementArrayBuffer");c(this,"curProgram");c(this,"programUniforms",new WeakMap);c(this,"canvas");c(this,"MAX_RENDERBUFFER_SIZE");c(this,"MAX_TEXTURE_SIZE");c(this,"MAX_VIEWPORT_DIMS");c(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS");c(this,"MAX_TEXTURE_IMAGE_UNITS");c(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS");c(this,"MAX_VERTEX_ATTRIBS");c(this,"MAX_VARYING_VECTORS");c(this,"MAX_VERTEX_UNIFORM_VECTORS");c(this,"MAX_FRAGMENT_UNIFORM_VECTORS");c(this,"TEXTURE_MAG_FILTER");c(this,"TEXTURE_MIN_FILTER");c(this,"TEXTURE_WRAP_S");c(this,"TEXTURE_WRAP_T");c(this,"LINEAR");c(this,"CLAMP_TO_EDGE");c(this,"RGBA");c(this,"UNSIGNED_BYTE");c(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL");c(this,"UNPACK_FLIP_Y_WEBGL");c(this,"FLOAT");c(this,"TRIANGLES");c(this,"UNSIGNED_SHORT");c(this,"ONE");c(this,"ONE_MINUS_SRC_ALPHA");c(this,"VERTEX_SHADER");c(this,"FRAGMENT_SHADER");c(this,"STATIC_DRAW");c(this,"COMPILE_STATUS");c(this,"LINK_STATUS");c(this,"DYNAMIC_DRAW");c(this,"COLOR_ATTACHMENT0");this.gl=t,this.activeTextureUnit=t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0;const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(e).fill(void 0).map((s,i)=>(this.activeTexture(i),t.getParameter(t.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=t.isEnabled(t.SCISSOR_TEST);const r=t.getParameter(t.SCISSOR_BOX);this.scissorX=r[0],this.scissorY=r[1],this.scissorWidth=r[2],this.scissorHeight=r[3],this.blendEnabled=t.isEnabled(t.BLEND),this.blendSrcRgb=t.getParameter(t.BLEND_SRC_RGB),this.blendDstRgb=t.getParameter(t.BLEND_DST_RGB),this.blendSrcAlpha=t.getParameter(t.BLEND_SRC_ALPHA),this.blendDstAlpha=t.getParameter(t.BLEND_DST_ALPHA),this.boundArrayBuffer=t.getParameter(t.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=t.getParameter(t.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=t.getParameter(t.CURRENT_PROGRAM),this.canvas=t.canvas,this.MAX_RENDERBUFFER_SIZE=t.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=t.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=t.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=t.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=t.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=t.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=t.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=t.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=t.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=t.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=t.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=t.TEXTURE_WRAP_T,this.LINEAR=t.LINEAR,this.CLAMP_TO_EDGE=t.CLAMP_TO_EDGE,this.RGBA=t.RGBA,this.UNSIGNED_BYTE=t.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=t.UNPACK_FLIP_Y_WEBGL,this.FLOAT=t.FLOAT,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.ONE=t.ONE,this.ONE_MINUS_SRC_ALPHA=t.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.VERTEX_SHADER=t.VERTEX_SHADER,this.FRAGMENT_SHADER=t.FRAGMENT_SHADER,this.STATIC_DRAW=t.STATIC_DRAW,this.COMPILE_STATUS=t.COMPILE_STATUS,this.LINK_STATUS=t.LINK_STATUS,this.DYNAMIC_DRAW=t.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=t.COLOR_ATTACHMENT0}isWebGl2(){return Ki(this.gl)}activeTexture(t){const{gl:e}=this;this.activeTextureUnit!==t&&(e.activeTexture(t+e.TEXTURE0),this.activeTextureUnit=t)}bindTexture(t){const{gl:e,activeTextureUnit:r,texture2dUnits:s}=this;s[r]!==t&&(s[r]=t,e.bindTexture(this.gl.TEXTURE_2D,t))}_getActiveTexture(){const{activeTextureUnit:t,texture2dUnits:e}=this;return e[t]}texParameteri(t,e){const{gl:r,texture2dParams:s}=this,i=this._getActiveTexture();if(!i)throw new Error("No active texture");let o=s.get(i);o||(o={},s.set(i,o)),o[t]!==e&&(o[t]=e,r.texParameteri(r.TEXTURE_2D,t,e))}texImage2D(t,e,r,s,i,o,a,l){const{gl:h}=this;o?h.texImage2D(h.TEXTURE_2D,t,e,r,s,i,o,a,l):h.texImage2D(h.TEXTURE_2D,t,e,r,s,i)}compressedTexImage2D(t,e,r,s,i,o){const{gl:a}=this;a.compressedTexImage2D(a.TEXTURE_2D,t,e,r,s,i,o)}pixelStorei(t,e){const{gl:r}=this;r.pixelStorei(t,e)}generateMipmap(){const{gl:t}=this;t.generateMipmap(t.TEXTURE_2D)}createTexture(){const{gl:t}=this;return t.createTexture()}deleteTexture(t){const{gl:e}=this;t&&this.texture2dParams.delete(t),e.deleteTexture(t)}viewport(t,e,r,s){const{gl:i}=this;i.viewport(t,e,r,s)}clearColor(t,e,r,s){const{gl:i}=this;i.clearColor(t,e,r,s)}setScissorTest(t){const{gl:e,scissorEnabled:r}=this;t!==r&&(t?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),this.scissorEnabled=t)}scissor(t,e,r,s){const{gl:i,scissorX:o,scissorY:a,scissorWidth:l,scissorHeight:h}=this;(t!==o||e!==a||r!==l||s!==h)&&(i.scissor(t,e,r,s),this.scissorX=t,this.scissorY=e,this.scissorWidth=r,this.scissorHeight=s)}setBlend(t){const{gl:e,blendEnabled:r}=this;t!==r&&(t?e.enable(e.BLEND):e.disable(e.BLEND),this.blendEnabled=t)}blendFunc(t,e){const{gl:r,blendSrcRgb:s,blendDstRgb:i,blendSrcAlpha:o,blendDstAlpha:a}=this;(t!==s||e!==i||t!==o||e!==a)&&(r.blendFunc(t,e),this.blendSrcRgb=t,this.blendDstRgb=e,this.blendSrcAlpha=t,this.blendDstAlpha=e)}createBuffer(){const{gl:t}=this;return t.createBuffer()}createFramebuffer(){const{gl:t}=this;return t.createFramebuffer()}bindFramebuffer(t){const{gl:e}=this;e.bindFramebuffer(e.FRAMEBUFFER,t)}framebufferTexture2D(t,e,r){const{gl:s}=this;s.framebufferTexture2D(s.FRAMEBUFFER,t,s.TEXTURE_2D,e,r)}clear(){const{gl:t}=this;t.clear(t.COLOR_BUFFER_BIT)}arrayBufferData(t,e,r){const{gl:s,boundArrayBuffer:i}=this;i!==t&&(s.bindBuffer(s.ARRAY_BUFFER,t),this.boundArrayBuffer=t),s.bufferData(s.ARRAY_BUFFER,e,r)}elementArrayBufferData(t,e,r){const{gl:s,boundElementArrayBuffer:i}=this;i!==t&&(s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t),this.boundElementArrayBuffer=t),s.bufferData(s.ELEMENT_ARRAY_BUFFER,e,r)}vertexAttribPointer(t,e,r,s,i,o,a){const{gl:l,boundArrayBuffer:h}=this;h!==t&&(l.bindBuffer(l.ARRAY_BUFFER,t),this.boundArrayBuffer=t),l.vertexAttribPointer(e,r,s,i,o,a)}useProgram(t){const{gl:e,curProgram:r}=this;r!==t&&(e.useProgram(t),this.curProgram=t)}setUniform(t,e,...r){const{gl:s,programUniforms:i}=this;let o=i.get(this.curProgram);o||(o=new Map,i.set(this.curProgram,o));const a=o.get(e);(!a||!lo(a,r))&&(o.set(e,r),s[t](e,...r))}getParameter(t){const{gl:e}=this;return e.getParameter(t)}drawElements(t,e,r,s){const{gl:i}=this;i.drawElements(t,e,r,s)}getExtension(t){const{gl:e}=this;return e.getExtension(t)}createVertexArray(){const{gl:t}=this;return L(t instanceof WebGL2RenderingContext),t.createVertexArray()}bindVertexArray(t){const{gl:e}=this;L(e instanceof WebGL2RenderingContext),e.bindVertexArray(t)}getAttribLocation(t,e){const{gl:r}=this;return r.getAttribLocation(t,e)}getUniformLocation(t,e){const{gl:r}=this;return r.getUniformLocation(t,e)}enableVertexAttribArray(t){const{gl:e}=this;e.enableVertexAttribArray(t)}disableVertexAttribArray(t){const{gl:e}=this;e.disableVertexAttribArray(t)}createShader(t){const{gl:e}=this;return e.createShader(t)}compileShader(t){const{gl:e}=this;e.compileShader(t)}attachShader(t,e){const{gl:r}=this;r.attachShader(t,e)}linkProgram(t){const{gl:e}=this;e.linkProgram(t)}deleteProgram(t){const{gl:e}=this;e.deleteProgram(t)}getShaderParameter(t,e){const{gl:r}=this;return r.getShaderParameter(t,e)}getShaderInfoLog(t){const{gl:e}=this;return e.getShaderInfoLog(t)}createProgram(){const{gl:t}=this;return t.createProgram()}getProgramParameter(t,e){const{gl:r}=this;return r.getProgramParameter(t,e)}getProgramInfoLog(t){const{gl:e}=this;return e.getProgramInfoLog(t)}shaderSource(t,e){const{gl:r}=this;r.shaderSource(t,e)}deleteShader(t){const{gl:e}=this;e.deleteShader(t)}}function lo(n,t){return n.length!==t.length?!1:n.every((e,r)=>Array.isArray(e)||e instanceof Float32Array?!1:e===t[r])}const br=class br extends ct{constructor(e,r){super(e);c(this,"props");this.props=br.resolveDefaults(r||{})}get width(){return this.props.width}set width(e){this.props.width=e}get height(){return this.props.height}set height(e){this.props.height=e}async getTextureData(){return{data:null,premultiplyAlpha:null}}static resolveDefaults(e){return{width:e.width||256,height:e.height||256}}};c(br,"z$__type__Props");let Rt=br;class Hn extends rr{constructor(e,r,s){super(e,r,s);c(this,"framebuffer");const i=e.createFramebuffer();L(i,"Unable to create framebuffer"),this.framebuffer=i}async onLoadRequest(){const{glw:e}=this,r=this._nativeCtxTexture=this.createNativeCtxTexture(),{width:s,height:i}=this.textureSource;return e.texImage2D(0,e.RGBA,s,i,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(s*i*4),e.bindFramebuffer(this.framebuffer),e.framebufferTexture2D(e.COLOR_ATTACHMENT0,r,0),e.bindFramebuffer(null),{width:s,height:i}}}function co(n){return/\.(ktx|pvr)$/.test(n)}const ho=async n=>{const e=await(await fetch(n)).arrayBuffer();return n.indexOf(".ktx")!==-1?uo(e):fo(e)},uo=async n=>{const t=new DataView(n),e=t.getUint32(12)===16909060,r=[],s={glInternalFormat:t.getUint32(28,e),pixelWidth:t.getUint32(36,e),pixelHeight:t.getUint32(40,e),numberOfMipmapLevels:t.getUint32(56,e),bytesOfKeyValueData:t.getUint32(60,e)};let i=64;i+=s.bytesOfKeyValueData;for(let o=0;o<s.numberOfMipmapLevels;o++){const a=t.getUint32(i);i+=4,r.push(t.buffer.slice(i,a)),i+=a}return{data:{glInternalFormat:s.glInternalFormat,mipmaps:r,width:s.pixelWidth||0,height:s.pixelHeight||0,type:"ktx"},premultiplyAlpha:!1}},fo=async n=>{const a=n,l=new Int32Array(a,0,13),h=l[12]+52,d=new Uint8Array(a,h),f=[],p={pixelWidth:l[7],pixelHeight:l[6],numberOfMipmapLevels:l[11]||0};let v=0,y=p.pixelWidth||0,m=p.pixelHeight||0;for(let A=0;A<p.numberOfMipmapLevels;A++){const S=(y+3>>2)*(m+3>>2)*8,x=new Uint8Array(a,d.byteOffset+v,S);f.push(x),v+=S,y=y>>1,m=m>>1}return{data:{glInternalFormat:36196,mipmaps:f,width:p.pixelWidth||0,height:p.pixelHeight||0,type:"pvr"},premultiplyAlpha:!1}},St=class St extends ct{constructor(e,r){super(e);c(this,"props");this.props=St.resolveDefaults(r)}hasAlphaChannel(e){return e.indexOf("image/png")!==-1}async getTextureData(){const{src:e,premultiplyAlpha:r}=this.props;if(!e)return{data:null};if(typeof e!="string")return e instanceof ImageData?{data:e,premultiplyAlpha:r}:{data:e(),premultiplyAlpha:r};if(co(e))return ho(e);const s=Ni(e);if(this.txManager.imageWorkerManager)return await this.txManager.imageWorkerManager.getImage(s,r);if(this.txManager.hasCreateImageBitmap){const o=await(await fetch(s)).blob(),a=r!=null?r:this.hasAlphaChannel(o.type);return{data:await createImageBitmap(o,{premultiplyAlpha:a?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:a}}else{const i=new Image;return e.substr(0,5)!=="data:"&&(i.crossOrigin="Anonymous"),i.src=s,await new Promise((o,a)=>{i.onload=()=>o(),i.onerror=()=>a(new Error("Failed to load image"))}).catch(o=>{console.error(o)}),{data:i,premultiplyAlpha:r!=null?r:!0}}}static makeCacheKey(e){var i;const r=St.resolveDefaults(e),s=r.key||r.src;return typeof s!="string"?!1:"ImageTexture,".concat(s,",").concat((i=r.premultiplyAlpha)!=null?i:"true")}static resolveDefaults(e){var r,s,i;return{src:(r=e.src)!=null?r:"",premultiplyAlpha:(s=e.premultiplyAlpha)!=null?s:!0,key:(i=e.key)!=null?i:null}}};c(St,"z$__type__Props");let sr=St;const po=24,Vn=4*1024*1024;class mn extends ms{constructor(e){super(e);c(this,"glw");c(this,"system");c(this,"quadBuffer",new ArrayBuffer(Vn));c(this,"fQuadBuffer",new Float32Array(this.quadBuffer));c(this,"uiQuadBuffer",new Uint32Array(this.quadBuffer));c(this,"renderOps",[]);c(this,"curBufferIdx",0);c(this,"curRenderOp",null);c(this,"rttNodes",[]);c(this,"activeRttNode",null);c(this,"defShaderCtrl");c(this,"defaultShader");c(this,"quadBufferCollection");c(this,"defaultTexture");c(this,"quadBufferUsage",0);c(this,"renderToTextureActive",!1);this.mode="webgl";const{canvas:r,clearColor:s,bufferMemory:i}=e;this.defaultTexture=new nr(this.txManager),this.defaultTexture.setRenderableOwner(this,!0),this.defaultTexture.once("loaded",()=>{this.stage.requestRender()});const o=_i(r,e.contextSpy),a=this.glw=new ao(o),l=Et(s);a.viewport(0,0,r.width,r.height),a.clearColor(l[0],l[1],l[2],l[3]),a.setBlend(!0),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),qi(a,i),this.system={parameters:Qi(this.glw),extensions:ji(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;const h=a.createBuffer();L(h);const d=6*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new Ss([{buffer:h,attributes:{a_position:{name:"a_position",size:2,type:a.FLOAT,normalized:!1,stride:d,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:a.FLOAT,normalized:!1,stride:d,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:a.UNSIGNED_BYTE,normalized:!0,stride:d,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:a.FLOAT,normalized:!1,stride:d,offset:5*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:e}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,e.setScissorTest(!1),e.clear()}getShaderManager(){return this.shManager}createCtxTexture(e){return e instanceof lt?new Ji(this.glw,this.txMemManager,e):e instanceof Rt?new Hn(this.glw,this.txMemManager,e):new rr(this.glw,this.txMemManager,e)}addQuad(e){var Xe,_e,ge,de,Z;const{fQuadBuffer:r,uiQuadBuffer:s}=this,{width:i,height:o,colorTl:a,colorTr:l,colorBl:h,colorBr:d,textureOptions:f,shader:p,shaderProps:v,alpha:y,clippingRect:m,tx:A,ty:S,ta:x,tb:b,tc:g,td:T,renderCoords:_,rtt:C,parentHasRenderTexture:I,framebufferDimensions:R}=e;let{texture:B}=e;if(v&&Gr(v,"$dimensions")){const j=v.$dimensions;j.width=i,j.height=o}B=B!=null?B:this.defaultTexture,L(B instanceof ct,"Invalid texture type");let{curBufferIdx:w,curRenderOp:N}=this;const P={width:i,height:o},k=p||this.defaultShader;L(k instanceof Ve),this.reuseRenderOp(e)||(this.newRenderOp(k,v,y,P,m,w,C,I,R),N=this.curRenderOp,L(N));const M=(Xe=f==null?void 0:f.flipX)!=null?Xe:!1;let D=(_e=f==null?void 0:f.flipY)!=null?_e:!1;B instanceof Rt&&(D=!D);let O=0,V=0,Y=1,z=1;if(B instanceof lt){const{x:j,y:ee,width:J,height:$}=B.props,{width:fe=0,height:ce=0}=B.parentTexture.dimensions||{width:0,height:0};O=j/fe,Y=O+J/fe,V=ee/ce,z=V+$/ce,B=B.parentTexture}const re=(ge=f==null?void 0:f.resizeMode)!=null?ge:!1;if(B instanceof sr&&re&&B.dimensions){const{width:j,height:ee}=B.dimensions;if(re.type==="cover"){const J=i/j,$=o/ee,fe=Math.max(J,$),ce=1/fe;if(fe&&J&&J<fe){const he=ce*i;O=(1-he/j)*((de=re.clipX)!=null?de:.5),Y=O+he/j}if(fe&&$&&$<fe){const he=ce*o;V=(1-he/ee)*((Z=re.clipY)!=null?Z:.5),z=V+he/ee}}}M&&([O,Y]=[Y,O]),D&&([V,z]=[z,V]);const ue=B.ctxTexture;L(ue instanceof rr);const ie=this.addTexture(ue,w);if(N=this.curRenderOp,L(N),_){const{x1:j,y1:ee,x2:J,y2:$,x3:fe,y3:ce,x4:he,y4:Me}=_;r[w++]=j,r[w++]=ee,r[w++]=O,r[w++]=V,s[w++]=a,r[w++]=ie,r[w++]=J,r[w++]=$,r[w++]=Y,r[w++]=V,s[w++]=l,r[w++]=ie,r[w++]=he,r[w++]=Me,r[w++]=O,r[w++]=z,s[w++]=h,r[w++]=ie,r[w++]=fe,r[w++]=ce,r[w++]=Y,r[w++]=z,s[w++]=d,r[w++]=ie}else if(b!==0||g!==0)r[w++]=A,r[w++]=S,r[w++]=O,r[w++]=V,s[w++]=a,r[w++]=ie,r[w++]=A+i*x,r[w++]=S+i*g,r[w++]=Y,r[w++]=V,s[w++]=l,r[w++]=ie,r[w++]=A+o*b,r[w++]=S+o*T,r[w++]=O,r[w++]=z,s[w++]=h,r[w++]=ie,r[w++]=A+i*x+o*b,r[w++]=S+i*g+o*T,r[w++]=Y,r[w++]=z,s[w++]=d,r[w++]=ie;else{const j=A+i*x,ee=S+o*T;r[w++]=A,r[w++]=S,r[w++]=O,r[w++]=V,s[w++]=a,r[w++]=ie,r[w++]=j,r[w++]=S,r[w++]=Y,r[w++]=V,s[w++]=l,r[w++]=ie,r[w++]=A,r[w++]=ee,r[w++]=O,r[w++]=z,s[w++]=h,r[w++]=ie,r[w++]=j,r[w++]=ee,r[w++]=Y,r[w++]=z,s[w++]=d,r[w++]=ie}N.length+=po,N.numQuads++,this.curBufferIdx=w}newRenderOp(e,r,s,i,o,a,l,h,d){const f=new ys(this.glw,this.options,this.quadBufferCollection,e,r,s,o,i,a,0,l,h,d);this.curRenderOp=f,this.renderOps.push(f)}addTexture(e,r,s){const{curRenderOp:i}=this;L(i);const o=i.addTexture(e);if(o===4294967295){if(s)throw new Error("Unable to add texture to render op");const{shader:a,shaderProps:l,dimensions:h,clippingRect:d,alpha:f}=i;return this.newRenderOp(a,l,f,h,d,r),this.addTexture(e,r,!0)}return o}reuseRenderOp(e){var h;const{shader:r,shaderProps:s,parentHasRenderTexture:i,rtt:o,clippingRect:a}=e,l=r||this.defaultShader;return!(((h=this.curRenderOp)==null?void 0:h.shader)!==l||!ki(this.curRenderOp.clippingRect,a)||i||o||this.curRenderOp.shader!==this.defaultShader&&(!s||!this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,s)))}addRenderOp(e){this.renderOps.push(e),this.curRenderOp=null}render(e="screen"){var a;const{glw:r,quadBuffer:s}=this,i=new Float32Array(s,0,this.curBufferIdx),o=(a=this.quadBufferCollection.getBuffer("a_position"))!=null?a:null;r.arrayBufferData(o,i,r.STATIC_DRAW),this.renderOps.forEach((l,h)=>{l.draw()}),this.quadBufferUsage=this.curBufferIdx*i.BYTES_PER_ELEMENT}renderToTexture(e){for(let r=0;r<this.rttNodes.length;r++)if(this.rttNodes[r]===e)return;this.rttNodes.unshift(e)}renderRTTNodes(){const{glw:e}=this;this.stage;for(let r=0;r<this.rttNodes.length;r++){const s=this.rttNodes[r];if(!s||!s.hasRTTupdates)continue;this.activeRttNode=s,L(s.texture,"RTT node missing texture");const i=s.texture.ctxTexture;L(i instanceof Hn),this.renderToTextureActive=!0,e.bindFramebuffer(i.framebuffer),e.viewport(0,0,i.w,i.h),e.clear();for(let o=0;o<s.children.length;o++){const a=s.children[o];a&&(a.update(this.stage.deltaTime,{x:0,y:0,width:0,height:0,valid:!1}),this.stage.addQuads(a),a.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,s.hasRTTupdates=!1}e.bindFramebuffer(null),e.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(e){const r=this.rttNodes.indexOf(e);r!==-1&&this.rttNodes.splice(r,1)}getBufferInfo(){return{totalAvailable:Vn,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}}class go{constructor(){c(this,"activeAnimations",new Set)}registerAnimation(t){this.activeAnimations.add(t)}unregisterAnimation(t){this.activeAnimations.delete(t)}update(t){this.activeAnimations.forEach(e=>{e.update(t)})}}function mo(){function n(e){return e.indexOf("image/png")!==-1}function t(e,r){return new Promise(function(s,i){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){if(o.status!==200)return i(new Error("Failed to load image: "+o.statusText));var a=o.response,l=r!==void 0?r:n(a.type);createImageBitmap(a,{premultiplyAlpha:l?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}).then(function(h){s({data:h,premultiplyAlpha:r})}).catch(function(h){i(h)})},o.onerror=function(){i(new Error("Network error occurred while trying to fetch the image."))},o.send()})}self.onmessage=e=>{var r=e.data.src,s=e.data.id,i=e.data.premultiplyAlpha;t(r,i).then(function(o){self.postMessage({id:s,src:r,data:o})}).catch(function(o){self.postMessage({id:s,src:r,error:o.message})})}}class xo{constructor(t){c(this,"imageWorkersEnabled",!0);c(this,"messageManager",{});c(this,"workers",[]);c(this,"workerIndex",0);c(this,"nextId",0);this.workers=this.createWorkers(t),this.workers.forEach(e=>{e.onmessage=this.handleMessage.bind(this)})}handleMessage(t){const{id:e,data:r,error:s}=t.data,i=this.messageManager[e];if(i){const[o,a]=i;delete this.messageManager[e],s?a(new Error(s)):o(r)}}createWorkers(t=1){const e="(".concat(mo.toString(),")()"),r=new Blob([e.replace('"use strict";',"")],{type:"application/javascript"}),s=(self.URL?URL:webkitURL).createObjectURL(r),i=[];for(let o=0;o<t;o++)i.push(new Worker(s));return i}getNextWorker(){const t=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,t}getImage(t,e){return new Promise((r,s)=>{try{if(this.workers){const i=this.nextId++;this.messageManager[i]=[r,s];const o=this.getNextWorker();o&&o.postMessage({id:i,src:t,premultiplyAlpha:e})}}catch(i){s(i)}})}}const _t=class _t extends ct{constructor(e,r){super(e);c(this,"props");this.props=_t.resolveDefaults(r)}async getTextureData(){const{width:e,height:r}=this.props,s=e*r*4,i=new Uint8ClampedArray(s);for(let o=0;o<s;o+=4){const a=Math.floor(Math.random()*256);i[o]=a,i[o+1]=a,i[o+2]=a,i[o+3]=255}return{data:new ImageData(i,e,r)}}static makeCacheKey(e){if(e.cacheId===void 0)return!1;const r=_t.resolveDefaults(e);return"NoiseTexture,".concat(r.width,",").concat(r.height,",").concat(r.cacheId)}static resolveDefaults(e){var r,s,i;return{width:(r=e.width)!=null?r:128,height:(s=e.height)!=null?s:128,cacheId:(i=e.cacheId)!=null?i:0}}};c(_t,"z$__type__Props");let Jr=_t;class yo{constructor(t){c(this,"keyCache",new Map);c(this,"inverseKeyCache",new WeakMap);c(this,"txConstructors",{});c(this,"imageWorkerManager",null);c(this,"hasCreateImageBitmap",!!self.createImageBitmap);c(this,"hasWorker",!!self.Worker);c(this,"renderer");c(this,"frameTime",0);this.hasCreateImageBitmap&&this.hasWorker&&t>0&&(this.imageWorkerManager=new xo(t)),this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.registerTextureType("ImageTexture",sr),this.registerTextureType("ColorTexture",nr),this.registerTextureType("NoiseTexture",Jr),this.registerTextureType("SubTexture",lt),this.registerTextureType("RenderTexture",Rt)}registerTextureType(t,e){this.txConstructors[t]=e}loadTexture(t,e){let r;const s=this.txConstructors[t];if(!s)throw new Error('Texture type "'.concat(t,'" is not registered'));if(!r){const i=s.makeCacheKey(e);i&&this.keyCache.has(i)?r=this.keyCache.get(i):(r=new s(this,e),i&&this.initTextureToCache(r,i))}return r}initTextureToCache(t,e){const{keyCache:r,inverseKeyCache:s}=this;r.set(e,t),s.set(t,e)}removeTextureFromCache(t){const{inverseKeyCache:e,keyCache:r}=this,s=e.get(t);s&&r.delete(s)}}function vo(n,t){var e=0,r,s;t=t||{};function i(){var o=r,a=arguments.length,l,h;e:for(;o;){if(o.args.length!==arguments.length){o=o.next;continue}for(h=0;h<a;h++)if(o.args[h]!==arguments[h]){o=o.next;continue e}return o!==r&&(o===s&&(s=o.prev),o.prev.next=o.next,o.next&&(o.next.prev=o.prev),o.next=r,o.prev=null,r.prev=o,r=o),o.val}for(l=new Array(a),h=0;h<a;h++)l[h]=arguments[h];return o={args:l,val:n.apply(null,l)},r?(r.prev=o,o.next=r):s=o,e===t.maxSize?(s=s.prev,s.next=null):e++,r=o,o.val}return i.clear=function(){r=null,s=null,e=0},i}const bo={normal:400,bold:700,bolder:900,lighter:100},Xn=n=>typeof n=="number"?n:bo[n]||400;function Ao(n,t,e,r,s){let i=Xn(e);for(const o of n){const a=o[t];if(!a)continue;if(a.size===1)return console.warn("TrFontManager: Only one font face found for family: '".concat(t,"' - will be used for all weights and styles")),a.values().next().value;const l=new Map;for(const d of a){const f=Xn(d.descriptors.weight);if(f===i&&d.descriptors.style===r&&d.descriptors.stretch===s)return d;l.set(f,d)}const h="TrFontManager: No exact match: '".concat(t," Weight: ").concat(i," Style: ").concat(r," Stretch: ").concat(s,"'");if(console.error(h),i===400&&l.has(500))return l.get(500);if(i===500&&l.has(400))return l.get(400);if(i<400){for(;i>0;){if(l.has(i))return l.get(i);i-=100}i=600}for(;i<1e3;){if(l.has(i))return l.get(i);i+=100}for(i=500;i>0;){if(l.has(i))return l.get(i);i-=100}}}const To=vo(Ao);class xn{constructor(t){c(this,"textRenderers");this.textRenderers=t}addFontFace(t){for(const e in this.textRenderers){const r=this.textRenderers[e];r&&r.isFontFaceSupported(t)&&r.addFontFace(t)}}static resolveFontFace(t,e){const{fontFamily:r,fontWeight:s,fontStyle:i,fontStretch:o}=e;return To(t,r,s,i,o)}}const wo={x:(n,t)=>{n.props.x=t},y:(n,t)=>{n.props.y=t},width:(n,t)=>{n.props.width=t},height:(n,t)=>{n.props.height=t},color:(n,t)=>{n.props.color=t},zIndex:(n,t)=>{n.props.zIndex=t},fontFamily:(n,t)=>{n.props.fontFamily=t},fontWeight:(n,t)=>{n.props.fontWeight=t},fontStyle:(n,t)=>{n.props.fontStyle=t},fontStretch:(n,t)=>{n.props.fontStretch=t},fontSize:(n,t)=>{n.props.fontSize=t},text:(n,t)=>{n.props.text=t},textAlign:(n,t)=>{n.props.textAlign=t},contain:(n,t)=>{n.props.contain=t},offsetY:(n,t)=>{n.props.offsetY=t},scrollable:(n,t)=>{n.props.scrollable=t},scrollY:(n,t)=>{n.props.scrollY=t},letterSpacing:(n,t)=>{n.props.letterSpacing=t},lineHeight:(n,t)=>{n.props.lineHeight=t},maxLines:(n,t)=>{n.props.maxLines=t},textBaseline:(n,t)=>{n.props.textBaseline=t},verticalAlign:(n,t)=>{n.props.verticalAlign=t},overflowSuffix:(n,t)=>{n.props.overflowSuffix=t},debug:(n,t)=>{n.props.debug=t}};class _s{constructor(t){c(this,"stage");c(this,"set");this.stage=t;const e={...wo,...this.getPropertySetters()};this.set=Object.freeze(Object.fromEntries(Object.entries(e).map(([r,s])=>[r,(i,o)=>{i.props[r]!==o&&(s(i,o),this.stage.requestRender())}])))}setStatus(t,e,r){t.status!==e&&(t.status=e,t.emitter.emit(e,r))}setIsRenderable(t,e){t.isRenderable=e}destroyState(t){this.setStatus(t,"destroyed"),t.emitter.removeAllListeners()}scheduleUpdateState(t){t.updateScheduled||(t.updateScheduled=!0,queueMicrotask(()=>{t.status!=="destroyed"&&(t.updateScheduled=!1,this.updateState(t))}))}}class Rs extends He{constructor(e){super();c(this,"fontFamily");c(this,"descriptors");c(this,"loaded",!1);c(this,"metrics",null);const{fontFamily:r,descriptors:s,metrics:i}=e;i&&(this.metrics={ascender:i.ascender/i.unitsPerEm,descender:i.descender/i.unitsPerEm,lineGap:i.lineGap/i.unitsPerEm}),this.fontFamily=r,this.descriptors={style:"normal",weight:"normal",stretch:"normal",...s}}static convertToCssFontFaceDescriptors(e){return{style:e.style,weight:typeof e.weight=="number"?"".concat(e.weight):e.weight,stretch:e.stretch,unicodeRange:e.unicodeRange,featureSettings:e.featureSettings,display:e.display}}}const So={LINE_FEED:10,CARRIAGE_RETURN:13,SPACE:32,TAB:9,ZERO_WIDTH_SPACE:8203,ZERO_WIDTH_NON_JOINER:8204,ZERO_WIDTH_JOINER:8205,LEFT_TO_RIGHT_MARK:8206,RIGHT_TO_LEFT_MARK:8207,LEFT_TO_RIGHT_EMBEDDING:8234,RIGHT_TO_LEFT_EMBEDDING:8235,POP_DIRECTIONAL_FORMATTING:8236,LEFT_TO_RIGHT_OVERRIDE:8237,RIGHT_TO_LEFT_OVERRIDE:8238,LINE_SEPARATOR:8232,PARAGRAPH_SEPARATOR:8233,OBJECT_REPLACEMENT_CHARACTER:65532,REPLACEMENT_CHARACTER:65533,ZERO_WIDTH_NO_BREAK_SPACE:65279,LEFT_TO_RIGHT_ISOLATE:8294,RIGHT_TO_LEFT_ISOLATE:8295,FIRST_STRONG_ISOLATE:8296,POP_DIRECTIONAL_ISOLATE:8297,INHIBIT_SYMMETRIC_SWAPPING:8298,ACTIVATE_SYMMETRIC_SWAPPING:8299,INHIBIT_ARABIC_FORM_SHAPING:8300,ACTIVATE_ARABIC_FORM_SHAPING:8301,NATIONAL_DIGIT_SHAPES:8302,NOMINAL_DIGIT_SHAPES:8303,LEFT_TO_RIGHT_BOUNDARY:8206,RIGHT_TO_LEFT_BOUNDARY:8207};class _o{}class Ro extends _o{constructor(e,r){super();c(this,"data");c(this,"glyphMap");c(this,"kernings");this.data=e,this.glyphMap=r;const s=this.kernings={};e.kernings.forEach(i=>{const o=i.second,a=s[o]=s[o]||{};a[i.first]=i.amount}),this.kernings=s}*shapeText(e,r){var o;let s,i;for(;(s=r.peek())&&!s.done;){const a=s.value,l=this.glyphMap.get(a);if(r.next(),l!==void 0){const h=i!==void 0?(((o=this.kernings[l.id])==null?void 0:o[i])||0)+e.letterSpacing:0;i=l.id,yield{mapped:!0,glyphId:l.id,codepoint:a,cluster:r.lastIndex,xAdvance:l.xadvance+h,yAdvance:0,xOffset:l.xoffset+h,yOffset:l.yoffset,xBearing:0,yBearing:0,width:l.width,height:l.height}}else a===So.LINE_FEED&&(i=void 0),yield{mapped:!1,codepoint:a,cluster:r.lastIndex}}}}class Ye extends Rs{constructor(e,r){super(r);c(this,"type");c(this,"texture");c(this,"maxCharHeight",0);c(this,"data");c(this,"shaper");c(this,"glyphMap",new Map);const{atlasUrl:s,atlasDataUrl:i,stage:o}=r;this.type=e;const a=o.renderer;L(a instanceof mn,"SDF Font Faces can only be used with the WebGL Renderer"),this.texture=o.txManager.loadTexture("ImageTexture",{src:s,premultiplyAlpha:!1}),this.texture.on("loaded",()=>{this.checkLoaded(),o.requestRender()}),this.texture.ctxTexture.load(),fetch(i).then(async l=>{var d;this.data=await l.json(),L(this.data);let h=0;if(this.data.chars.forEach(f=>{this.glyphMap.set(f.id,f);const p=f.yoffset+f.height;p>h&&(h=p)}),this.maxCharHeight=h,this.shaper=new Ro(this.data,this.glyphMap),!this.metrics)if((d=this.data)!=null&&d.lightningMetrics){const{ascender:f,descender:p,lineGap:v,unitsPerEm:y}=this.data.lightningMetrics;this.metrics={ascender:f/y,descender:p/y,lineGap:v/y}}else throw new Error("Font metrics not found in ".concat(this.type," font ").concat(this.fontFamily,". ")+"Make sure you are using the latest version of the Lightning 3 `msdf-generator` tool to generate your SDF fonts.");this.checkLoaded()}).catch(console.error)}getAtlasEntry(e){const r=this.glyphMap.get(e);if(r===void 0)throw new Error("Glyph ".concat(e," not found in font ").concat(this.fontFamily));return{x:r.x,y:r.y,width:r.width,height:r.height}}checkLoaded(){this.loaded||this.texture.state==="loaded"&&this.data&&(this.loaded=!0,this.emit("loaded"))}}const Co=24;function Eo(n,t,e,r,s,i,o,a,l){const h=Math.min(Math.max(o.firstLineIdx,0),a.length),d=0,{metrics:f}=e;L(f,"Font metrics not loaded"),L(e.data,"Font data not loaded");const p=(f.ascender-f.descender)*n;let v=0;r==="middle"?v=(t-p)/2:r==="bottom"&&(v=t-p);const y=s/i,m=e.data.common.base,S=f.ascender*n-m,x=y+S+h*t+v;if(!(l&&x>=l/i))return{sdfX:d,sdfY:x,lineIndex:h}}class xt{constructor(t,e=0){c(this,"iterator");c(this,"peekBuffer",[]);c(this,"_lastIndex");this.iterator=t,this.iterator=t,this._lastIndex=e-1,this.peekBuffer=[]}next(){const t=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return t.done?this._lastIndex=-1:this._lastIndex++,t}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const t=this.iterator.next();return this.peekBuffer.push(t),t}get lastIndex(){return this._lastIndex}}function*yt(n,t=0){let e=t;for(;e<n.length;){const r=n.codePointAt(e);if(r===void 0)throw new Error("Invalid Unicode code point");yield r,e+=r<=65535?1:2}}function Io(n,t,e){const r=e.shapeText(t,new xt(yt(n,0),0));let s=0;for(const i of r)i.mapped&&(s+=i.xAdvance);return s}function Bo(n,t,e,r,s,i,o,a,l,h,d,f,p,v,y,m,A,S,x){L(y,"Font face must be loaded"),L(y.loaded,"Font face must be loaded"),L(y.data,"Font face must be loaded"),L(y.shaper,"Font face must be loaded");const b=a/y.data.info.size,g=l/b,T=i/b,_=h/b,C=p[n],I=(C==null?void 0:C.codepointIndex)||0,R=(C==null?void 0:C.maxX)||0,B=(C==null?void 0:C.maxY)||0;let w=R,N=B,P=t,k=e,M=0;const D={codepointIndex:-1,bufferOffset:-1,xStart:-1},O=y.shaper,V={letterSpacing:_};let Y=O.shapeText(V,new xt(yt(r,I),I)),z,re=-1;const ue=[],ie=o/b,Xe=Io(S,V,O);let _e=!0;for(;_e;){const ge=(x===0||n+1<x)&&(f!=="both"||A||k+g+y.maxCharHeight<=ie),de=ge?T:T-Xe;let Z=0;const j=k+y.maxCharHeight>=v.y1,ee=k<=v.y2,J=j&&ee;for(;(z=Y.next())&&!z.done;){const $=z.value;if(n===p.length)p.push({codepointIndex:$.cluster,maxY:N,maxX:w});else if(n>p.length)throw new Error("Unexpected lineCache length");if($.codepoint===32||$.codepoint===10?D.codepointIndex!==-1&&(D.codepointIndex=-1,Z=P):D.codepointIndex===-1&&(D.codepointIndex=$.cluster,D.bufferOffset=M,D.xStart=Z),$.mapped){const fe=P+$.xOffset+$.width;if(f!=="none"&&fe>=de&&D.codepointIndex!==-1&&D.xStart>0)if(ge){Y=O.shapeText(V,new xt(yt(r,D.codepointIndex),D.codepointIndex)),M=D.bufferOffset;break}else Y=O.shapeText(V,new xt(yt(S,0),0)),P=D.xStart,M=D.bufferOffset,f="none";else{const ce=P+$.xOffset,he=k+$.yOffset;if(J){re===-1&&(re=M);const Me=y.getAtlasEntry($.glyphId),$e=Me.x/y.data.common.scaleW,Ge=Me.y/y.data.common.scaleH,ut=Me.width/y.data.common.scaleW,dt=Me.height/y.data.common.scaleH;d[M++]=ce,d[M++]=he,d[M++]=$e,d[M++]=Ge,d[M++]=ce+$.width,d[M++]=he,d[M++]=$e+ut,d[M++]=Ge,d[M++]=ce,d[M++]=he+$.height,d[M++]=$e,d[M++]=Ge+dt,d[M++]=ce+$.width,d[M++]=he+$.height,d[M++]=$e+ut,d[M++]=Ge+dt}N=Math.max(N,he+$.height),w=Math.max(w,ce+$.width),P+=$.xAdvance}}else if($.codepoint===10){if(ge)break;Y=O.shapeText(V,new xt(yt(S,0),0)),f="none"}}re!==-1&&(ue.push({bufferStart:re,bufferEnd:M}),re=-1),P=0,k+=g,n++,D.codepointIndex=-1,Z=0,!m&&f==="both"&&k>v.y2||z&&z.done?_e=!1:ge||(_e=!1)}if(s==="center"){const ge=f==="none"?w:T;for(let de=0;de<ue.length;de++){const Z=ue[de],j=d[Z.bufferEnd-4]-d[Z.bufferStart],ee=(ge-j)/2;for(let J=Z.bufferStart;J<Z.bufferEnd;J+=4)d[J]+=ee}}else if(s==="right"){const ge=f==="none"?w:T;for(let de=0;de<ue.length;de++){const Z=ue[de],j=Z.bufferEnd===Z.bufferStart?0:d[Z.bufferEnd-4]-d[Z.bufferStart],ee=ge-j;for(let J=Z.bufferStart;J<Z.bufferEnd;J+=4)d[J]+=ee}}return L(z),{bufferNumFloats:M,bufferNumQuads:M/16,layoutNumCharacters:z.done?r.length-I:z.value.cluster-I+1,fullyProcessed:!!z.done,maxX:w,maxY:N,numLines:p.length}}function Fo(n,t){return Math.ceil(n/t)*t}function Mo(n,t){return Math.floor(n/t)*t}function Lo(n,t,e,r,s,i,o,a){const{screen:l,sdf:h}=n;if(!Pi(o))l.x1=0,l.y1=0,l.x2=0,l.y2=0,h.x1=0,h.y1=0,h.x2=0,h.y2=0,n.numLines=0,n.firstLineIdx=0;else{const d=o.x1-t,f=d+(o.x2-o.x1),p=o.y1-e+r,v=Mo(p-i,s||1),y=Fo(p+(o.y2-o.y1)+i,s||1);l.x1=d,l.y1=v,l.x2=f,l.y2=y,h.x1=d/a,h.y1=v/a,h.x2=f/a,h.y2=y/a,n.numLines=Math.ceil((y-v)/s),n.firstLineIdx=s?Math.floor(v/s):0}n.valid=!0}function Cs(n,t){return t*(n.ascender-n.descender+n.lineGap)}const ko={x:0,y:0,width:0,height:0};class Po extends _s{constructor(e){super(e);c(this,"ssdfFontFamilies",{});c(this,"msdfFontFamilies",{});c(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]);c(this,"sdfShader");c(this,"rendererBounds");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,r)=>{e.props.fontFamily=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontWeight:(e,r)=>{e.props.fontWeight=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStyle:(e,r)=>{e.props.fontStyle=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStretch:(e,r)=>{e.props.fontStretch=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontSize:(e,r)=>{e.props.fontSize=r,this.invalidateLayoutCache(e)},text:(e,r)=>{e.props.text=r,this.invalidateLayoutCache(e)},textAlign:(e,r)=>{e.props.textAlign=r,this.invalidateLayoutCache(e)},color:(e,r)=>{e.props.color=r},x:(e,r)=>{e.props.x=r,e.elementBounds.valid&&(this.setElementBoundsX(e),!e.renderWindow.valid&&Ir(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},y:(e,r)=>{e.props.y=r,e.elementBounds.valid&&(this.setElementBoundsY(e),!e.renderWindow.valid&&Ir(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},contain:(e,r)=>{e.props.contain=r,this.invalidateLayoutCache(e)},width:(e,r)=>{e.props.width=r,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,r)=>{e.props.height=r,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,r)=>{e.props.offsetY=r,this.invalidateLayoutCache(e)},scrollable:(e,r)=>{e.props.scrollable=r,this.invalidateLayoutCache(e)},scrollY:(e,r)=>{e.props.scrollY=r,this.scheduleUpdateState(e)},letterSpacing:(e,r)=>{e.props.letterSpacing=r,this.invalidateLayoutCache(e)},lineHeight:(e,r)=>{e.props.lineHeight=r,e.resLineHeight=void 0,this.invalidateLayoutCache(e)},maxLines:(e,r)=>{e.props.maxLines=r,this.invalidateLayoutCache(e)},textBaseline:(e,r)=>{e.props.textBaseline=r,this.invalidateLayoutCache(e)},verticalAlign:(e,r)=>{e.props.verticalAlign=r,this.invalidateLayoutCache(e)},overflowSuffix:(e,r)=>{e.props.overflowSuffix=r,this.invalidateLayoutCache(e)},debug:(e,r)=>{e.props.debug=r}}}canRenderFont(e){const{fontFamily:r}=e;return r in this.ssdfFontFamilies||r in this.msdfFontFamilies||r==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(e){return e instanceof Ye}addFontFace(e){L(e instanceof Ye);const r=e.fontFamily,s=e.type==="ssdf"?this.ssdfFontFamilies:e.type==="msdf"?this.msdfFontFamilies:void 0;if(!s){console.warn("Invalid font face type: ".concat(e.type));return}let i=s[r];i||(i=new Set,s[r]=i),i.add(e)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new He,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){let{trFontFace:r}=e;const{textH:s,lineCache:i,debugData:o,forceFullLayoutCalc:a}=e;if(o.updateCount++,e.status==="initialState"&&this.setStatus(e,"loading"),!r){if(r=this.resolveFontFace(e.props),e.trFontFace=r,!r){const O="SdfTextRenderer: Could not resolve font face for family: '".concat(e.props.fontFamily,"'");console.error(O),this.setStatus(e,"failed",new Error(O));return}r.texture.setRenderableOwner(e,!0)}if(!r.loaded){r.once("loaded",()=>{this.scheduleUpdateState(e)});return}L(r.data,"Font face data should be loaded"),L(r.metrics,"Font face metrics should be loaded");const{text:l,fontSize:h,x:d,y:f,contain:p,width:v,height:y,verticalAlign:m,scrollable:A,overflowSuffix:S,maxLines:x}=e.props,b=p==="both"&&A?e.props.scrollY:0,{renderWindow:g}=e,T=r.data.info.size,_=h/T;let C=e.resLineHeight;if(C===void 0){const O=e.props.lineHeight;O===void 0?C=Cs(r.metrics,h):C=O,e.resLineHeight=C}const I=C/_;e.distanceRange=_*r.data.distanceField.distanceRange;const R=l.length*Co;let B=e.vertexBuffer;(!B||B.length<R)&&(B=new Float32Array(R*2));const w=e.elementBounds;if(w.valid||(this.setElementBoundsX(e),this.setElementBoundsY(e),w.valid=!0),!a&&g.valid){const O=g.screen;if(d+O.x1<=w.x1&&d+O.x2>=w.x2&&f-b+O.y1<=w.y1&&f-b+O.y2>=w.y2){this.setStatus(e,"loaded");return}g.valid=!1,this.setStatus(e,"loading")}const{offsetY:N,textAlign:P}=e.props;if(!g.valid){if(!Ir(w,this.rendererBounds))return;Lo(g,d,f,b,C,p==="both"?w.y2-w.y1:0,w,_)}const k=Eo(T,I,r,m,N,_,g,i,s);if(!k){this.setStatus(e,"loaded");return}const{letterSpacing:M}=e.props,D=Bo(k.lineIndex,k.sdfX,k.sdfY,l,P,v,y,h,C,M,B,p,i,g.sdf,r,a,A,S,x);e.bufferUploaded=!1,e.bufferNumFloats=D.bufferNumFloats,e.bufferNumQuads=D.bufferNumQuads,e.vertexBuffer=B,e.renderWindow=g,o.lastLayoutNumCharacters=D.layoutNumCharacters,o.bufferSize=B.byteLength,D.fullyProcessed&&(e.textW=D.maxX*_,e.textH=D.numLines*I*_),this.setStatus(e,"loaded")}renderQuads(e,r,s,i,o,a){var w,N,P;if(!e.vertexBuffer)return;const l=this.stage.renderer;L(l instanceof mn);const{fontSize:h,color:d,contain:f,scrollable:p,zIndex:v,debug:y}=e.props,m=f==="both"&&p?e.props.scrollY:0,{textW:A=0,textH:S=0,distanceRange:x,vertexBuffer:b,bufferUploaded:g,trFontFace:T,elementBounds:_}=e;let{webGlBuffers:C}=e;if(!C){const k=l.glw,M=4*Float32Array.BYTES_PER_ELEMENT,D=k.createBuffer();L(D),e.webGlBuffers=new Ss([{buffer:D,attributes:{a_position:{name:"a_position",size:2,type:k.FLOAT,normalized:!1,stride:M,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:k.FLOAT,normalized:!1,stride:M,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,L(e.webGlBuffers),C=e.webGlBuffers}if(!g){const k=l.glw,M=(w=C==null?void 0:C.getBuffer("a_textureCoordinate"))!=null?w:null;k.arrayBufferData(M,b,k.STATIC_DRAW),e.bufferUploaded=!0}if(L(T),p&&f==="both"){L(_.valid);const k=Li(_,ko);s.valid?(e.clippingRect.valid=!0,s=us(s,k,e.clippingRect)):(e.clippingRect.valid=!0,s=ds(k,e.clippingRect))}const I=new ys(l.glw,l.options,C,this.sdfShader,{transform:r.getFloatArr(),color:Ri(d,i),size:h/(((N=T.data)==null?void 0:N.info.size)||0),scrollY:m,distanceRange:x,debug:y.sdfShaderDebug},i,s,{height:S,width:A},0,v,!1,o,a),R=(P=e.trFontFace)==null?void 0:P.texture;L(R);const B=R.ctxTexture;I.addTexture(B),I.length=e.bufferNumFloats,I.numQuads=e.bufferNumQuads,l.addRenderOp(I)}setIsRenderable(e,r){var s;super.setIsRenderable(e,r),(s=e.trFontFace)==null||s.texture.setRenderableOwner(e,r)}destroyState(e){var r;super.destroyState(e),(r=e.trFontFace)==null||r.texture.setRenderableOwner(e,!1)}resolveFontFace(e){return xn.resolveFontFace(this.fontFamilyArray,e)}releaseFontFace(e){e.resLineHeight=void 0,e.trFontFace&&(e.trFontFace.texture.setRenderableOwner(e,!1),e.trFontFace=void 0)}invalidateLayoutCache(e){e.renderWindow.valid=!1,e.elementBounds.valid=!1,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}setElementBoundsX(e){const{x:r,contain:s,width:i}=e.props,{elementBounds:o}=e;o.x1=r,o.x2=s!=="none"?r+i:1/0}setElementBoundsY(e){const{y:r,contain:s,height:i}=e.props,{elementBounds:o}=e;o.y1=r,o.y2=s==="both"?r+i:1/0}}class Mr extends Rs{constructor(e){super(e);c(this,"fontFace");c(this,"fontUrl");const{fontFamily:r,fontUrl:s}=e,i=s.replace(/\(|\)/g,""),o=this.descriptors,a={style:o.style,weight:typeof o.weight=="number"?"".concat(o.weight):o.weight,stretch:o.stretch,unicodeRange:o.unicodeRange,featureSettings:o.featureSettings,display:o.display},l=new FontFace(r,"url(".concat(i,")"),a);l.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error),this.fontFace=l,this.fontUrl=s}}function No(n,t,e){if(t.metrics)return t.metrics;const r=n.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz");console.warn("Font metrics not provided for Canvas Web font ".concat(t.fontFamily,". ")+"Using fallback values. It is HIGHLY recommended you use the latest version of the Lightning 3 `msdf-generator` tool to extract the default metrics for the font and provide them in the Canvas Web font definition.");let s;return r.actualBoundingBoxDescent&&r.actualBoundingBoxAscent?s={ascender:r.actualBoundingBoxAscent/e,descender:-r.actualBoundingBoxDescent/e,lineGap:.2}:s={ascender:.8,descender:-.2,lineGap:.2},t.metrics=s,s}const $n=2048;function Gn(n,t,e,r,s){const i=n!=="bottom"?.5*t:0;return e*(r-1)+i+Math.max(e,t)+(s||0)}class Do{constructor(t,e){c(this,"_canvas");c(this,"_context");c(this,"_settings");this._canvas=t,this._context=e,this._settings=this.mergeDefaults({})}set settings(t){this._settings=this.mergeDefaults(t)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const t=[this._settings.fontFamily],e=[];for(let r=0,s=t.length;r<s;r++)t[r]==="serif"||t[r]==="sans-serif"?e.push(t[r]):e.push('"'.concat(t[r],'"'));return"".concat(this._settings.fontStyle," ").concat(this._settings.fontSize*this.getPrecision(),"px ").concat(e.join(","))}_load(){if(document.fonts){const t=this._getFontSetting();try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(e=>{console.warn("[Lightning] Font load error",e,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("[Lightning] Font not found",t)})}catch(e){console.warn("[Lightning] Can't check font loading for "+t)}}}calculateRenderInfo(){const t={},e=this.getPrecision(),r=this._settings.paddingLeft*e,s=this._settings.paddingRight*e,i=this._settings.fontSize*e;let o=this._settings.offsetY===null?null:this._settings.offsetY*e;const a=this._settings.w*e,l=this._settings.h*e;let h=this._settings.wordWrapWidth*e;const d=this._settings.cutSx*e,f=this._settings.cutEx*e,p=this._settings.cutSy*e,v=this._settings.cutEy*e,y=(this._settings.letterSpacing||0)*e,m=this._settings.textIndent*e,A=this._settings.trFontFace;this.setFontProperties(),L(A);const S=No(this._context,A,i),x=Cs(S,i)*e,b=this._settings.lineHeight!==null?this._settings.lineHeight*e:x,g=this._settings.maxHeight,T=g!==null&&b>0?Math.floor(g/b):0,_=this._settings.maxLines,C=T>0&&_>0?Math.min(T,_):Math.max(T,_);let I=a||2048/this.getPrecision(),R=I-r;if(R<10&&(I+=10-R,R=10),h||(h=R),this._settings.textOverflow&&!this._settings.wordWrap){let M;switch(this._settings.textOverflow){case"clip":M="";break;case"ellipsis":M=this._settings.overflowSuffix;break;default:M=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,h-m,M)}let B;if(this._settings.wordWrap)B=this.wrapText(this._settings.text,h,y,m);else{B={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const M=B.l.length;for(let D=0;D<M-1;D++)B.n.push(D)}let w=B.l;if(C&&w.length>C){const M=w.slice(0,C);let D=null;if(this._settings.overflowSuffix){const re=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,ue=this.wrapText(M[M.length-1],h-re,y,m);M[M.length-1]="".concat(ue.l[0]).concat(this._settings.overflowSuffix),D=[ue.l.length>1?ue.l[1]:""]}else D=[""];let O;const V=w.length;let Y=0;const z=B.n.length;for(O=C;O<V;O++)D[Y]+="".concat(D[Y]?" ":"").concat(w[O]),O+1<z&&B.n[O+1]&&Y++;t.remainingText=D.join("\n"),t.moreTextLines=!0,w=M}else t.moreTextLines=!1,t.remainingText="";let N=0;const P=[];for(let M=0;M<w.length;M++){const D=this.measureText(w[M],y)+(M===0?m:0);P.push(D),N=Math.max(N,D)}t.lineWidths=P,a||(I=N+r+s,R=N);let k;return l?k=l:k=Gn(this._settings.textBaseline,i,b,w.length,o),o===null&&(o=i),t.w=I,t.h=k,t.lines=w,t.precision=e,I||(I=1),k||(k=1),(d||f)&&(I=Math.min(I,f-d)),(p||v)&&(k=Math.min(k,v-p)),t.width=I,t.innerWidth=R,t.height=k,t.fontSize=i,t.cutSx=d,t.cutSy=p,t.cutEx=f,t.cutEy=v,t.lineHeight=b,t.defLineHeight=x,t.lineWidths=P,t.offsetY=o,t.paddingLeft=r,t.paddingRight=s,t.letterSpacing=y,t.textIndent=m,t.metrics=S,t}draw(t,e){const r=this.getPrecision(),s=(e==null?void 0:e.lines)||t.lines,i=(e==null?void 0:e.lineWidths)||t.lineWidths,o=e?Gn(this._settings.textBaseline,t.fontSize,t.lineHeight,e.lines.length,this._settings.offsetY===null?null:this._settings.offsetY*r):t.height;this._canvas.width=Math.min(Math.ceil(t.width+this._settings.textRenderIssueMargin),$n),this._canvas.height=Math.min(Math.ceil(o),$n),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy);let a,l;const h=[],{metrics:d}=t,f=d?d.ascender*t.fontSize:t.fontSize,p=(d.ascender-d.descender)*t.fontSize;for(let y=0,m=s.length;y<m;y++)a=y===0?t.textIndent:0,l=y*t.lineHeight+f,this._settings.verticalAlign=="middle"?l+=(t.lineHeight-p)/2:this._settings.verticalAlign=="bottom"&&(l+=t.lineHeight-p),this._settings.textAlign==="right"?a+=t.innerWidth-i[y]:this._settings.textAlign==="center"&&(a+=(t.innerWidth-i[y])/2),a+=t.paddingLeft,h.push({text:s[y],x:a,y:l,w:i[y]});if(this._settings.highlight){const y=this._settings.highlightColor,m=this._settings.highlightHeight*r||t.fontSize*1.5,A=this._settings.highlightOffset*r,S=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*r:t.paddingLeft,x=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*r:t.paddingRight;this._context.fillStyle=Er(y);for(let b=0;b<h.length;b++){const g=h[b];this._context.fillRect(g.x-S,g.y-t.offsetY+A,g.w+x+S,m)}}let v=null;this._settings.shadow&&(v=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=Er(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*r,this._context.shadowOffsetY=this._settings.shadowOffsetY*r,this._context.shadowBlur=this._settings.shadowBlur*r),this._context.fillStyle=Er(this._settings.textColor);for(let y=0,m=h.length;y<m;y++){const A=h[y];if(t.letterSpacing===0)this._context.fillText(A.text,A.x,A.y);else{const S=A.text.split("");let x=A.x;for(let b=0,g=S.length;b<g;b++)this._context.fillText(S[b],x,A.y),x+=this.measureText(S[b],t.letterSpacing)}}v&&(this._context.shadowColor=v[0],this._context.shadowOffsetX=v[1],this._context.shadowOffsetY=v[2],this._context.shadowBlur=v[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy)}wrapWord(t,e,r){const s=this._context.measureText(r).width,i=t.length,o=this._context.measureText(t).width;if(o<=e)return t;let a=Math.floor(e*i/o),l=this._context.measureText(t.substring(0,a)).width+s;if(l>e)for(;a>0&&(l=this._context.measureText(t.substring(0,a)).width+s,l>e);)a-=1;else for(;a<i;)if(l=this._context.measureText(t.substring(0,a)).width+s,l<e)a+=1;else{a-=1;break}return t.substring(0,a)+(e>=s?r:"")}wrapText(t,e,r,s=0){const i=t.split(/\r?\n/g);let o=[];const a=[];for(let l=0;l<i.length;l++){const h=[];let d="",f=e-s;const p=i[l].split(" ");for(let v=0;v<p.length;v++){const y=this.measureText(p[v],r),m=y+this.measureText(" ",r);v===0||m>f?(v>0&&(h.push(d),d=""),d+=p[v],f=e-y-(v===0?s:0)):(f-=m,d+=" ".concat(p[v]))}h.push(d),d="",o=o.concat(h),l<i.length-1&&a.push(o.length)}return{l:o,n:a}}measureText(t,e=0){return e?t.split("").reduce((r,s)=>r+this._context.measureText(s).width+e,0):this._context.measureText(t).width}mergeDefaults(t){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFamily:null,trFontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxHeight:null,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...t}}}const Yn=typeof self>"u"?globalThis:self;var cs;const Kn=((cs=Yn.document)==null?void 0:cs.fonts)||Yn.fonts;function Oo(n){const{fontFamily:t,fontStyle:e,fontWeight:r,fontStretch:s,fontSize:i}=n;return[e,r,s,"".concat(i,"px"),t].join(" ")}class Qn extends _s{constructor(e){super(e);c(this,"canvas");c(this,"context");c(this,"fontFamilies",{});c(this,"fontFamilyArray",[this.fontFamilies]);c(this,"loadFont",e=>{const r=Oo(e.props),s=xn.resolveFontFace(this.fontFamilyArray,e.props);if(L(s,"Could not resolve font face for ".concat(r)),e.fontInfo={fontFace:s,cssString:r,loaded:!1},!e.fontInfo.loaded){Kn.load(r).then(this.onFontLoaded.bind(this,e,r)).catch(this.onFontLoadError.bind(this,e,r));return}});typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let r=this.canvas.getContext("2d",{willReadFrequently:!0});r||(this.canvas=document.createElement("canvas"),r=this.canvas.getContext("2d",{willReadFrequently:!0})),L(r),this.context=r,this.addFontFace(new Mr({fontFamily:"sans-serif",descriptors:{},fontUrl:""}))}getPropertySetters(){return{fontFamily:(e,r)=>{e.props.fontFamily=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,r)=>{e.props.fontWeight=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,r)=>{e.props.fontStyle=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,r)=>{e.props.fontStretch=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,r)=>{e.props.fontSize=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,r)=>{e.props.text=r,this.invalidateLayoutCache(e)},textAlign:(e,r)=>{e.props.textAlign=r,this.invalidateLayoutCache(e)},color:(e,r)=>{e.props.color=r,this.invalidateLayoutCache(e)},x:(e,r)=>{e.props.x=r},y:(e,r)=>{e.props.y=r},contain:(e,r)=>{e.props.contain=r,this.invalidateLayoutCache(e)},width:(e,r)=>{e.props.width=r,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,r)=>{e.props.height=r,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,r)=>{e.props.offsetY=r,this.invalidateLayoutCache(e)},scrollY:(e,r)=>{e.props.scrollY=r},letterSpacing:(e,r)=>{e.props.letterSpacing=r,this.invalidateLayoutCache(e)},lineHeight:(e,r)=>{e.props.lineHeight=r,this.invalidateLayoutCache(e)},maxLines:(e,r)=>{e.props.maxLines=r,this.invalidateLayoutCache(e)},textBaseline:(e,r)=>{e.props.textBaseline=r,this.invalidateLayoutCache(e)},verticalAlign:(e,r)=>{e.props.verticalAlign=r,this.invalidateLayoutCache(e)},overflowSuffix:(e,r)=>{e.props.overflowSuffix=r,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof Mr}addFontFace(e){L(e instanceof Mr),e.fontFamily!=="sans-serif"&&Kn.add(e.fontFace);const{fontFamilies:r}=this,s=e.fontFace.family;let i=r[s];i||(i=new Set,r[s]=i),i.add(e)}createState(e,r){return{node:r,props:e,status:"initialState",updateScheduled:!1,emitter:new He,textureNode:void 0,lightning2TextRenderer:new Do(this.canvas,this.context),renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){if(e.status==="initialState"&&this.setStatus(e,"loading"),e.status!=="loaded"){if(!e.fontInfo)return this.loadFont(e);e.fontInfo.loaded&&(e.renderInfo||(e.renderInfo=this.calculateRenderInfo(e),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,this.renderSingleCanvasPage(e)))}}renderSingleCanvasPage(e){L(e.renderInfo);const r=e.node,s=this.stage.txManager.loadTexture("ImageTexture",{src:(function(i,o){return L(o),i.draw(o,{lines:o.lines,lineWidths:o.lineWidths}),this.canvas.width===0||this.canvas.height===0?null:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)}).bind(this,e.lightning2TextRenderer,e.renderInfo)});if(e.textureNode)e.textureNode.texture=s;else{const i=this.stage.createNode({parent:r,texture:s,autosize:!0,alpha:Mi(e.props.color)});e.textureNode=i}this.setStatus(e,"loaded")}calculateRenderInfo(e){var r,s;return e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFamily:e.props.fontFamily,trFontFace:(r=e.fontInfo)==null?void 0:r.fontFace,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:Et(e.props.color),offsetY:e.props.offsetY,wordWrap:e.props.contain!=="none",wordWrapWidth:e.props.contain==="none"?void 0:e.props.width,letterSpacing:e.props.letterSpacing,lineHeight:(s=e.props.lineHeight)!=null?s:null,maxLines:e.props.maxLines,maxHeight:e.props.contain==="both"?e.props.height-e.props.offsetY:null,textBaseline:e.props.textBaseline,verticalAlign:e.props.verticalAlign,overflowSuffix:e.props.overflowSuffix,w:e.props.contain!=="none"?e.props.width:void 0},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.renderInfo}renderQuads(){}destroyState(e){e.status!=="destroyed"&&(super.destroyState(e),e.textureNode&&(e.textureNode.destroy(),delete e.textureNode),delete e.renderInfo)}invalidateLayoutCache(e){e.renderInfo=void 0,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,r){var s;r!==((s=e.fontInfo)==null?void 0:s.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,r,s){var i;r!==((i=e.fontInfo)==null?void 0:i.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,console.error("CanvasTextRenderer: Error loading font '".concat(e.fontInfo.cssString,"'"),s),this.scheduleUpdateState(e))}}class Uo{constructor(){c(this,"data",{})}reset(){this.data={}}increment(t){this.data[t]||(this.data[t]=0),this.data[t]++}getData(){return{...this.data}}}class zo{constructor(t,e){c(this,"stage");c(this,"memUsed",0);c(this,"loadedTextures",new Map);c(this,"criticalThreshold");c(this,"targetThreshold");c(this,"cleanupInterval");c(this,"debugLogging");c(this,"lastCleanupTime",0);c(this,"criticalCleanupRequested",!1);c(this,"frameTime",0);this.stage=t;const{criticalThreshold:r}=e;this.criticalThreshold=Math.round(r);const s=Math.max(0,Math.min(1,e.targetThresholdLevel));if(this.targetThreshold=Math.round(r*s),this.cleanupInterval=e.cleanupInterval,this.debugLogging=e.debugLogging,e.debugLogging){let i=0;setInterval(()=>{i!==this.memUsed&&(i=this.memUsed,console.log("[TextureMemoryManager] Memory used: ".concat(Un(this.memUsed)," mb / ").concat(Un(this.criticalThreshold)," mb (").concat((this.memUsed/this.criticalThreshold*100).toFixed(1),"%)")))},1e3)}r===0&&(this.setTextureMemUse=()=>{})}setTextureMemUse(t,e){if(this.loadedTextures.has(t)&&(this.memUsed-=this.loadedTextures.get(t)),e===0){this.loadedTextures.delete(t);return}else this.memUsed+=e,this.loadedTextures.set(t,e);this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}cleanup(){const t=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,this.criticalCleanupRequested=!1,t&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.debugLogging&&console.log("[TextureMemoryManager] Cleaning up textures. Critical: ".concat(t));const e=[...this.loadedTextures.keys()].sort((i,o)=>{const a=i.renderable,l=o.renderable;return a===l?i.lastRenderableChangeTime-o.lastRenderableChangeTime:a?1:l?-1:0}),r=this.targetThreshold,s=this.stage.txManager;for(const i of e)if(i.renderable||(i.ctxTexture.free(),s.removeTextureFromCache(i),this.memUsed<=r))break;this.memUsed>=this.criticalThreshold&&(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),console.warn("[TextureMemoryManager] Memory usage above critical threshold after cleanup: ".concat(this.memUsed)))}getMemoryInfo(){let t=0;const e=[...this.loadedTextures.keys()].reduce((r,s)=>(t+=s.renderable?1:0,r+(s.renderable?this.loadedTextures.get(s):0)),0);return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:e,memUsed:this.memUsed,renderableTexturesLoaded:t,loadedTextures:this.loadedTextures.size}}}const Wo={isWhite:!0,a:1,r:255,g:255,b:255};function Lr(n){if(n===4294967295)return Wo;const t=(n>>>24&255)/255,e=n>>>16&255&255,r=n>>>8&255&255,s=n&255&255;return{isWhite:!1,a:t,r:s,g:r,b:e}}function Jt({a:n,r:t,g:e,b:r}){return"rgba(".concat(t,",").concat(e,",").concat(r,",").concat(n,")")}class Ho extends gs{constructor(){super(...arguments);c(this,"image");c(this,"tintCache")}load(){this.textureSource.state==="freed"&&(this.textureSource.setState("loading"),this.onLoadRequest().then(e=>{this.textureSource.setState("loaded",e),this.updateMemSize()}).catch(e=>{this.textureSource.setState("failed",e)}))}free(){this.image=void 0,this.tintCache=void 0,this.textureSource.setState("freed"),this.setTextureMemUse(0)}updateMemSize(){const e=this.tintCache?8:4;if(this.textureSource.dimensions){const{width:r,height:s}=this.textureSource.dimensions;this.setTextureMemUse(r*s*e)}}hasImage(){return this.image!==void 0}getImage(e){var o;const r=this.image;if(L(r,"Attempt to get unloaded image texture"),e.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),r;const s=Jt(e);if(((o=this.tintCache)==null?void 0:o.key)===s)return this.tintCache.image;const i=this.tintTexture(r,s);return this.tintCache={key:s,image:i},this.updateMemSize(),i}tintTexture(e,r){const{width:s,height:i}=e,o=document.createElement("canvas");o.width=s,o.height=i;const a=o.getContext("2d");return a&&(a.fillStyle=r,a.globalCompositeOperation="copy",a.fillRect(0,0,s,i),a.globalCompositeOperation="multiply",a.drawImage(e,0,0,s,i,0,0,s,i),a.globalCompositeOperation="destination-in",a.drawImage(e,0,0,s,i,0,0,s,i)),o}async onLoadRequest(){const{data:e}=await this.textureSource.getTextureData();if(e instanceof ImageData){const r=document.createElement("canvas");r.width=e.width,r.height=e.height;const s=r.getContext("2d");return s&&s.putImageData(e,0,0),this.image=r,{width:e.width,height:e.height}}else if(e instanceof ImageBitmap)return this.image=e,{width:e.width,height:e.height};return{width:0,height:0}}}function Vo(n){var t,e;return n.shader instanceof gn&&n.shader.shType===ws&&(e=(t=n.shaderProps)==null?void 0:t.radius)!=null?e:0}class Xo extends ms{constructor(e){super(e);c(this,"context");c(this,"canvas");c(this,"pixelRatio");c(this,"clearColor");c(this,"renderToTextureActive",!1);c(this,"activeRttNode",null);c(this,"defShaderCtr");this.mode="canvas",this.shManager.renderer=this;const{canvas:r,pixelRatio:s,clearColor:i}=e;this.canvas=r,this.context=r.getContext("2d"),this.pixelRatio=s,this.clearColor=i?Fi(i):void 0,this.defShaderCtr={type:"DefaultShader",props:{},shader:new gn("DefaultShader"),getResolvedProps:()=>()=>({})}}reset(){this.canvas.width=this.canvas.width;const e=this.context;if(this.clearColor){const[r,s,i,o]=this.clearColor;e.fillStyle="rgba(".concat(r,", ").concat(s,", ").concat(i,", ").concat(o/255,")"),e.fillRect(0,0,this.canvas.width,this.canvas.height)}e.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(e){const r=this.context,{tx:s,ty:i,width:o,height:a,alpha:l,colorTl:h,colorTr:d,colorBr:f,ta:p,tb:v,tc:y,td:m,clippingRect:A}=e;let S=e.texture,x,b;if(S){if(S instanceof lt&&(b=S.props,S=S.parentTexture),x=S.ctxTexture,S.state==="freed"){x.load();return}if(S.state!=="loaded"||!x.hasImage())return}const g=Lr(h),T=p!==1,_=A.width!==0&&A.height!==0,C=h!==d||h!==f,I=e.shader?Vo(e):0;if((T||_||I)&&r.save(),_){const R=new Path2D,{x:B,y:w,width:N,height:P}=A;R.rect(B,w,N,P),r.clip(R)}if(T){const R=this.pixelRatio;r.setTransform(p,y,v,m,s*R,i*R),r.scale(R,R),r.translate(-s,-i)}if(I){const R=new Path2D;R.roundRect(s,i,o,a,I),r.clip(R)}if(x){const R=x.getImage(g);r.globalAlpha=l,b?r.drawImage(R,b.x,b.y,b.width,b.height,s,i,o,a):r.drawImage(R,s,i,o,a),r.globalAlpha=1}else if(C){let R=s,B=i,w;h===d?(R=s,B=i+a,w=Lr(f)):(R=s+o,B=i,w=Lr(d));const N=r.createLinearGradient(s,i,R,B);N.addColorStop(0,Jt(g)),N.addColorStop(1,Jt(w)),r.fillStyle=N,r.fillRect(s,i,o,a)}else r.fillStyle=Jt(g),r.fillRect(s,i,o,a);(T||_||I)&&r.restore()}createCtxTexture(e){return new Ho(this.txMemManager,e)}getShaderManager(){return this.shManager}getDefShaderCtr(){return this.defShaderCtr}renderRTTNodes(){}removeRTTNode(e){}renderToTexture(e){}getBufferInfo(){return null}}class $o extends Yr{constructor(e,r){super(e,r);c(this,"textRenderer");c(this,"trState");c(this,"_textRendererOverride",null);c(this,"onTextLoaded",()=>{const{contain:e}=this,r=this.trState.props.width,s=this.trState.props.height,i=this.trState.textW||0,o=this.trState.textH||0;e==="both"?(this.props.width=r,this.props.height=s):e==="width"?(this.props.width=r,this.props.height=o):e==="none"&&(this.props.width=i,this.props.height=o),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});c(this,"onTextFailed",(e,r)=>{this.emit("failed",{type:"text",error:r})});this._textRendererOverride=r.textRendererOverride;const{resolvedTextRenderer:s,textRendererState:i}=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:r.width,height:r.height,textAlign:r.textAlign,color:r.color,zIndex:r.zIndex,contain:r.contain,scrollable:r.scrollable,scrollY:r.scrollY,offsetY:r.offsetY,letterSpacing:r.letterSpacing,debug:r.debug,fontFamily:r.fontFamily,fontSize:r.fontSize,fontStretch:r.fontStretch,fontStyle:r.fontStyle,fontWeight:r.fontWeight,text:r.text,lineHeight:r.lineHeight,maxLines:r.maxLines,textBaseline:r.textBaseline,verticalAlign:r.verticalAlign,overflowSuffix:r.overflowSuffix});this.textRenderer=s,this.trState=i}get width(){return this.props.width}set width(e){this.props.width=e,this.textRenderer.set.width(this.trState,e),this.contain==="none"&&this.setUpdateType(F.Local)}get height(){return this.props.height}set height(e){this.props.height=e,this.textRenderer.set.height(this.trState,e),this.contain!=="both"&&this.setUpdateType(F.Local)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e,this.textRenderer.destroyState(this.trState);const{resolvedTextRenderer:r,textRendererState:s}=this.resolveTextRendererAndState(this.trState.props);this.textRenderer=r,this.trState=s}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(e){this.textRenderer.set.lineHeight&&this.textRenderer.set.lineHeight(this.trState,e)}get maxLines(){return this.trState.props.maxLines}set maxLines(e){this.textRenderer.set.maxLines&&this.textRenderer.set.maxLines(this.trState,e)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(e){this.textRenderer.set.textBaseline&&this.textRenderer.set.textBaseline(this.trState,e)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(e){this.textRenderer.set.verticalAlign&&this.textRenderer.set.verticalAlign(this.trState,e)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(e){this.textRenderer.set.overflowSuffix&&this.textRenderer.set.overflowSuffix(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,r){super.update(e,r),L(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkRenderProps(){return this.trState.props.text!==""?!0:super.checkRenderProps()}onChangeIsRenderable(e){super.onChangeIsRenderable(e),this.textRenderer.setIsRenderable(this.trState,e)}renderQuads(e){var r;if(L(this.globalTransform),!this.textRenderer.renderQuads){super.renderQuads(e);return}this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode)||(this.parentHasRenderTexture&&((r=this.props.parent)!=null&&r.rtt)&&(this.globalTransform=pe.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),L(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions))}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}resolveTextRendererAndState(e){const r=this.stage.resolveTextRenderer(e,this._textRendererOverride),s=r.createState(e,this);return s.emitter.on("loaded",this.onTextLoaded),s.emitter.on("failed",this.onTextFailed),r.scheduleUpdateState(s),{resolvedTextRenderer:r,textRendererState:s}}}function Go(n){const t={boolean:!0,string:!0,number:!0,undefined:!0},e=Object.keys(n);for(let r=0;r<e.length;r++){const s=e[r];if(!s)continue;const i=n[s],o=typeof i;o==="string"&&i.length>2048&&(console.warn("Custom Data value for ".concat(s," is too long, it will be truncated to 2048 characters")),n[s]=i.substring(0,2048)),t[o]||(console.warn("Custom Data value for ".concat(s," is not a boolean, string, or number, it will be ignored")),delete n[s])}return n}const Yo=2e6;class Ko{constructor(t){c(this,"options");c(this,"animationManager");c(this,"txManager");c(this,"txMemManager");c(this,"fontManager");c(this,"textRenderers");c(this,"shManager");c(this,"renderer");c(this,"root");c(this,"boundsMargin");c(this,"defShaderCtr");c(this,"eventBus");c(this,"deltaTime",0);c(this,"lastFrameTime",0);c(this,"currentFrameTime",0);c(this,"fpsNumFrames",0);c(this,"fpsElapsedTime",0);c(this,"renderRequested",!1);c(this,"frameEventQueue",[]);c(this,"contextSpy",null);this.options=t;const{canvas:e,clearColor:r,appWidth:s,appHeight:i,boundsMargin:o,enableContextSpy:a,numImageWorkers:l,textureMemory:h,renderMode:d}=t;this.eventBus=t.eventBus,this.txManager=new yo(l),this.txMemManager=new zo(this,h),this.shManager=new oo,this.animationManager=new go,this.contextSpy=a?new Uo:null;let f=[0,0,0,0];o&&(f=Array.isArray(o)?o:[o,o,o,o]),this.boundsMargin=f;const p={stage:this,canvas:e,pixelRatio:t.devicePhysicalPixelRatio*t.deviceLogicalPixelRatio,clearColor:r!=null?r:4278190080,bufferMemory:Yo,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy};d==="canvas"?this.renderer=new Xo(p):this.renderer=new mn(p),this.defShaderCtr=this.renderer.getDefShaderCtr(),Ci(d),this.txManager.renderer=this.renderer,this.textRenderers=d==="webgl"?{canvas:new Qn(this),sdf:new Po(this)}:{canvas:new Qn(this)},this.fontManager=new xn(this.textRenderers);const v=new Yr(this,{x:0,y:0,width:s,height:i,alpha:1,autosize:!1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1});this.root=v,Xi(this)}updateFrameTime(){const t=$i();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=t,this.deltaTime=this.lastFrameTime?t-this.lastFrameTime:100/6,this.txManager.frameTime=t,this.txMemManager.frameTime=t,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}updateAnimations(){const{animationManager:t}=this;this.root&&t.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested}drawFrame(){const{renderer:t,renderRequested:e}=this;L(t),this.root.updateType!==0&&this.root.update(this.deltaTime,this.root.clippingRect),t.reset(),this.txMemManager.criticalCleanupRequested&&this.txMemManager.cleanup(),t.rttNodes.length>0&&t.renderRTTNodes(),this.addQuads(this.root),t==null||t.render(),this.calculateFps(),e&&(this.renderRequested=!1)}queueFrameEvent(t,e){this.frameEventQueue.push([t,e])}flushFrameEvents(){for(const[t,e]of this.frameEventQueue)this.eventBus.emit(t,e);this.frameEventQueue=[]}calculateFps(){var e,r,s;const{fpsUpdateInterval:t}=this.options;if(t&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=t)){const i=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:i,contextSpyData:(r=(e=this.contextSpy)==null?void 0:e.getData())!=null?r:null}),(s=this.contextSpy)==null||s.reset()}}addQuads(t){L(this.renderer&&t.globalTransform),t.isRenderable&&t.renderQuads(this.renderer);for(let e=0;e<t.children.length;e++){const r=t.children[e];r&&(r==null?void 0:r.worldAlpha)!==0&&this.addQuads(r)}}requestRender(){this.renderRequested=!0}resolveTextRenderer(t,e=null){let r=e,s=!1;if(r){const o=this.textRenderers[r];o?o.canRenderFont(t)||(console.warn("Cannot use override text renderer '".concat(r,"' for font"),t),r=null,s=!0):(console.warn("Text renderer override '".concat(r,"' not found.")),r=null,s=!0)}if(!r){for(const[o,a]of Object.entries(this.textRenderers))if(o!=="canvas"&&a.canRenderFont(t)){r=o;break}r||(r="canvas")}s&&console.warn("Falling back to text renderer ".concat(String(r)));const i=this.textRenderers[r];return L(i,"resolvedTextRenderer undefined"),i}createShaderCtr(t,e){return this.shManager.loadShader(t,e)}createNode(t){const e=this.resolveNodeDefaults(t);return new Yr(this,e)}createTextNode(t){var s,i,o,a,l,h,d,f,p,v,y,m,A,S,x,b,g,T;const e=(s=t.fontSize)!=null?s:16,r={...this.resolveNodeDefaults(t),text:(i=t.text)!=null?i:"",textRendererOverride:(o=t.textRendererOverride)!=null?o:null,fontSize:e,fontFamily:(a=t.fontFamily)!=null?a:"sans-serif",fontStyle:(l=t.fontStyle)!=null?l:"normal",fontWeight:(h=t.fontWeight)!=null?h:"normal",fontStretch:(d=t.fontStretch)!=null?d:"normal",textAlign:(f=t.textAlign)!=null?f:"left",contain:(p=t.contain)!=null?p:"none",scrollable:(v=t.scrollable)!=null?v:!1,scrollY:(y=t.scrollY)!=null?y:0,offsetY:(m=t.offsetY)!=null?m:0,letterSpacing:(A=t.letterSpacing)!=null?A:0,lineHeight:t.lineHeight,maxLines:(S=t.maxLines)!=null?S:0,textBaseline:(x=t.textBaseline)!=null?x:"alphabetic",verticalAlign:(b=t.verticalAlign)!=null?b:"middle",overflowSuffix:(g=t.overflowSuffix)!=null?g:"...",debug:(T=t.debug)!=null?T:{},shaderProps:null};return new $o(this,r)}resolveNodeDefaults(t){var l,h,d,f,p,v,y,m,A,S,x,b,g,T,_,C,I,R,B,w,N,P,k,M,D,O,V,Y,z,re,ue,ie,Xe,_e,ge,de,Z,j,ee,J,$,fe,ce,he,Me,$e,Ge,ut,dt;const e=(l=t.color)!=null?l:4294967295,r=(f=(d=(h=t.colorTl)!=null?h:t.colorTop)!=null?d:t.colorLeft)!=null?f:e,s=(y=(v=(p=t.colorTr)!=null?p:t.colorTop)!=null?v:t.colorRight)!=null?y:e,i=(S=(A=(m=t.colorBl)!=null?m:t.colorBottom)!=null?A:t.colorLeft)!=null?S:e,o=(g=(b=(x=t.colorBr)!=null?x:t.colorBottom)!=null?b:t.colorRight)!=null?g:e,a=Go((T=t.data)!=null?T:{});return{x:(_=t.x)!=null?_:0,y:(C=t.y)!=null?C:0,width:(I=t.width)!=null?I:0,height:(R=t.height)!=null?R:0,alpha:(B=t.alpha)!=null?B:1,autosize:(w=t.autosize)!=null?w:!1,clipping:(N=t.clipping)!=null?N:!1,color:e,colorTop:(P=t.colorTop)!=null?P:e,colorBottom:(k=t.colorBottom)!=null?k:e,colorLeft:(M=t.colorLeft)!=null?M:e,colorRight:(D=t.colorRight)!=null?D:e,colorBl:i,colorBr:o,colorTl:r,colorTr:s,zIndex:(O=t.zIndex)!=null?O:0,zIndexLocked:(V=t.zIndexLocked)!=null?V:0,parent:(Y=t.parent)!=null?Y:null,texture:(z=t.texture)!=null?z:null,textureOptions:(re=t.textureOptions)!=null?re:{},shader:(ue=t.shader)!=null?ue:this.defShaderCtr,src:(ie=t.src)!=null?ie:null,scale:(Xe=t.scale)!=null?Xe:null,scaleX:(ge=(_e=t.scaleX)!=null?_e:t.scale)!=null?ge:1,scaleY:(Z=(de=t.scaleY)!=null?de:t.scale)!=null?Z:1,mount:(j=t.mount)!=null?j:0,mountX:(J=(ee=t.mountX)!=null?ee:t.mount)!=null?J:0,mountY:(fe=($=t.mountY)!=null?$:t.mount)!=null?fe:0,pivot:(ce=t.pivot)!=null?ce:.5,pivotX:(Me=(he=t.pivotX)!=null?he:t.pivot)!=null?Me:.5,pivotY:(Ge=($e=t.pivotY)!=null?$e:t.pivot)!=null?Ge:.5,rotation:(ut=t.rotation)!=null?ut:0,rtt:(dt=t.rtt)!=null?dt:!1,data:a}}}class Qo extends He{constructor(e,r){var m,A,S,x,b,g,T,_;super();c(this,"root");c(this,"canvas");c(this,"settings");c(this,"stage");c(this,"inspector",null);const s={criticalThreshold:((m=e.textureMemory)==null?void 0:m.criticalThreshold)||124e6,targetThresholdLevel:((A=e.textureMemory)==null?void 0:A.targetThresholdLevel)||.5,cleanupInterval:((S=e.textureMemory)==null?void 0:S.cleanupInterval)||3e4,debugLogging:((x=e.textureMemory)==null?void 0:x.debugLogging)||!1},i={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,textureMemory:s,boundsMargin:e.boundsMargin||0,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:(b=e.clearColor)!=null?b:0,fpsUpdateInterval:e.fpsUpdateInterval||0,numImageWorkers:e.numImageWorkers!==void 0?e.numImageWorkers:2,enableContextSpy:(g=e.enableContextSpy)!=null?g:!1,enableInspector:(T=e.enableInspector)!=null?T:!1,renderMode:(_=e.renderMode)!=null?_:"webgl"};this.settings=i;const{appWidth:o,appHeight:a,deviceLogicalPixelRatio:l,devicePhysicalPixelRatio:h,enableInspector:d}=i,f=o*l,p=a*l,v=document.createElement("canvas");this.canvas=v,v.width=f*h,v.height=p*h,v.style.width="".concat(f,"px"),v.style.height="".concat(p,"px"),this.stage=new Ko({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,fpsUpdateInterval:this.settings.fpsUpdateInterval,numImageWorkers:this.settings.numImageWorkers,renderMode:this.settings.renderMode,textureMemory:s,eventBus:this}),this.root=this.stage.root;let y;if(typeof r=="string"?y=document.getElementById(r):y=r,!y)throw new Error("Could not find target element");y.appendChild(v),d&&!fn()&&(this.inspector=new Vi(v,i))}createNode(e){L(this.stage,"Stage is not initialized");const r=this.stage.createNode(e);return this.inspector?this.inspector.createNode(r):r}createTextNode(e){const r=this.stage.createTextNode(e);return this.inspector?this.inspector.createTextNode(r):r}destroyNode(e){return this.inspector&&this.inspector.destroyNode(e.id),e.destroy()}createTexture(e,r){return this.stage.txManager.loadTexture(e,r)}createShader(e,r){return this.stage.shManager.loadShader(e,r)}createDynamicShader(e){return this.stage.shManager.loadDynamicShader({effects:e})}createEffect(e,r,s){return{name:s,type:e,props:r}}getNodeById(e){var i;const r=(i=this.stage)==null?void 0:i.root;if(!r)return null;const s=o=>{if(o.id===e)return o;for(const a of o.children){const l=s(a);if(l)return l}return null};return s(r)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){throw new Error("Not implemented")}}let Pe,yn;function jo(n={},t="app"){return Pe=new Qo(n,t),yn=Pe.createShader.bind(Pe),Pe}class qo extends Array{constructor(e){super();c(this,"_parent");this._parent=e}get selected(){return this[this._parent.selected||0]}get firstChild(){return this[0]}insert(e,r){if(r){const s=this.indexOf(r);this.splice(s,0,e)}else this.push(e);e.parent=this._parent}remove(e){const r=this.indexOf(e);r>=0&&this.splice(r,1)}}function Zo(){return!0&&!1}const Jo=Zo()||!1,ae={debug:!1,animationsEnabled:!0,animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100},setActiveElement:()=>{}};function jn(n){return ea(n)&&n.debug}function je(n,t,...e){Jo&&(ae.debug||jn(t)||jn(e[0]))&&console.log(n,t,...e)}const ve=n=>n instanceof Function;function ea(n){return typeof n=="object"}function Ct(n){return Array.isArray(n)}function ta(n){return typeof n=="string"}function ra(n){return typeof n=="number"}function na(n){return Number.isInteger(n)}function sa(n){return"destroy"in n&&typeof n.destroy=="function"}function kr(n){return n instanceof We}function ia(n,t){for(const e of t)if(e in n)return!0;return!1}function Es(n,t={}){if(Ct(n))n.forEach(e=>{Es(e,t)});else if(n)for(const e in n)t[e]===void 0&&(t[e]=n[e]);return t}class qn extends Array{constructor(e,r={}){var t=(...Pu)=>(super(...Pu),c(this,"onChange"),this);return Ct(r)?t(...r):ta(r)?t(r):t(...Object.entries(r).filter(([s,i])=>i).map(([s])=>s)),this.onChange=e,this}has(e){return this.indexOf(e)>=0}is(e){return this.indexOf(e)>=0}add(e){this.push(e),this.onChange()}toggle(e,r){r===!0?this.has(e)||this.add(e):r===!1?this.has(e)&&this.remove(e):this.has(e)?this.remove(e):this.add(e)}remove(e){const r=this.indexOf(e);r>=0&&(this.splice(r,1),this.onChange())}}const Ue={Element:"element",TextNode:"textNode",Text:"text"};function oa(n){const t=[];let e=!1,r=0;for(let g=0;g<n.children.length;g++){const T=n.children[g];if(T._type!==Ue.Text&&T.flexItem!==!1){if(T._type===Ue.TextNode&&T.text&&!(T.width||T.height))return!1;T.flexOrder!==void 0&&(e=!0),T.flexGrow!==void 0&&(r+=T.flexGrow),t.push(T)}}e&&t.sort((g,T)=>(g.flexOrder||0)-(T.flexOrder||0));const s=t.length,o=(n.flexDirection||"row")==="row",a=o?"width":"height",l=o?"height":"width",h=o?"marginLeft":"marginTop",d=o?"marginRight":"marginBottom",f=o?"x":"y",p=o?"y":"x",v=n[a]||0,y=n[l]||0,m=n.gap||0,A=n.justifyContent||"flexStart",S=n.alignItems;if(r){const g=t.reduce((_,C)=>_+(C.flexGrow?0:C[a]||0)+(C[h]||0)+(C[d]||0),0),T=(v-g-m*(s-1))/r;for(let _=0;_<t.length;_++){const C=t[_];C.flexGrow!==void 0&&C.flexGrow>0&&(C[a]=C.flexGrow*T)}}let x=0;["center","spaceBetween","spaceEvenly"].includes(A)&&(x=t.reduce((g,T)=>g+(T[a]||0)+(T[h]||0)+(T[d]||0),0));const b=y&&S?g=>{S==="flexStart"?g[p]=0:S==="center"?g[p]=(y-(g[l]||0))/2:S==="flexEnd"&&(g[p]=y-(g[l]||0))}:g=>g;if(A==="flexStart"){let g=0;for(let T=0;T<t.length;T++){const _=t[T];_[f]=g+(_[h]||0),g+=(_[a]||0)+m+(_[h]||0)+(_[d]||0),b(_)}if(n.flexBoundary!=="fixed"){const T=g-m;if(T!==n[a])return n[a]=T,!0}}else if(A==="flexEnd"){let g=v;for(let T=s-1;T>=0;T--){const _=t[T];_[f]=g-(_[a]||0)-(_[d]||0),g-=(_[a]||0)+m+(_[h]||0)+(_[d]||0),b(_)}if(n.flexBoundary!=="fixed"){const T=g-m;if(T!==n[a])return n[a]=T,!0}}else if(A==="center"){let g=(v-(x+m*(s-1)))/2;for(let T=0;T<t.length;T++){const _=t[T];_[f]=g+(_[h]||0),g+=(_[a]||0)+m+(_[h]||0)+(_[d]||0),b(_)}}else if(A==="spaceBetween"){const g=(v-x)/(s-1);let T=0;for(let _=0;_<t.length;_++){const C=t[_];C[f]=T+(C[h]||0),T+=(C[a]||0)+g+(C[h]||0)+(C[d]||0),b(C)}}else if(A==="spaceEvenly"){const g=(v-x)/(s+1);let T=g;for(let _=0;_<t.length;_++){const C=t[_];C[f]=T+(C[h]||0),T+=(C[a]||0)+g+(C[h]||0)+(C[d]||0),b(C)}}return!1}const Ht=new Set;let Pr=!0;function Zn(n){const t=[];let e=0;for(const[r,s]of Object.entries(n))t.push({name:"el".concat(e),type:r,props:s}),e++;return yn("DynamicShader",{effects:t})}function ft(n=""){return{set(t){ra(t)&&(t={width:t,color:255}),this.effects=this.effects?{...this.effects||{},["border".concat(n)]:t}:{["border".concat(n)]:t}},get(){var t;return(t=this.effects)==null?void 0:t["border".concat(n)]}}}const aa=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","width","worldX","worldY","x","y","zIndex","zIndexLocked"],la=["absX","absY","autosize","clipping","contain","fontFamily","fontStretch","fontStyle","fontWeight","letterSpacing","maxLines","offsetY","overflowSuffix","rtt","scrollable","scrollY","src","text","textAlign","textBaseline","textOverflow","texture","verticalAlign","wordWrap"];class We extends Object{constructor(t){super(),this._type=t==="text"?Ue.TextNode:Ue.Element,this.rendered=!1,this.lng={},this.children=new qo(this)}get effects(){return this._effects}set effects(t){this._effects=t,this.rendered&&(this.shader=Zn(t))}get parent(){return this._parent}set parent(t){var e;this._parent=t,this.rendered&&(this.lng.parent=(e=t==null?void 0:t.lng)!=null?e:null)}set shader(t){let e=t;Ct(t)&&(e=yn(...t)),this.lng.shader=e}_sendToLightningAnimatable(t,e){if(this.transition&&this.rendered&&ae.animationsEnabled&&(this.transition===!0||this.transition[t])){const r=this.transition===!0||this.transition[t]===!0?void 0:this.transition[t],s=this.animate({[t]:e},r);return ve(this.onAnimationStarted)&&s.once("animating",i=>{var o;(o=this.onAnimationStarted)==null||o.call(this,i,t,e)}),ve(this.onAnimationFinished)&&s.once("stopped",i=>{var o;(o=this.onAnimationFinished)==null||o.call(this,i,t,e)}),s.start()}this.lng[t]=e}animate(t,e){return L(this.rendered,"Node must be rendered before animating"),this.lng.animate(t,e||this.animationSettings)}chain(t,e){return this._animationRunning&&(this._animationQueue=[],this._animationRunning=!1),e?this._animationQueueSettings=e:this._animationQueueSettings||(this._animationQueueSettings=e||this.animationSettings),e=e||this._animationQueueSettings,this._animationQueue=this._animationQueue||[],this._animationQueue.push({props:t,animationSettings:e}),this}async start(){let t=this._animationQueue.shift();for(;t;)this._animationRunning=!0,await this.animate(t.props,t.animationSettings).start().waitUntilStopped(),t=this._animationQueue.shift();this._animationRunning=!1,this._animationQueueSettings=void 0}setFocus(){if(this.rendered){if(this.forwardFocus!==void 0)if(ve(this.forwardFocus)){if(this.forwardFocus.call(this,this)!==!1)return}else{const t=typeof this.forwardFocus=="number"?this.forwardFocus:null;if(t!==null&&t<this.children.length){const e=this.children[t];kr(e)&&e.setFocus();return}}queueMicrotask(()=>ae.setActiveElement(this))}else this.autofocus=!0}isTextNode(){return this._type===Ue.TextNode}_layoutOnLoad(){this.lng.on("loaded",(t,e)=>{const{dimensions:r}=e;this.parent.updateLayout(this,r)})}getText(){let t="";for(let e=0;e<this.children.length;e++)t+=this.children[e].text;return t}destroy(){this._queueDelete&&sa(this.lng)&&this.lng.destroy()}set onEvents(t){this._events=t}get onEvents(){return this._events}set style(t){Ct(t)?this._style=Es(t):this._style=t;for(const e in this._style)this[e]===void 0&&(this[e]=this._style[e])}get style(){return this._style}get hasChildren(){return this.children.length>0}getChildById(t){return this.children.find(e=>e.id===t)}searchChildrenById(t){for(let e=0;e<this.children.length;e++){const r=this.children[e];if(kr(r)){if(r.id===t)return r;const s=r.searchChildrenById(t);if(s)return s}}}set states(t){this._states=new qn(this._stateChanged.bind(this),t),this.rendered&&this._stateChanged()}get states(){return this._states=this._states||new qn(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||ae.animationSettings}set animationSettings(t){this._animationSettings=t}requiresLayout(){return this.display==="flex"||this.onBeforeLayout}updateLayout(t,e){var r,s;if(this.hasChildren){je("Layout: ",this);let i=!1;ve(this.onBeforeLayout)&&(i=this.onBeforeLayout.call(this,this,t,e)||!1),this.display==="flex"?(oa(this)||i)&&((r=this.parent)==null||r.updateLayout()):i&&((s=this.parent)==null||s.updateLayout()),ve(this.onLayout)&&this.onLayout.call(this,this,t,e)}}_stateChanged(){if(je("State Changed: ",this,this.states),this.forwardStates){const e=this.states.slice();this.children.forEach(r=>{r.states=e})}const t=this.states;if(this._undoStyles||this.style&&ia(this.style,t)){this._undoStyles=this._undoStyles||[];const e={};this._undoStyles.forEach(s=>{e[s]=this.style[s]});const r=t.reduce((s,i)=>{const o=this.style[i];return o&&(s={...s,...o}),s},{});this._undoStyles=Object.keys(r),r.transition!==void 0&&(this.transition=r.transition),Object.assign(this,e,r)}}render(){var s;const t=this,e=this.parent;if(!e){console.warn("Parent not set - no node created for: ",this);return}if(!e.rendered){console.warn("Parent not rendered yet: ",this);return}if(this.rendered){console.warn("Node already rendered: ",this);return}e.requiresLayout()&&!Ht.has(e)&&(Ht.add(e),Pr&&(Pr=!1,queueMicrotask(()=>{Pr=!0;const i=[...Ht];Ht.clear();for(let o=i.length-1;o>=0;o--)i[o].updateLayout()}))),this._states&&this._stateChanged();const r=t.lng;if(r.x=r.x||0,r.y=r.y||0,e.rendered&&(r.parent=e.lng),t._effects&&(r.shader=Zn(t._effects)),t.isTextNode()){const i=r;if(ae.fontSettings)for(const o in ae.fontSettings)i[o]===void 0&&(i[o]=ae.fontSettings[o]);i.text=i.text||t.getText(),i.textAlign&&!i.contain&&console.warn("Text align requires contain: ",t.getText()),i.contain&&(i.width||(i.width=(e.width||0)-i.x-(i.marginRight||0)),i.contain==="both"&&!i.height&&!i.maxLines?i.height=(e.height||0)-i.y-(i.marginBottom||0):i.maxLines===1&&(i.height=i.height||i.lineHeight||i.fontSize)),je("Rendering: ",this,r),t.lng=Pe.createTextNode(r),e.requiresLayout()&&(!r.width||!r.height)&&t._layoutOnLoad()}else r.texture||(isNaN(r.width)&&(r.width=(e.width||0)-r.x),isNaN(r.height)&&(r.height=(e.height||0)-r.y),r.rtt&&!r.color&&(r.color=4294967295),!r.color&&!r.src&&(r.color=0)),je("Rendering: ",this,r),t.lng=Pe.createNode(r);if(t.rendered=!0,t.autosize&&e.requiresLayout()&&t._layoutOnLoad(),t.onFail&&t.lng.on("failed",t.onFail),t.onLoad&&t.lng.on("loaded",t.onLoad),ve(this.onCreate)&&this.onCreate.call(this,t),t.onEvents&&t.onEvents.forEach(([i,o])=>{t.lng.on(i,(a,l)=>o(t,l))}),(s=t.lng)!=null&&s.div&&(t.lng.div.element=t),t._type===Ue.Element)for(let i=0;i<t.children.length;i++){const o=t.children[i];L(o,"Child is undefined"),kr(o)?o.render():o.text&&o._type===Ue.Text&&console.warn("TextNode outside of <Text>: ",o)}t.autofocus&&t.setFocus()}}for(const n of aa)Object.defineProperty(We.prototype,n,{get(){return this.lng[n]},set(t){this._sendToLightningAnimatable(n,t)}});for(const n of la)Object.defineProperty(We.prototype,n,{get(){return this.lng[n]},set(t){this.lng[n]=t}});Object.defineProperties(We.prototype,{borderRadius:{set(n){this.effects=this.effects?{...this.effects,radius:{radius:n}}:{radius:{radius:n}}},get(){var n,t;return(t=(n=this.effects)==null?void 0:n.radius)==null?void 0:t.radius}},border:ft(),borderLeft:ft("Left"),borderRight:ft("Right"),borderTop:ft("Top"),borderBottom:ft("Bottom"),linearGradient:{set(n={}){this.effects=this.effects?{...this.effects,linearGradient:n}:{linearGradient:n}},get(){var n;return(n=this.effects)==null?void 0:n.linearGradient}}});const K={context:void 0,registry:void 0};function vt(n){K.context=n}const Is=(n,t)=>n===t,ir=Symbol("solid-proxy"),Bs=Symbol("solid-track"),or={equals:Is};let Fs=zs;const Se=1,ar=2,Ms={owned:null,cleanups:null,context:null,owner:null},Nr={};var W=null;let Dr=null,ca=null,X=null,le=null,Be=null,Ar=0;function Ne(n,t){const e=X,r=W,s=n.length===0,i=t===void 0?r:t,o=s?Ms:{owned:null,cleanups:null,context:i?i.context:null,owner:i},a=s?n:()=>n(()=>te(()=>Tr(o)));W=o,X=null;try{return Fe(a,!0)}finally{X=e,W=r}}function H(n,t){t=t?Object.assign({},or,t):or;const e={value:n,observers:null,observerSlots:null,comparator:t.equals||void 0},r=s=>(typeof s=="function"&&(s=s(e.value)),Us(e,s));return[Os.bind(e),r]}function en(n,t,e){const r=Bt(n,t,!0,Se);Je(r)}function Ie(n,t,e){const r=Bt(n,t,!1,Se);Je(r)}function De(n,t,e){Fs=ma;const r=Bt(n,t,!1,Se);r.user=!0,Be?Be.push(r):Je(r)}function Q(n,t,e){e=e?Object.assign({},or,e):or;const r=Bt(n,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=e.equals||void 0,Je(r),Os.bind(r)}function ha(n){return n&&typeof n=="object"&&"then"in n}function Ls(n,t,e){let r,s,i;arguments.length===2&&typeof t=="object"||arguments.length===1?(r=!0,s=n,i=t||{}):(r=n,s=t,i={});let o=null,a=Nr,l=null,h=!1,d="initialValue"in i,f=typeof r=="function"&&Q(r);const p=new Set,[v,y]=(i.storage||H)(i.initialValue),[m,A]=H(void 0),[S,x]=H(void 0,{equals:!1}),[b,g]=H(d?"ready":"unresolved");if(K.context){l="".concat(K.context.id).concat(K.context.count++);let R;i.ssrLoadFrom==="initial"?a=i.initialValue:K.load&&(R=K.load(l))&&(a=R)}function T(R,B,w,N){return o===R&&(o=null,N!==void 0&&(d=!0),(R===a||B===a)&&i.onHydrated&&queueMicrotask(()=>i.onHydrated(N,{value:B})),a=Nr,_(B,w)),B}function _(R,B){Fe(()=>{B===void 0&&y(()=>R),g(B!==void 0?"errored":d?"ready":"unresolved"),A(B);for(const w of p.keys())w.decrement();p.clear()},!1)}function C(){const R=fa,B=v(),w=m();if(w!==void 0&&!o)throw w;return X&&!X.user&&R&&en(()=>{S(),o&&(R.resolved||p.has(R)||(R.increment(),p.add(R)))}),B}function I(R=!0){if(R!==!1&&h)return;h=!1;const B=f?f():r;if(B==null||B===!1){T(o,te(v));return}const w=a!==Nr?a:te(()=>s(B,{value:v(),refetching:R}));return ha(w)?(o=w,"value"in w?(w.status==="success"?T(o,w.value,void 0,B):T(o,void 0,void 0,B),w):(h=!0,queueMicrotask(()=>h=!1),Fe(()=>{g(d?"refreshing":"pending"),x()},!1),w.then(N=>T(w,N,void 0,B),N=>T(w,void 0,Hs(N),B)))):(T(o,w,void 0,B),w)}return Object.defineProperties(C,{state:{get:()=>b()},error:{get:()=>m()},loading:{get(){const R=b();return R==="pending"||R==="refreshing"}},latest:{get(){if(!d)return C();const R=m();if(R&&!o)throw R;return v()}}}),f?en(()=>I(!1)):I(!1),[C,{refetch:I,mutate:y}]}function ua(n,t=Is,e){const r=new Map,s=Bt(i=>{const o=n();for(const[a,l]of r.entries())if(t(a,o)!==t(a,i))for(const h of l.values())h.state=Se,h.pure?le.push(h):Be.push(h);return o},void 0,!0,Se);return Je(s),i=>{const o=X;if(o){let a;(a=r.get(i))?a.add(o):r.set(i,a=new Set([o])),be(()=>{a.delete(o),!a.size&&r.delete(i)})}return t(i,s.value)}}function vn(n){return Fe(n,!1)}function te(n){if(X===null)return n();const t=X;X=null;try{return n()}finally{X=t}}function qe(n,t,e){const r=Array.isArray(n);let s,i=e&&e.defer;return o=>{let a;if(r){a=Array(n.length);for(let h=0;h<n.length;h++)a[h]=n[h]()}else a=n();if(i)return i=!1,o;const l=te(()=>t(a,s,o));return s=a,l}}function lu(n){De(()=>te(n))}function be(n){return W===null||(W.cleanups===null?W.cleanups=[n]:W.cleanups.push(n)),n}function ks(){return X}function Ze(){return W}function Ps(n,t){const e=W,r=X;W=n,X=null;try{return Fe(t,!0)}catch(s){An(s)}finally{W=e,X=r}}function da(n){const t=X,e=W;return Promise.resolve().then(()=>{X=t,W=e;let r;return Fe(n,!1),X=W=null,r?r.done:void 0})}function Ns(n,t){const e=Symbol("context");return{id:e,Provider:xa(e),defaultValue:n}}function Ds(n){return W&&W.context&&W.context[n.id]!==void 0?W.context[n.id]:n.defaultValue}function bn(n){const t=Q(n),e=Q(()=>tn(t()));return e.toArray=()=>{const r=e();return Array.isArray(r)?r:r!=null?[r]:[]},e}let fa;function Os(){if(this.sources&&this.state)if(this.state===Se)Je(this);else{const n=le;le=null,Fe(()=>cr(this),!1),le=n}if(X){const n=this.observers?this.observers.length:0;X.sources?(X.sources.push(this),X.sourceSlots.push(n)):(X.sources=[this],X.sourceSlots=[n]),this.observers?(this.observers.push(X),this.observerSlots.push(X.sources.length-1)):(this.observers=[X],this.observerSlots=[X.sources.length-1])}return this.value}function Us(n,t,e){let r=n.value;return(!n.comparator||!n.comparator(r,t))&&(n.value=t,n.observers&&n.observers.length&&Fe(()=>{for(let s=0;s<n.observers.length;s+=1){const i=n.observers[s],o=Dr&&Dr.running;o&&Dr.disposed.has(i),(o?!i.tState:!i.state)&&(i.pure?le.push(i):Be.push(i),i.observers&&Ws(i)),o||(i.state=Se)}if(le.length>1e6)throw le=[],new Error},!1)),t}function Je(n){if(!n.fn)return;Tr(n);const t=Ar;pa(n,n.value,t)}function pa(n,t,e){let r;const s=W,i=X;X=W=n;try{r=n.fn(t)}catch(o){return n.pure&&(n.state=Se,n.owned&&n.owned.forEach(Tr),n.owned=null),n.updatedAt=e+1,An(o)}finally{X=i,W=s}(!n.updatedAt||n.updatedAt<=e)&&(n.updatedAt!=null&&"observers"in n?Us(n,r):n.value=r,n.updatedAt=e)}function Bt(n,t,e,r=Se,s){const i={fn:n,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:W,context:W?W.context:null,pure:e};return W===null||W!==Ms&&(W.owned?W.owned.push(i):W.owned=[i]),i}function lr(n){if(n.state===0)return;if(n.state===ar)return cr(n);if(n.suspense&&te(n.suspense.inFallback))return n.suspense.effects.push(n);const t=[n];for(;(n=n.owner)&&(!n.updatedAt||n.updatedAt<Ar);)n.state&&t.push(n);for(let e=t.length-1;e>=0;e--)if(n=t[e],n.state===Se)Je(n);else if(n.state===ar){const r=le;le=null,Fe(()=>cr(n,t[0]),!1),le=r}}function Fe(n,t){if(le)return n();let e=!1;t||(le=[]),Be?e=!0:Be=[],Ar++;try{const r=n();return ga(e),r}catch(r){e||(Be=null),le=null,An(r)}}function ga(n){if(le&&(zs(le),le=null),n)return;const t=Be;Be=null,t.length&&Fe(()=>Fs(t),!1)}function zs(n){for(let t=0;t<n.length;t++)lr(n[t])}function ma(n){let t,e=0;for(t=0;t<n.length;t++){const r=n[t];r.user?n[e++]=r:lr(r)}if(K.context){if(K.count){K.effects||(K.effects=[]),K.effects.push(...n.slice(0,e));return}else K.effects&&(n=[...K.effects,...n],e+=K.effects.length,delete K.effects);vt()}for(t=0;t<e;t++)lr(n[t])}function cr(n,t){n.state=0;for(let e=0;e<n.sources.length;e+=1){const r=n.sources[e];if(r.sources){const s=r.state;s===Se?r!==t&&(!r.updatedAt||r.updatedAt<Ar)&&lr(r):s===ar&&cr(r,t)}}}function Ws(n){for(let t=0;t<n.observers.length;t+=1){const e=n.observers[t];e.state||(e.state=ar,e.pure?le.push(e):Be.push(e),e.observers&&Ws(e))}}function Tr(n){let t;if(n.sources)for(;n.sources.length;){const e=n.sources.pop(),r=n.sourceSlots.pop(),s=e.observers;if(s&&s.length){const i=s.pop(),o=e.observerSlots.pop();r<s.length&&(i.sourceSlots[o]=r,s[r]=i,e.observerSlots[r]=o)}}if(n.owned){for(t=n.owned.length-1;t>=0;t--)Tr(n.owned[t]);n.owned=null}if(n.cleanups){for(t=n.cleanups.length-1;t>=0;t--)n.cleanups[t]();n.cleanups=null}n.state=0}function Hs(n){return n instanceof Error?n:new Error(typeof n=="string"?n:"Unknown error",{cause:n})}function An(n,t=W){throw Hs(n)}function tn(n){if(typeof n=="function"&&!n.length)return tn(n());if(Array.isArray(n)){const t=[];for(let e=0;e<n.length;e++){const r=tn(n[e]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return n}function xa(n,t){return function(r){let s;return Ie(()=>s=te(()=>(W.context={...W.context,[n]:r.value},bn(()=>r.children))),void 0),s}}const rn=Symbol("fallback");function hr(n){for(let t=0;t<n.length;t++)n[t]()}function ya(n,t,e={}){let r=[],s=[],i=[],o=0,a=t.length>1?[]:null;return be(()=>hr(i)),()=>{let l=n()||[],h,d;return l[Bs],te(()=>{let p=l.length,v,y,m,A,S,x,b,g,T;if(p===0)o!==0&&(hr(i),i=[],r=[],s=[],o=0,a&&(a=[])),e.fallback&&(r=[rn],s[0]=Ne(_=>(i[0]=_,e.fallback())),o=1);else if(o===0){for(s=new Array(p),d=0;d<p;d++)r[d]=l[d],s[d]=Ne(f);o=p}else{for(m=new Array(p),A=new Array(p),a&&(S=new Array(p)),x=0,b=Math.min(o,p);x<b&&r[x]===l[x];x++);for(b=o-1,g=p-1;b>=x&&g>=x&&r[b]===l[g];b--,g--)m[g]=s[b],A[g]=i[b],a&&(S[g]=a[b]);for(v=new Map,y=new Array(g+1),d=g;d>=x;d--)T=l[d],h=v.get(T),y[d]=h===void 0?-1:h,v.set(T,d);for(h=x;h<=b;h++)T=r[h],d=v.get(T),d!==void 0&&d!==-1?(m[d]=s[h],A[d]=i[h],a&&(S[d]=a[h]),d=y[d],v.set(T,d)):i[h]();for(d=x;d<p;d++)d in m?(s[d]=m[d],i[d]=A[d],a&&(a[d]=S[d],a[d](d))):s[d]=Ne(f);s=s.slice(0,o=p),r=l.slice(0)}return s});function f(p){if(i[d]=p,a){const[v,y]=H(d);return a[d]=y,t(l[d],v)}return t(l[d])}}}function va(n,t,e={}){let r=[],s=[],i=[],o=[],a=0,l;return be(()=>hr(i)),()=>{const h=n()||[];return h[Bs],te(()=>{if(h.length===0)return a!==0&&(hr(i),i=[],r=[],s=[],a=0,o=[]),e.fallback&&(r=[rn],s[0]=Ne(f=>(i[0]=f,e.fallback())),a=1),s;for(r[0]===rn&&(i[0](),i=[],r=[],s=[],a=0),l=0;l<h.length;l++)l<r.length&&r[l]!==h[l]?o[l](()=>h[l]):l>=r.length&&(s[l]=Ne(d));for(;l<r.length;l++)i[l]();return a=o.length=i.length=h.length,r=h.slice(0),s=s.slice(0,a)});function d(f){i[l]=f;const[p,v]=H(h[l]);return o[l]=v,t(p,l)}}}function Vs(n,t){return te(()=>n(t||{}))}function Vt(){return!0}const nn={get(n,t,e){return t===ir?e:n.get(t)},has(n,t){return t===ir?!0:n.has(t)},set:Vt,deleteProperty:Vt,getOwnPropertyDescriptor(n,t){return{configurable:!0,enumerable:!0,get(){return n.get(t)},set:Vt,deleteProperty:Vt}},ownKeys(n){return n.keys()}};function Or(n){return(n=typeof n=="function"?n():n)?n:{}}function ba(){for(let n=0,t=this.length;n<t;++n){const e=this[n]();if(e!==void 0)return e}}function Tn(...n){let t=!1;for(let o=0;o<n.length;o++){const a=n[o];t=t||!!a&&ir in a,n[o]=typeof a=="function"?(t=!0,Q(a)):a}if(t)return new Proxy({get(o){for(let a=n.length-1;a>=0;a--){const l=Or(n[a])[o];if(l!==void 0)return l}},has(o){for(let a=n.length-1;a>=0;a--)if(o in Or(n[a]))return!0;return!1},keys(){const o=[];for(let a=0;a<n.length;a++)o.push(...Object.keys(Or(n[a])));return[...new Set(o)]}},nn);const e={},r=Object.create(null);for(let o=n.length-1;o>=0;o--){const a=n[o];if(!a)continue;const l=Object.getOwnPropertyNames(a);for(let h=l.length-1;h>=0;h--){const d=l[h];if(d==="__proto__"||d==="constructor")continue;const f=Object.getOwnPropertyDescriptor(a,d);if(!r[d])r[d]=f.get?{enumerable:!0,configurable:!0,get:ba.bind(e[d]=[f.get.bind(a)])}:f.value!==void 0?f:void 0;else{const p=e[d];p&&(f.get?p.push(f.get.bind(a)):f.value!==void 0&&p.push(()=>f.value))}}}const s={},i=Object.keys(r);for(let o=i.length-1;o>=0;o--){const a=i[o],l=r[a];l&&l.get?Object.defineProperty(s,a,l):s[a]=l?l.value:void 0}return s}function Aa(n,...t){if(ir in n){const s=new Set(t.length>1?t.flat():t[0]),i=t.map(o=>new Proxy({get(a){return o.includes(a)?n[a]:void 0},has(a){return o.includes(a)&&a in n},keys(){return o.filter(a=>a in n)}},nn));return i.push(new Proxy({get(o){return s.has(o)?void 0:n[o]},has(o){return s.has(o)?!1:o in n},keys(){return Object.keys(n).filter(o=>!s.has(o))}},nn)),i}const e={},r=t.map(()=>({}));for(const s of Object.getOwnPropertyNames(n)){const i=Object.getOwnPropertyDescriptor(n,s),o=!i.get&&!i.set&&i.enumerable&&i.writable&&i.configurable;let a=!1,l=0;for(const h of t)h.includes(s)&&(a=!0,o?r[l][s]=i.value:Object.defineProperty(r[l],s,i)),++l;a||(o?e[s]=i.value:Object.defineProperty(e,s,i))}return[...r,e]}function ye(n){let t,e;const r=s=>{const i=K.context;if(i){const[a,l]=H();K.count||(K.count=0),K.count++,(e||(e=n())).then(h=>{vt(i),K.count--,l(()=>h.default),vt()}),t=a}else if(!t){const[a]=Ls(()=>(e||(e=n())).then(l=>l.default));t=a}let o;return Q(()=>(o=t())&&te(()=>{if(!i)return o(s);const a=K.context;vt(i);const l=o(s);return vt(a),l}))};return r.preload=()=>e||((e=n()).then(s=>t=()=>s.default),e),r}const Ta=n=>"Stale read from <".concat(n,">.");function wn(n){const t="fallback"in n&&{fallback:()=>n.fallback};return Q(ya(()=>n.each,n.children,t||void 0))}function cu(n){const t="fallback"in n&&{fallback:()=>n.fallback};return Q(va(()=>n.each,n.children,t||void 0))}function wr(n){const t=n.keyed,e=Q(()=>n.when,void 0,{equals:(r,s)=>t?r===s:!r==!s});return Q(()=>{const r=e();if(r){const s=n.children;return typeof s=="function"&&s.length>0?te(()=>s(t?r:()=>{if(!te(e))throw Ta("Show");return n.when})):s}return n.fallback},void 0,void 0)}const wa=void 0,[Sr,Xs]=H(void 0);ae.setActiveElement=Xs;function ur(n=""){return na(n)?n:typeof n=="string"?n.startsWith("#")?+(n.replace("#","0x")+(n.length===7?"ff":"")):n.startsWith("0x")?Number(n):+("0x"+(n.length===6?n+"ff":n)):0}function Sa({createElement:n,createTextNode:t,isTextNode:e,replaceText:r,insertNode:s,removeNode:i,setProperty:o,getParentNode:a,getFirstChild:l,getNextSibling:h}){function d(x,b,g,T){if(g!==void 0&&!T&&(T=[]),typeof b!="function")return f(x,b,T,g);Ie(_=>f(x,b(),_,g),T)}function f(x,b,g,T,_){for(;typeof g=="function";)g=g();if(b===g)return g;const C=typeof b,I=T!==void 0;if(C==="string"||C==="number")if(C==="number"&&(b=b.toString()),I){let R=g[0];R&&e(R)?r(R,b):R=t(b),g=y(x,g,T,R)}else g!==""&&typeof g=="string"?r(l(x),g=b):(y(x,g,T,t(b)),g=b);else if(b==null||C==="boolean")g=y(x,g,T);else{if(C==="function")return Ie(()=>{let R=b();for(;typeof R=="function";)R=R();g=f(x,R,g,T)}),()=>g;if(Array.isArray(b)){const R=[];if(p(R,b,_))return Ie(()=>g=f(x,R,g,T,!0)),()=>g;if(R.length===0){const B=y(x,g,T);if(I)return g=B}else Array.isArray(g)?g.length===0?m(x,R,T):v(x,g,R):g==null||g===""?m(x,R):v(x,I&&g||[l(x)],R);g=R}else{if(Array.isArray(g)){if(I)return g=y(x,g,T,b);y(x,g,null,b)}else g==null||g===""||!l(x)?s(x,b):A(x,b,l(x));g=b}}return g}function p(x,b,g){let T=!1;for(let _=0,C=b.length;_<C;_++){let I=b[_],R;if(!(I==null||I===!0||I===!1))if(Array.isArray(I))T=p(x,I)||T;else if((R=typeof I)=="string"||R==="number")x.push(t(I));else if(R==="function")if(g){for(;typeof I=="function";)I=I();T=p(x,Array.isArray(I)?I:[I])||T}else x.push(I),T=!0;else x.push(I)}return T}function v(x,b,g){let T=g.length,_=b.length,C=T,I=0,R=0,B=h(b[_-1]),w=null;for(;I<_||R<C;){if(b[I]===g[R]){I++,R++;continue}for(;b[_-1]===g[C-1];)_--,C--;if(_===I){const N=C<T?R?h(g[R-1]):g[C-R]:B;for(;R<C;)s(x,g[R++],N)}else if(C===R)for(;I<_;)(!w||!w.has(b[I]))&&i(x,b[I]),I++;else if(b[I]===g[C-1]&&g[R]===b[_-1]){const N=h(b[--_]);s(x,g[R++],h(b[I++])),s(x,g[--C],N),b[_]=g[C]}else{if(!w){w=new Map;let P=R;for(;P<C;)w.set(g[P],P++)}const N=w.get(b[I]);if(N!=null)if(R<N&&N<C){let P=I,k=1,M;for(;++P<_&&P<C&&!((M=w.get(b[P]))==null||M!==N+k);)k++;if(k>N-R){const D=b[I];for(;R<N;)s(x,g[R++],D)}else A(x,g[R++],b[I++])}else I++;else i(x,b[I++])}}}function y(x,b,g,T){if(g===void 0){let C;for(;C=l(x);)i(x,C);return T&&s(x,T),""}const _=T||t("");if(b.length){let C=!1;for(let I=b.length-1;I>=0;I--){const R=b[I];if(_!==R){const B=a(R)===x;!C&&!I?B?A(x,_,R):s(x,_,g):B&&i(x,R)}else C=!0}}else s(x,_,g);return[_]}function m(x,b,g){for(let T=0,_=b.length;T<_;T++)s(x,b[T],g)}function A(x,b,g){s(x,b,g),i(x,g)}function S(x,b,g={},T){return b||(b={}),T||Ie(()=>g.children=f(x,b.children,g.children)),Ie(()=>b.ref&&b.ref(x)),Ie(()=>{for(const _ in b){if(_==="children"||_==="ref")continue;const C=b[_];C!==g[_]&&(o(x,_,C,g[_]),g[_]=C)}}),g}return{render(x,b){let g;return Ne(T=>{g=T,d(b,x())}),g},insert:d,spread(x,b,g){typeof b=="function"?Ie(T=>S(x,b(),T,g)):S(x,b,void 0,g)},createElement:n,createTextNode:t,insertNode:s,setProp(x,b,g,T){return o(x,b,g,T),g},mergeProps:Tn,effect:Ie,memo:Q,createComponent:Vs,use(x,b,g){return te(()=>x(b,g))}}}function _a(n){const t=Sa(n);return t.mergeProps=Tn,t}const $s={createElement(n){return new We(n)},createTextNode(n){return{_type:Ue.Text,text:n,parent:void 0}},replaceText(n,t){je("Replace Text: ",n,t),n.text=t;const e=n.parent;L(e),e.text=e.getText()},setProperty(n,t,e=!0){n[t]=e},insertNode(n,t,e){je("INSERT: ",n,t,e),n.children.insert(t,e),t._queueDelete=!1,t instanceof We?n.rendered&&t.render():n.isTextNode()&&(n.text=n.getText())},isTextNode(n){return n.isTextNode()},removeNode(n,t){je("REMOVE: ",n,t),n.children.remove(t),t._queueDelete=!0,t instanceof We&&queueMicrotask(()=>t.destroy())},getParentNode(n){return n.parent},getFirstChild(n){return n.children[0]},getNextSibling(n){const t=n.parent.children||[],e=t.indexOf(n)+1;if(e<t.length)return t[e]}},Gs=_a($s);let Ur;const bt=$s.createElement("App"),Ra=function(n,t){return Gs.render(n,bt)};function Ca(n=ae.rendererOptions,t){return Ur=jo(n,"app"),bt.lng=Ur.root,bt.rendered=!0,{renderer:Ur,rootNode:bt,render:Ra}}const{effect:hu,memo:Sn,createComponent:E,createElement:_r,createTextNode:uu,insertNode:du,insert:Ea,spread:_n,setProp:Ia,mergeProps:Ae,use:Ba}=Gs,G=n=>{const t=_r("node");return _n(t,n,!1),t},q=n=>{const t=_r("text");return _n(t,n,!1),t},Jn="_$DX_DELEGATE";function Fa(n,t=window.document){const e=t[Jn]||(t[Jn]=new Set);for(let r=0,s=n.length;r<s;r++){const i=n[r];e.has(i)||(e.add(i),t.addEventListener(i,Ma))}}function Ma(n){const t="$$".concat(n.type);let e=n.composedPath&&n.composedPath()[0]||n.target;for(n.target!==e&&Object.defineProperty(n,"target",{configurable:!0,value:e}),Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return e||document}}),K.registry&&!K.done&&(K.done=_$HY.done=!0);e;){const r=e[t];if(r&&!e.disabled){const s=e["".concat(t,"Data")];if(s!==void 0?r.call(e,s,n):r.call(e,n),n.cancelBubble)return}e=e._$host||e.parentNode||e.host}}const La=!1;function Ys(){let n=new Set;function t(s){return n.add(s),()=>n.delete(s)}let e=!1;function r(s,i){if(e)return!(e=!1);const o={to:s,options:i,defaultPrevented:!1,preventDefault:()=>o.defaultPrevented=!0};for(const a of n)a.listener({...o,from:a.location,retry:l=>{l&&(e=!0),a.navigate(s,{...i,resolve:!1})}});return!o.defaultPrevented}return{subscribe:t,confirm:r}}let sn;function Rn(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),sn=window.history.state._depth}Rn();function ka(n){return{...n,_depth:window.history.state&&window.history.state._depth}}function Pa(n,t){let e=!1;return()=>{const r=sn;Rn();const s=r==null?null:sn-r;if(e){e=!1;return}s&&t(s)?(e=!0,window.history.go(-s)):n()}}const Na=/^(?:[a-z0-9]+:)?\/\//i,Da=/^\/+|(\/)\/+$/g,Ks="http://sr";function At(n,t=!1){const e=n.replace(Da,"$1");return e?t||/^[?#]/.test(e)?e:"/"+e:""}function er(n,t,e){if(Na.test(t))return;const r=At(n),s=e&&At(e);let i="";return!s||t.startsWith("/")?i=r:s.toLowerCase().indexOf(r.toLowerCase())!==0?i=r+s:i=s,(i||"/")+At(t,!i)}function Oa(n,t){if(n==null)throw new Error(t);return n}function Ua(n,t){return At(n).replace(/\/*(\*.*)?$/g,"")+At(t)}function Qs(n){const t={};return n.searchParams.forEach((e,r)=>{t[r]=e}),t}function js(n,t,e){const[r,s]=n.split("/*",2),i=r.split("/").filter(Boolean),o=i.length;return a=>{const l=a.split("/").filter(Boolean),h=l.length-o;if(h<0||h>0&&s===void 0&&!t)return null;const d={path:o?"":"/",params:{}},f=p=>e===void 0?void 0:e[p];for(let p=0;p<o;p++){const v=i[p],y=l[p],m=v[0]===":",A=m?v.slice(1):v;if(m&&zr(y,f(A)))d.params[A]=y;else if(m||!zr(y,v))return null;d.path+="/".concat(y)}if(s){const p=h?l.slice(-h).join("/"):"";if(zr(p,f(s)))d.params[s]=p;else return null}return d}}function zr(n,t){const e=r=>r.localeCompare(n,void 0,{sensitivity:"base"})===0;return t===void 0?!0:typeof t=="string"?e(t):typeof t=="function"?t(n):Array.isArray(t)?t.some(e):t instanceof RegExp?t.test(n):!1}function za(n){const[t,e]=n.pattern.split("/*",2),r=t.split("/").filter(Boolean);return r.reduce((s,i)=>s+(i.startsWith(":")?2:3),r.length-(e===void 0?0:1))}function qs(n){const t=new Map,e=Ze();return new Proxy({},{get(r,s){return t.has(s)||Ps(e,()=>t.set(s,Q(()=>n()[s]))),t.get(s)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(n())}})}function Cn(n){let t=/(\/?\:[^\/]+)\?/.exec(n);if(!t)return[n];let e=n.slice(0,t.index),r=n.slice(t.index+t[0].length);const s=[e,e+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(r);)s.push(e+=t[1]),r=r.slice(t[0].length);return Cn(r).reduce((i,o)=>[...i,...s.map(a=>a+o)],[])}const Wa=100,Zs=Ns(),Js=Ns(),En=()=>Oa(Ds(Zs),"<A> and 'use' router primitives can be only used inside a Route."),In=()=>En().navigatorFactory(),ei=()=>En().location,Ha=(n,t)=>{const e=ei(),r=Q(()=>Cn(n()).map(s=>js(s,void 0,t)));return Q(()=>{for(const s of r()){const i=s(e.pathname);if(i)return i}})},Va=()=>En().params;function Xa(n,t=""){const{component:e,load:r,children:s,info:i}=n,o=!s||Array.isArray(s)&&!s.length,a={key:n,component:e,load:r,info:i};return ti(n.path).reduce((l,h)=>{for(const d of Cn(h)){const f=Ua(t,d);let p=o?f:f.split("/*",1)[0];p=p.split("/").map(v=>v.startsWith(":")||v.startsWith("*")?v:encodeURIComponent(v)).join("/"),l.push({...a,originalPath:h,pattern:p,matcher:js(p,!o,n.matchFilters)})}return l},[])}function $a(n,t=0){return{routes:n,score:za(n[n.length-1])*1e4-t,matcher(e){const r=[];for(let s=n.length-1;s>=0;s--){const i=n[s],o=i.matcher(e);if(!o)return null;r.unshift({...o,route:i})}return r}}}function ti(n){return Array.isArray(n)?n:[n]}function ri(n,t="",e=[],r=[]){const s=ti(n);for(let i=0,o=s.length;i<o;i++){const a=s[i];if(a&&typeof a=="object"){a.hasOwnProperty("path")||(a.path="");const l=Xa(a,t);for(const h of l){e.push(h);const d=Array.isArray(a.children)&&a.children.length===0;if(a.children&&!d)ri(a.children,h.pattern,e,r);else{const f=$a([...e],r.length);r.push(f)}e.pop()}}}return e.length?r:r.sort((i,o)=>o.score-i.score)}function Wr(n,t){for(let e=0,r=n.length;e<r;e++){const s=n[e].matcher(t);if(s)return s}return[]}function Ga(n,t){const e=new URL(Ks),r=Q(l=>{const h=n();try{return new URL(h,e)}catch(d){return console.error("Invalid path ".concat(h)),l}},e,{equals:(l,h)=>l.href===h.href}),s=Q(()=>r().pathname),i=Q(()=>r().search,!0),o=Q(()=>r().hash),a=()=>"";return{get pathname(){return s()},get search(){return i()},get hash(){return o()},get state(){return t()},get key(){return a()},query:qs(qe(i,()=>Qs(r())))}}let Ke;function Ya(){return Ke}function Ka(n,t,e,r={}){const{signal:[s,i],utils:o={}}=n,a=o.parsePath||(P=>P),l=o.renderPath||(P=>P),h=o.beforeLeave||Ys(),d=er("",r.base||"");if(d===void 0)throw new Error("".concat(d," is not a valid base path"));d&&!s().value&&i({value:d,replace:!0,scroll:!1});const[f,p]=H(!1);let v;const y=(P,k)=>{k.value===m()&&k.state===S()||(v===void 0&&p(!0),Ke=P,v=k,da(()=>{v===k&&(A(v.value),x(v.state),T[1]([]))}).finally(()=>{v===k&&vn(()=>{Ke=void 0,P==="navigate"&&w(v),p(!1),v=void 0})}))},[m,A]=H(s().value),[S,x]=H(s().state),b=Ga(m,S),g=[],T=H([]),_=Q(()=>typeof r.transformUrl=="function"?Wr(t(),r.transformUrl(b.pathname)):Wr(t(),b.pathname)),C=qs(()=>{const P=_(),k={};for(let M=0;M<P.length;M++)Object.assign(k,P[M].params);return k}),I={pattern:d,path:()=>d,outlet:()=>null,resolvePath(P){return er(d,P)}};return Ie(qe(s,P=>y("native",P),{defer:!0})),{base:I,location:b,params:C,isRouting:f,renderPath:l,parsePath:a,navigatorFactory:B,matches:_,beforeLeave:h,preloadRoute:N,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:T};function R(P,k,M){te(()=>{if(typeof k=="number"){k&&(o.go?o.go(k):console.warn("Router integration does not support relative routing"));return}const{replace:D,resolve:O,scroll:V,state:Y}={replace:!1,resolve:!0,scroll:!0,...M},z=O?P.resolvePath(k):er("",k);if(z===void 0)throw new Error("Path '".concat(k,"' is not a routable path"));if(g.length>=Wa)throw new Error("Too many redirects");const re=m();(z!==re||Y!==S())&&(La||h.confirm(z,M)&&(g.push({value:re,replace:D,scroll:V,state:S()}),y("navigate",{value:z,state:Y})))})}function B(P){return P=P||Ds(Js)||I,(k,M)=>R(P,k,M)}function w(P){const k=g[0];k&&(i({...P,replace:k.replace,scroll:k.scroll}),g.length=0)}function N(P,k={}){const M=Wr(t(),P.pathname),D=Ke;Ke="preload";for(let O in M){const{route:V,params:Y}=M[O];V.component&&V.component.preload&&V.component.preload();const{load:z}=V;k.preloadData&&z&&Ps(e(),()=>z({params:Y,location:{pathname:P.pathname,search:P.search,hash:P.hash,query:Qs(P),state:null,key:""},intent:"preload"}))}Ke=D}}function Qa(n,t,e,r){const{base:s,location:i,params:o}=n,{pattern:a,component:l,load:h}=r().route,d=Q(()=>r().path);l&&l.preload&&l.preload();const f=h?h({params:o,location:i,intent:Ke||"initial"}):void 0;return{parent:t,pattern:a,path:d,outlet:()=>l?Vs(l,{params:o,location:i,data:f,get children(){return e()}}):e(),resolvePath(v){return er(s.path(),v,d())}}}const ja=n=>t=>{const{base:e}=t,r=bn(()=>t.children),s=Q(()=>ri(r(),t.base||""));let i;const o=Ka(n,s,()=>i,{base:e,singleFlight:t.singleFlight,transformUrl:t.transformUrl});return n.create&&n.create(o),E(Zs.Provider,{value:o,get children(){return E(qa,{routerState:o,get root(){return t.root},get load(){return t.rootLoad},get children(){return[Sn(()=>(i=Ze())&&null),E(Za,{routerState:o,get branches(){return s()}})]}})}})};function qa(n){const t=n.routerState.location,e=n.routerState.params,r=Q(()=>n.load&&te(()=>{n.load({params:e,location:t,intent:Ya()||"initial"})}));return E(wr,{get when(){return n.root},keyed:!0,get fallback(){return n.children},children:s=>E(s,{params:e,location:t,get data(){return r()},get children(){return n.children}})})}function Za(n){const t=[];let e;const r=Q(qe(n.routerState.matches,(s,i,o)=>{let a=i&&s.length===i.length;const l=[];for(let h=0,d=s.length;h<d;h++){const f=i&&i[h],p=s[h];o&&f&&p.route.key===f.route.key?l[h]=o[h]:(a=!1,t[h]&&t[h](),Ne(v=>{t[h]=v,l[h]=Qa(n.routerState,l[h-1]||n.routerState.base,es(()=>r()[h+1]),()=>n.routerState.matches()[h])}))}return t.splice(s.length).forEach(h=>h()),o&&a?o:(e=l[0],l)}));return es(()=>r()&&e)()}const es=n=>()=>E(wr,{get when(){return n()},keyed:!0,children:t=>E(Js.Provider,{value:t,get children(){return t.outlet()}})}),oe=n=>{const t=bn(()=>n.children);return Tn(n,{get children(){return t()}})};function Ja([n,t],e,r){return[n,r?s=>t(r(s)):t]}function el(n){if(n==="#")return null;try{return document.querySelector(n)}catch(t){return null}}function tl(n){let t=!1;const e=s=>typeof s=="string"?{value:s}:s,r=Ja(H(e(n.get()),{equals:(s,i)=>s.value===i.value&&s.state===i.state}),void 0,s=>(!t&&n.set(s),s));return n.init&&be(n.init((s=n.get())=>{t=!0,r[1](e(s)),t=!1})),ja({signal:r,create:n.create,utils:n.utils})}function rl(n,t,e){return n.addEventListener(t,e),()=>n.removeEventListener(t,e)}function nl(n,t){const e=el("#".concat(n));e?e.scrollIntoView():t&&window.scrollTo(0,0)}const sl=new Map;function il(n=!0,t=!1,e="/_server",r){return s=>{const i=s.base.path(),o=s.navigatorFactory(s.base);let a={};function l(m){return m.namespaceURI==="http://www.w3.org/2000/svg"}function h(m){if(m.defaultPrevented||m.button!==0||m.metaKey||m.altKey||m.ctrlKey||m.shiftKey)return;const A=m.composedPath().find(_=>_ instanceof Node&&_.nodeName.toUpperCase()==="A");if(!A||t&&!A.hasAttribute("link"))return;const S=l(A),x=S?A.href.baseVal:A.href;if((S?A.target.baseVal:A.target)||!x&&!A.hasAttribute("state"))return;const g=(A.getAttribute("rel")||"").split(/\s+/);if(A.hasAttribute("download")||g&&g.includes("external"))return;const T=S?new URL(x,document.baseURI):new URL(x);if(!(T.origin!==window.location.origin||i&&T.pathname&&!T.pathname.toLowerCase().startsWith(i.toLowerCase())))return[A,T]}function d(m){const A=h(m);if(!A)return;const[S,x]=A,b=s.parsePath(x.pathname+x.search+x.hash),g=S.getAttribute("state");m.preventDefault(),o(b,{resolve:!1,replace:S.hasAttribute("replace"),scroll:!S.hasAttribute("noscroll"),state:g&&JSON.parse(g)})}function f(m){const A=h(m);if(!A)return;const[S,x]=A;a[x.pathname]||s.preloadRoute(x,{preloadData:S.getAttribute("preload")!=="false"})}function p(m){const A=h(m);if(!A)return;const[S,x]=A;a[x.pathname]||(a[x.pathname]=setTimeout(()=>{s.preloadRoute(x,{preloadData:S.getAttribute("preload")!=="false"}),delete a[x.pathname]},200))}function v(m){const A=h(m);if(!A)return;const[,S]=A;a[S.pathname]&&(clearTimeout(a[S.pathname]),delete a[S.pathname])}function y(m){if(m.defaultPrevented)return;let A=m.submitter&&m.submitter.hasAttribute("formaction")?m.submitter.getAttribute("formaction"):m.target.getAttribute("action");if(!A)return;if(!A.startsWith("https://action/")){const x=new URL(A,Ks);if(A=s.parsePath(x.pathname+x.search),!A.startsWith(e))return}if(m.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const S=sl.get(A);if(S){m.preventDefault();const x=new FormData(m.target);m.submitter&&m.submitter.name&&x.append(m.submitter.name,m.submitter.value),S.call({r:s,f:m.target},x)}}Fa(["click","submit"]),document.addEventListener("click",d),n&&(document.addEventListener("mouseover",p),document.addEventListener("mouseout",v),document.addEventListener("focusin",f),document.addEventListener("touchstart",f)),document.addEventListener("submit",y),be(()=>{document.removeEventListener("click",d),n&&(document.removeEventListener("mouseover",p),document.removeEventListener("mouseout",v),document.removeEventListener("focusin",f),document.removeEventListener("touchstart",f)),document.removeEventListener("submit",y)})}}function ol(n){const t=n.replace(/^.*?#/,"");if(!t.startsWith("/")){const[,e="/"]=window.location.hash.split("#",2);return"".concat(e,"#").concat(t)}return t}function al(n){const t=()=>window.location.hash.slice(1),e=Ys();return tl({get:t,set({value:r,replace:s,scroll:i,state:o}){s?window.history.replaceState(ka(o),"","#"+r):window.history.pushState(o,"","#"+r);const a=r.indexOf("#"),l=a>=0?r.slice(a+1):"";nl(l,i),Rn()},init:r=>rl(window,"hashchange",Pa(r,s=>!e.confirm(s&&s<0?s:t()))),create:il(n.preload,n.explicitLinks,n.actionBase),utils:{go:r=>window.history.go(r),renderPath:r=>"#".concat(r),parsePath:ol,beforeLeave:e}})(n)}var ll=!!wa;function cl(n){return n!==null&&(typeof n=="object"||typeof n=="function")}function ts(n,...t){return typeof n=="function"?n(...t):n}var hl=ll?n=>Ze()?be(n):n:be,ul=()=>{let n=[];const t=()=>n=[];return{push:(...e)=>n.push(...e),execute(e,r,s,i){n.forEach(o=>o(e,r,s,i)),t()},clear:t}};function dr(n,t,e,r){return n.addEventListener(t,e,r),hl(n.removeEventListener.bind(n,t,e,r))}function ni(n,t){const{push:e,execute:r}=ul();return[(s,i,o)=>{const a=dr(n,s,i,o!=null?o:t);return e(a),a},be(r)]}function si(n,t=Ze()){let e=0,r,s;return()=>(e++,be(()=>{e--,queueMicrotask(()=>{!e&&s&&(s(),s=r=void 0)})}),s||Ne(i=>r=n(s=i),t),r)}function dl(n){const t=Ze(),e=si(n,t);return()=>K.context?Ne(n,t):e()}var fl=si(()=>{const[n,t]=H(null);return dr(window,"keydown",e=>{t(e),setTimeout(()=>t(null))}),n});const Xt={ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"Enter",l:"Last"," ":"Space",Backspace:"Back",Escape:"Escape"},[fr,pl]=H([]),gl=n=>{const t=fl();if(n)for(const[e,r]of Object.entries(n))Ct(r)?r.forEach(s=>{Xt[s]=e}):Xt[r]=e;return De(qe(Sr,(e,r,s=[])=>{let i=e;const o=[];for(;i;)i.states.has("focus")||(i.states.add("focus"),ve(i.onFocus)&&i.onFocus.call(i,e,r),ve(i.onFocusChanged)&&i.onFocusChanged.call(i,!0,e,r)),o.push(i),i=i.parent;return s.forEach(a=>{o.includes(a)||(a.states.remove("focus"),ve(a.onBlur)&&a.onBlur.call(a,e,r),ve(a.onFocusChanged)&&a.onFocusChanged.call(a,!1,e,r))}),pl(o),o},{defer:!0})),De(()=>{const e=t();if(e){const r=Xt[e.key]||Xt[e.keyCode];te(()=>{const s=fr();let i;for(const o of s){if(i=i||o,r){const a=o["on".concat(r)];if(ve(a)&&a.call(o,e,o,i)===!0)break}else console.log("Unhandled key event: ".concat(e.key||e.keyCode));if(ve(o.onKeyPress)&&o.onKeyPress.call(o,e,r,o,i)===!0)break}return!1})}}),fr};function ml(n=[]){const t=[];let e;for(e=0;e<n.length;e++){const r=n[e];if(typeof r=="string"&&!r.includes("PAUSE-"))t.push(n[e]);else break}return[t.join(",\b ")].concat(n.slice(e))}function rs(n){return new Promise(t=>{setTimeout(t,n)})}function xl(n,t,e="en-US"){const r=window.speechSynthesis;return new Promise((s,i)=>{const o=new SpeechSynthesisUtterance(n);o.lang=e,o.onend=()=>{s()},o.onerror=a=>{i(a)},t.push(o),r.speak(o)})}function on(n,t,e=!0){const r=window.speechSynthesis,s=ml(Array.isArray(n)?n:[n]),i=[],o=[];let a=!0;return{series:(async()=>{try{for(;a&&s.length;){const h=await Promise.resolve(s.shift());if(a){if(typeof h=="string"&&h.includes("PAUSE-")){let d=Number(h.split("PAUSE-")[1])*1e3;isNaN(d)&&(d=0),await rs(d)}else if(typeof h=="string"&&h.length){let f=3;for(;a&&f>0;)try{await xl(h,o,t),f=0}catch(p){if(p instanceof SpeechSynthesisErrorEvent)if(p.error==="network")f--,console.warn("Speech synthesis network error. Retries left: ".concat(f)),await rs(500*(3-f));else if(p.error==="canceled"||p.error==="interrupted")f=0;else throw new Error("SpeechSynthesisErrorEvent: ".concat(p.error));else throw p}}else if(typeof h=="function"){const d=on(h(),t,!1);i.push(d),await d.series}else if(Array.isArray(h)){const d=on(h,t,!1);i.push(d),await d.series}}else break}}finally{a=!1}})(),get active(){return a},append:h=>{s.push(h)},cancel:()=>{a&&(e&&r.cancel(),i.forEach(h=>{h.cancel()}),a=!1)}}}let $t;function yl(n,t="en-US"){return $t&&$t.cancel(),$t=on(n,t),$t}var an=(n,t)=>{let e;const r=()=>clearTimeout(e);return Ze()&&be(r),Object.assign((...i)=>{e!==void 0&&r(),e=setTimeout(()=>n(...i),t)},{clear:r})},ii=(n,t)=>{let e=!1,r,s;const i=(...a)=>{s=a,!e&&(e=!0,r=setTimeout(()=>{n(...s),e=!1},t))},o=()=>{clearTimeout(r),e=!1};return Ze()&&be(o),Object.assign(i,{clear:o})};function vl(n){let t=0,e=!1;const[r,s]=H(void 0,{equals:!1}),i=n(()=>{e=!0,s()});return()=>(e||(i(),r()),e?(e=!!t,!0):(ks()&&(t++,be(()=>t--)),!1))}let ln,Tt=[],Ee,cn=!1;const bl=3e5;function ns(n,t){const e=an(n,t);let r;const s=i=>{r=i,e(i)};return s.flush=()=>{e.clear(),n(r)},s.clear=e.clear,s}function pt(n){return n.id||n.name}function Al(n=[]){if(!ne.onFocusChange||!ne.enabled)return;const t=n.every(i=>!i.loading),e=n.filter(i=>!Tt.includes(i));if(ln(),!t&&ne.onFocusChange){ne.onFocusChange([]);return}Tt=n.slice(0);const r=[],s=e.reduce((i,o)=>(o.announce?(i.push([pt(o),"Announce",o.announce]),r.push(o.announce)):o.title?(i.push([pt(o),"Title",o.title]),r.push(o.title)):i.push([pt(o),"No Announce",""]),i),[]);if(e.reverse().reduce((i,o)=>(o.announceContext?(i.push([pt(o),"Context",o.announceContext]),r.push(o.announceContext)):i.push([pt(o),"No Context",""]),i),s),ne.debug&&console.table(s),r.length)return ne.speak(r.reduce((i,o)=>i.concat(o),[]))}function Tl(n){if(!cn)return Ee=yl(n)}const ne={debug:!1,enabled:!0,cancel:function(){Ee&&Ee.cancel()},clearPrevFocus:function(n=0){Tt=Tt.slice(0,n),ln()},speak:function(n,{append:t=!1,notification:e=!1}={}){return ne.onFocusChange&&ne.enabled&&(ne.onFocusChange.flush(),t&&Ee&&Ee.active?Ee.append(n):(ne.cancel(),Tl(n)),e&&(cn=!0,Ee==null||Ee.series.finally(()=>{cn=!1,ne.refresh()}).catch(console.error))),Ee},refresh:function(n=0){ne.clearPrevFocus(n),ne.onFocusChange&&ne.onFocusChange(te(()=>fr()))},setupTimers:function({focusDebounce:n=400,focusChangeTimeout:t=bl}={}){ne.onFocusChange=ns(Al,n),ln=ns(()=>{Tt=[]},t)}},wl=()=>(ne.setupTimers(),De(qe(fr,ne.onFocusChange,{defer:!0})),ne);function Sl(n){const t={...n},e={...n},r={},s=o=>{let a=r[o];if(!a){if(!ks())return t[o];r[o]=a=H(t[o],{internal:!0}),delete t[o]}return a[0]()};for(const o in n)Object.defineProperty(e,o,{get:()=>s(o),enumerable:!0});const i=(o,a)=>{const l=r[o];if(l)return l[1](a);o in t&&(t[o]=ts(a,[t[o]]))};return[e,(o,a)=>{if(cl(o)){const l=te(()=>Object.entries(ts(o,e)));vn(()=>{for(const[h,d]of l)i(h,()=>d)})}else i(o,a);return e}]}var oi={passive:!0},_l={x:0,y:0,isInside:!1,sourceType:null};function Rl(n=window,t,e={}){const{touch:r=!0,followTouch:s=!0}=e,[i,o]=ni(n,oi),a=l=>t({x:l.pageX,y:l.pageY,sourceType:"mouse"});if(i("mousemove",a),i("dragover",a),r){const l=h=>{h.touches.length&&t({x:h.touches[0].clientX,y:h.touches[0].clientY,sourceType:"touch"})};i("touchstart",l),s&&i("touchmove",l)}return o}function Cl(n=window,t,e={}){const{touch:r=!0}=e,[s,i]=ni(n,oi);let o=!1,a=!r;function l(h){this==="mouse"?o=h:a=h,t(o||a)}return s("mouseover",l.bind("mouse",!0)),s("mouseout",l.bind("mouse",!1)),s("mousemove",l.bind("mouse",!0),{passive:!0,once:!0}),r&&(s("touchstart",l.bind("touch",!0)),s("touchend",l.bind("touch",!1))),i}function El(n,t={}){const e={..._l,...t.initialValue},[r,s]=Sl(e),i=o=>{Rl(o,s,t),Cl(o,s.bind(void 0,"isInside"),t)};return typeof n!="function"?i(n):De(()=>i(n())),r}var Il=dl(El.bind(void 0,void 0,void 0));function hn(n,t){return new KeyboardEvent("keydown",{key:n,keyCode:t,which:t,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0})}const Bl=ii(n=>{const t=n.deltaY;t<0?document.dispatchEvent(hn("ArrowUp",38)):t>0&&document.dispatchEvent(hn("ArrowDown",40))},250),Fl=n=>{var r;const t=Sr(),e=((r=ae.rendererOptions)==null?void 0:r.deviceLogicalPixelRatio)||1;t&&ai(n.clientX,n.clientY,t.lng.absX*e,t.lng.absY*e,t.width*e,t.height*e)&&document.dispatchEvent(hn("Enter",13))};function ai(n,t,e,r,s=0,i=0){return n>=e&&n<=e+s&&t>=r&&t<=r+i}function Ml(n,t,e){var o;const r=[],s=((o=ae.rendererOptions)==null?void 0:o.deviceLogicalPixelRatio)||1;let i=[n];for(;i.length>0;){const a=[];for(const d of i)d.alpha!==0&&ai(t,e,d.lng.absX*s,d.lng.absY*s,d.width*s,d.height*s)&&a.push(d);const l=a.length;if(l===0)break;l>1&&a.sort((d,f)=>(f.zIndex||0)-(d.zIndex||0));const h=a[0];r.push(h),h.isTextNode()?i=[]:i=h.children}return r}function Ll(n=bt,t=100){const e=Il(),r=vl(s=>ii(s,t));dr(window,"wheel",Bl),dr(window,"click",Fl),De(()=>{var s;if(r()){const i=Ml(n,e.x,e.y).filter(o=>(o.focus||o.onFocus||o.onEnter)&&!o.skipFocus);if(i.length){let o=i[i.length-1];for(;(s=o.parent)!=null&&s.forwardStates;)o=o.parent;const a=o.parent;(a==null?void 0:a.selected)!==void 0&&(a.selected=a.children.indexOf(o)),Xs(o)}}})}const[kl,Pl]=H(""),u={name:"Base Lightning TV",alpha:{primary:1,secondary:.7,tertiary:.1,inactive:.5,full:1,none:0,alpha1:.1,alpha2:.3,alpha3:.5,alpha4:.7,alpha5:.9,alpha6:.95},animation:{duration:{none:0,xfast:100,fast:250,normal:500,slow:750,xslow:900},delay:{none:0,xfast:10,fast:25,normal:50,slow:75,xslow:90},expressive:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},expressiveEntrance:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},expressiveExit:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},standard:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},standardEntrance:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},standardExit:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},utility:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},utilityEntrance:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},utilityExit:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25}},asset:{arrowLeft:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADiNXWtAAAAi0lEQVRIDWNgGAWjIfD//38JID5Fk5AAGqwKxPeA+D/VLQCaaQLEr0CGgwBVLQCa5wbEn0EGwwDVLAAaGA3Ev2AGw2iqWAA0rBiI/8EMRaYptgBoWDeygehsci1gIlcjWfqArqZdEMFcBLSEdpGMZAntkimSJbTLaEiW0K6oQLKEdoUdzJJRemiHAAD4n+yzPWCs7QAAAABJRU5ErkJggg==",arrowRight:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADiNXWtAAAAg0lEQVRIDWNgGAWjIYArBP7//38KiCVwyVMsDjQcBO4BsSrFhmEzAGw8hHgFpEywqaFIDMkCEPMzELtRZCC6ZjQLQNxfQByNro5sPhYLQEL/gLiYbEORNeKwACbcDVPLBGMMOhrmVDSapkFE00imaTKlaUajaVFB28Ju0CXrUQfhDAEAEgHss6NhpLQAAAAASUVORK5CYII=",backspaceOutline:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAAAAXNSR0IArs4c6QAACmpJREFUeF7tnVmoZUcVhv/feY4gBEVEH/KgCCZxCK2itNo4xQQH+kUN0TjEiDGKKBqnaExwBjUaR6KY+NQgiQkOMSYhYEScIopGJOqDE2hHjfP0y4p1Oqdv33v2qr32Prv2Paug6Ye7Vu2qv75TtWvtGohMqUBAAQZ80zUVQAKUEIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypfPsAJJ0NYC92XRHKPB3AAfLv18BuBLAFSR/NKZWswJI0vkA3jCmILsw75sAvIfkR8eo22wAknQSgMvGEGFD8vwxgFeQvGrI+s4CIEnHAPgugHsMWfkNzevDAM4i+Z8h6t88QJLuXOB5yBAVzjxuVeBaAM8ieXNUjzkAdAmA50Yrmv5HKPATACeQ/GNEm6YBkvRyANblZhpHAXsfekpkOGsWIEmPAHA9gDuOo13mWhS4gOSZfdVoEiBJ9wFwA4D7961Y+lUpsK/v7KxVgL4K4ElOCS4l+Uyn7a41k3Q0gMcC2ANgH4CHV1T2OyStx69OzQEk6TwAZztr8lMAx5P8s9N+Y8wk2cTjfQDu66z080h+zml7yKwpgCSdCOByZyX+BuBRJH/otN84M0kWN/s0gOc4Kv8Nko922B1m0gxAkh4I4AcVwcL9JA/UVnjT7CXdHYD9yEzfVUkAjib5uxqNmgCoBAu/CeBhzsJ/kORZTtuNN5Nk70bXAZ0Hy59G8qIawVoB6LMAnu8suE3tH0/y3077NAMg6esAuoaoC0la7M2dJgdI0ssAXOgs8W8BHEvS/s9UoYCkdwN4bYfL5STto7U7TQpQZbDQehzreawHylSpgKSTAVza4XYDyeNqsp4MoB7BwteQfH9N5dL2NgWK3l0vyAdJWhDXnSYBSNLtANh3GO/KwgMk97trlYbbKiDJPpzea5U8JKuYqDIeql0kvQPAG5352ZLMR5L8q9M+zXZQYFcAJOnJAL7sbGWLMFuk2SLOmYIKzB6gEiz8HoB7O7U4meQXnLZp1qGApD8BuOcsh7AewcL3kuyadg4OjSSbhRxH0j4BjJok2Ufga0j+YdQHlcznDlBNsPAa+xpP8r/rEHbxjAKPbRuyHvKFY0Ik6QUALOprPfIT1gHRbAGSdDoA77aSX5Zg4e8nhGfx6FEgWoJn8Zy1QCTplq5vjc3NwnoEC/eQ/HYD8IwC0TbwrA2i2QHUI1h4JskLGoJnUIhWwLMWiGYFkCSLMX2t5WDhlneeLm5Dw5kDntEhkmRhEVvesWNqZgiTdC6AN3W1Svn72oOFkuxF+WcVIQUrai+IKuA5BBHJ453auc1mA1AJFn7Jsf7EKj9ZsLBHw1ZDtI5neAmaBUBzCxaO2cBj5u2FZtlO0l8A3K3ZIaxHsPB8kt5vYn00c/mM0dBj5OmqzAqjOQDUfLBwJ32HbPAh84pCM5seSNJLAHzcWeFJgoVdZRui4YfIo6ucff8uyVY03LW5IawyWPgvW5u77mChV/QIABFfb/kidk0CVKbDth3Huw35dJLeniqiV2/fniDYx1f7vlWTeoUFah6wZQhrqwcqwUKbrtsaH0+6mOQpHsOpbXpCVFPstcJjBZNkmzHv0swQJultAN7iVO375TyafzjtJzcbEaK1w9McQJXBQlvvYmtsfjE5FZUFGAGiSeBpCqDKYKFtmX0qya9Utl0z5gNCNBk8BSA7CtiODNwxjf4trEew8BySNtTNOg0A0aTwtARQTbDQeh3rfawXmn0KQDQ5PC0B9EkAL3LSkAD9X6hWALIJzJ3mNoSdS9I7U3NyuX6zQO+zKOzkEEmaHqDSFdpZM97tOfkSfRvvk0LUDEAFIgseetf85DS+AYgk/bPr1NvRZ2HLg4ektwI4xzmgZCBxYohaBMjWPeenDOcvaIvZ2oez5gAqQ5mtLbb3oa4z+Bb6nTHW1UP92vFIr54vzJ8BcGplGdYKkSRbCXGHSWdh2z1ckp1taGccroxyFt9cznG4iGuDqFmASk9kZxxakNGTckHZBBA1DVCB6BMAXuwhyA4VmGL/+05l6zlsbdt7DJmXU0uXmSQ7JvD2zQ1hiwJJsotRvlVxXO87SU5+heUYDT5Gni5KVhg1D1DphWqCjOYy6RlAYzb0mHn3gWkWABWIaoKMubHwSBpGebGWZNdc2vmUO6a1BhJXFUSSff/yLuOYamvzzwEcVfFr7tWwPXqi6uN2PXWYG0C1Qca1n8RaDlewl3kPRL3gWXo/XBwo1dXWdk/a3jEOnJoVQGUoqw0yvpLkh7oUHvLvTohC8FRANBo8pT3sxLeVJ/M2M4QtiVYTZJzkNPoOiAaBxwHRqPDMFqBS8Jog4yT3YewA0aDwrIBodHhmDVApvG0mtO3PnjTJjTxbIBoFnm0gWgs8pQ06lxY3N4QtCWZBRgPDezdnHvPr+alV2EiaL0DlF2Dbn20bdB40XtHwQ5nOHqAC0SyCjEM1Wkv57AqACkRvBvB2p7hrDzI6yzU7s90EUPNBxtnR4SjwrgGo9EK1Qca8cM4ByU4mkuz++F93ZHELyZX3iW31n+S+sKWZWfNBxkCbNeUq6ekArugo1I0kH1xT8EkBKj1R80HGGkFbtZVkZ3bb2d2r0tUkn1hTh8kBKhB9DMBLnQWfJMjoLFuTZpJsO/ONAB7UUcBLSHqvX781q1YAqg0yfoDkq5psrQYLJeldAF7nKFr1x+wmACq9kAUZLazvvTV4P8kDDlE22kTSQ4uuK9dCF5HuR/I3NYI1A1CBaB+AK50VsAMj7TJeixNl2kYBSccCsB/ZMQ6Brif5GIfdYSZNAVQg8rzsLSphl/Hapby2LDZTUaBcq/56ALb1fOVxLkuinULy4loRmwOoQGQX7T7DWZnPk3y203bXmkl6AIA91isDOBGADV3e1HsJbasA1QYZvUKl3fYKPI2knXFQnZoEqPRCNUHG6oqnwyEFLiJ5Wl89mgWoQFQTZOyrwSb7WUztcSRtu0+v1DRABaKPADijV+3SaZUCNgE5geTNEZnmAFBtkDGix6b4Xld2BNvJcaHUPEClF6oNMoZE2eXOtm3q1ZFha1mfWQBUINoL4Kqurbm7vPEj1bOAqx3udW0kk62+swGoQHQ2gPOGFGAD8roJgF0t+qkx6jorgApElwE4aQwxZp6n3YNxsPyzA7yst/4iSdvEMFqaHUCjKZEZ91IgAeolWzotFEiAkoWQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnT+H0jPT81J3xWWAAAAAElFTkSuQmCC",check:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAOCAYAAAAi2ky3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACtSURBVHgBvdPdDcIgEAfwoy8Nb45QN3AGF2s36Ahu4gpuIDoBfSgfpdoTlCbEWEMh6T8hFzjyg5AAkBHOcQe5UWqspRx435sDpMYj6IYQwwVSEiJ2MKVUBWuzLSLl2HL+uxmNCGFO8yaL7RHxve6qRZoAuS4hxac8735elWVx7jrtMKL1o0Gcat9jhExHSukN/kUIFZ7MpDRtzE1isDRkAUtDvrA8ZI597FUf8gWH9P0b4gko9wAAAABJRU5ErkJggg=="},color:{palette:{},white:"0xffffffff",black:"0x000000ff",grey:"0x929096ff",red:"0xe74c3cff",orange:"0xdc7633ff",yellow:"0xf7dc6fff",green:"0x2ecc71ff",blue:"0x93a9fdff",purple:"0x663399ff",overlay:"0x181819b3",material:"0x181819ff",materialNeutral:"0x181819ff",materialNeutralElevated:"0x373639ff",materialInverse:"0xf8f7faff",materialInverseElevated:"0xffffffff",materialBrand:"0x000033ff",materialBrandElevated:"0x242a65ff",textNeutral:"0xf8f7faff",textNeutralSecondary:"0xf8f7fab3",textNeutralTertiary:"0xf8f7fa1a",textNeutralDisabled:"0xf8f7fa80",textInverse:"0x181819ff",textInverseSecondary:"0x181819b3",textInverseTertiary:"0x1818191a",textInverseDisabled:"0x18181980",textBrand:"0x93a9fdff",textBrandSecondary:"0x93a9fdb3",textBrandTertiary:"0x93a9fd1a",textBrandDisabled:"0x93a9fd80",textPositive:"0x2ecc71ff",textNegative:"0xe74c3cff",textInfo:"0x93a9fdff",textCaution:"0xdc7633ff",fillTransparent:"0xffffff0",fillNeutral:"0xf8f7faff",fillNeutralSecondary:"0xf8f7fab3",fillNeutralTertiary:"0xf8f7fa1a",fillNeutralDisabled:"0xf8f7fa80",fillInverse:"0x181819ff",fillInverseSecondary:"0x181819b3",fillInverseTertiary:"0x1818191a",fillInverseDisabled:"0x18181980",fillBrand:"0x93a9fdff",fillBrandSecondary:"0x93a9fdb3",fillBrandTertiary:"0x93a9fd1a",fillBrandDisabled:"0x93a9fd80",fillPositive:"0x2ecc71ff",fillNegative:"0xe74c3cff",fillInfo:"0x93a9fdff",fillCaution:"0xdc7633ff",strokeNeutral:"0xf8f7faff",strokeNeutralSecondary:"0xf8f7fab3",strokeNeutralTertiary:"0xf8f7fa1a",strokeNeutralDisabled:"0xf8f7fa80",strokeInverse:"0x181819ff",strokeInverseSecondary:"0x181819b3",strokeInverseTertiary:"0x1818191a",strokeInverseDisabled:"0x18181980",strokeBrand:"0x93a9fdff",strokeBrandSecondary:"0x93a9fdb3",strokeBrandTertiary:"0x93a9fd1a",strokeBrandDisabled:"0x93a9fd80",strokePositive:"0x2ecc71ff",strokeNegative:"0xe74c3cff",strokeInfo:"0x93a9fdff",strokeCaution:"0xdc7633ff",interactiveNeutral:"0xffffff1a",interactiveNeutralFocus:"0xffffffff",interactiveNeutralFocusSoft:"0xffffff1a",interactiveInverse:"0x48474b1a",interactiveInverseFocus:"0x48474bff",interactiveInverseFocusSoft:"0x48474b1a",interactiveBrand:"0xbecffe1a",interactiveBrandFocus:"0xbecffeff",interactiveBrandFocusSoft:"0xbecffe1a",shadowNeutral:"0x000000b3",shadowNeutralFocus:"0x000000b3",shadowNeutralFocusSoft:"0x000000b3",shadowNeutralText:"0x000000ff",shadowInverse:"0x000000b3",shadowInverseFocus:"0x000000b3",shadowInverseFocusSoft:"0x000000b3",shadowInverseText:"0x000000ff",shadowBrand:"0x000000b3",shadowBrandFocus:"0x000000b3",shadowBrandFocusSoft:"0x000000b3",shadowBrandText:"0x000000ff"},font:[],layout:{columnCount:10,focusScale:1.2,gutterX:20,gutterY:20,marginX:150,marginY:150,safe:50,screenW:1920,screenH:1080},radius:{none:0,xs:2,sm:4,md:8,lg:16,xl:24},spacer:{none:0,xxs:2,xs:4,sm:8,md:10,lg:20,xl:30,xxl:40,xxxl:50},stroke:{none:0,sm:2,md:4,lg:6,xl:8},typography:{display1:{fontFamily:"Arial",fontSize:75,lineHeight:85,fontWeight:500,verticalAlign:"middle",textBaseline:"bottom"},display2:{fontFamily:"Arial",fontSize:50,lineHeight:60,fontWeight:500,verticalAlign:"middle",textBaseline:"bottom"},display3:{fontFamily:"Arial",fontSize:56,fontWeight:400,lineHeight:68,verticalAlign:"middle",textBaseline:"bottom"},display4:{fontFamily:"Arial",fontSize:48,fontWeight:400,lineHeight:64,verticalAlign:"middle",textBaseline:"bottom"},headline1:{fontFamily:"Arial",fontSize:35,fontWeight:500,lineHeight:48,verticalAlign:"middle",textBaseline:"bottom"},headline2:{fontFamily:"Arial",fontSize:30,fontWeight:500,lineHeight:40,verticalAlign:"middle",textBaseline:"bottom"},headline3:{fontFamily:"Arial",fontSize:25,fontWeight:500,lineHeight:36,verticalAlign:"middle",textBaseline:"bottom"},body1:{fontFamily:"Arial",fontSize:25,fontWeight:300,lineHeight:40,verticalAlign:"middle",textBaseline:"bottom"},body2:{fontFamily:"Arial",fontSize:22,fontWeight:300,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},body3:{fontFamily:"Arial",fontSize:20,fontWeight:300,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},button1:{fontFamily:"Arial",fontSize:25,fontWeight:500,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},button2:{fontFamily:"Arial",fontSize:20,fontWeight:500,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},callout1:{fontFamily:"Arial",fontSize:20,fontWeight:500,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},caption1:{fontFamily:"Arial",fontSize:15,fontWeight:500,lineHeight:24,verticalAlign:"middle",textBaseline:"bottom"},tag1:{fontFamily:"Arial",fontSize:20,fontWeight:500,lineHeight:24,verticalAlign:"middle",textBaseline:"bottom"},footnote1:{fontFamily:"Arial",fontSize:22,fontWeight:300,lineHeight:30,verticalAlign:"middle",textBaseline:"bottom"},subtitle1:{fontFamily:"Arial",fontSize:32,fontWeight:400,lineHeight:36,verticalAlign:"middle",textBaseline:"bottom"},subtitle2:{fontFamily:"Arial",fontSize:28,fontWeight:500,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},navigation:{fontFamily:"Arial",fontSize:28,fontWeight:400,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"}},componentConfig:{Keyboard:{base:{keyProps:{delete:{title:null,icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAAAAXNSR0IArs4c6QAACmpJREFUeF7tnVmoZUcVhv/feY4gBEVEH/KgCCZxCK2itNo4xQQH+kUN0TjEiDGKKBqnaExwBjUaR6KY+NQgiQkOMSYhYEScIopGJOqDE2hHjfP0y4p1Oqdv33v2qr32Prv2Paug6Ye7Vu2qv75TtWvtGohMqUBAAQZ80zUVQAKUEIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypfPsAJJ0NYC92XRHKPB3AAfLv18BuBLAFSR/NKZWswJI0vkA3jCmILsw75sAvIfkR8eo22wAknQSgMvGEGFD8vwxgFeQvGrI+s4CIEnHAPgugHsMWfkNzevDAM4i+Z8h6t88QJLuXOB5yBAVzjxuVeBaAM8ieXNUjzkAdAmA50Yrmv5HKPATACeQ/GNEm6YBkvRyANblZhpHAXsfekpkOGsWIEmPAHA9gDuOo13mWhS4gOSZfdVoEiBJ9wFwA4D7961Y+lUpsK/v7KxVgL4K4ElOCS4l+Uyn7a41k3Q0gMcC2ANgH4CHV1T2OyStx69OzQEk6TwAZztr8lMAx5P8s9N+Y8wk2cTjfQDu66z080h+zml7yKwpgCSdCOByZyX+BuBRJH/otN84M0kWN/s0gOc4Kv8Nko922B1m0gxAkh4I4AcVwcL9JA/UVnjT7CXdHYD9yEzfVUkAjib5uxqNmgCoBAu/CeBhzsJ/kORZTtuNN5Nk70bXAZ0Hy59G8qIawVoB6LMAnu8suE3tH0/y3077NAMg6esAuoaoC0la7M2dJgdI0ssAXOgs8W8BHEvS/s9UoYCkdwN4bYfL5STto7U7TQpQZbDQehzreawHylSpgKSTAVza4XYDyeNqsp4MoB7BwteQfH9N5dL2NgWK3l0vyAdJWhDXnSYBSNLtANh3GO/KwgMk97trlYbbKiDJPpzea5U8JKuYqDIeql0kvQPAG5352ZLMR5L8q9M+zXZQYFcAJOnJAL7sbGWLMFuk2SLOmYIKzB6gEiz8HoB7O7U4meQXnLZp1qGApD8BuOcsh7AewcL3kuyadg4OjSSbhRxH0j4BjJok2Ufga0j+YdQHlcznDlBNsPAa+xpP8r/rEHbxjAKPbRuyHvKFY0Ik6QUALOprPfIT1gHRbAGSdDoA77aSX5Zg4e8nhGfx6FEgWoJn8Zy1QCTplq5vjc3NwnoEC/eQ/HYD8IwC0TbwrA2i2QHUI1h4JskLGoJnUIhWwLMWiGYFkCSLMX2t5WDhlneeLm5Dw5kDntEhkmRhEVvesWNqZgiTdC6AN3W1Svn72oOFkuxF+WcVIQUrai+IKuA5BBHJ453auc1mA1AJFn7Jsf7EKj9ZsLBHw1ZDtI5neAmaBUBzCxaO2cBj5u2FZtlO0l8A3K3ZIaxHsPB8kt5vYn00c/mM0dBj5OmqzAqjOQDUfLBwJ32HbPAh84pCM5seSNJLAHzcWeFJgoVdZRui4YfIo6ucff8uyVY03LW5IawyWPgvW5u77mChV/QIABFfb/kidk0CVKbDth3Huw35dJLeniqiV2/fniDYx1f7vlWTeoUFah6wZQhrqwcqwUKbrtsaH0+6mOQpHsOpbXpCVFPstcJjBZNkmzHv0swQJultAN7iVO375TyafzjtJzcbEaK1w9McQJXBQlvvYmtsfjE5FZUFGAGiSeBpCqDKYKFtmX0qya9Utl0z5gNCNBk8BSA7CtiODNwxjf4trEew8BySNtTNOg0A0aTwtARQTbDQeh3rfawXmn0KQDQ5PC0B9EkAL3LSkAD9X6hWALIJzJ3mNoSdS9I7U3NyuX6zQO+zKOzkEEmaHqDSFdpZM97tOfkSfRvvk0LUDEAFIgseetf85DS+AYgk/bPr1NvRZ2HLg4ektwI4xzmgZCBxYohaBMjWPeenDOcvaIvZ2oez5gAqQ5mtLbb3oa4z+Bb6nTHW1UP92vFIr54vzJ8BcGplGdYKkSRbCXGHSWdh2z1ckp1taGccroxyFt9cznG4iGuDqFmASk9kZxxakNGTckHZBBA1DVCB6BMAXuwhyA4VmGL/+05l6zlsbdt7DJmXU0uXmSQ7JvD2zQ1hiwJJsotRvlVxXO87SU5+heUYDT5Gni5KVhg1D1DphWqCjOYy6RlAYzb0mHn3gWkWABWIaoKMubHwSBpGebGWZNdc2vmUO6a1BhJXFUSSff/yLuOYamvzzwEcVfFr7tWwPXqi6uN2PXWYG0C1Qca1n8RaDlewl3kPRL3gWXo/XBwo1dXWdk/a3jEOnJoVQGUoqw0yvpLkh7oUHvLvTohC8FRANBo8pT3sxLeVJ/M2M4QtiVYTZJzkNPoOiAaBxwHRqPDMFqBS8Jog4yT3YewA0aDwrIBodHhmDVApvG0mtO3PnjTJjTxbIBoFnm0gWgs8pQ06lxY3N4QtCWZBRgPDezdnHvPr+alV2EiaL0DlF2Dbn20bdB40XtHwQ5nOHqAC0SyCjEM1Wkv57AqACkRvBvB2p7hrDzI6yzU7s90EUPNBxtnR4SjwrgGo9EK1Qca8cM4ByU4mkuz++F93ZHELyZX3iW31n+S+sKWZWfNBxkCbNeUq6ekArugo1I0kH1xT8EkBKj1R80HGGkFbtZVkZ3bb2d2r0tUkn1hTh8kBKhB9DMBLnQWfJMjoLFuTZpJsO/ONAB7UUcBLSHqvX781q1YAqg0yfoDkq5psrQYLJeldAF7nKFr1x+wmACq9kAUZLazvvTV4P8kDDlE22kTSQ4uuK9dCF5HuR/I3NYI1A1CBaB+AK50VsAMj7TJeixNl2kYBSccCsB/ZMQ6Brif5GIfdYSZNAVQg8rzsLSphl/Hapby2LDZTUaBcq/56ALb1fOVxLkuinULy4loRmwOoQGQX7T7DWZnPk3y203bXmkl6AIA91isDOBGADV3e1HsJbasA1QYZvUKl3fYKPI2knXFQnZoEqPRCNUHG6oqnwyEFLiJ5Wl89mgWoQFQTZOyrwSb7WUztcSRtu0+v1DRABaKPADijV+3SaZUCNgE5geTNEZnmAFBtkDGix6b4Xld2BNvJcaHUPEClF6oNMoZE2eXOtm3q1ZFha1mfWQBUINoL4Kqurbm7vPEj1bOAqx3udW0kk62+swGoQHQ2gPOGFGAD8roJgF0t+qkx6jorgApElwE4aQwxZp6n3YNxsPyzA7yst/4iSdvEMFqaHUCjKZEZ91IgAeolWzotFEiAkoWQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnT+H0jPT81J3xWWAAAAAElFTkSuQmCC"}}}}}};function Nl(){let n,t,e,r=0;const s=1,i={duration:750,easing:"ease-in-out"},o={alpha:s,color:4294967295};function a(l){if(l.startsWith("#")){n.color=ur(l),n.src="",n.alpha=1,r=1,t.alpha=0,e.alpha=0;return}else n.color=4294967295,e.alpha=1;if(r===0){n.src=l,r=1;return}if(r===1){t.src=l,r=2,t.alpha=0,t.animate({alpha:s},i).start(),n.animate({alpha:0},i).start();return}r===2&&(n.src=l,r=1,n.alpha=0,n.animate({alpha:s},i).start(),t.animate({alpha:0},i).start())}return De(qe(kl,l=>{a(l)},{defer:!0})),E(G,{width:1920,height:1080,zIndex:-5,get children(){return[E(G,{ref(l){var h=n;typeof h=="function"?h(l):n=l},style:o}),E(G,{ref(l){var h=t;typeof h=="function"?h(l):t=l},style:o,alpha:0}),E(G,{ref(l){var h=e;typeof h=="function"?h(l):e=l},src:"./assets/hero-mask-inverted.png",get color(){return ur(u.color.materialBrand)},width:1920,height:1080})]}})}function Gt(n){if(!n||!n[Symbol.iterator])throw new Error("objectFromEntries requires a single iterable argument");const t={};for(const[e,r]of n)t[e]=r;return t}const Dl=["focus","disabled"],Ol=["brand","inverse","neutral"];function U({themeKeys:n,base:t,modes:e={},tones:r={},themeStyles:s,modeKeys:i=Dl,toneKeys:o=Ol},a=!1){const l=(y,m,A)=>{const S=o.map(x=>{var T,_;const b={};return new Set([].concat.apply([],[(T=y==null?void 0:y[x])!=null?T:{},(_=m==null?void 0:m[x])!=null?_:{}].map(Object.keys))).forEach(C=>{var I,R,B;i.includes(C)||(b[C]=(B=(I=m==null?void 0:m[x])==null?void 0:I[C])!=null?B:(R=y==null?void 0:y[x])==null?void 0:R[C])}),i.forEach(C=>{var I,R;b[C]={...A[C],...(I=y==null?void 0:y[x])==null?void 0:I[C],...(R=m==null?void 0:m[x])==null?void 0:R[C]}}),[x,b]});return Gt(S)},h=(y,m)=>{const A=i.map(x=>[x,{...y==null?void 0:y[x],...m==null?void 0:m[x]}]);return Gt(A)},d=(y,m)=>({...y,...m.base}),f=y=>Gt(Object.entries(n).filter(([m,A])=>y[A]).map(([m,A])=>[m,y[A]])),p=y=>Gt(Object.entries(y).map(([A,S])=>{const x=f(S);return Object.entries(S).filter(([b,g])=>i.includes(b)).forEach(([b,g])=>{x[b]=f(g)}),[A,x]}));return((y,m,A)=>{const S=p(s);a&&console.log(S);const x=d(y,S);a&&console.log(x);const b=h(m,S);a&&console.log(b);const g=l(A,S,b);return a&&console.log(g),{base:{...x,...b},tones:g}})(t,e,r)}function pr(n=0){return(t,e,r=0,s)=>{var A,S,x,b;if(t.children.length===0)return;const i=t.flexDirection==="row"?"width":"height",o=t.flexDirection==="row"?"x":"y",a=t.gap||0,l=t.scroll||"auto",[h,d]=Ul(t);let f=(A=t[o])!=null?A:0;const p=(S=e==null?void 0:e[o])!=null?S:0,v=(x=e==null?void 0:e[i])!=null?x:0,y=s===void 0?"none":r>s?"positive":"negative";let m=f;if(l==="auto")t.scrollIndex!=null&&t.scrollIndex>=0?t.selected>=t.scrollIndex&&(y==="positive"?m=f-v-a:m=f+v+a):(Math.abs(f)+d<h.position+h.size||p<Math.abs(f))&&(m=-p+n);else if(l==="always"||l==="edge"&&y==="negative"&&Math.abs(f)>p)m=-p+n;else if(l==="edge"&&y==="positive"&&Math.abs(f)+d<p+v)m=f-v-a;else if(l==="edge"&&y==="none"){let g=0,T,_;for(;g<t.children.length&&Math.abs(f)+d<p+v;)T=t.children[g++],_=(b=T[i])!=null?b:0,f-=_+a;m=f}o==="x"&&t.x!==m?t.x=m:o==="y"&&t.y!==m&&(t.y=m)}}function Ul(n){var r,s,i,o,a,l;let t,e;return n.flexDirection==="row"?(t={position:(r=n.children[n.children.length-1].x)!=null?r:0,size:(s=n.children[n.children.length-1].width)!=null?s:0},e=(i=n.width)!=null?i:0):(t={position:(o=n.children[n.children.length-1].y)!=null?o:0,size:(a=n.children[n.children.length-1].height)!=null?a:0},e=(l=n.height)!=null?l:0),[t,e]}function ze(...n){const t=n.filter(e=>typeof e=="function");if(t.length!==0)return t.length===1?t[0]:function(...e){let r;for(const s of t)if(r=s.apply(this,e),r===!0)return r;return r}}function li(){if(!this||this.selected===void 0||this.children.length===0)return!1;let n=this.children[this.selected];for(;n!=null&&n.skipFocus;)this.selected++,n=this.children[this.selected];return n instanceof We?(n.setFocus(),!0):!1}function gr(n){return function(){var i,o,a;const t=this.children.length,e=this.wrap,r=this.selected||0;if(t===0)return!1;if(n==="right"||n==="down")do if(this.selected=(this.selected||0)%t+1,this.selected>=t){if(!e){this.selected=void 0;break}this.selected=0}while((i=this.children[this.selected])!=null&&i.skipFocus);else if(n==="left"||n==="up")do if(this.selected=(this.selected||0)%t-1,this.selected<0){if(!e){this.selected=void 0;break}this.selected=t-1}while((o=this.children[this.selected])!=null&&o.skipFocus);if(this.selected===void 0&&(this.selected=r,(a=this.children[this.selected])!=null&&a.states.has("focus")))return!1;const s=this.children[this.selected];if(this.onSelectedChanged&&this.onSelectedChanged.call(this,this,s,this.selected,r),this.plinko&&r!==void 0){const h=this.children[r].selected||0;s.selected=h<s.children.length?h:s.children.length-1}return s.setFocus(),!0}}function zl(n=1){const t=u.layout.screenW,e=u.layout.columnCount,r=u.layout.marginX,s=u.layout.gutterX;(n<1||n>e)&&(console.error("getWidthByUpCount expects an upCount between 1 & ".concat(e,", received ").concat(n,". Defaulting to upCount 1.")),n=1);const i=t-r*2,o=(n-1)*s;return(i-o)/n}function Wl(n,t){const e=t();let r,s,i,o;Array.isArray(e)?e.length===2?(r=o=e[0],s=i=e[1]):e.length===3?(r=e[0],s=i=e[1],o=e[2]):[r,i,o,s]=e:r=i=o=s=e,n.onBeforeLayout=(a,l)=>{if(l){n.width=n.children.reduce((f,p)=>f+(p.width||0),0)+s+i;const h=n.children[0];h&&(h.x=s,h.marginLeft=s);let d=0;return n.children.forEach(f=>{f.y=r,f.marginTop=r,d=Math.max(d,f.height||0)}),n.height=d+r+o,!0}}}function Hl(n,t){const e=Pe.createTexture("ImageTexture",{src:n});return t.reduce((r,s)=>{const{x:i,y:o,width:a,height:l}=s;return r[s.name]=Pe.createTexture("SubTexture",{texture:e,x:i,y:o,width:a,height:l}),r},{})}const{Artwork:{defaultTone:fu,...Vl}={themeStyles:{}}}=u==null?void 0:u.componentConfig,Xl={themeKeys:{fallbackSrc:"fallbackSrc",fillColor:"fillColor",scale:"imageScale",pivotX:"imageScalePivotX",pivotY:"imageScalePivotY",borderRadius:"radius"},base:{fallbackSrc:void 0,fillColor:u.color.overlay,gradientColor:u.color.material,pivotX:.5,pivotY:.5,scale:void 0,borderRadius:u.radius.md},themeStyles:Vl};U(Xl);const{Badge:{defaultTone:pu,...Bn}={themeStyles:{}}}=u.componentConfig,$l={themeKeys:{color:"backgroundColor",borderRadius:"radius",gap:"contentSpacing"},base:{color:u.color.fillInverseSecondary,borderRadius:u.radius.sm,border:{color:u.color.strokeInverse,width:u.stroke.sm},gap:u.spacer.xs,display:"flex",justifyContent:"spaceEvenly",padding:[u.spacer.md-u.stroke.sm,u.spacer.xs+u.stroke.sm,u.spacer.md+u.stroke.sm,u.spacer.md+u.stroke.sm]},tones:{inverse:{color:u.color.fillNeutralSecondary,borderRadius:u.radius.sm,border:{color:u.color.strokeInverseSecondary,width:u.stroke.sm}},brand:{color:u.color.fillBrand,borderRadius:u.radius.sm,border:{color:u.color.strokeInverseSecondary,width:u.stroke.sm}}},themeStyles:Bn},Gl={themeKeys:{color:"textColor"},base:{...u.typography.tag1,color:u.color.textNeutral},tones:{inverse:{color:u.color.textInverse},brand:{color:u.color.textNeutral}},themeStyles:Bn},Yl={themeKeys:{color:"iconColor"},base:{color:u.color.textNeutral},tones:{inverse:{color:u.color.textInverse},brand:{color:u.color.textNeutral}},themeStyles:Bn};U($l);U(Yl);U(Gl);const{Button:{defaultTone:Kl,...Ql}={buttonThemeStyles:{}}}=u==null?void 0:u.componentConfig,{Surface:{surfaceDefaultTone:jl,...ql}={surfaceThemeStyles:{}}}=u==null?void 0:u.componentConfig,Fn={...Ql,...ql},Zl={themeKeys:{textAlign:"textAlign",borderRadius:"radius",color:"backgroundColor",justifyContent:"justify",itemSpacing:"contentSpacing"},base:{height:u.typography.button1.lineHeight+u.spacer.xl*2,display:"flex",padding:[u.spacer.xxxl,u.spacer.xl],color:u.color.interactiveNeutral,justifyContent:"center",alignItems:"center",borderRadius:u.radius.sm,contentColor:u.color.fillNeutral},modes:{focus:{color:u.color.interactiveNeutralFocus,contentColor:u.color.fillInverse},disabled:{color:u.color.fillNeutralDisabled}},tones:{inverse:{color:u.color.interactiveInverse},brand:{color:u.color.interactiveBrand,focus:{color:u.color.fillNeutral}}},themeStyles:Fn},Jl={themeKeys:{color:"contentColor"},base:{color:u.color.textNeutral},modes:{focus:{color:u.color.textInverse},disabled:{color:u.color.textNeutralDisabled}},tones:{inverse:{color:u.color.fillNeutral},brand:{color:u.color.fillBrand,focus:{color:u.color.fillBrand}}},themeStyles:Fn},ec={themeKeys:{color:"textColor"},base:{color:u.color.textNeutral,...u.typography.button1},modes:{focus:{color:u.color.textInverse},disabled:{color:u.color.textNeutralDisabled}},tones:{inverse:{color:u.color.fillNeutral},brand:{color:u.color.fillBrand,focus:{color:u.color.fillBrand}}},themeStyles:Fn},tc=U(Zl),rc=U(Jl),nc=U(ec),gu={tone:Kl||jl||"neutral",Container:tc,Content:rc,Text:nc},{Checkbox:{defaultTone:mu,...ci}={themeStyles:{}}}=u==null?void 0:u.componentConfig,sc={themeKeys:{color:"backgroundColor",borderRadius:"radius",border:"border",justifyContent:"justifyContent"},base:{width:u.spacer.xxl,height:u.spacer.xxl,display:"flex",justifyContent:"center",color:u.color.fillNeutral,alignItems:"center",borderRadius:u.spacer.xxl/4,border:{color:u.color.strokeInverse,width:u.stroke.sm}},modes:{disabled:{alpha:u.alpha.inactive}},tones:{brand:{borderRadius:u.spacer.xxl/4,border:{color:u.color.strokeNeutralSecondary,width:u.stroke.sm},color:u.color.fillNeutralSecondary,checked:{borderRadius:u.spacer.xxl/4,border:{color:u.color.strokeNeutralSecondary,width:u.stroke.sm},color:u.color.fillBrand}},neutral:{borderRadius:u.spacer.xxl/4,border:{color:u.color.strokeNeutralSecondary,width:u.stroke.sm},color:u.color.fillInverseSecondary,checked:{borderRadius:u.spacer.xxl/4,border:{color:u.color.strokeNeutralSecondary,width:u.stroke.sm},color:u.color.fillNeutral}},inverse:{borderRadius:u.spacer.xxl/4,border:{color:u.color.strokeInverseSecondary,width:u.stroke.sm},color:u.color.fillNeutralSecondary,checked:{borderRadius:u.spacer.xxl/4,border:{color:u.color.strokeInverseSecondary,width:u.stroke.sm},color:u.color.fillInverse}}},modeKeys:["focus","disabled","checked"],themeStyles:ci},ic={themeKeys:{width:"checkWidth",height:"checkHeight"},base:{width:u.spacer.lg,height:u.spacer.lg,src:u.asset.check},tones:{neutral:{color:u.color.fillInverse},inverse:{color:u.color.fillNeutral},brand:{color:u.color.fillInverse}},themeStyles:ci};U(sc);U(ic);const{Icon:{defaultTone:xu,...oc}={themeStyles:{}}}=u==null?void 0:u.componentConfig,ac={themeKeys:{color:"color"},base:{width:100,height:100,color:u.color.fillInverse},tones:{inverse:{color:u.color.fillInverse},brand:{color:u.color.fillBrand}},themeStyles:oc};U(ac);const{Column:{defaultTone:lc,...cc}={themeStyles:{}}}=u==null?void 0:u.componentConfig,hc={themeKeys:{gap:"itemSpacing",scrollIndex:"scrollIndex",transition:"itemTransition"},base:{display:"flex",flexBoundary:"fixed",flexDirection:"column",gap:u.layout.gutterY,transition:{...u.animation.standardEntrance,duration:u.animation.duration.fast}},themeStyles:cc},uc=U(hc),Hr={tone:lc||"neutral",Container:uc},dc=n=>E(G,n),hi=n=>{const t=gr("up"),e=gr("down");return E(dc,Ae(n,{get gap(){return n.itemSpacing},get transition(){return n.itemTransition},get onUp(){return ze(n.onUp,t)},get onDown(){return ze(n.onDown,e)},get selected(){return n.selected||0},forwardFocus:li,get onCreate(){return ze(r=>{var s,i;return pr(n.y).call(r,r,r.children[(s=n.selected)!=null?s:0],(i=n.selected)!=null?i:0,void 0)},n.onLayout)},get onSelectedChanged(){return ze(n.onSelectedChanged,n.scroll!=="none"?pr(n.y):void 0)},get style(){var r;return[n.style,Hr.Container.tones[(r=n.tone)!=null?r:Hr.tone],Hr.Container.base]}}))},{Input:{defaultTone:yu,...Mn}={themeStyles:{}}}=u==null?void 0:u.componentConfig,fc={themeKeys:{justifyContent:"justify"},base:{display:"flex",justifyContent:"flexStart",flexDirection:"column",width:100,height:100,actualTitle:""},themeStyles:Mn},pc={themeKeys:{borderRadius:"radius",color:"backgroundColor"},base:{width:zl(4),height:100,display:"flex",flexDirection:"column",padding:[u.spacer.xxxl,u.spacer.xl],color:u.color.interactiveNeutral,contentColor:u.color.fillInverse,borderRadius:u.radius.sm,marginX:u.spacer.xxxl},themeStyles:Mn},gc={themeKeys:{color:"textColor"},base:{textAlign:"left",color:u.color.textNeutral,...u.typography.button1},themeStyles:Mn};U(fc);U(pc);U(gc);const{Key:{defaultTone:vu,...ui}={themeStyles:{}}}=u==null?void 0:u.componentConfig,mc={themeKeys:{keySpacing:"keySpacing",textAlign:"textAlign",borderRadius:"borderRadius",color:"backgroundColor",justifyContent:"justify",baseWidth:"baseWidth",sizes:"sizes",contentColor:"contentColor"},base:{keySpacing:u.spacer.md,height:u.spacer.md*9,paddingX:u.spacer.md,contentColor:u.color.fillNeutral,sizes:{sm:1,md:2,lg:3,xl:4,xxl:5},padding:[u.spacer.md],baseWidth:u.spacer.md*7,color:u.color.interactiveNeutral,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:u.radius.sm},modes:{focus:{color:u.color.interactiveNeutralFocus,contentColor:u.color.fillInverse},disabled:{color:u.color.fillNeutralDisabled,contentColor:u.color.fillNeutralDisabled}},tones:{inverse:{color:u.color.interactiveInverse,focus:{color:u.color.interactiveInverseFocus,contentColor:u.color.fillNeutral}},brand:{focus:{contentColor:u.color.fillNeutral}}},themeStyles:ui},xc={themeKeys:{color:"textColor"},base:{color:u.color.textNeutral,...u.typography.headline2},modes:{focus:{color:u.color.textInverse},disabled:{color:u.color.textNeutralDisabled}},tones:{inverse:{focus:{color:u.color.textNeutral}}},themeStyles:ui};U(mc);U(xc);const{Keyboard:{defaultTone:bu,...di}={}}=u==null?void 0:u.componentConfig,{Key:{...yc}={}}=u==null?void 0:u.componentConfig,vc={themeKeys:{gap:"keySpacing",width:"screenW",marginX:"marginX",keyHeight:"keyHeight"},base:{gap:u.spacer.md,width:u.layout.screenW,display:"flex",marginX:u.layout.marginX,keyHeight:100,flexBoundary:"contain"},themeStyles:di},bc={themeKeys:{gap:"keySpacing",textAlign:"textAlign",borderRadius:"borderRadius",color:"backgroundColor",justifyContent:"justify",baseWidth:"baseWidth",sizes:"sizes",contentColor:"contentColor"},base:{gap:u.spacer.md,height:u.spacer.md*9,sizes:{sm:1,md:2,lg:3,xl:4,xxl:5},contentColor:u.color.fillNeutral,padding:[u.spacer.xxxl,u.spacer.xl],baseWidth:u.spacer.md*7,color:u.color.interactiveNeutral,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:u.radius.sm},modes:{focus:{color:u.color.interactiveNeutralFocus,contentColor:u.color.fillInverse},disabled:{color:u.color.fillNeutralDisabled,contentColor:u.color.fillNeutralDisabled}},tones:{inverse:{color:u.color.interactiveInverse,focus:{color:u.color.interactiveInverseFocus,contentColor:u.color.fillNeutral}},brand:{focus:{contentColor:u.color.fillNeutral}}},themeStyles:yc},Ac={themeKeys:{color:"textColor"},base:{color:u.color.textNeutral,...u.typography.headline2},modes:{focus:{color:u.color.textInverse},disabled:{color:u.color.textNeutralDisabled}},tones:{inverse:{focus:{color:u.color.textNeutral}}},themeStyles:di};U(vc);U(bc);U(Ac);const{Row:{defaultTone:Tc,...wc}={themeStyles:{}}}=u==null?void 0:u.componentConfig,Sc={themeKeys:{gap:"itemSpacing",scrollIndex:"scrollIndex",transition:"itemTransition"},base:{display:"flex",flexBoundary:"fixed",flexDirection:"row",gap:u.layout.gutterX,transition:{...u.animation.standardEntrance,duration:u.animation.duration.fast}},themeStyles:wc},_c=U(Sc),Vr={tone:Tc,Container:_c},Rc=n=>{const t=gr("left"),e=gr("right");return E(G,Ae(n,{get selected(){return n.selected||0},get gap(){return n.itemSpacing},get transition(){return n.itemTransition},get scrollIndex(){return n.scrollIndex},get onLeft(){return ze(n.onLeft,t)},get onRight(){return ze(n.onRight,e)},forwardFocus:li,get onLayout(){return ze(r=>pr(n.x).call(r,r,r.children[r.selected],r.selected,void 0),n.onLayout)},get onSelectedChanged(){return ze(n.onSelectedChanged,n.scroll!=="none"?pr(n.x):void 0)},get style(){var r;return[n.style,Vr.Container.tones[(r=n.tone)!=null?r:Vr.tone],Vr.Container.base]}}))},{Label:{defaultTone:Au,...fi}={themeStyles:{}}}=u==null?void 0:u.componentConfig,Cc={themeKeys:{color:"backgroundColor",borderRadius:"radius"},base:{display:"flex",justifyContent:"center",color:u.color.textNeutral,padding:[u.spacer.md,u.spacer.lg],borderRadius:[u.radius.md,u.radius.md,u.radius.md,u.radius.none],height:u.typography.caption1.lineHeight+u.spacer.md,neutral:{backgroundColor:u.color.fillNeutral}},tones:{inverse:{color:u.color.fillInverse},brand:{color:u.color.fillBrand,focus:{color:u.color.orange}}},themeStyles:fi},Ec={themeKeys:{color:"textColor"},base:{...u.typography.caption1,color:u.color.textInverse},tones:{inverse:{color:u.color.textNeutral},brand:{color:u.color.textNeutral}},themeStyles:fi};U(Cc);U(Ec);const{Details:{defaultTone:Tu,...pi}={themeStyles:{}}}=u==null?void 0:u.componentConfig,Ic={themeKeys:{alignItems:"alignItems",gap:"contentSpacing",badgeContentSpacing:"badgeContentSpacing",ratingContentSpacing:"ratingContentSpacing"},base:{display:"flex",flexDirection:"row",alignItems:"center",gap:u.spacer.sm,flexBoundary:"contain",badgeContentSpacing:u.spacer.sm,ratingContentSpacing:u.spacer.sm},themeStyles:pi},Bc={themeKeys:{color:"textColor"},base:{...u.typography.body2,marginRight:u.spacer.lg,color:u.color.textNeutral},tones:{neutral:{disabled:{color:u.color.textNeutralDisabled}},inverse:{color:u.color.textInverse,disabled:{color:u.color.textNeutralDisabled}},brand:{color:u.color.textNeutral,disabled:{color:u.color.textNeutralDisabled}}},themeStyles:pi};U(Ic);U(Bc);const{Rating:{defaultTone:wu,...Ln}={themeStyles:{}}}=u==null?void 0:u.componentConfig,Fc={themeKeys:{justifyContent:"justifyContent",gap:"contentSpacing"},base:{display:"flex",flexDirection:"row",justifyContent:"flexStart",gap:u.spacer.sm,alignItems:"center"},themeStyles:Ln},Mc={themeKeys:{color:"textColor"},base:{color:u.color.textNeutral,...u.typography.body2},tones:{neutral:{disabled:{color:u.color.textNeutralDisabled}},inverse:{color:u.color.textInverse,disabled:{color:u.color.textNeutralDisabled}},brand:{color:u.color.textNeutral,disabled:{color:u.color.textNeutralDisabled}}},themeStyles:Ln},Lc={themeKeys:{color:"color"},base:{height:u.typography.body2.lineHeight,width:u.typography.body2.lineHeight,color:u.color.fillNeutral,marginRight:u.spacer.sm},themeStyles:Ln};U(Fc);U(Lc);U(Mc);const{Metadata:{defaultTone:Su,...kn}={themeStyles:{}}}=u==null?void 0:u.componentConfig,kc={themeKeys:{justifyContent:"justifyContent",alpha:"alpha"},base:{display:"flex",flexDirection:"column",justifyContent:"flexStart",flexBoundary:"contain",alpha:u.alpha.primary},modes:{disabled:{alpha:u.alpha.inactive}},themeStyles:kn},Pc={themeKeys:{color:"textColor"},base:{maxLines:1,contain:"width",...u.typography.headline3,color:u.color.textNeutral},tones:{neutral:{disabled:{color:u.color.textNeutralDisabled}},inverse:{color:u.color.textInverse,disabled:{color:u.color.textNeutralDisabled}},brand:{color:u.color.textNeutral,disabled:{color:u.color.textNeutralDisabled}}},themeStyles:kn},Nc={themeKeys:{color:"textColor"},base:{contain:"width",maxLines:2,...u.typography.body3,color:u.color.textNeutralSecondary},tones:{neutral:{disabled:{color:u.color.textNeutralDisabled}},inverse:{color:u.color.textInverseSecondary,disabled:{color:u.color.textNeutralDisabled}},brand:{color:u.color.textNeutralSecondary,disabled:{color:u.color.textNeutralDisabled}}},themeStyles:kn};U(kc);U(Nc);U(Pc);const{ProgressBar:{defaultTone:_u,...gi}={themeStyles:{}}}=u==null?void 0:u.componentConfig,Dc={themeKeys:{color:"barColor",borderRadius:"radius"},base:{height:u.spacer.md,color:u.color.fillNeutralTertiary,borderRadius:u.radius.xs},tones:{inverse:{color:u.color.fillInverseTertiary}},themeStyles:gi},Oc={themeKeys:{color:"progressColor",borderRadius:"radius"},base:{borderRadius:u.radius.xs,color:u.color.fillNeutral},tones:{inverse:{color:u.color.fillInverse},brand:{color:u.color.fillBrand}},themeStyles:gi};U(Dc);U(Oc);const{Radio:{defaultTone:Ru,...mi}={themeStyles:{}}}=u==null?void 0:u.componentConfig,Uc={themeKeys:{borderRadius:"radius",color:"backgroundColor",colorChecked:"backgroundColorChecked"},base:{color:u.color.fillNeutralSecondary,height:u.spacer.xxl+u.stroke.sm*2,width:u.spacer.xxl+u.stroke.sm*2,borderRadius:u.spacer.xxl/2+u.stroke.sm,border:{color:u.color.strokeNeutralSecondary,width:u.stroke.sm}},tones:{inverse:{border:{color:u.color.strokeInverseSecondary,width:u.stroke.sm}},brand:{border:{color:u.color.fillBrand,width:u.stroke.sm}}},modeKeys:["focus","disabled","checked"],themeStyles:mi},zc={themeKeys:{width:"knobWidth",height:"knobHeight",borderRadius:"knobRadius",color:"knobColor",colorChecked:"knobColorChecked"},base:{color:u.color.fillInverse,colorChecked:u.color.fillInverse,width:u.spacer.xxl,height:u.spacer.xxl,borderRadius:u.spacer.xxl/2},tones:{inverse:{color:u.color.fillNeutral}},themeStyles:mi};U(Uc);U(zc);const{Tile:{defaultTone:Cu,...Rr}={tileThemeStyles:{}}}=u==null?void 0:u.componentConfig,{Surface:{defaultSurfaceTone:Eu,...Wc}={surfaceThemeStyles:{}}}=u==null?void 0:u.componentConfig,Hc={themeKeys:{alpha:"alpha",paddingYProgress:"paddingYProgress",paddingYBetweenContent:"paddingYBetweenContent",contentSpacingY:"contentSpacingY",borderRadius:"radius"},base:{width:400,height:240,padding:[40,10],paddingYProgress:u.spacer.xl,paddingYBetweenContent:u.spacer.md,contentSpacingY:u.spacer.md,borderRadius:u.radius.md,alpha:u.alpha.primary},modes:{disabled:{alpha:u.alpha.inactive}},themeStyles:{...Wc,...Rr}},Vc={themeKeys:{},base:{display:"flex",flexDirection:"column",flexBoundary:"contain",mountY:1},themeStyles:Rr},Xc={themeKeys:{},base:{display:"flex",flexDirection:"column",justifyContent:"flexStart"},themeStyles:Rr},$c={themeKeys:{},base:{width:u.spacer.lg*5,height:u.spacer.xxl+u.spacer.md},themeStyles:Rr};U(Hc);U(Vc);U(Xc);U($c);const{Toggle:{defaultTone:Iu,...xi}={themeStyles:{}}}=u==null?void 0:u.componentConfig,Te=u.spacer.xl,Le=u.spacer.xs,me=u.stroke.sm,Gc={themeKeys:{borderRadius:"strokeRadius",color:"backgroundColor",colorChecked:"backgroundColorChecked"},base:{color:u.color.fillInverseTertiary,colorChecked:u.color.fillNeutral,height:Te+(Le+me)*2,width:(me+Le*2+Te)*2,borderRadius:Te/2+Le+me,border:{color:u.color.fillNeutral,width:me}},modes:{focus:{},disabled:{borderRadius:Te/2+Le+me,border:{color:u.color.fillNeutralDisabled,width:me},color:u.color.fillInverseDisabled,colorChecked:u.color.fillNeutralDisabled}},tones:{inverse:{borderRadius:Te/2+Le+me,border:{color:u.color.fillInverse,width:me},color:u.color.fillNeutralTertiary,colorChecked:u.color.fillInverse,disabled:{borderRadius:Te/2+Le+me,border:{color:u.color.fillInverseDisabled,width:me},color:u.color.fillNeutralDisabled,colorChecked:u.color.fillInverseDisabled}},brand:{borderRadius:Te/2+Le+me,border:{color:u.color.fillBrand,width:me},color:u.color.fillBrandTertiary,colorChecked:u.color.fillBrand,disabled:{borderRadius:Te/2+Le+me,border:{color:u.color.fillNeutralDisabled,width:me},color:u.color.fillInverseDisabled,colorChecked:u.color.fillNeutralDisabled}}},themeStyles:xi},Yc={themeKeys:{width:"knobWidth",height:"knobHeight",padding:"knobPadding",borderRadius:"knobRadius",color:"knobColor",colorChecked:"knobColorChecked"},base:{color:u.color.fillNeutral,colorChecked:u.color.fillInverse,width:Te,height:Te,borderRadius:Te/2,padding:Le},modes:{focus:{},disabled:{color:u.color.fillNeutralDisabled,colorChecked:u.color.fillInverseDisabled}},tones:{inverse:{color:u.color.fillInverse,colorChecked:u.color.fillNeutral,disabled:{color:u.color.fillInverseDisabled,colorChecked:u.color.fillNeutralDisabled}},brand:{color:u.color.fillBrand,colorChecked:u.color.fillInverse,disabled:{color:u.color.fillNeutralDisabled,colorChecked:u.color.fillInverseDisabled}}},themeStyles:xi};U(Gc);U(Yc);const Kc={color:255,height:150,width:330,x:1910,y:10,mountX:1,alpha:.8,zIndex:100},Re={x:10,fontSize:22,textColor:ur(4143380223)},Yt={fontSize:22,textColor:ur(4143380223)},[Qc,jc]=H(0),[qc,Zc]=H(0),[Jc,eh]=H(99),[th,rh]=H(0),[nh,sh]=H(0),[ih,oh]=H(0),[ah,lh]=H(0);let ss=0,is=0;const ch=n=>{n&&(jc(n),eh(t=>Math.min(n,t)),rh(t=>Math.max(n,t)),is+=n,ss++,Zc(Math.round(is/ss)))},hh=n=>{let t=0,e=0,r=0;n.txManager.textureIdCache.forEach(s=>{s.state==="loaded"&&t++,s.state==="loading"&&e++,s.state==="failed"&&r++}),sh(t),oh(e),lh(r)};function uh(n){n.renderer.on("fpsUpdate",(t,e)=>{const r=typeof e=="number"?e:e.fps;r>5&&(ch(r),hh(t.root.stage))})}const dh=n=>E(G,Ae(n,{style:Kc,get children(){return[E(G,{get children(){return[E(q,{style:Re,children:"FPS:"}),E(q,{style:Yt,x:90,get children(){return Qc().toString()}})]}}),E(G,{x:160,get children(){return[E(q,{style:Re,children:"AVG:"}),E(q,{style:Yt,x:100,get children(){return qc().toString()}})]}}),E(G,{x:0,y:20,get children(){return[E(q,{style:Re,children:"MIN:"}),E(q,{style:Yt,x:90,get children(){return Jc().toString()}})]}}),E(G,{x:160,y:20,get children(){return[E(q,{style:Re,children:"MAX:"}),E(q,{style:Yt,x:100,get children(){return th().toString()}})]}}),E(G,{x:0,y:50,get children(){return[E(q,{style:Re,children:"Loaded Textures Cnt:"}),E(q,{style:Re,x:270,get children(){return nh().toString()}})]}}),E(G,{x:0,y:80,get children(){return[E(q,{style:Re,children:"Loading Textures Cnt:"}),E(q,{style:Re,x:270,get children(){return ih().toString()}})]}}),E(G,{x:0,y:110,get children(){return[E(q,{style:Re,children:"Failed Textures Cnt:"}),E(q,{style:Re,x:270,get children(){return ah().toString()}})]}})]}})),un={Column:{flexDirection:"column",display:"flex",width:140,height:600,y:360,gap:20,zIndex:101,transition:{x:{duration:250,easing:"ease-in-out"}},x:8,focus:{width:500,x:u.layout.marginX}},Gradient:{zIndex:99,color:255,src:"./assets/sidenav.png",alpha:0,width:1200,height:1080,focus:{alpha:1},transition:{alpha:!0}},NavButton:{zIndex:102,height:70,width:100,borderRadius:8,focus:{color:1111638783},active:{width:328,height:70}}},fh="/solid-demo-app/",ph=[{name:"experiment",width:81,height:100,x:0,y:0},{name:"trending",width:100,height:56,x:81,y:0},{name:"tv",width:100,height:68,x:181,y:0},{name:"movie",width:94,height:100,x:282,y:0}];function gh(n){const t=Hl(fh+"assets/icons_white.png",ph);return E(G,Ae(n,{get texture(){return t[n.name]},get width(){return t[n.name].props.width},get height(){return t[n.name].props.height},get x(){return(100-(t[n.name].props.width||0))/2},get y(){return(100-(t[n.name].props.height||0))/2}}))}function Kt(n){return E(G,Ae(n,{forwardStates:!0,get style(){return un.NavButton},get children(){return[E(G,{y:-16,get children(){return E(gh,{scale:.5,get name(){return n.icon}})}}),E(q,{style:{fontSize:38,x:116,y:18,height:50,alpha:0,active:{alpha:1}},get children(){return n.children}})]}}))}function mh(n){let t;const e=In();function r(){t.states.add("focus"),this.children.forEach(o=>o.states.add("active")),this.children.selected.setFocus()}function s(){t.states.remove("focus"),this.selected=0,this.children.forEach(o=>o.states.remove("active"))}function i(o){if(Ha(()=>o)())return n.focusPage();e(o)}return[E(G,{flexItem:!1,width:300,height:150,x:30,y:15,zIndex:105,get alpha(){return n.showWidgets?1:0},get children(){return[E(q,{x:80,fontSize:28,color:4143380036,children:"Built With:"}),E(G,{y:22,src:"./assets/solidWord.png",width:280,height:52}),E(G,{x:0,y:110,src:"./assets/tmdb.png",width:80,height:41}),E(q,{x:90,y:110,contain:"width",width:160,fontSize:12,color:4143380036,children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]}}),E(hi,Ae(n,{onFocus:r,onBlur:s,get style(){return un.Column},scroll:"none",get children(){return[E(Kt,{onEnter:()=>i("/browse/all"),icon:"trending",children:"Trending"}),E(Kt,{icon:"movie",onEnter:()=>i("/browse/movie"),children:"Movies"}),E(Kt,{icon:"tv",onEnter:()=>i("/browse/tv"),children:"TV"}),E(Kt,{icon:"experiment",onEnter:()=>i("/examples"),children:"Examples"})]}})),E(G,{skipFocus:!0,ref(o){var a=t;typeof a=="function"?a(o):t=o},get style(){return un.Gradient}})]}const xh=n=>{gl({Announcer:["a"],Menu:["m"],Escape:["Escape",27],Backspace:["Backspace",8],Left:["ArrowLeft",37],Right:["ArrowRight",39],Up:["ArrowUp",38],Down:["ArrowDown",40],Enter:["Enter",13]}),Ll();const t=wl();t.enabled=!1;const e=In();let r,s;uh({renderer:Pe});function i(){return r.states.has("focus")?!1:(s=Sr(),r.setFocus())}const[o,a]=H(!0),l=ei(),h=["/browse","/entity"];return De(()=>{const d=l.pathname;let f=h.some(p=>d.startsWith(p));d==="/"&&(f=!0),a(f)}),E(G,{ref(d){var f=window.APP;typeof f=="function"?f(d):window.APP=d},onAnnouncer:()=>t.enabled=!t.enabled,onLast:()=>history.back(),onMenu:()=>e("/"),style:{width:1920,height:1080},onBackspace:i,onLeft:i,onRight:()=>r.states.has("focus")&&s.setFocus(),get children(){return[E(Nl,{}),E(dh,{mountX:1,x:1910,y:10,get alpha(){return o()?1:0}}),Sn(()=>n.children),E(mh,{ref(d){var f=r;typeof f=="function"?f(d):r=d},focusPage:()=>s.setFocus(),get showWidgets(){return o()}})]}})},mr={Page:{width:1920,height:1080},headlineText:{width:1200,height:240,x:360,y:455,contain:"both",fontSize:66,textAlign:"center"},headlineSubText:{width:960,height:170,x:530,y:655,contain:"both",fontSize:48,textAlign:"center"},itemsContainer:{width:u.layout.screenW,height:800,y:560,x:0,zIndex:2},Thumbnail:{borderRadius:16,width:185,height:278,scale:1,zIndex:2,transition:{scale:{duration:250,easing:"ease-in-out"}},border:{width:0,color:0},focus:{scale:1.1,border:{color:4294967142,width:8}}},FocusRing:{borderRadius:16,width:194,height:286,y:-5,x:-5,zIndex:-1},FPS:{color:255,height:42,width:140,x:20,y:20,zIndex:100},FPSLabel:{x:10,y:0,fontSize:36,textColor:4294967295},FPSValue:{x:90,y:0,fontSize:36,textColor:4294967295},showHeadline:{x:70,y:20},headlineBlur:{width:1920,height:150,x:0,y:0,zIndex:14,alpha:.9,color:255},RowTitle:{height:60,width:300,marginBottom:-40,fontSize:36,color:4042322175,zIndex:2},Row:{display:"flex",justifyContent:"spaceBetween",height:300},Column:{display:"flex",flexDirection:"column",justifyContent:"flexStart",flexBoundary:"contain",gap:64,width:u.layout.screenW-2*u.layout.marginX,x:u.layout.marginX+u.layout.gutterX,y:48,transition:{y:{duration:250,easing:"ease-in-out"}},zIndex:2},Rect:{width:250,height:100,y:10,x:300,color:65535},peopleBio:{...u.typography.body1,fontFamily:"Roboto",fontWeight:"normal",contain:"both",width:780,height:340}},xr={width:120,height:40,mount:.5,color:179,borderRadius:8,borderBottom:{width:2,color:4278254335},border:{width:2,color:4210752051},focus:{color:4210752255,borderRadius:20,borderBottom:{width:0,color:0}}},yh={color:10918399,height:8,y:2,x:-4,width:xr.width+8},vh={fontSize:12,y:12,contain:"width",textAlign:"center",color:4143380991,height:xr.height,width:xr.width},Bu={container:xr,topBar:yh,text:vh},os={width:386,height:136,color:1901898751,focus:{color:1513726719},disabled:{color:689783807}},Fu={fontSize:32,contain:"width",textAlign:"center",mountY:-.35,color:4294967295,height:os.height,width:os.width,focus:{fontSize:40},disabled:{color:2425393407}};function bh(n){function t(e){e.color=4294967295}return E(G,Ae(n,{color:16711935,onLoad:t,onFail:e=>e.src="failback.png",get style(){return mr.Thumbnail}}))}function Ah(n){const[t,e]=Aa(n,["items"]);return E(Rc,Ae(e,{get style(){return mr.Row},get children(){return E(wn,{get each(){return t.items},children:r=>E(bh,r)})}}))}const Th="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyZDE4YjEwMTA0YjdiZTlkNjFiMWYwYjVlMGEwNzM2OCIsInN1YiI6IjYwZTVjMTdlNGNhNjc2MDA3NTA4Njc3MSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.D_nqH9kd-bhhWzeVsTDPYhHnsUaNAuyAa6YATmKHqsA",wh="https://api.themoviedb.org/3";let yi,vi;const Sh="w185",_h={headers:{"Content-Type":"application/json",Authorization:"Bearer "+Th}};function Xr(n,t=Sh){return vi+t+n}function Rh(n,t={}){return yi?dn(n,t):bi().then(()=>dn(n,t))}function dn(n,t={}){return fetch(wh+n,{..._h,...t}).then(e=>e.json())}function bi(){return dn("/configuration").then(n=>{var t;return yi=n,vi=(t=n.images)==null?void 0:t.secure_base_url,n})}const Ch={get:Rh,loadConfig:bi};function Eh(n,t){return n.length>t?n.substring(0,t-3)+"...":n}function Ih(n,t=7){let e=[];for(let r=0,s=n.length;r<s;r+=t)e.push(n.slice(r,r+t));return e}function Bh(n=[]){return n.map(t=>({src:Xr(t.poster_path||t.profile_path),tileSrc:Xr(t.backdrop_path||t.profile_path,"w300"),backdrop:Xr(t.backdrop_path,"w1280"),href:"/entity/".concat(t.media_type||"people","/").concat(t.id),shortTitle:Eh(t.title||t.name,30),title:t.title||t.name,data:t,entityInfo:{type:t.media_type||"people",id:t.id},heroContent:{title:t.title||t.name,description:t.overview}}))}let $r=new Map;const Qt=new Map;function Fh(n){return t=>{const e="/trending/".concat(n,"/week?page=").concat(t);if($r.has(e))return $r.get(e);let r=Ch.get(e).then(s=>{let i=s.results.filter(l=>!l.adult),o=(Qt.has(n)?Qt.get(n):[]).concat(Bh(i)),a=Ih(o);return a[a.length-1].length<7?Qt.set(n,a.pop()):Qt.delete(n),a});return $r.set(e,r),r}}function Mh(n){const[t,e]=H([]),[r,s]=H(1),[i,o]=H(!1),[a]=Ls(r,n);return en(()=>{const l=a();l&&vn(()=>{l.length===0&&o(!0),e(h=>[...h,...l])})}),{pages:t,page:r,setPage:s,setPages:e,end:i,setEnd:o}}const Cr=900,Lh={display:"flex",flexDirection:"column",flexBoundary:"fixed",width:Cr,height:220,gap:16},kh={...u.typography.display2,fontFamily:"Roboto",fontWeight:700,maxLines:1,width:Cr,contain:"width"},Ph=n=>E(q,Ae(n,{style:kh})),Nh={...u.typography.body1,fontFamily:"Roboto",fontWeight:400,lineHeight:32,width:Cr,maxLines:3,contain:"width"},Dh={fontSize:16,lineHeight:20},Oh=n=>E(q,Ae(n,{style:Nh,get children(){return n.children}})),Uh=n=>(()=>{var t=_r("node");return Ba(Wl,t,()=>[8,13,11,13]),_n(t,Ae(n,{style:{color:"0x00000099",borderRadius:8,border:{width:2,color:"0xffffffff"}}}),!0),Ea(t,E(q,{style:Dh,get children(){return n.children}})),t})(),as={...u.typography.body2,fontFamily:"Roboto",fontWeight:400},zh=n=>E(G,{style:{display:"flex",flexDirection:"row",gap:18,width:Cr,height:48},get children(){return[E(G,{y:-4,src:"./assets/stars.png",width:188,height:31}),E(G,{y:-4,flexItem:!1,clipping:!0,get width(){return 188*n.voteAverage/10},height:31,get children(){return E(G,{src:"./assets/stars-full.png",width:188,height:31})}}),E(q,{style:as,get children(){return[Sn(()=>n.voteCount)," reviews"]}}),E(q,{style:as,get children(){return n.metaText}}),E(wn,{get each(){return n.badges},children:t=>E(Uh,{y:-5,children:t})})]}}),Wh=n=>E(G,Ae({id:"contentBlock",style:Lh},n,{get children(){return[E(Ph,{get children(){return n.content.title}}),E(Oh,{get children(){return n.content.description}}),E(wr,{get when(){return n.content.voteCount},get children(){return E(zh,{get metaText(){return n.content.metaText},get badges(){return n.content.badges},get voteCount(){return n.content.voteCount},get voteAverage(){return n.content.voteAverage}})}})]}})),ls=()=>{const n=Va(),[t,e]=H(0),[r,s]=H({}),i=In(),o=ua(()=>0),a=Q(()=>Mh(Fh(n.filter||"all"))),l=an(p=>Pl(p),400),h=an(p=>s(p||{}),200);De(qe(Sr,p=>{p.backdrop&&l(p.backdrop),p.heroContent&&h(p.heroContent)},{defer:!0}));function d(){var v;(v=this.children.selected)==null||v.setFocus(),e((this.y||0)*-1+24);let p=a().pages().length;this.parent.selected=this.parent.children.indexOf(this),(p===0||this.parent.selected&&this.parent.selected>=p-2)&&a().setPage(y=>y+1)}function f(){let p=this.children.find(v=>v.states.has("focus"));return L(p&&p.href),i(p.href),!0}return E(wr,{get when(){return a().pages().length},get children(){return[E(Wh,{y:360,x:162,get content(){return r()}}),E(G,{clipping:!0,get style(){return mr.itemsContainer},get children(){return E(hi,{id:"BrowseColumn",plinko:!0,announce:"All Trending - Week",get y(){return t()},scroll:"none",get style(){return mr.Column},get children(){return E(wn,{get each(){return a().pages()},children:(p,v)=>E(Ah,{get autofocus(){return o(v())},items:p,width:1620,onFocus:d,onEnter:f})})}})}})]}})},Hh=()=>(()=>{var n=_r("node");return Ia(n,"style",{width:1920,height:1080,color:868483072}),n})(),Ce="/solid-demo-app/";function Vh(n){n.fontManager.addFontFace(new Ye("msdf",{fontFamily:"Roboto",descriptors:{weight:700},atlasDataUrl:Ce+"fonts/Roboto-Bold.msdf.json",atlasUrl:Ce+"fonts/Roboto-Bold.msdf.png",stage:n})),n.fontManager.addFontFace(new Ye("msdf",{fontFamily:"Roboto",descriptors:{weight:500},atlasDataUrl:Ce+"fonts/Roboto-Medium.msdf.json",atlasUrl:Ce+"fonts/Roboto-Medium.msdf.png",stage:n})),n.fontManager.addFontFace(new Ye("msdf",{fontFamily:"Roboto",descriptors:{weight:400},atlasDataUrl:Ce+"fonts/Roboto-Regular.msdf.json",atlasUrl:Ce+"fonts/Roboto-Regular.msdf.png",stage:n})),n.fontManager.addFontFace(new Ye("msdf",{fontFamily:"Roboto",descriptors:{weight:100},atlasDataUrl:Ce+"fonts/Roboto-Thin.msdf.json",atlasUrl:Ce+"fonts/Roboto-Thin.msdf.png",stage:n})),n.fontManager.addFontFace(new Ye("msdf",{fontFamily:"Arial",descriptors:{weight:500},atlasDataUrl:Ce+"fonts/Roboto-Regular.msdf.json",atlasUrl:Ce+"fonts/Roboto-Regular.msdf.png",stage:n}))}const Xh=ye(()=>xe(()=>import("./Grid-B2ZkTAHG.js"),[])),$h=ye(()=>xe(()=>import("./Portal-BsW52hrt.js"),[])),Gh=ye(()=>xe(()=>import("./Text-C5W4XXsI.js"),[])),Yh=ye(()=>xe(()=>import("./Create-4xGeEmMp.js"),[])),Kh=ye(()=>xe(()=>import("./Viewport-CQ4RMtjj.js"),[])),Qh=ye(()=>xe(()=>import("./Buttons-CIjA7ER_.js"),[])),jh=ye(()=>xe(()=>import("./Flex-WYq83qQw.js"),[])),qh=ye(()=>xe(()=>import("./FlexSize-DBWyOked.js"),[])),Zh=ye(()=>xe(()=>import("./FlexColumnSize--ZQ51KZa.js"),[])),Jh=ye(()=>xe(()=>import("./FlexColumn-DGFx9530.js"),[])),eu=ye(()=>xe(()=>import("./ButtonsMaterial-BV09hQbH.js"),[])),tu=ye(()=>xe(()=>import("./SuperFlex-CJtK1QSz.js"),[])),ru=ye(()=>xe(()=>import("./Entity-SYzJbzBE.js"),[])),nu=ye(()=>xe(()=>import("./People-Cx8CBGPI.js"),[]));ae.debug=!1;ae.animationsEnabled=!0;ae.fontSettings.fontFamily="Roboto";ae.fontSettings.color=4143380223;ae.fontSettings.fontSize=32;ae.rendererOptions={fpsUpdateInterval:0,enableInspector:!0,numImageWorkers:2,deviceLogicalPixelRatio:window.innerHeight/1080};const{renderer:su,render:iu}=Ca();Vh(su.stage);iu(()=>E(al,{root:n=>E(xh,n),get children(){return[E(oe,{path:"",component:ls}),E(oe,{path:"examples",component:$h}),E(oe,{path:"browse/:filter",component:ls}),E(oe,{path:"grid",component:Xh}),E(oe,{path:"text",component:Gh}),E(oe,{path:"buttons",component:Qh}),E(oe,{path:"flex",component:jh}),E(oe,{path:"create",component:Yh}),E(oe,{path:"viewport",component:Kh}),E(oe,{path:"flexsize",component:qh}),E(oe,{path:"flexcolumnsize",component:Zh}),E(oe,{path:"flexcolumn",component:Jh}),E(oe,{path:"superflex",component:tu}),E(oe,{path:"buttonsmaterial",component:eu}),E(oe,{path:"entity/people/:id",component:nu}),E(oe,{path:"entity/:type/:id",component:ru}),E(oe,{path:"*all",component:Hh})]}}));function Mu(){const n=document.getElementById("video");return n.hidden=!1,setTimeout(()=>n.play(),50),n.focus(),n}function Lu(){const n=document.getElementById("video");return n.hidden=!0,n.pause(),n}export{Ch as A,Bh as B,hi as C,Xr as D,Va as E,wn as F,Wh as G,Ah as H,cu as I,Lu as J,Mu as K,Xs as L,Fu as M,Rc as R,wr as S,q as T,G as V,au as __vite_legacy_guard,Ls as a,en as b,H as c,vn as d,ua as e,De as f,lu as g,E as h,mr as i,L as j,ur as k,Sn as l,Ae as m,bn as n,qe as o,be as p,Bu as q,_r as r,Pl as s,u as t,In as u,Ba as v,Wl as w,_n as x,Ea as y,gu as z};
//# sourceMappingURL=index-DJrJ72Ns.js.map
