var Ei=Object.defineProperty;var Ii=(n,t,e)=>t in n?Ei(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var c=(n,t,e)=>Ii(n,typeof t!="symbol"?t+"":t,e);function _d(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();const Bi="modulepreload",Mi=function(n){return"/solid-demo-app/"+n},On={},ve=function(t,e,r){let s=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.all(e.map(a=>{if(a=Mi(a),a in On)return;On[a]=!0;const l=a.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(document.querySelector('link[href="'.concat(a,'"]').concat(h)))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":Bi,l||(f.as="script",f.crossOrigin=""),f.href=a,o&&f.setAttribute("nonce",o),document.head.appendChild(f),l)return new Promise((u,p)=>{f.addEventListener("load",u),f.addEventListener("error",()=>p(new Error("Unable to preload CSS for ".concat(a))))})}))}return s.then(()=>t()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};function Li(n,t){const e={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},r=n.getContext("webgl",e)||n.getContext("experimental-webgl",e);if(!r)throw new Error("Unable to create WebGL context");return t?new Proxy(r,{get(s,i){const o=s[i];return typeof o=="function"?(t.increment(String(i)),o.bind(s)):o}}):r}function F(n,t){if(!xn()&&!n)throw new Error(t||"Assertion failed")}function zn(n,t,e){const r=Math.trunc(n>>>24),s=Math.trunc(n>>>16&255),i=Math.trunc(n>>>8&255),o=Math.trunc(n&255),a=Math.trunc(t>>>24),l=Math.trunc(t>>>16&255),h=Math.trunc(t>>>8&255),f=Math.trunc(t&255),u=Math.round(a*e+r*(1-e)),p=Math.round(l*e+s*(1-e)),v=Math.round(h*e+i*(1-e)),m=Math.round(f*e+o*(1-e));return(u<<24|p<<16|v<<8|m)>>>0}function Fi(n,t){const e=n>>>24,r=n>>>16&255,s=n>>>8&255,i=Math.trunc((n&255)*t);return(e<<24|r<<16|s<<8|i)>>>0}let xs=!0;function Pi(n){xs=n==="webgl"}function Lt(n,t,e=!1){const r=(n&255)/255*t,s=xs?r:1,i=Math.trunc((n>>>24)*s),o=Math.trunc((n>>>16&255)*s),a=Math.trunc((n>>>8&255)*s),l=Math.trunc(r*255);return e?(l<<24|a<<16|o<<8|i)>>>0:(i<<24|o<<16|a<<8|l)>>>0}function Yr(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function xn(){return{BASE_URL:"/solid-demo-app/",DEV:!1,LEGACY:!1,MODE:"production",PROD:!0,SSR:!1}&&!0}let ki=1;function Ni(){return ki++}class He{constructor(){c(this,"eventListeners",{})}on(t,e){let r=this.eventListeners[t];r||(r=[]),r.push(e),this.eventListeners[t]=r}off(t,e){const r=this.eventListeners[t];if(!r)return;if(!e){delete this.eventListeners[t];return}const s=r.indexOf(e);s>=0&&r.splice(s,1)}once(t,e){const r=(s,i)=>{this.off(t,r),e(s,i)};this.on(t,r)}emit(t,e){const r=this.eventListeners[t];r&&[...r].forEach(s=>{s(this,e)})}removeAllListeners(){this.eventListeners={}}}const Di=/^(data|ftps?|https?):/,It=n=>{const t=n>>>24,e=n>>>16&255,r=n>>>8&255,s=n&255;return[t/255,e/255,r/255,s/255]},Ui=n=>{const t=n>>>24,e=n>>>16&255,r=n>>>8&255,s=n&255;return[t,e,r,s]};function Oi(n){return(n&255)/255}function Ir(n){const t=Math.floor(n[0]*255),e=Math.floor(n[1]*255),r=Math.floor(n[2]*255),s=Math.floor(n[3]*255);return"rgba(".concat(t,",").concat(e,",").concat(r,",").concat(s.toFixed(4),")")}function Ft(n,t,e,r,s){return s?(s.x1=n,s.y1=t,s.x2=e,s.y2=r,s):{x1:n,y1:t,x2:e,y2:r}}function Br(n,t){return n.x1<t.x2&&n.x2>t.x1&&n.y1<t.y2&&n.y2>t.y1}function zi(n,t){return t?(t.x=n.x1,t.y=n.y1,t.width=n.x2-n.x1,t.height=n.y2-n.y1,t):{x:n.x1,y:n.y1,width:n.x2-n.x1,height:n.y2-n.y1}}function ys(n,t,e){const r=Math.max(n.x,t.x),s=Math.max(n.y,t.y),i=Math.min(n.x+n.width,t.x+t.width)-r,o=Math.min(n.y+n.height,t.y+t.height)-s;return i>0&&o>0?e?(e.x=r,e.y=s,e.width=i,e.height=o,e):{x:r,y:s,width:i,height:o}:e?(e.x=0,e.y=0,e.width=0,e.height=0,e):{x:0,y:0,width:0,height:0}}function vs(n,t){return t?(t.x=n.x,t.y=n.y,t.width=n.width,t.height=n.height,t):{x:n.x,y:n.y,width:n.width,height:n.height}}function Wi(n,t){return n===t?!0:n===null||t===null?!1:n.x===t.x&&n.y===t.y&&n.width===t.width&&n.height===t.height}function Wn(n,t){return n.x1<=t.x2&&n.y1<=t.y2&&n.x2>=t.x1&&n.y2>=t.y1}function Hi(n){return n.x1<n.x2&&n.y1<n.y2}function Gi(n){if(self.location.protocol==="file:"&&!Di.test(n)){const e=self.location.pathname.split("/");e.pop();const r=e.join("/"),s=self.location.protocol+"//"+r;return n.charAt(0)==="."&&(n=n.slice(1)),n.charAt(0)==="/"&&(n=n.slice(1)),s+"/"+n}return new URL(n,self.location.href).href}class me{constructor(){c(this,"ta");c(this,"tb");c(this,"tx");c(this,"tc");c(this,"td");c(this,"ty");c(this,"_floatArr",null);c(this,"mutation");this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return Vi}static multiply(t,e,r){const s=t.ta*e.ta+t.tb*e.tc,i=t.ta*e.tb+t.tb*e.td,o=t.ta*e.tx+t.tb*e.ty+t.tx,a=t.tc*e.ta+t.td*e.tc,l=t.tc*e.tb+t.td*e.td,h=t.tc*e.tx+t.td*e.ty+t.ty;return r||(r=new me),r.ta=s,r.tb=i,r.tx=o,r.tc=a,r.td=l,r.ty=h,r.mutation=!0,r}static identity(t){return t||(t=new me),t.ta=1,t.tb=0,t.tx=0,t.tc=0,t.td=1,t.ty=0,t.mutation=!0,t}static translate(t,e,r){return r||(r=new me),r.ta=1,r.tb=0,r.tx=t,r.tc=0,r.td=1,r.ty=e,r.mutation=!0,r}static scale(t,e,r){return r||(r=new me),r.ta=t,r.tb=0,r.tx=0,r.tc=0,r.td=e,r.ty=0,r.mutation=!0,r}static rotate(t,e){const r=Math.cos(t),s=Math.sin(t);return e||(e=new me),e.ta=r,e.tb=-s,e.tx=0,e.tc=s,e.td=r,e.ty=0,e.mutation=!0,e}static copy(t,e){return e||(e=new me),e.ta=t.ta,e.tc=t.tc,e.tb=t.tb,e.td=t.td,e.tx=t.tx,e.ty=t.ty,e.mutation=!0,e}translate(t,e){return this.tx=this.ta*t+this.tb*e+this.tx,this.ty=this.tc*t+this.td*e+this.ty,this.mutation=!0,this}scale(t,e){return this.ta=this.ta*t,this.tb=this.tb*e,this.tc=this.tc*t,this.td=this.td*e,this.mutation=!0,this}rotate(t){if(t===0||!(t%Math.PI*2))return this;const e=Math.cos(t),r=Math.sin(t),s=this.ta*e+this.tb*r,i=this.tb*e-this.ta*r,o=this.tc*e+this.td*r,a=this.td*e-this.tc*r;return this.ta=s,this.tb=i,this.tc=o,this.td=a,this.mutation=!0,this}multiply(t){return me.multiply(this,t,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}const Vi=new me,Pt=0,kt=2,Nt=4,Dt=6,Ut=1,Ot=3,zt=5,Wt=7;class nr{constructor(t){c(this,"data");this.data=new Float32Array(8),t&&(this.data[Pt]=t[Pt],this.data[kt]=t[kt],this.data[Nt]=t[Nt],this.data[Dt]=t[Dt],this.data[Ut]=t[Ut],this.data[Ot]=t[Ot],this.data[zt]=t[zt],this.data[Wt]=t[Wt])}static translate(t,e,r,s,i,o,a,l,h){return h||(h=new nr),h.data[Pt]=t,h.data[kt]=r,h.data[Nt]=i,h.data[Dt]=a,h.data[Ut]=e,h.data[Ot]=s,h.data[zt]=o,h.data[Wt]=l,h}get x1(){return this.data[Pt]}get x2(){return this.data[kt]}get x3(){return this.data[Nt]}get x4(){return this.data[Dt]}get y1(){return this.data[Ut]}get y2(){return this.data[Ot]}get y3(){return this.data[zt]}get y4(){return this.data[Wt]}}const Hn=n=>n&&!(n&n-1),bs=(n,t,e,r)=>{const s=3*n,i=3*(e-n)-s,o=1-s-i,a=3*t,l=3*(r-t)-a,h=1-a-l;return function(f){if(f>=1)return 1;if(f<=0)return 0;let u=.5,p,v,m;for(let w=0;w<20;w++){if(p=u*(u*(u*o+i)+s),m=f-p,m>-1e-8&&m<1e-8)return u*(u*(u*h+l)+a);if(v=u*(u*(3*o)+2*i)+s,v>1e-10&&v<1e-10)break;u+=m/v}let x=0,A=1;for(let w=0;w<20;w++){if(u=.5*(x+A),p=u*(u*(u*o+i)+s),m=f-p,m>-1e-8&&m<1e-8)return u*(u*(u*h+l)+a);m<0?A=u:x=u}}},qt={},$i={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},Zt=n=>n,Xi=n=>{const t=/-?\d*\.?\d+/g,e=n.match(t);if(e){const[r,s,i,o]=e,a=parseFloat(r||"0.42"),l=parseFloat(s||"0"),h=parseFloat(i||"1"),f=parseFloat(o||"1"),u=bs(a,l,h,f);return qt[n]=u,u}return console.warn("Unknown cubic-bezier timing: "+n),Zt},Yi=n=>{if(n==="linear")return Zt;if(qt[n]!==void 0)return qt[n]||Zt;if(n==="step-start")return()=>1;if(n==="step-end")return e=>e===1?1:0;const t=$i[n];if(t!==void 0){const[e,r,s,i]=t,o=bs(e,r,s,i);return qt[n]=o,o}return n.startsWith("cubic-bezier")?Xi(n):(console.warn("Unknown timing function: "+n),Zt)};function Gn(n){return(n/1024/1024).toFixed(2)}class Ki extends He{constructor(e,r,s){var a,l,h,f,u,p;super();c(this,"node");c(this,"props");c(this,"settings");c(this,"progress",0);c(this,"delayFor",0);c(this,"timingFunction");c(this,"propValuesMap",{});c(this,"dynPropValuesMap");this.node=e,this.props=r;for(const v in r)if(v!=="shaderProps")this.propValuesMap.props===void 0&&(this.propValuesMap.props={}),this.propValuesMap.props[v]={start:e[v],target:r[v]};else if(e.shader.type!=="DynamicShader"){this.propValuesMap.shaderProps={};for(const m in r.shaderProps)this.propValuesMap.shaderProps[m]={start:e.shader.props[m],target:r.shaderProps[m]}}else{const m=Object.keys(r.shaderProps),x=m.length;this.dynPropValuesMap={};for(let A=0;A<x;A++){const w=m[A],y=r.shaderProps[w];this.dynPropValuesMap[w]={};const b=Object.entries(y),g=b.length;for(let T=0;T<g;T++){const[_,C]=b[T];this.dynPropValuesMap[w][_]={start:e.shader.props[w][_],target:C}}}}const i=s.easing||"linear",o=(a=s.delay)!=null?a:0;this.settings={duration:(l=s.duration)!=null?l:0,delay:o,easing:i,loop:(h=s.loop)!=null?h:!1,repeat:(f=s.repeat)!=null?f:0,repeatDelay:(u=s.repeatDelay)!=null?u:0,stopMethod:(p=s.stopMethod)!=null?p:!1},this.timingFunction=Yi(i),this.delayFor=o}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(e,r){const s=Object.entries(r),i=s.length;for(let o=0;o<i;o++){const[a,l]=s[o];e[a]=l.start}}restore(){if(this.reset(),this.propValuesMap.props!==void 0&&this.restoreValues(this.node,this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),r=e.length;if(r>0)for(let s=0;s<r;s++){const i=e[s];this.restoreValues(this.node.shader.props[i],this.dynPropValuesMap[i])}}}reverseValues(e){const r=Object.entries(e),s=r.length;for(let i=0;i<s;i++){const[o,a]=r[i];e[o]={start:a.target,target:a.start}}}reverse(){if(this.progress=0,this.propValuesMap.props!==void 0&&this.reverseValues(this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.reverseValues(this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),r=e.length;if(r>0)for(let s=0;s<r;s++){const i=e[s];this.reverseValues(this.dynPropValuesMap[i])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,r,s){return(this.timingFunction(e)||e)*(s-r)+r}updateValue(e,r,s,i){if(this.progress===1)return r;if(this.progress===0)return s;const o=r;if(e.indexOf("color")!==-1){if(s===o)return s;if(i){const a=this.timingFunction(this.progress)||this.progress;return zn(s,o,a)}return zn(s,o,this.progress)}return i?this.applyEasing(this.progress,s,o):s+(o-s)*this.progress}updateValues(e,r,s){const i=Object.entries(r),o=i.length;for(let a=0;a<o;a++){const[l,h]=i[a];e[l]=this.updateValue(l,h.target,h.start,s)}}update(e){const{duration:r,loop:s,easing:i,stopMethod:o}=this.settings,{delayFor:a}=this;if(r===0&&a===0){this.emit("finished",{});return}if(this.delayFor>0){if(this.delayFor-=e,this.delayFor>=0)return;e=-this.delayFor,this.delayFor=0}if(r===0){this.emit("finished",{});return}if(this.progress===0&&this.emit("animating",{}),this.progress+=e/r,this.progress>1&&(this.progress=s?0:1,o)){this.emit("finished",{});return}if(this.propValuesMap.props!==void 0&&this.updateValues(this.node,this.propValuesMap.props,i),this.propValuesMap.shaderProps!==void 0&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,i),this.dynPropValuesMap!==void 0){const l=Object.keys(this.dynPropValuesMap),h=l.length;if(h>0)for(let f=0;f<h;f++){const u=l[f];this.updateValues(this.node.shader.props[u],this.dynPropValuesMap[u],i)}}this.progress===1&&this.emit("finished",{})}}class Qi extends He{constructor(e,r){super();c(this,"manager");c(this,"animation");c(this,"stoppedPromise");c(this,"stoppedResolve",null);c(this,"state");this.manager=e,this.animation=r,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this)}start(){return this.state!=="running"&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="running"),this}stop(){return this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating)}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(e=>{this.stoppedResolve=e}))}onFinished(){F(this.stoppedResolve);const{loop:e,stopMethod:r}=this.animation.settings;if(r==="reverse"){this.animation.once("finished",this.onFinished),this.animation.reverse();return}e||(this.unregisterAnimation(),this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this),this.state="stopped")}onAnimating(){this.emit("animating",this)}}var we;(function(n){n[n.Init=0]="Init",n[n.OutOfBounds=2]="OutOfBounds",n[n.InBounds=4]="InBounds",n[n.InViewport=8]="InViewport"})(we||(we={}));const Bt=new Map;Bt.set(we.Init,"init");Bt.set(we.OutOfBounds,"outOfBounds");Bt.set(we.InBounds,"inBounds");Bt.set(we.InViewport,"inViewport");var M;(function(n){n[n.Children=1]="Children",n[n.ScaleRotate=2]="ScaleRotate",n[n.Local=4]="Local",n[n.Global=8]="Global",n[n.Clipping=16]="Clipping",n[n.CalculatedZIndex=32]="CalculatedZIndex",n[n.ZIndexSortedChildren=64]="ZIndexSortedChildren",n[n.PremultipliedColors=128]="PremultipliedColors",n[n.WorldAlpha=256]="WorldAlpha",n[n.RenderState=512]="RenderState",n[n.IsRenderable=1024]="IsRenderable",n[n.RenderTexture=2048]="RenderTexture",n[n.ParentRenderTexture=4096]="ParentRenderTexture",n[n.None=0]="None",n[n.All=8191]="All"})(M||(M={}));class Kr extends He{constructor(e,r){super();c(this,"stage");c(this,"children",[]);c(this,"_id",Ni());c(this,"props");c(this,"updateType",M.All);c(this,"globalTransform");c(this,"scaleRotateTransform");c(this,"localTransform");c(this,"renderCoords");c(this,"renderBound");c(this,"strictBound");c(this,"preloadBound");c(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1});c(this,"isRenderable",!1);c(this,"renderState",we.Init);c(this,"worldAlpha",1);c(this,"premultipliedColorTl",0);c(this,"premultipliedColorTr",0);c(this,"premultipliedColorBl",0);c(this,"premultipliedColorBr",0);c(this,"calcZIndex",0);c(this,"hasRTTupdates",!1);c(this,"parentHasRenderTexture",!1);c(this,"onTextureLoaded",(e,r)=>{var s,i;this.autosizeNode(r),this.stage.requestRender(),this.parentHasRenderTexture&&this.setRTTUpdates(1),this.emit("loaded",{type:"texture",dimensions:r}),((i=(s=this.props.textureOptions)==null?void 0:s.resizeMode)==null?void 0:i.type)==="contain"&&this.setUpdateType(M.Local)});c(this,"onTextureFailed",(e,r)=>{this.emit("failed",{type:"texture",error:r})});c(this,"onTextureFreed",()=>{this.emit("freed",{type:"texture"})});this.stage=e,this.props={...r,parent:null,texture:null,src:null,rtt:!1},this.parent=r.parent,this.texture=r.texture,this.src=r.src,this.rtt=r.rtt,this.updateScaleRotateTransform()}loadTexture(){const{texture:e}=this.props;F(e),queueMicrotask(()=>{this.textureOptions.preload&&e.ctxTexture.load(),e.state==="loaded"?(F(e.dimensions),this.onTextureLoaded(e,e.dimensions)):e.state==="failed"?(F(e.error),this.onTextureFailed(e,e.error)):e.state==="freed"&&this.onTextureFreed(e),e.on("loaded",this.onTextureLoaded),e.on("failed",this.onTextureFailed),e.on("freed",this.onTextureFreed)})}unloadTexture(){this.texture&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this,!1))}autosizeNode(e){this.autosize&&(this.width=e.width,this.height=e.height)}setUpdateType(e){this.updateType|=e;const r=this.props.parent;r&&!(r.updateType&M.Children)&&r.setUpdateType(M.Children),this.parentHasRenderTexture&&this.setRTTUpdates(e)}sortChildren(){this.children.sort((e,r)=>e.calcZIndex-r.calcZIndex)}updateScaleRotateTransform(){const{rotation:e,scaleX:r,scaleY:s}=this.props;if(e===0&&r===1&&s===1){this.scaleRotateTransform=void 0;return}this.scaleRotateTransform=me.rotate(e,this.scaleRotateTransform).scale(r,s)}updateLocalTransform(){var h,f;const{x:e,y:r,width:s,height:i}=this.props,o=this.props.mountX*s,a=this.props.mountY*i;if(this.scaleRotateTransform){const u=this.props.pivotX*s,p=this.props.pivotY*i;this.localTransform=me.translate(e-o+u,r-a+p,this.localTransform).multiply(this.scaleRotateTransform).translate(-u,-p)}else this.localTransform=me.translate(e-o,r-a,this.localTransform);const l=this.props.texture;if(l&&l.dimensions&&((f=(h=this.props.textureOptions)==null?void 0:h.resizeMode)==null?void 0:f.type)==="contain"){let u=1,p=1,v=0,m=0;const{width:x,height:A}=l.dimensions,w=x/A,y=s/i;if(w>y){const b=s/x,g=A*b;m=(i-g)/2,p=g/i}else{const b=i/A,g=x*b;v=(s-g)/2,u=g/s}this.localTransform.translate(v,m).scale(u,p)}this.setUpdateType(M.Global)}update(e,r){var o;this.updateType&M.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(M.Local)),this.updateType&M.Local&&(this.updateLocalTransform(),this.setUpdateType(M.Global));const s=this.props.parent;let i=M.None;if(this.updateType&M.ParentRenderTexture){let a=this.parent;for(;a;)a.rtt&&(this.parentHasRenderTexture=!0),a=a.parent}this.updateType^M.All&&this.updateType&M.RenderTexture&&this.children.forEach(a=>{a.setUpdateType(M.All)}),this.updateType&M.Global&&(F(this.localTransform),this.globalTransform=me.copy((s==null?void 0:s.globalTransform)||this.localTransform,this.globalTransform),this.parentHasRenderTexture&&((o=this.props.parent)!=null&&o.rtt)&&(this.globalTransform=me.identity()),s&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(M.Clipping|M.RenderState|M.Children),i|=M.Global),this.updateType&M.Clipping&&(this.calculateClippingRect(r),this.setUpdateType(M.Children),i|=M.Clipping),this.updateType&M.WorldAlpha&&(s?this.worldAlpha=s.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(M.Children|M.PremultipliedColors|M.IsRenderable),i|=M.WorldAlpha),this.updateType&M.PremultipliedColors&&(this.premultipliedColorTl=Lt(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=Lt(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=Lt(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=Lt(this.props.colorBr,this.worldAlpha,!0))),this.updateType&M.RenderState&&(this.updateRenderState(r),this.setUpdateType(M.IsRenderable)),this.updateType&M.IsRenderable&&this.updateIsRenderable(),s&&this.updateType&M.CalculatedZIndex&&(this.calculateZIndex(),s.setUpdateType(M.ZIndexSortedChildren)),this.updateType&M.Children&&this.children.length&&!this.rtt&&this.children.forEach(a=>{a.setUpdateType(i),a.updateType!==0&&a.update(e,this.clippingRect)}),this.updateType&M.ZIndexSortedChildren&&this.sortChildren(),this.updateType=0}checkRenderProps(){return this.props.texture?!0:!this.props.width||!this.props.height?!1:!!(this.props.shader!==this.stage.defShaderCtr||this.props.clipping||this.props.color!==0||this.props.colorTop!==0||this.props.colorBottom!==0||this.props.colorLeft!==0||this.props.colorRight!==0||this.props.colorTl!==0||this.props.colorTr!==0||this.props.colorBl!==0||this.props.colorBr!==0)}checkRenderBounds(e){F(this.renderBound);const r=e.width||this.stage.root.width,s=e.height||this.stage.root.height;if(this.strictBound=Ft(e.x,e.y,e.x+r,e.y+s,this.strictBound),Wn(this.renderBound,this.strictBound))return we.InViewport;const i=this.stage.boundsMargin;return this.preloadBound=Ft(this.strictBound.x1-i[3],this.strictBound.y1-i[0],this.strictBound.x2+i[1],this.strictBound.y2+i[2],this.preloadBound),Wn(this.renderBound,this.preloadBound)?we.InBounds:we.OutOfBounds}updateRenderState(e){const r=this.checkRenderBounds(e);if(r===this.renderState)return;const s=this.renderState;this.renderState=r;const i=Bt.get(r);F(i),this.emit(i,{previous:s,current:r})}updateIsRenderable(){let e;this.worldAlpha===0||!this.checkRenderProps()?e=!1:e=this.renderState>we.OutOfBounds,this.isRenderable!==e&&(this.isRenderable=e,this.onChangeIsRenderable(e))}onChangeIsRenderable(e){var r;(r=this.texture)==null||r.setRenderableOwner(this,e)}calculateRenderCoords(){const{width:e,height:r,globalTransform:s}=this;F(s);const{tx:i,ty:o,ta:a,tb:l,tc:h,td:f}=s;if(l===0&&h===0){const u=i,p=i+e*a,v=o,m=o+r*f;this.renderCoords=nr.translate(u,v,p,v,p,m,u,m,this.renderCoords)}else this.renderCoords=nr.translate(i,o,i+e*a,o+e*h,i+e*a+r*l,o+e*h+r*f,i+r*l,o+r*f,this.renderCoords)}updateBoundingRect(){const{renderCoords:e,globalTransform:r}=this;F(r),F(e);const{tb:s,tc:i}=r,{x1:o,y1:a,x3:l,y3:h}=e;if(s===0||i===0)this.renderBound=Ft(o,a,l,h,this.renderBound);else{const{x2:f,x4:u,y2:p,y4:v}=e;this.renderBound=Ft(Math.min(o,f,l,u),Math.min(a,p,h,v),Math.max(o,f,l,u),Math.max(a,p,h,v),this.renderBound)}}calculateClippingRect(e){F(this.globalTransform);const{clippingRect:r,props:s,globalTransform:i}=this,{clipping:o}=s,a=i.tb!==0||i.tc!==0;o&&!a?(r.x=i.tx,r.y=i.ty,r.width=this.width*i.ta,r.height=this.height*i.td,r.valid=!0):r.valid=!1,e.valid&&r.valid?ys(e,r,r):e.valid&&(vs(e,r),r.valid=!0)}calculateZIndex(){var o,a;const e=this.props,r=e.zIndex||0,s=((o=e.parent)==null?void 0:o.zIndex)||0;let i=r;(a=e.parent)!=null&&a.zIndexLocked&&(i=r<s?r:s),this.calcZIndex=i}destroy(){this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,delete this.renderCoords,delete this.renderBound,delete this.strictBound,delete this.preloadBound,delete this.globalTransform,delete this.scaleRotateTransform,delete this.localTransform,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;const e=[...this.children];for(let r=0;r<e.length;r++)e[r].destroy();this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}renderQuads(e){const{texture:r,width:s,height:i,textureOptions:o,rtt:a,shader:l}=this.props;if(this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode))return;const{premultipliedColorTl:h,premultipliedColorTr:f,premultipliedColorBl:u,premultipliedColorBr:p}=this,{zIndex:v,worldAlpha:m,globalTransform:x,clippingRect:A,renderCoords:w}=this;F(x),F(w),e.addQuad({width:s,height:i,colorTl:h,colorTr:f,colorBl:u,colorBr:p,texture:r,textureOptions:o,zIndex:v,shader:l.shader,shaderProps:l.getResolvedProps(),alpha:m,clippingRect:A,tx:x.tx,ty:x.ty,ta:x.ta,tb:x.tb,tc:x.tc,td:x.td,renderCoords:w,rtt:a,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions})}get id(){return this._id}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(M.Local))}get absX(){var e,r,s;return this.props.x+(((e=this.props.parent)==null?void 0:e.absX)||((s=(r=this.props.parent)==null?void 0:r.globalTransform)==null?void 0:s.tx)||0)}get absY(){var e,r;return this.props.y+((r=(e=this.props.parent)==null?void 0:e.absY)!=null?r:0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(M.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(M.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(M.RenderTexture)))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(M.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(M.RenderTexture)))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(M.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(M.ScaleRotate))}get mount(){return this.props.mount}set mount(e){(this.props.mountX!==e||this.props.mountY!==e)&&(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(M.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(M.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(M.Local))}get pivot(){return this.props.pivot}set pivot(e){(this.props.pivotX!==e||this.props.pivotY!==e)&&(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(M.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(M.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(M.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(M.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(M.PremultipliedColors|M.WorldAlpha)}get autosize(){return this.props.autosize}set autosize(e){this.props.autosize=e}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(M.Clipping)}get color(){return this.props.color}set color(e){this.colorTop=e,this.colorBottom=e,this.colorLeft=e,this.colorRight=e,this.props.color=e,this.setUpdateType(M.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){(this.props.colorTl!==e||this.props.colorTr!==e)&&(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(M.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){(this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(M.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){(this.props.colorTl!==e||this.props.colorBl!==e)&&(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(M.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){(this.props.colorTr!==e||this.props.colorBr!==e)&&(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(M.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(M.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(M.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(M.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(M.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(M.CalculatedZIndex|M.Children),this.children.forEach(r=>{r.setUpdateType(M.CalculatedZIndex)})}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(M.CalculatedZIndex|M.Children),this.children.forEach(r=>{r.setUpdateType(M.CalculatedZIndex)})}get parent(){return this.props.parent}set parent(e){const r=this.props.parent;if(r!==e){if(this.props.parent=e,r){const s=r.children.indexOf(this);F(s!==-1,"CoreNode.parent: Node not found in old parent's children!"),r.children.splice(s,1),r.setUpdateType(M.Children|M.ZIndexSortedChildren)}e&&(e.children.push(this),this.setUpdateType(M.All),e.setUpdateType(M.Children|M.ZIndexSortedChildren),(e.rtt||e.parentHasRenderTexture)&&this.setRTTUpdates(M.All)),this.updateScaleRotateTransform()}}get rtt(){return this.props.rtt}set rtt(e){var r,s;if(this.props.rtt===!0&&(this.props.rtt=e,e===!1&&this.texture!==null)){this.unloadTexture(),this.setUpdateType(M.All),this.children.forEach(i=>{i.parentHasRenderTexture=!1}),(r=this.stage.renderer)==null||r.removeRTTNode(this);return}e!==!1&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.props.rtt=!0,this.hasRTTupdates=!0,this.setUpdateType(M.All),this.children.forEach(i=>{i.setUpdateType(M.All)}),(s=this.stage.renderer)==null||s.renderToTexture(this))}get shader(){return this.props.shader}set shader(e){this.props.shader!==e&&(this.props.shader=e,this.setUpdateType(M.IsRenderable))}get src(){return this.props.src}set src(e){if(this.props.src!==e){if(this.props.src=e,!e){this.texture=null;return}this.texture=this.stage.txManager.loadTexture("ImageTexture",{src:e})}}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){let e=this.parent;for(;e;){if(e.rtt)return e;e=e.parent}return null}get texture(){return this.props.texture}set texture(e){if(this.props.texture===e)return;const r=this.props.texture;r&&(r.setRenderableOwner(this,!1),this.unloadTexture()),this.props.texture=e,e&&(e.setRenderableOwner(this,this.isRenderable),this.loadTexture()),this.setUpdateType(M.IsRenderable)}set textureOptions(e){this.props.textureOptions=e}get textureOptions(){return this.props.textureOptions}setRTTUpdates(e){var r;this.hasRTTupdates=!0,(r=this.parent)==null||r.setRTTUpdates(e)}animate(e,r){const s=new Ki(this,e,r);return new Qi(this.stage.animationManager,s)}flush(){}}const Ht={alpha:n=>n===1?null:{prop:"opacity",value:"".concat(n)},x:n=>({prop:"left",value:"".concat(n,"px")}),y:n=>({prop:"top",value:"".concat(n,"px")}),width:n=>n===0?null:{prop:"width",value:"".concat(n,"px")},height:n=>n===0?null:{prop:"height",value:"".concat(n,"px")},zIndex:()=>"zIndex",fontFamily:()=>"font-family",fontSize:()=>"font-size",fontStyle:()=>"font-style",fontWeight:()=>"font-weight",fontStretch:()=>"font-stretch",lineHeight:()=>"line-height",letterSpacing:()=>"letter-spacing",textAlign:()=>"text-align",overflowSuffix:()=>"overflow-suffix",maxLines:()=>"max-lines",contain:()=>"contain",verticalAlign:()=>"vertical-align",clipping:n=>n===!1?null:{prop:"overflow",value:n?"hidden":"visible"},rotation:n=>n===0?null:{prop:"transform",value:"rotate(".concat(n,"rad)")},scale:n=>n===1?null:{prop:"transform",value:"scale(".concat(n,")")},scaleX:n=>n===1?null:{prop:"transform",value:"scaleX(".concat(n,")")},scaleY:n=>n===1?null:{prop:"transform",value:"scaleY(".concat(n,")")},color:n=>n===0?null:{prop:"color",value:As(n)}},As=n=>{const t=(n&255)/255,e=n>>8&255,r=n>>16&255,s=n>>24&255;return"rgba(".concat(s,",").concat(r,",").concat(e,",").concat(t,")")},Vn={id:"id"};class ji{constructor(t,e){c(this,"root",null);c(this,"canvas",null);c(this,"height",1080);c(this,"width",1920);c(this,"scaleX",1);c(this,"scaleY",1);var i,o,a,l,h,f;if(xn())return;if(!e)throw new Error("settings is required");this.height=Math.ceil((o=e.appHeight)!=null?o:1080/((i=e.deviceLogicalPixelRatio)!=null?i:1)),this.width=Math.ceil((l=e.appWidth)!=null?l:1900/((a=e.deviceLogicalPixelRatio)!=null?a:1)),this.scaleX=(h=e.deviceLogicalPixelRatio)!=null?h:1,this.scaleY=(f=e.deviceLogicalPixelRatio)!=null?f:1,this.canvas=t,this.root=document.createElement("div"),this.setRootPosition(),document.body.appendChild(this.root),new MutationObserver(this.setRootPosition.bind(this)).observe(t,{attributes:!0,childList:!1,subtree:!1}),new ResizeObserver(this.setRootPosition.bind(this)).observe(t),window.addEventListener("resize",this.setRootPosition.bind(this)),console.warn("Inspector is enabled, this will impact performance")}setRootPosition(){if(this.root===null||this.canvas===null)return;const t=this.canvas.getBoundingClientRect(),e=document.documentElement.scrollTop+t.top,r=document.documentElement.scrollLeft+t.left;this.root.id="root",this.root.style.left="".concat(r,"px"),this.root.style.top="".concat(e,"px"),this.root.style.width="".concat(this.width,"px"),this.root.style.height="".concat(this.height,"px"),this.root.style.position="absolute",this.root.style.transformOrigin="0 0 0",this.root.style.transform="scale(".concat(this.scaleX,", ").concat(this.scaleY,")"),this.root.style.overflow="hidden",this.root.style.zIndex="65534"}createDiv(t,e){const r=document.createElement("div");r.style.position="absolute",r.id=t.toString();for(const s in e)this.updateNodeProperty(r,s,e[s]);return r}createNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,this.createProxy(t,e)}createTextNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,this.createProxy(t,e)}createProxy(t,e){return new Proxy(t,{set:(r,s,i)=>(this.updateNodeProperty(e,s,i),Reflect.set(r,s,i)),get:(r,s,i)=>(s==="destroy"&&this.destroyNode(r.id),s==="animate"?(o,a)=>{const l=r.animate(o,a);return new Proxy(l,{get:(h,f,u)=>(f==="start"&&this.animateNode(e,o,a),Reflect.get(h,f,u))})}:Reflect.get(r,s,i))})}destroyNode(t){const e=document.getElementById(t.toString());e==null||e.remove()}updateNodeProperty(t,e,r){var s;if(!(this.root===null||r===void 0||r===null)){if(e==="parent"){const i=r.id;if(i===1){this.root.appendChild(t);return}const o=document.getElementById(i.toString());o==null||o.appendChild(t);return}if(e==="text"){t.innerHTML=String(r),t.style.visibility="hidden";return}if(e==="src"&&r){t.setAttribute("data-src",String(r));return}if(Ht[e]){const i=(s=Ht[e])==null?void 0:s.call(Ht,r);if(i===null)return;if(typeof i=="string"){t.style.setProperty(i,String(r));return}typeof i=="object"&&t.style.setProperty(i.prop,i.value);return}if(Vn[e]){const i=Vn[e];if(!i)return;t.setAttribute(String(i),String(r));return}if(e==="data"){for(const i in r){const o=r[i];o===void 0?t.removeAttribute("data-".concat(i)):t.setAttribute("data-".concat(i),String(o))}return}}}animateNode(t,e,r){const{duration:s=1e3,delay:i=0}=r,{x:o,y:a,width:l,height:h,alpha:f=1,rotation:u=0,scale:p=1,color:v}=e;function m(){setTimeout(()=>{t.style.top="".concat(a,"px"),t.style.left="".concat(o,"px"),t.style.width="".concat(l,"px"),t.style.height="".concat(h,"px"),t.style.opacity="".concat(f),t.style.rotate="".concat(u,"rad"),t.style.scale="".concat(p),t.style.color=As(v)},s)}setTimeout(m,i)}}const qi=n=>{let t=!1;const e=()=>{if(n.updateFrameTime(),n.updateAnimations(),!n.hasSceneUpdates()){n.calculateFps(),setTimeout(e,16.666666666666668),t||(n.txMemManager.checkCleanup()&&n.txMemManager.cleanup(),n.eventBus.emit("idle"),t=!0),n.flushFrameEvents();return}t=!1,n.drawFrame(),n.flushFrameEvents(),requestAnimationFrame(e)};requestAnimationFrame(e)},Zi=()=>performance?performance.now():Date.now();class Ts{constructor(t,e){c(this,"textureSource");c(this,"memManager");this.memManager=t,this.textureSource=e}setTextureMemUse(t){this.memManager.setTextureMemUse(this.textureSource,t)}get renderable(){return this.textureSource.renderable}}class Ss{constructor(t){c(this,"options");c(this,"mode");c(this,"stage");c(this,"txManager");c(this,"txMemManager");c(this,"shManager");c(this,"rttNodes",[]);this.options=t,this.stage=t.stage,this.txManager=t.txManager,this.txMemManager=t.txMemManager,this.shManager=t.shManager}}class Ji{}class ws{static makeCacheKey(t){return!1}static resolveDefaults(t){return{}}}function $n(n,t,e){const r=n.createShader(t);if(!r)throw new Error;if(n.shaderSource(r,e),n.compileShader(r),n.getShaderParameter(r,n.COMPILE_STATUS))return r;console.log(n.getShaderInfoLog(r)),n.deleteShader(r)}function eo(n,t,e){const r=n.createProgram();if(!r)throw new Error;if(n.attachShader(r,t),n.attachShader(r,e),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS))return r;console.log(n.getProgramInfoLog(r)),n.deleteProgram(r)}class Ge extends ws{constructor(e){super();c(this,"boundBufferCollection",null);c(this,"buffersBound",!1);c(this,"program");c(this,"vao");c(this,"renderer");c(this,"glw");c(this,"attributeBuffers");c(this,"attributeLocations");c(this,"attributeNames");c(this,"uniformLocations");c(this,"uniformTypes");c(this,"supportsIndexedTextures");const r=this.renderer=e.renderer,s=this.glw=this.renderer.glw;this.supportsIndexedTextures=e.supportsIndexedTextures||!1;const i=s.isWebGl2(),o=i&&e.webgl2Extensions||!i&&e.webgl1Extensions||[],a=i?"2.0":"1.0";o.forEach(x=>{if(!s.getExtension(x))throw new Error('Shader "'.concat(this.constructor.name,'" requires extension "').concat(x,'" for WebGL ').concat(a," but wasn't found"))});const l=e.shaderSources||this.constructor.shaderSources;if(l)i&&(l!=null&&l.webGl2)&&(l.fragment=l.webGl2.fragment,l.vertex=l.webGl2.vertex,delete l.webGl2);else throw new Error('Shader "'.concat(this.constructor.name,'" is missing shaderSources.'));const h=r.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,f=l.vertex instanceof Function?l.vertex(h):l.vertex,u=l.fragment instanceof Function?l.fragment(h):l.fragment,p=$n(s,s.VERTEX_SHADER,f),v=$n(s,s.FRAGMENT_SHADER,u);if(!p||!v)throw new Error;const m=eo(s,p,v);if(!m)throw new Error;if(this.program=m,i){const x=s.createVertexArray();if(!x)throw new Error;this.vao=x,s.bindVertexArray(this.vao)}this.attributeLocations={},this.attributeBuffers={},this.attributeNames=[],[...e.attributes].forEach(x=>{const A=s.getAttribLocation(this.program,x);if(A<0)throw new Error("".concat(this.constructor.name,': Vertex shader must have an attribute "').concat(x,'"!'));const w=s.createBuffer();if(!w)throw new Error("".concat(this.constructor.name,': Could not create buffer for attribute "').concat(x,'"'));this.attributeLocations[x]=A,this.attributeBuffers[x]=w,this.attributeNames.push(x)}),this.uniformLocations={},this.uniformTypes={},e.uniforms.forEach(x=>{const A=s.getUniformLocation(this.program,x.name);if(this.uniformTypes[x.name]=x.uniform,!A){console.warn('Shader "'.concat(this.constructor.name,'" could not get uniform location for "').concat(x.name,'"'));return}this.uniformLocations[x.name]=A})}bindBufferAttribute(e,r,s){const{glw:i}=this;i.enableVertexAttribArray(e),i.vertexAttribPointer(r,e,s.size,s.type,s.normalized,s.stride,s.offset)}disableAttribute(e){this.glw.disableVertexAttribArray(e)}disableAttributes(){for(const e in this.attributeLocations)this.disableAttribute(this.attributeLocations[e]);this.boundBufferCollection=null}canBatchShaderProps(e,r){return!1}bindRenderOp(e,r){this.bindBufferCollection(e.buffers),e.textures.length>0&&this.bindTextures(e.textures);const{glw:s,parentHasRenderTexture:i,renderToTexture:o}=e;if(!(o&&i)){if(i){const{width:a,height:l}=e.framebufferDimensions||{};this.setUniform("u_pixelRatio",1),this.setUniform("u_resolution",new Float32Array([a!=null?a:0,l!=null?l:0]))}else this.setUniform("u_pixelRatio",e.options.pixelRatio),this.setUniform("u_resolution",new Float32Array([s.canvas.width,s.canvas.height]));if(r){if(Yr(r,"$dimensions")){let a=r.$dimensions;a||(a=e.dimensions),this.setUniform("u_dimensions",[a.width,a.height])}if(Yr(r,"$alpha")){let a=r.$alpha;a||(a=e.alpha),this.setUniform("u_alpha",a)}this.bindProps(r)}}}setUniform(e,...r){this.glw.setUniform(this.uniformTypes[e],this.uniformLocations[e],...r)}bindBufferCollection(e){if(this.boundBufferCollection!==e){for(const r in this.attributeLocations){const s=e.getBuffer(r),i=e.getAttributeInfo(r);F(s,'Buffer for "'.concat(r,'" not found')),F(i),this.bindBufferAttribute(this.attributeLocations[r],s,i)}this.boundBufferCollection=e}}bindProps(e){}bindTextures(e){}attach(){this.glw.useProgram(this.program),this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}c(Ge,"shaderSources");class _s extends Ji{constructor(e,r,s,i,o,a,l,h,f,u,p,v,m){super();c(this,"glw");c(this,"options");c(this,"buffers");c(this,"shader");c(this,"shaderProps");c(this,"alpha");c(this,"clippingRect");c(this,"dimensions");c(this,"bufferIdx");c(this,"zIndex");c(this,"renderToTexture");c(this,"parentHasRenderTexture");c(this,"framebufferDimensions");c(this,"length",0);c(this,"numQuads",0);c(this,"textures",[]);c(this,"maxTextures");this.glw=e,this.options=r,this.buffers=s,this.shader=i,this.shaderProps=o,this.alpha=a,this.clippingRect=l,this.dimensions=h,this.bufferIdx=f,this.zIndex=u,this.renderToTexture=p,this.parentHasRenderTexture=v,this.framebufferDimensions=m,this.maxTextures=i.supportsIndexedTextures?e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(e){const{textures:r,maxTextures:s}=this,i=r.findIndex(a=>a===e);if(i!==-1)return i;const o=r.length;return o>=s?4294967295:(this.textures.push(e),o)}draw(){const{glw:e,shader:r,shaderProps:s,options:i}=this,{shManager:o}=i;o.useShader(r),r.bindRenderOp(this,s);const a=this.bufferIdx/24*6*2;if(this.clippingRect.valid){const{x:l,y:h,width:f,height:u}=this.clippingRect,p=i.pixelRatio,v=i.canvas.height,m=Math.round(l*p),x=Math.round(f*p),A=Math.round(u*p),w=Math.round(v-A-h*p);e.setScissorTest(!0),e.scissor(m,w,x,A)}else e.setScissorTest(!1);e.drawElements(e.TRIANGLES,6*this.numQuads,e.UNSIGNED_SHORT,a)}}function to(n){const t={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(t).forEach(r=>{t[r]=n.getParameter(n[r])}),t}function ro(n){const t={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(t).forEach(r=>{t[r]=n.getExtension(r)}),t}function no(n,t){const e=~~(t/80),r=new Uint16Array(e*6);for(let i=0,o=0;i<e;i+=6,o+=4)r[i]=o,r[i+1]=o+1,r[i+2]=o+2,r[i+3]=o+2,r[i+4]=o+1,r[i+5]=o+3;const s=n.createBuffer();n.elementArrayBufferData(s,r,n.STATIC_DRAW)}function so(n){return n!==null&&typeof n=="object"&&n.constructor&&n.constructor.name==="HTMLImageElement"}const Mr=new Uint8Array([0,0,0,0]);class sr extends Ts{constructor(e,r,s){super(r,s);c(this,"glw");c(this,"_nativeCtxTexture",null);c(this,"_state","freed");c(this,"_w",0);c(this,"_h",0);this.glw=e}get ctxTexture(){return this._state==="freed"&&this.load(),F(this._nativeCtxTexture),this._nativeCtxTexture}get w(){return this._w}get h(){return this._h}load(){this._state==="loading"||this._state==="loaded"||(this._state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),this.onLoadRequest().then(({width:e,height:r})=>{this._state!=="freed"&&(this._state="loaded",this._w=e,this._h=r,this.textureSource.setState("loaded",{width:e,height:r}))}).catch(e=>{this._state!=="freed"&&(this._state="failed",this.textureSource.setState("failed",e),console.error(e))}))}async onLoadRequest(){var o,a;const{glw:e}=this;e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(Mr.byteLength);const r=await((o=this.textureSource)==null?void 0:o.getTextureData());if(!this._nativeCtxTexture)return F(this._state==="freed"),{width:0,height:0};let s=0,i=0;if(F(this._nativeCtxTexture),e.activeTexture(0),r.data instanceof ImageBitmap||r.data instanceof ImageData||so(r.data)){const l=r.data;s=l.width,i=l.height,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!r.premultiplyAlpha),e.texImage2D(0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l),this.setTextureMemUse(s*i*4),(e.isWebGl2()||Hn(s)&&Hn(i))&&e.generateMipmap()}else if(r.data===null)s=0,i=0,e.bindTexture(this._nativeCtxTexture),e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,Mr),this.setTextureMemUse(Mr.byteLength);else if("mipmaps"in r.data&&r.data.mipmaps){const{mipmaps:l,width:h=0,height:f=0,type:u,glInternalFormat:p}=r.data,v=u==="ktx"?new DataView((a=l[0])!=null?a:new ArrayBuffer(0)):l[0];e.bindTexture(this._nativeCtxTexture),e.compressedTexImage2D(0,p,h,f,0,v),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),this.setTextureMemUse(v.byteLength)}else console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",r);return{width:s,height:i}}free(){if(this._state==="freed"||(this._state="freed",this.textureSource.setState("freed"),this._w=0,this._h=0,!this._nativeCtxTexture))return;const{glw:e}=this;e.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null}createNativeCtxTexture(){const{glw:e}=this,r=e.createTexture();if(!r)throw new Error("Could not create WebGL Texture");return e.activeTexture(0),e.bindTexture(r),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r}}class dt extends He{constructor(e){super();c(this,"txManager");c(this,"dimensions",null);c(this,"error",null);c(this,"state","freed");c(this,"renderableOwners",new Set);c(this,"renderable",!1);c(this,"lastRenderableChangeTime",0);this.txManager=e}setRenderableOwner(e,r){var i,o;const s=this.renderableOwners.size;if(r){this.renderableOwners.add(e);const a=this.renderableOwners.size;a>s&&a===1&&(this.renderable=!0,this.lastRenderableChangeTime=this.txManager.frameTime,(i=this.onChangeIsRenderable)==null||i.call(this,!0))}else{this.renderableOwners.delete(e);const a=this.renderableOwners.size;a<s&&a===0&&(this.renderable=!1,this.lastRenderableChangeTime=this.txManager.frameTime,(o=this.onChangeIsRenderable)==null||o.call(this,!1))}}get ctxTexture(){const e=this.txManager.renderer.createCtxTexture(this);return Object.defineProperty(this,"ctxTexture",{value:e}),e}setState(e,...r){if(this.state!==e){if(this.state=e,e==="loaded"){const s=r;this.dimensions=s[0]}else if(e==="failed"){const s=r;this.error=s[0]}this.emit(e,...r)}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}}const _t=class _t extends dt{constructor(e,r){super(e);c(this,"props");this.props=_t.resolveDefaults(r||{})}get color(){return this.props.color}set color(e){this.props.color=e}async getTextureData(){const e=new Uint32Array([this.color]),r=new Uint8ClampedArray(e.buffer);return{data:new ImageData(r,1,1),premultiplyAlpha:!0}}static makeCacheKey(e){const r=_t.resolveDefaults(e);return"ColorTexture,".concat(r.color)}static resolveDefaults(e){return{color:e.color||4294967295}}};c(_t,"z$__type__Props");let ir=_t;const vr=class vr extends dt{constructor(e,r){super(e);c(this,"props");c(this,"parentTexture");c(this,"onParentTxLoaded",()=>{this.setState("loaded",{width:this.props.width,height:this.props.height})});c(this,"onParentTxFailed",(e,r)=>{this.setState("failed",r)});this.props=vr.resolveDefaults(r||{}),this.parentTexture=this.props.texture,queueMicrotask(()=>{const s=this.parentTexture;s.state==="loaded"?this.onParentTxLoaded(s,s.dimensions):s.state==="failed"&&this.onParentTxFailed(s,s.error),s.on("loaded",this.onParentTxLoaded),s.on("failed",this.onParentTxFailed)})}onChangeIsRenderable(e){this.parentTexture.setRenderableOwner(this,e)}async getTextureData(){return{data:this.props}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{texture:e.texture,x:e.x||0,y:e.y||0,width:e.width||0,height:e.height||0}}};c(vr,"z$__type__Props");let ht=vr;class io extends sr{constructor(t,e,r){super(t,e,r)}async onLoadRequest(){var e,r;const t=await this.textureSource.getTextureData();return{width:((e=t.data)==null?void 0:e.width)||0,height:((r=t.data)==null?void 0:r.height)||0}}}class Rs extends Ge{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}}c(Rs,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio;\n        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);\n\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);\n        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "});class Cs extends Ge{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});c(this,"supportsIndexedTextures",!0)}bindTextures(e){const{renderer:r,glw:s}=this;if(e.length>r.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error("DefaultShaderBatched: Cannot bind more than ".concat(r.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS," textures"));e.forEach((o,a)=>{s.activeTexture(a),s.bindTexture(o.ctxTexture)});const i=Array.from(Array(e.length).keys());this.setUniform("u_textures[0]",i)}}c(Cs,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:e=>"\n      #define txUnits ".concat(e,"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[").concat(e,"], int idx, vec2 uv) {\n        ").concat(Array.from(Array(e).keys()).map(r=>"\n          ".concat(r!==0?"else ":"","if (idx == ").concat(r,") {\n            return texture2D(textures[").concat(r,"], uv);\n          }\n        ")).join(""),"\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    ")});class se{constructor(t){c(this,"priority",1);c(this,"name","");c(this,"ref");c(this,"target");c(this,"passParameters","");c(this,"declaredUniforms","");c(this,"uniformInfo",{});const{ref:e,target:r,props:s={}}=t;this.ref=e,this.target=r;const i={},o=[];let a="";const l=this.constructor.uniforms||{};for(const h in l){const f=l[h],u=f.type,p="".concat(e,"_").concat(h);let v="";f.size&&(v="[".concat(f.size(s),"]")),o.push(p),a+="uniform ".concat(u," ").concat(p).concat(v,";"),i[h]={name:p,uniform:l[h].method}}this.passParameters=o.join(","),this.declaredUniforms=a,this.uniformInfo=i}static getEffectKey(t){return""}static getMethodParameters(t,e){const r=[];for(const s in t){const i=t[s];let o="";i.size&&(o="[".concat(i.size(e),"]")),r.push("".concat(i.type," ").concat(s).concat(o))}return r.join(",")}static resolveDefaults(t){return{}}static makeEffectKey(t){return!1}}c(se,"uniforms",{}),c(se,"methods"),c(se,"onShaderMask"),c(se,"onColorize"),c(se,"onEffectMask");const Lr=new Map,oo=(n,t)=>{const e=JSON.stringify(n);if(Lr.has(e))return Lr.get(e);n=n!=null?n:[];const r=[],s=n.length;let i=0;for(;i<s;i++){const{name:o,type:a,props:l}=n[i],h={name:o,type:a,props:{}},f=t[a],u=f.resolveDefaults(l),p=f.uniforms,v=Object.keys(p),m=v.length;let x=0;for(;x<m;x++){const A=v[x],w=p[A],y={value:u[A],programValue:void 0,updateOnBind:w.updateOnBind||!1,hasValidator:w.validator!==void 0,hasProgramValueUpdater:w.updateProgramValue!==void 0},b=y.hasValidator&&w.validator(u[A],u)||u[A];u[A]!==b&&(y.validatedValue=b),y.hasProgramValueUpdater&&w.updateProgramValue(y),y.programValue===void 0&&(y.programValue=y.value),h.props[A]=y}r.push(h)}return Lr.set(e,r),r},Pe=class Pe extends Ge{constructor(e,r,s){const i=Pe.createShader(r,s);super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...i.uniforms],shaderSources:{vertex:i.vertex,fragment:i.fragment}});c(this,"effects",[]);this.effects=i.effects}bindTextures(e){const{glw:r}=this;r.activeTexture(0),r.bindTexture(e[0].ctxTexture)}bindProps(e){var o;const r=e.effects,s=r.length;let i=0;for(;i<s;i++){const a=r[i],l=this.effects[i].uniformInfo,h=Object.keys(a.props),f=h.length;let u=0;for(;u<f;u++){const p=h[u];if(a.props[p].updateOnBind===!0){const m=(o=this.renderer.shManager.getRegisteredEffects()[a.type])==null?void 0:o.uniforms[p];m==null||m.updateProgramValue(a.props[p],e)}this.setUniform(l[p].name,a.props[p].programValue)}}}canBatchShaderProps(e,r){if(e.$dimensions.width!==r.$dimensions.width||e.$dimensions.height!==r.$dimensions.height||e.effects.length!==r.effects.length)return!1;const s=e.effects.length;let i=0;for(;i<s;i++){const o=e.effects[i],a=r.effects[i];if(o.type!==a.type)return!1;for(const l in o.props)if(a.props&&!a.props[l]||o.props[l].value!==a.props[l].value)return!1}return!0}static createShader(e,r){const s={},i={};let o="";const a=[],l=[],h=e.effects.map(m=>{const x=r[m.type],A=x.getEffectKey(m.props||{});s[A]=s[A]?++s[A]:1;const w=s[A];w===1&&l.push({key:A,type:m.type,props:m.props});const y=new x({ref:"".concat(A).concat(w===1?"":w),target:A,props:m.props});return o+=y.declaredUniforms,a.push(...Object.values(y.uniformInfo)),y});let f="";l==null||l.forEach(m=>{var C;const x=r[m.type],A=x.resolveDefaults((C=m.props)!=null?C:{}),w=[];for(const I in x.methods){let R=I;const B=x.methods[I];i[I]&&i[I]!==B&&(R=Pe.resolveMethodDuplicate(I,B,i)),i[R]=B.replace("function",R),w.push({m:I,cm:R})}let y=x.onShaderMask instanceof Function?x.onShaderMask(A):x.onShaderMask,b=x.onColorize instanceof Function?x.onColorize(A):x.onColorize,g=x.onEffectMask instanceof Function?x.onEffectMask(A):x.onEffectMask;w.forEach(I=>{const{m:R,cm:B}=I,S=new RegExp("\\$".concat(R),"g");y&&(y=y.replace(S,B)),b&&(b=b.replace(S,B)),g&&(g=g.replace(S,B))});const T=x.getMethodParameters(x.uniforms,A),_=T.length>0?", ".concat(T):"";y&&(f+="\n        float fx_".concat(m.key,"_onShaderMask(float shaderMask ").concat(_,") {\n          ").concat(y,"\n        }\n        ")),b&&(f+="\n          vec4 fx_".concat(m.key,"_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(_,") {\n            ").concat(b,"\n          }\n        ")),g&&(f+="\n          vec4 fx_".concat(m.key,"_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(_,") {\n            ").concat(g,"\n          }\n        "))});let u="";for(const m in i)u+=i[m];let p="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",v="\n\n    ";for(let m=0;m<h.length;m++){const x=h[m],A=x.passParameters.length>0?", ".concat(x.passParameters):"",w=r[x.name];w.onShaderMask&&(v+="\n        shaderMask = fx_".concat(x.target,"_onShaderMask(shaderMask ").concat(A,");\n        ")),w.onColorize&&(v+="\n        maskColor = fx_".concat(x.target,"_onColorize(shaderMask, maskColor, shaderColor").concat(A,");\n        ")),w.onEffectMask&&(p="fx_".concat(x.target,"_onEffectMask(shaderMask, maskColor, shaderColor").concat(A,")"));const y=h[m+1];(y===void 0||r[y.name].onEffectMask)&&(v+="\n          shaderColor = ".concat(p,";\n        "))}return{effects:h,uniforms:a,fragment:Pe.fragment(o,u,f,v),vertex:Pe.vertex()}}static resolveMethodDuplicate(e,r,s,i=0){const o=e+(i>0?i:"");return s[o]&&s[o]!==r?this.resolveMethodDuplicate(e,r,s,++i):o}static resolveDefaults(e,r){var s;return F(r),{effects:oo((s=e.effects)!=null?s:[],r),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,r){var i;let s="";return(i=e.effects)==null||i.forEach(o=>{const l=r[o.type].getEffectKey(o.props||{});s+=",".concat(l)}),"DynamicShader".concat(s)}};c(Pe,"z$__type__Props"),c(Pe,"vertex",()=>"\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  "),c(Pe,"fragment",(e,r,s,i)=>"\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ".concat(e,"\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n\n    ").concat(r,"\n\n    ").concat(s,"\n\n    void main() {\n      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ").concat(i,"\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  "));let ct=Pe;class Qr extends Ge{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(t){return{radius:t.radius||10,$dimensions:{width:0,height:0}}}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=Math.min(t.$dimensions.width,t.$dimensions.height)/(2*t.radius);this.setUniform("u_radius",t.radius*Math.min(e,1))}canBatchShaderProps(t,e){return t.radius===e.radius&&t.$dimensions.width===e.$dimensions.width&&t.$dimensions.height===e.$dimensions.height}}c(Qr,"z$__type__Props"),c(Qr,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "});const ao=new Float32Array([1,0,0,0,1,0,0,0,1]),br=class br extends Ge{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=br.resolveDefaults(t);for(const r in e)if(r==="transform")this.setUniform("u_transform",!1,e[r]);else if(r==="scrollY")this.setUniform("u_scrollY",e[r]);else if(r==="color"){const s=It(e.color);this.setUniform("u_color",s)}else r==="size"?this.setUniform("u_size",e[r]):r==="distanceRange"?this.setUniform("u_distanceRange",e[r]):r==="debug"&&this.setUniform("u_debug",e[r]?1:0)}static resolveDefaults(t={}){var e,r,s,i,o,a;return{transform:(e=t.transform)!=null?e:ao,scrollY:(r=t.scrollY)!=null?r:0,color:(s=t.color)!=null?s:4294967295,size:(i=t.size)!=null?i:16,distanceRange:(o=t.distanceRange)!=null?o:1,debug:(a=t.debug)!=null?a:!1}}};c(br,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n\n        // Calculate screen space with pixel ratio\n        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);\n\n        gl_Position = vec4(screenSpace, 0.0, 1.0);\n        v_texcoord = a_textureCoordinate;\n\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "});let jr=br;const ut=n=>{n.programValue===void 0&&(n.programValue=new Float32Array(4));const t=n.value,e=n.programValue;e[0]=(t>>>24)/255,e[1]=(t>>>16&255)/255,e[2]=(t>>>8&255)/255,e[3]=(t&255)/255},lo=n=>{const t=n.validatedValue||n.value;if(n.programValue instanceof Float32Array){const e=n.programValue;e[0]=t[0],e[1]=t[1]}else n.programValue=new Float32Array(t)},co=n=>{const t=n.validatedValue||n.value;if(n.programValue instanceof Float32Array){const e=n.programValue;e[0]=t[0],e[1]=t[1],e[2]=t[1],e[3]=t[1]}else n.programValue=new Float32Array(t)},Es=n=>{const t=n.validatedValue||n.value;if(n.programValue instanceof Float32Array){const e=t.length,r=n.programValue;for(let s=0;s<e;s++)r[s]=t[s]}else n.programValue=new Float32Array(t)},yn=n=>{const t=Array.isArray(n);if(t){if(t&&n.length===4)return n;if(t&&n.length===2)return[n[0],n[1],n[0],n[1]];if(t&&n.length===3)return[n[0],n[1],n[2],n[0]]}else return[n,n,n,n];return[n[0],n[0],n[0],n[0]]},Is=(n,t)=>{n.programValue===void 0&&(n.programValue=new Float32Array(4));const e=n.programValue,r=n.validatedValue||n.value;if(t===void 0&&n.$dimensions===void 0){e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3];return}let s=n.$dimensions;if(t!==void 0){const{$dimensions:p}=t;if(s!==void 0&&(s.width===p.width||s.height===p.height))return;s===void 0&&(s={width:p==null?void 0:p.width,height:p==null?void 0:p.height},n.$dimensions=s)}const{width:i,height:o}=s,[a,l,h,f]=r,u=Math.min(Math.min(Math.min(i/Math.max(i,a+l),i/Math.max(i,h+f)),Math.min(o/Math.max(o,a+h),o/Math.max(o,l+f))),1);e[0]=a*u,e[1]=l*u,e[2]=h*u,e[3]=f*u};class rt extends se{constructor(){super(...arguments);c(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){var r;return{radius:(r=e.radius)!=null?r:10}}}c(rt,"z$__type__Props"),c(rt,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:yn,updateProgramValue:Is}}),c(rt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),c(rt,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);\n  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);\n  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  "),c(rt,"onEffectMask","\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  ");class xt extends se{constructor(){super(...arguments);c(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){var r,s;return{width:(r=e.width)!=null?r:10,color:(s=e.color)!=null?s:4294967295}}}c(xt,"z$__type__Props"),c(xt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ut,method:"uniform4fv",type:"vec4"}}),c(xt,"onEffectMask","\n  float intR = shaderMask + 1.0;\n  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);\n  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);\n  "),c(xt,"onColorize","\n    return color;\n  ");const Ue=class Ue extends se{constructor(){super(...arguments);c(this,"name","linearGradient")}static getEffectKey(e){return"linearGradient".concat(e.colors.length)}static resolveDefaults(e){var i,o;const r=(i=e.colors)!=null?i:[4278190080,4294967295];let s=e.stops||[];if(s.length===0||s.length!==r.length){const a=r.length;let l=0;const h=s;for(;l<a;l++)s[l]?(h[l]=s[l],s[l-1]===void 0&&h[l-2]!==void 0&&(h[l-1]=h[l-2]+(s[l]-h[l-2])/2)):h[l]=l*(1/(r.length-1));s=h}return{colors:r,stops:s,angle:(o=e.angle)!=null?o:0}}};c(Ue,"z$__type__Props"),c(Ue,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.reduce((r,s)=>r.concat(It(s)),[]),updateProgramValue:Es,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),c(Ue,"methods",{fromLinear:"\n      vec4 function(vec4 linearRGB) {\n        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);\n        vec4 lower = linearRGB * vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",toLinear:"\n      vec4 function(vec4 sRGB) {\n        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));\n        vec4 lower = sRGB/vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "}),c(Ue,"ColorLoop",e=>{let r="";for(let s=2;s<e;s++)r+="colorOut = mix(colorOut, colors[".concat(s,"], clamp((dist - stops[").concat(s-1,"]) / (stops[").concat(s,"] - stops[").concat(s-1,"]), 0.0, 1.0));");return r}),c(Ue,"onColorize",e=>{const r=e.colors.length||1;return"\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));\n      ".concat(Ue.ColorLoop(r),"\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});let qr=Ue;class Zr extends se{constructor(){super(...arguments);c(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(e){var r;return{amount:(r=e.amount)!=null?r:1}}}c(Zr,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),c(Zr,"onColorize","\n    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;\n    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);\n  ");class nt extends se{constructor(){super(...arguments);c(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){var r,s;return{width:(r=e.width)!=null?r:10,color:(s=e.color)!=null?s:4294967295}}}c(nt,"z$__type__Props"),c(nt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ut,method:"uniform4fv",type:"vec4"}}),c(nt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),c(nt,"onEffectMask","\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),c(nt,"onColorize","\n    return color;\n  ");class st extends se{constructor(){super(...arguments);c(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){var r,s;return{width:(r=e.width)!=null?r:10,color:(s=e.color)!=null?s:4294967295}}}c(st,"z$__type__Props"),c(st,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ut,method:"uniform4fv",type:"vec4"}}),c(st,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),c(st,"onEffectMask","\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),c(st,"onColorize","\n    return color;\n  ");class it extends se{constructor(){super(...arguments);c(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){var r,s;return{width:(r=e.width)!=null?r:10,color:(s=e.color)!=null?s:4294967295}}}c(it,"z$__type__Props"),c(it,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ut,method:"uniform4fv",type:"vec4"}}),c(it,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),c(it,"onEffectMask","\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),c(it,"onColorize","\n    return color;\n  ");class ot extends se{constructor(){super(...arguments);c(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){var r,s;return{width:(r=e.width)!=null?r:10,color:(s=e.color)!=null?s:4294967295}}}c(ot,"z$__type__Props"),c(ot,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ut,method:"uniform4fv",type:"vec4"}}),c(ot,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),c(ot,"onEffectMask","\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),c(ot,"onColorize","\n    return color;\n  ");class yt extends se{constructor(){super(...arguments);c(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){var r,s,i,o,a;return{amplitude:(r=e.amplitude)!=null?r:.2,narrowness:(s=e.narrowness)!=null?s:4,blockiness:(i=e.blockiness)!=null?i:2,minimizer:(o=e.minimizer)!=null?o:8,time:(a=e.time)!=null?a:Date.now()}}}c(yt,"z$__type__Props"),c(yt,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:e=>{const r=e.value=(Date.now()-e.value)%1e3;e.programValue=r},type:"float"}}),c(yt,"methods",{rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "}),c(yt,"onColorize","\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ");class Jt extends se{constructor(){super(...arguments);c(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){var r;return{fade:(r=e.fade)!=null?r:10}}}c(Jt,"z$__type__Props"),c(Jt,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:yn,updateProgramValue:co}}),c(Jt,"onColorize","\n  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ");const qe=class qe extends se{constructor(){super(...arguments);c(this,"name","radialGradient")}static getEffectKey(e){return"radialGradient".concat(e.colors.length)}static resolveDefaults(e){var i,o,a,l,h;const r=(i=e.colors)!=null?i:[4278190080,4294967295];let s=e.stops||[];if(s.length===0||s.length!==r.length){const f=r.length;let u=0;const p=s;for(;u<f;u++)s[u]?(p[u]=s[u],s[u-1]===void 0&&p[u-2]!==void 0&&(p[u-1]=p[u-2]+(s[u]-p[u-2])/2)):p[u]=u*(1/(r.length-1));s=p}return{colors:r,stops:s,width:(o=e.width)!=null?o:0,height:(l=(a=e.height)!=null?a:e.width)!=null?l:0,pivot:(h=e.pivot)!=null?h:[.5,.5]}}};c(qe,"z$__type__Props"),c(qe,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:lo,method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.reduce((r,s)=>r.concat(It(s)),[]),updateProgramValue:Es,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),c(qe,"ColorLoop",e=>{let r="";for(let s=2;s<e;s++)r+="colorOut = mix(colorOut, colors[".concat(s,"], clamp((dist - stops[").concat(s-1,"]) / (stops[").concat(s,"] - stops[").concat(s-1,"]), 0.0, 1.0));");return r}),c(qe,"onColorize",e=>{const r=e.colors.length||1;return"\n      vec2 point = v_textureCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = mix(colors[0], colors[1], stopCalc);\n      ".concat(qe.ColorLoop(r),"\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});let Jr=qe;class at extends se{constructor(){super(...arguments);c(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){var r,s,i,o,a,l,h;return{width:(r=e.width)!=null?r:10,progress:(s=e.progress)!=null?s:.5,offset:(i=e.offset)!=null?i:0,range:(o=e.range)!=null?o:Math.PI*2,rounded:(a=e.rounded)!=null?a:!1,radius:(l=e.radius)!=null?l:1,color:(h=e.color)!=null?h:4294967295}}}c(at,"z$__type__Props"),c(at,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ut,method:"uniform4fv",type:"vec4"}}),c(at,"methods",{rotateUV:"\n    vec2 function(vec2 uv, float d) {\n      float s = sin(d);\n      float c = cos(d);\n      mat2 rotMatrix = mat2(c, -s, s, c);\n      return uv * rotMatrix;\n    }\n    ",drawDot:"\n    float function(vec2 uv, vec2 p, float r) {\n      uv += p;\n      float circle = length(uv) - r;\n      return clamp(-circle, 0.0, 1.0);\n    }\n    "}),c(at,"onEffectMask","\n    float outerRadius = radius * u_dimensions.y * 0.5;\n\n    float endAngle = range * progress - 0.0005;\n\n    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;\n\n    uv = $rotateUV(uv, -(offset));\n    float linewidth = width * u_pixelRatio;\n    float circle = length(uv) - (outerRadius - linewidth) ;\n    circle = abs(circle) - linewidth;\n    circle = clamp(-circle, 0.0, 1.0);\n\n    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);\n    float p = endAngle / (PI * 2.);\n\n    circle *= step(fract(angle), fract(p));\n\n    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));\n    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));\n\n    return mix(shaderColor, maskColor, circle);\n  "),c(at,"onColorize","\n    return color;\n  ");class lt extends se{constructor(){super(...arguments);c(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(e){var r;return{x:e.x||0,y:e.y||0,width:e.width||50,height:e.height||50,radius:(r=e.radius)!=null?r:0}}}c(lt,"z$__type__Props"),c(lt,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:yn,updateProgramValue:Is}}),c(lt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),c(lt,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  vec2 size = vec2(width, height) * 0.5;\n  vec2 basePos = v_textureCoordinate.xy * u_dimensions.xy - vec2(x, y);\n  vec2 pos = basePos - size;\n  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);\n  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);\n  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);\n  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);\n  return $boxDist(pos, size, r);\n  "),c(lt,"onEffectMask","\n  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));\n  ");const Bs="RoundedRectangle";class vn extends ws{constructor(e){super();c(this,"shType");this.shType=e,e!==Bs&&console.warn("Unsupported shader:",e)}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class ho{constructor(t,e,r,s){c(this,"type");c(this,"shader");c(this,"resolvedProps");c(this,"props");this.type=t,this.shader=e,this.resolvedProps=r;const i=Object.keys(r),o=i.length,a={};for(let l=0;l<o;l++){const h=i[l];Object.defineProperty(a,h,{get:()=>this.resolvedProps[h],set:f=>{this.resolvedProps[h]=f,s.requestRender()}})}this.props=a}getResolvedProps(){return this.resolvedProps}}class uo{constructor(t,e,r){c(this,"shader");c(this,"resolvedProps");c(this,"props");c(this,"type");this.shader=t,this.type="DynamicShader",this.resolvedProps=e;const s=r.getRegisteredEffects(),i={},o=e.effects,a=o.length;for(let l=0;l<a;l++){const{name:h,props:f,type:u}=o[l];if(h===void 0)continue;const p={},v=Object.keys(f),m=v.length;for(let x=0;x<m;x++){const A=v[x];Object.defineProperty(p,A,{get:()=>this.resolvedProps.effects[l].props[A].value,set:w=>{var b,g;const y=this.resolvedProps.effects[l].props[A];y.value=w,y.hasValidator&&(w=y.validatedValue=(b=s[u].uniforms[A])==null?void 0:b.validator(w,f)),y.hasProgramValueUpdater?(g=s[u].uniforms[A])==null||g.updateProgramValue(y):y.programValue=w,r.renderer.stage.requestRender()}})}Object.defineProperty(i,h,{get:()=>p})}this.props=i}getResolvedProps(){return this.resolvedProps}}class fo{constructor(){c(this,"shCache",new Map);c(this,"shConstructors",{});c(this,"attachedShader",null);c(this,"effectConstructors",{});c(this,"renderer");this.registerShaderType("DefaultShader",Rs),this.registerShaderType("DefaultShaderBatched",Cs),this.registerShaderType("RoundedRectangle",Qr),this.registerShaderType("DynamicShader",ct),this.registerShaderType("SdfShader",jr),this.registerEffectType("border",xt),this.registerEffectType("borderBottom",it),this.registerEffectType("borderLeft",ot),this.registerEffectType("borderRight",nt),this.registerEffectType("borderTop",st),this.registerEffectType("fadeOut",Jt),this.registerEffectType("linearGradient",qr),this.registerEffectType("radialGradient",Jr),this.registerEffectType("grayscale",Zr),this.registerEffectType("glitch",yt),this.registerEffectType("radius",rt),this.registerEffectType("radialProgress",at),this.registerEffectType("holePunch",lt)}registerShaderType(t,e){this.shConstructors[t]=e}registerEffectType(t,e){this.effectConstructors[t]=e}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(t,e){if(!this.renderer)throw new Error("Renderer is not been defined");const r=this.shConstructors[t];if(!r)throw new Error('Shader type "'.concat(t,'" is not registered'));if(this.renderer.mode==="canvas"&&r.prototype instanceof Ge)return this._createShaderCtr(t,new vn(t),e);if(t==="DynamicShader")return this.loadDynamicShader(e);const s=r.resolveDefaults(e),i=r.makeCacheKey(s)||r.name;if(i&&this.shCache.has(i))return this._createShaderCtr(t,this.shCache.get(i),s);const o=new r(this.renderer,e);return i&&this.shCache.set(i,o),this._createShaderCtr(t,o,s)}loadDynamicShader(t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=ct.resolveDefaults(t,this.effectConstructors),r=ct.makeCacheKey(e,this.effectConstructors);if(r&&this.shCache.has(r))return this._createDynShaderCtr(this.shCache.get(r),e);const s=new ct(this.renderer,t,this.effectConstructors);return r&&this.shCache.set(r,s),this._createDynShaderCtr(s,e)}_createShaderCtr(t,e,r){return new ho(t,e,r,this.renderer.stage)}_createDynShaderCtr(t,e){return new uo(t,e,this)}useShader(t){this.attachedShader!==t&&(this.attachedShader&&this.attachedShader.detach(),t.attach(),this.attachedShader=t)}}class Ms{constructor(t){c(this,"config");this.config=t}getBuffer(t){var e;return(e=this.config.find(r=>r.attributes[t]))==null?void 0:e.buffer}getAttributeInfo(t){var e;return(e=this.config.find(r=>r.attributes[t]))==null?void 0:e.attributes[t]}}function po(n){return self.WebGL2RenderingContext&&n instanceof self.WebGL2RenderingContext}class go{constructor(t){c(this,"gl");c(this,"activeTextureUnit",0);c(this,"texture2dUnits");c(this,"texture2dParams",new WeakMap);c(this,"scissorEnabled");c(this,"scissorX");c(this,"scissorY");c(this,"scissorWidth");c(this,"scissorHeight");c(this,"blendEnabled");c(this,"blendSrcRgb");c(this,"blendDstRgb");c(this,"blendSrcAlpha");c(this,"blendDstAlpha");c(this,"boundArrayBuffer");c(this,"boundElementArrayBuffer");c(this,"curProgram");c(this,"programUniforms",new WeakMap);c(this,"canvas");c(this,"MAX_RENDERBUFFER_SIZE");c(this,"MAX_TEXTURE_SIZE");c(this,"MAX_VIEWPORT_DIMS");c(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS");c(this,"MAX_TEXTURE_IMAGE_UNITS");c(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS");c(this,"MAX_VERTEX_ATTRIBS");c(this,"MAX_VARYING_VECTORS");c(this,"MAX_VERTEX_UNIFORM_VECTORS");c(this,"MAX_FRAGMENT_UNIFORM_VECTORS");c(this,"TEXTURE_MAG_FILTER");c(this,"TEXTURE_MIN_FILTER");c(this,"TEXTURE_WRAP_S");c(this,"TEXTURE_WRAP_T");c(this,"LINEAR");c(this,"CLAMP_TO_EDGE");c(this,"RGBA");c(this,"UNSIGNED_BYTE");c(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL");c(this,"UNPACK_FLIP_Y_WEBGL");c(this,"FLOAT");c(this,"TRIANGLES");c(this,"UNSIGNED_SHORT");c(this,"ONE");c(this,"ONE_MINUS_SRC_ALPHA");c(this,"VERTEX_SHADER");c(this,"FRAGMENT_SHADER");c(this,"STATIC_DRAW");c(this,"COMPILE_STATUS");c(this,"LINK_STATUS");c(this,"DYNAMIC_DRAW");c(this,"COLOR_ATTACHMENT0");this.gl=t,this.activeTextureUnit=t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0;const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(e).fill(void 0).map((s,i)=>(this.activeTexture(i),t.getParameter(t.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=t.isEnabled(t.SCISSOR_TEST);const r=t.getParameter(t.SCISSOR_BOX);this.scissorX=r[0],this.scissorY=r[1],this.scissorWidth=r[2],this.scissorHeight=r[3],this.blendEnabled=t.isEnabled(t.BLEND),this.blendSrcRgb=t.getParameter(t.BLEND_SRC_RGB),this.blendDstRgb=t.getParameter(t.BLEND_DST_RGB),this.blendSrcAlpha=t.getParameter(t.BLEND_SRC_ALPHA),this.blendDstAlpha=t.getParameter(t.BLEND_DST_ALPHA),this.boundArrayBuffer=t.getParameter(t.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=t.getParameter(t.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=t.getParameter(t.CURRENT_PROGRAM),this.canvas=t.canvas,this.MAX_RENDERBUFFER_SIZE=t.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=t.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=t.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=t.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=t.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=t.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=t.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=t.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=t.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=t.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=t.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=t.TEXTURE_WRAP_T,this.LINEAR=t.LINEAR,this.CLAMP_TO_EDGE=t.CLAMP_TO_EDGE,this.RGBA=t.RGBA,this.UNSIGNED_BYTE=t.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=t.UNPACK_FLIP_Y_WEBGL,this.FLOAT=t.FLOAT,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.ONE=t.ONE,this.ONE_MINUS_SRC_ALPHA=t.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.VERTEX_SHADER=t.VERTEX_SHADER,this.FRAGMENT_SHADER=t.FRAGMENT_SHADER,this.STATIC_DRAW=t.STATIC_DRAW,this.COMPILE_STATUS=t.COMPILE_STATUS,this.LINK_STATUS=t.LINK_STATUS,this.DYNAMIC_DRAW=t.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=t.COLOR_ATTACHMENT0}isWebGl2(){return po(this.gl)}activeTexture(t){const{gl:e}=this;this.activeTextureUnit!==t&&(e.activeTexture(t+e.TEXTURE0),this.activeTextureUnit=t)}bindTexture(t){const{gl:e,activeTextureUnit:r,texture2dUnits:s}=this;s[r]!==t&&(s[r]=t,e.bindTexture(this.gl.TEXTURE_2D,t))}_getActiveTexture(){const{activeTextureUnit:t,texture2dUnits:e}=this;return e[t]}texParameteri(t,e){const{gl:r,texture2dParams:s}=this,i=this._getActiveTexture();if(!i)throw new Error("No active texture");let o=s.get(i);o||(o={},s.set(i,o)),o[t]!==e&&(o[t]=e,r.texParameteri(r.TEXTURE_2D,t,e))}texImage2D(t,e,r,s,i,o,a,l){const{gl:h}=this;o?h.texImage2D(h.TEXTURE_2D,t,e,r,s,i,o,a,l):h.texImage2D(h.TEXTURE_2D,t,e,r,s,i)}compressedTexImage2D(t,e,r,s,i,o){const{gl:a}=this;a.compressedTexImage2D(a.TEXTURE_2D,t,e,r,s,i,o)}pixelStorei(t,e){const{gl:r}=this;r.pixelStorei(t,e)}generateMipmap(){const{gl:t}=this;t.generateMipmap(t.TEXTURE_2D)}createTexture(){const{gl:t}=this;return t.createTexture()}deleteTexture(t){const{gl:e}=this;t&&this.texture2dParams.delete(t),e.deleteTexture(t)}viewport(t,e,r,s){const{gl:i}=this;i.viewport(t,e,r,s)}clearColor(t,e,r,s){const{gl:i}=this;i.clearColor(t,e,r,s)}setScissorTest(t){const{gl:e,scissorEnabled:r}=this;t!==r&&(t?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),this.scissorEnabled=t)}scissor(t,e,r,s){const{gl:i,scissorX:o,scissorY:a,scissorWidth:l,scissorHeight:h}=this;(t!==o||e!==a||r!==l||s!==h)&&(i.scissor(t,e,r,s),this.scissorX=t,this.scissorY=e,this.scissorWidth=r,this.scissorHeight=s)}setBlend(t){const{gl:e,blendEnabled:r}=this;t!==r&&(t?e.enable(e.BLEND):e.disable(e.BLEND),this.blendEnabled=t)}blendFunc(t,e){const{gl:r,blendSrcRgb:s,blendDstRgb:i,blendSrcAlpha:o,blendDstAlpha:a}=this;(t!==s||e!==i||t!==o||e!==a)&&(r.blendFunc(t,e),this.blendSrcRgb=t,this.blendDstRgb=e,this.blendSrcAlpha=t,this.blendDstAlpha=e)}createBuffer(){const{gl:t}=this;return t.createBuffer()}createFramebuffer(){const{gl:t}=this;return t.createFramebuffer()}bindFramebuffer(t){const{gl:e}=this;e.bindFramebuffer(e.FRAMEBUFFER,t)}framebufferTexture2D(t,e,r){const{gl:s}=this;s.framebufferTexture2D(s.FRAMEBUFFER,t,s.TEXTURE_2D,e,r)}clear(){const{gl:t}=this;t.clear(t.COLOR_BUFFER_BIT)}arrayBufferData(t,e,r){const{gl:s,boundArrayBuffer:i}=this;i!==t&&(s.bindBuffer(s.ARRAY_BUFFER,t),this.boundArrayBuffer=t),s.bufferData(s.ARRAY_BUFFER,e,r)}elementArrayBufferData(t,e,r){const{gl:s,boundElementArrayBuffer:i}=this;i!==t&&(s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t),this.boundElementArrayBuffer=t),s.bufferData(s.ELEMENT_ARRAY_BUFFER,e,r)}vertexAttribPointer(t,e,r,s,i,o,a){const{gl:l,boundArrayBuffer:h}=this;h!==t&&(l.bindBuffer(l.ARRAY_BUFFER,t),this.boundArrayBuffer=t),l.vertexAttribPointer(e,r,s,i,o,a)}useProgram(t){const{gl:e,curProgram:r}=this;r!==t&&(e.useProgram(t),this.curProgram=t)}setUniform(t,e,...r){const{gl:s,programUniforms:i}=this;let o=i.get(this.curProgram);o||(o=new Map,i.set(this.curProgram,o));const a=o.get(e);(!a||!mo(a,r))&&(o.set(e,r),s[t](e,...r))}getParameter(t){const{gl:e}=this;return e.getParameter(t)}drawElements(t,e,r,s){const{gl:i}=this;i.drawElements(t,e,r,s)}getExtension(t){const{gl:e}=this;return e.getExtension(t)}createVertexArray(){const{gl:t}=this;return F(t instanceof WebGL2RenderingContext),t.createVertexArray()}bindVertexArray(t){const{gl:e}=this;F(e instanceof WebGL2RenderingContext),e.bindVertexArray(t)}getAttribLocation(t,e){const{gl:r}=this;return r.getAttribLocation(t,e)}getUniformLocation(t,e){const{gl:r}=this;return r.getUniformLocation(t,e)}enableVertexAttribArray(t){const{gl:e}=this;e.enableVertexAttribArray(t)}disableVertexAttribArray(t){const{gl:e}=this;e.disableVertexAttribArray(t)}createShader(t){const{gl:e}=this;return e.createShader(t)}compileShader(t){const{gl:e}=this;e.compileShader(t)}attachShader(t,e){const{gl:r}=this;r.attachShader(t,e)}linkProgram(t){const{gl:e}=this;e.linkProgram(t)}deleteProgram(t){const{gl:e}=this;e.deleteProgram(t)}getShaderParameter(t,e){const{gl:r}=this;return r.getShaderParameter(t,e)}getShaderInfoLog(t){const{gl:e}=this;return e.getShaderInfoLog(t)}createProgram(){const{gl:t}=this;return t.createProgram()}getProgramParameter(t,e){const{gl:r}=this;return r.getProgramParameter(t,e)}getProgramInfoLog(t){const{gl:e}=this;return e.getProgramInfoLog(t)}shaderSource(t,e){const{gl:r}=this;r.shaderSource(t,e)}deleteShader(t){const{gl:e}=this;e.deleteShader(t)}}function mo(n,t){return n.length!==t.length?!1:n.every((e,r)=>Array.isArray(e)||e instanceof Float32Array?!1:e===t[r])}const Ar=class Ar extends dt{constructor(e,r){super(e);c(this,"props");this.props=Ar.resolveDefaults(r||{})}get width(){return this.props.width}set width(e){this.props.width=e}get height(){return this.props.height}set height(e){this.props.height=e}async getTextureData(){return{data:null,premultiplyAlpha:null}}static resolveDefaults(e){return{width:e.width||256,height:e.height||256}}};c(Ar,"z$__type__Props");let Et=Ar;class Xn extends sr{constructor(e,r,s){super(e,r,s);c(this,"framebuffer");const i=e.createFramebuffer();F(i,"Unable to create framebuffer"),this.framebuffer=i}async onLoadRequest(){const{glw:e}=this,r=this._nativeCtxTexture=this.createNativeCtxTexture(),{width:s,height:i}=this.textureSource;return e.texImage2D(0,e.RGBA,s,i,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(s*i*4),e.bindFramebuffer(this.framebuffer),e.framebufferTexture2D(e.COLOR_ATTACHMENT0,r,0),e.bindFramebuffer(null),{width:s,height:i}}}function xo(n){return/\.(ktx|pvr)$/.test(n)}const yo=async n=>{const e=await(await fetch(n)).arrayBuffer();return n.indexOf(".ktx")!==-1?vo(e):bo(e)},vo=async n=>{const t=new DataView(n),e=t.getUint32(12)===16909060,r=[],s={glInternalFormat:t.getUint32(28,e),pixelWidth:t.getUint32(36,e),pixelHeight:t.getUint32(40,e),numberOfMipmapLevels:t.getUint32(56,e),bytesOfKeyValueData:t.getUint32(60,e)};let i=64;i+=s.bytesOfKeyValueData;for(let o=0;o<s.numberOfMipmapLevels;o++){const a=t.getUint32(i);i+=4,r.push(t.buffer.slice(i,a)),i+=a}return{data:{glInternalFormat:s.glInternalFormat,mipmaps:r,width:s.pixelWidth||0,height:s.pixelHeight||0,type:"ktx"},premultiplyAlpha:!1}},bo=async n=>{const a=n,l=new Int32Array(a,0,13),h=l[12]+52,f=new Uint8Array(a,h),u=[],p={pixelWidth:l[7],pixelHeight:l[6],numberOfMipmapLevels:l[11]||0};let v=0,m=p.pixelWidth||0,x=p.pixelHeight||0;for(let A=0;A<p.numberOfMipmapLevels;A++){const w=(m+3>>2)*(x+3>>2)*8,y=new Uint8Array(a,f.byteOffset+v,w);u.push(y),v+=w,m=m>>1,x=x>>1}return{data:{glInternalFormat:36196,mipmaps:u,width:p.pixelWidth||0,height:p.pixelHeight||0,type:"pvr"},premultiplyAlpha:!1}},Rt=class Rt extends dt{constructor(e,r){super(e);c(this,"props");this.props=Rt.resolveDefaults(r)}hasAlphaChannel(e){return e.indexOf("image/png")!==-1}async getTextureData(){const{src:e,premultiplyAlpha:r}=this.props;if(!e)return{data:null};if(typeof e!="string")return e instanceof ImageData?{data:e,premultiplyAlpha:r}:{data:e(),premultiplyAlpha:r};if(xo(e))return yo(e);const s=Gi(e);if(this.txManager.imageWorkerManager)return await this.txManager.imageWorkerManager.getImage(s,r);if(this.txManager.hasCreateImageBitmap){const o=await(await fetch(s)).blob(),a=r!=null?r:this.hasAlphaChannel(o.type);return{data:await createImageBitmap(o,{premultiplyAlpha:a?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:a}}else{const i=new Image;return e.substr(0,5)!=="data:"&&(i.crossOrigin="Anonymous"),i.src=s,await new Promise((o,a)=>{i.onload=()=>o(),i.onerror=()=>a(new Error("Failed to load image"))}).catch(o=>{console.error(o)}),{data:i,premultiplyAlpha:r!=null?r:!0}}}static makeCacheKey(e){var i;const r=Rt.resolveDefaults(e),s=r.key||r.src;return typeof s!="string"?!1:"ImageTexture,".concat(s,",").concat((i=r.premultiplyAlpha)!=null?i:"true")}static resolveDefaults(e){var r,s,i;return{src:(r=e.src)!=null?r:"",premultiplyAlpha:(s=e.premultiplyAlpha)!=null?s:!0,key:(i=e.key)!=null?i:null}}};c(Rt,"z$__type__Props");let or=Rt;const Ao=24;class bn extends Ss{constructor(e){super(e);c(this,"glw");c(this,"system");c(this,"quadBuffer");c(this,"fQuadBuffer");c(this,"uiQuadBuffer");c(this,"renderOps",[]);c(this,"curBufferIdx",0);c(this,"curRenderOp",null);c(this,"rttNodes",[]);c(this,"activeRttNode",null);c(this,"defShaderCtrl");c(this,"defaultShader");c(this,"quadBufferCollection");c(this,"defaultTexture");c(this,"quadBufferUsage",0);c(this,"renderToTextureActive",!1);this.quadBuffer=new ArrayBuffer(this.stage.options.quadBufferSize),this.fQuadBuffer=new Float32Array(this.quadBuffer),this.uiQuadBuffer=new Uint32Array(this.quadBuffer),this.mode="webgl";const{canvas:r,clearColor:s,bufferMemory:i}=e;this.defaultTexture=new ir(this.txManager),this.defaultTexture.setRenderableOwner(this,!0),this.defaultTexture.once("loaded",()=>{this.stage.requestRender()});const o=Li(r,e.contextSpy),a=this.glw=new go(o),l=It(s);a.viewport(0,0,r.width,r.height),a.clearColor(l[0],l[1],l[2],l[3]),a.setBlend(!0),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),no(a,i),this.system={parameters:to(this.glw),extensions:ro(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;const h=a.createBuffer();F(h);const f=6*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new Ms([{buffer:h,attributes:{a_position:{name:"a_position",size:2,type:a.FLOAT,normalized:!1,stride:f,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:a.FLOAT,normalized:!1,stride:f,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:a.UNSIGNED_BYTE,normalized:!0,stride:f,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:a.FLOAT,normalized:!1,stride:f,offset:5*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:e}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,e.setScissorTest(!1),e.clear()}getShaderManager(){return this.shManager}createCtxTexture(e){return e instanceof ht?new io(this.glw,this.txMemManager,e):e instanceof Et?new Xn(this.glw,this.txMemManager,e):new sr(this.glw,this.txMemManager,e)}addQuad(e){var Xe,Re,xe,pe,Z;const{fQuadBuffer:r,uiQuadBuffer:s}=this,{width:i,height:o,colorTl:a,colorTr:l,colorBl:h,colorBr:f,textureOptions:u,shader:p,shaderProps:v,alpha:m,clippingRect:x,tx:A,ty:w,ta:y,tb:b,tc:g,td:T,renderCoords:_,rtt:C,parentHasRenderTexture:I,framebufferDimensions:R}=e;let{texture:B}=e;if(v&&Yr(v,"$dimensions")){const q=v.$dimensions;q.width=i,q.height=o}B=B!=null?B:this.defaultTexture,F(B instanceof dt,"Invalid texture type");let{curBufferIdx:S,curRenderOp:N}=this;const k={width:i,height:o},P=p||this.defaultShader;F(P instanceof Ge),this.reuseRenderOp(e)||(this.newRenderOp(P,v,m,k,x,S,C,I,R),N=this.curRenderOp,F(N));const L=(Xe=u==null?void 0:u.flipX)!=null?Xe:!1;let D=(Re=u==null?void 0:u.flipY)!=null?Re:!1;B instanceof Et&&(D=!D);let U=0,V=0,K=1,z=1;if(B instanceof ht){const{x:q,y:ee,width:J,height:X}=B.props,{width:ge=0,height:he=0}=B.parentTexture.dimensions||{width:0,height:0};U=q/ge,K=U+J/ge,V=ee/he,z=V+X/he,B=B.parentTexture}const te=(xe=u==null?void 0:u.resizeMode)!=null?xe:!1;if(B instanceof or&&te&&B.dimensions){const{width:q,height:ee}=B.dimensions;if(te.type==="cover"){const J=i/q,X=o/ee,ge=Math.max(J,X),he=1/ge;if(ge&&J&&J<ge){const de=he*i;U=(1-de/q)*((pe=te.clipX)!=null?pe:.5),K=U+de/q}if(ge&&X&&X<ge){const de=he*o;V=(1-de/ee)*((Z=te.clipY)!=null?Z:.5),z=V+de/ee}}}L&&([U,K]=[K,U]),D&&([V,z]=[z,V]);const fe=B.ctxTexture;F(fe instanceof sr);const oe=this.addTexture(fe,S);if(N=this.curRenderOp,F(N),_){const{x1:q,y1:ee,x2:J,y2:X,x3:ge,y3:he,x4:de,y4:Le}=_;r[S++]=q,r[S++]=ee,r[S++]=U,r[S++]=V,s[S++]=a,r[S++]=oe,r[S++]=J,r[S++]=X,r[S++]=K,r[S++]=V,s[S++]=l,r[S++]=oe,r[S++]=de,r[S++]=Le,r[S++]=U,r[S++]=z,s[S++]=h,r[S++]=oe,r[S++]=ge,r[S++]=he,r[S++]=K,r[S++]=z,s[S++]=f,r[S++]=oe}else if(b!==0||g!==0)r[S++]=A,r[S++]=w,r[S++]=U,r[S++]=V,s[S++]=a,r[S++]=oe,r[S++]=A+i*y,r[S++]=w+i*g,r[S++]=K,r[S++]=V,s[S++]=l,r[S++]=oe,r[S++]=A+o*b,r[S++]=w+o*T,r[S++]=U,r[S++]=z,s[S++]=h,r[S++]=oe,r[S++]=A+i*y+o*b,r[S++]=w+i*g+o*T,r[S++]=K,r[S++]=z,s[S++]=f,r[S++]=oe;else{const q=A+i*y,ee=w+o*T;r[S++]=A,r[S++]=w,r[S++]=U,r[S++]=V,s[S++]=a,r[S++]=oe,r[S++]=q,r[S++]=w,r[S++]=K,r[S++]=V,s[S++]=l,r[S++]=oe,r[S++]=A,r[S++]=ee,r[S++]=U,r[S++]=z,s[S++]=h,r[S++]=oe,r[S++]=q,r[S++]=ee,r[S++]=K,r[S++]=z,s[S++]=f,r[S++]=oe}N.length+=Ao,N.numQuads++,this.curBufferIdx=S}newRenderOp(e,r,s,i,o,a,l,h,f){const u=new _s(this.glw,this.options,this.quadBufferCollection,e,r,s,o,i,a,0,l,h,f);this.curRenderOp=u,this.renderOps.push(u)}addTexture(e,r,s){const{curRenderOp:i}=this;F(i);const o=i.addTexture(e);if(o===4294967295){if(s)throw new Error("Unable to add texture to render op");const{shader:a,shaderProps:l,dimensions:h,clippingRect:f,alpha:u}=i;return this.newRenderOp(a,l,u,h,f,r),this.addTexture(e,r,!0)}return o}reuseRenderOp(e){var h;const{shader:r,shaderProps:s,parentHasRenderTexture:i,rtt:o,clippingRect:a}=e,l=r||this.defaultShader;return!(((h=this.curRenderOp)==null?void 0:h.shader)!==l||!Wi(this.curRenderOp.clippingRect,a)||i||o||this.curRenderOp.shader!==this.defaultShader&&(!s||!this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,s)))}addRenderOp(e){this.renderOps.push(e),this.curRenderOp=null}render(e="screen"){var a;const{glw:r,quadBuffer:s}=this,i=new Float32Array(s,0,this.curBufferIdx),o=(a=this.quadBufferCollection.getBuffer("a_position"))!=null?a:null;r.arrayBufferData(o,i,r.STATIC_DRAW),this.renderOps.forEach((l,h)=>{l.draw()}),this.quadBufferUsage=this.curBufferIdx*i.BYTES_PER_ELEMENT}renderToTexture(e){for(let r=0;r<this.rttNodes.length;r++)if(this.rttNodes[r]===e)return;this.rttNodes.unshift(e)}renderRTTNodes(){const{glw:e}=this;this.stage;for(let r=0;r<this.rttNodes.length;r++){const s=this.rttNodes[r];if(!s||!s.hasRTTupdates)continue;this.activeRttNode=s,F(s.texture,"RTT node missing texture");const i=s.texture.ctxTexture;F(i instanceof Xn),this.renderToTextureActive=!0,e.bindFramebuffer(i.framebuffer),e.viewport(0,0,i.w,i.h),e.clear();for(let o=0;o<s.children.length;o++){const a=s.children[o];a&&(a.update(this.stage.deltaTime,{x:0,y:0,width:0,height:0,valid:!1}),this.stage.addQuads(a),a.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,s.hasRTTupdates=!1}e.bindFramebuffer(null),e.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(e){const r=this.rttNodes.indexOf(e);r!==-1&&this.rttNodes.splice(r,1)}getBufferInfo(){return{totalAvailable:this.stage.options.quadBufferSize,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}}class To{constructor(){c(this,"activeAnimations",new Set)}registerAnimation(t){this.activeAnimations.add(t)}unregisterAnimation(t){this.activeAnimations.delete(t)}update(t){this.activeAnimations.forEach(e=>{e.update(t)})}}function So(){function n(e){return e.indexOf("image/png")!==-1}function t(e,r){return new Promise(function(s,i){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){if(o.status!==200)return i(new Error("Failed to load image: "+o.statusText));var a=o.response,l=r!==void 0?r:n(a.type);createImageBitmap(a,{premultiplyAlpha:l?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}).then(function(h){s({data:h,premultiplyAlpha:r})}).catch(function(h){i(h)})},o.onerror=function(){i(new Error("Network error occurred while trying to fetch the image."))},o.send()})}self.onmessage=e=>{var r=e.data.src,s=e.data.id,i=e.data.premultiplyAlpha;t(r,i).then(function(o){self.postMessage({id:s,src:r,data:o})}).catch(function(o){self.postMessage({id:s,src:r,error:o.message})})}}class wo{constructor(t){c(this,"imageWorkersEnabled",!0);c(this,"messageManager",{});c(this,"workers",[]);c(this,"workerIndex",0);c(this,"nextId",0);this.workers=this.createWorkers(t),this.workers.forEach(e=>{e.onmessage=this.handleMessage.bind(this)})}handleMessage(t){const{id:e,data:r,error:s}=t.data,i=this.messageManager[e];if(i){const[o,a]=i;delete this.messageManager[e],s?a(new Error(s)):o(r)}}createWorkers(t=1){const e="(".concat(So.toString(),")()"),r=new Blob([e.replace('"use strict";',"")],{type:"application/javascript"}),s=(self.URL?URL:webkitURL).createObjectURL(r),i=[];for(let o=0;o<t;o++)i.push(new Worker(s));return i}getNextWorker(){const t=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,t}getImage(t,e){return new Promise((r,s)=>{try{if(this.workers){const i=this.nextId++;this.messageManager[i]=[r,s];const o=this.getNextWorker();o&&o.postMessage({id:i,src:t,premultiplyAlpha:e})}}catch(i){s(i)}})}}const Ct=class Ct extends dt{constructor(e,r){super(e);c(this,"props");this.props=Ct.resolveDefaults(r)}async getTextureData(){const{width:e,height:r}=this.props,s=e*r*4,i=new Uint8ClampedArray(s);for(let o=0;o<s;o+=4){const a=Math.floor(Math.random()*256);i[o]=a,i[o+1]=a,i[o+2]=a,i[o+3]=255}return{data:new ImageData(i,e,r)}}static makeCacheKey(e){if(e.cacheId===void 0)return!1;const r=Ct.resolveDefaults(e);return"NoiseTexture,".concat(r.width,",").concat(r.height,",").concat(r.cacheId)}static resolveDefaults(e){var r,s,i;return{width:(r=e.width)!=null?r:128,height:(s=e.height)!=null?s:128,cacheId:(i=e.cacheId)!=null?i:0}}};c(Ct,"z$__type__Props");let en=Ct;class _o{constructor(t){c(this,"keyCache",new Map);c(this,"inverseKeyCache",new WeakMap);c(this,"txConstructors",{});c(this,"imageWorkerManager",null);c(this,"hasCreateImageBitmap",!!self.createImageBitmap);c(this,"hasWorker",!!self.Worker);c(this,"renderer");c(this,"frameTime",0);this.hasCreateImageBitmap&&this.hasWorker&&t>0&&(this.imageWorkerManager=new wo(t)),this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.registerTextureType("ImageTexture",or),this.registerTextureType("ColorTexture",ir),this.registerTextureType("NoiseTexture",en),this.registerTextureType("SubTexture",ht),this.registerTextureType("RenderTexture",Et)}registerTextureType(t,e){this.txConstructors[t]=e}loadTexture(t,e){let r;const s=this.txConstructors[t];if(!s)throw new Error('Texture type "'.concat(t,'" is not registered'));if(!r){const i=s.makeCacheKey(e);i&&this.keyCache.has(i)?r=this.keyCache.get(i):(r=new s(this,e),i&&this.initTextureToCache(r,i))}return r}initTextureToCache(t,e){const{keyCache:r,inverseKeyCache:s}=this;r.set(e,t),s.set(t,e)}removeTextureFromCache(t){const{inverseKeyCache:e,keyCache:r}=this,s=e.get(t);s&&r.delete(s)}}function Ro(n,t){var e=0,r,s;t=t||{};function i(){var o=r,a=arguments.length,l,h;e:for(;o;){if(o.args.length!==arguments.length){o=o.next;continue}for(h=0;h<a;h++)if(o.args[h]!==arguments[h]){o=o.next;continue e}return o!==r&&(o===s&&(s=o.prev),o.prev.next=o.next,o.next&&(o.next.prev=o.prev),o.next=r,o.prev=null,r.prev=o,r=o),o.val}for(l=new Array(a),h=0;h<a;h++)l[h]=arguments[h];return o={args:l,val:n.apply(null,l)},r?(r.prev=o,o.next=r):s=o,e===t.maxSize?(s=s.prev,s.next=null):e++,r=o,o.val}return i.clear=function(){r=null,s=null,e=0},i}const Co={normal:400,bold:700,bolder:900,lighter:100},Yn=n=>typeof n=="number"?n:Co[n]||400;function Eo(n,t,e,r,s){let i=Yn(e);for(const o of n){const a=o[t];if(!a)continue;if(a.size===1)return console.warn("TrFontManager: Only one font face found for family: '".concat(t,"' - will be used for all weights and styles")),a.values().next().value;const l=new Map;for(const f of a){const u=Yn(f.descriptors.weight);if(u===i&&f.descriptors.style===r&&f.descriptors.stretch===s)return f;l.set(u,f)}const h="TrFontManager: No exact match: '".concat(t," Weight: ").concat(i," Style: ").concat(r," Stretch: ").concat(s,"'");if(console.error(h),i===400&&l.has(500))return l.get(500);if(i===500&&l.has(400))return l.get(400);if(i<400){for(;i>0;){if(l.has(i))return l.get(i);i-=100}i=600}for(;i<1e3;){if(l.has(i))return l.get(i);i+=100}for(i=500;i>0;){if(l.has(i))return l.get(i);i-=100}}}const Io=Ro(Eo);class An{constructor(t){c(this,"textRenderers");this.textRenderers=t}addFontFace(t){for(const e in this.textRenderers){const r=this.textRenderers[e];r&&r.isFontFaceSupported(t)&&r.addFontFace(t)}}static resolveFontFace(t,e){const{fontFamily:r,fontWeight:s,fontStyle:i,fontStretch:o}=e;return Io(t,r,s,i,o)}}const Bo={x:(n,t)=>{n.props.x=t},y:(n,t)=>{n.props.y=t},width:(n,t)=>{n.props.width=t},height:(n,t)=>{n.props.height=t},color:(n,t)=>{n.props.color=t},zIndex:(n,t)=>{n.props.zIndex=t},fontFamily:(n,t)=>{n.props.fontFamily=t},fontWeight:(n,t)=>{n.props.fontWeight=t},fontStyle:(n,t)=>{n.props.fontStyle=t},fontStretch:(n,t)=>{n.props.fontStretch=t},fontSize:(n,t)=>{n.props.fontSize=t},text:(n,t)=>{n.props.text=t},textAlign:(n,t)=>{n.props.textAlign=t},contain:(n,t)=>{n.props.contain=t},offsetY:(n,t)=>{n.props.offsetY=t},scrollable:(n,t)=>{n.props.scrollable=t},scrollY:(n,t)=>{n.props.scrollY=t},letterSpacing:(n,t)=>{n.props.letterSpacing=t},lineHeight:(n,t)=>{n.props.lineHeight=t},maxLines:(n,t)=>{n.props.maxLines=t},textBaseline:(n,t)=>{n.props.textBaseline=t},verticalAlign:(n,t)=>{n.props.verticalAlign=t},overflowSuffix:(n,t)=>{n.props.overflowSuffix=t},debug:(n,t)=>{n.props.debug=t}};class Ls{constructor(t){c(this,"stage");c(this,"set");this.stage=t;const e={...Bo,...this.getPropertySetters()};this.set=Object.freeze(Object.fromEntries(Object.entries(e).map(([r,s])=>[r,(i,o)=>{i.props[r]!==o&&(s(i,o),this.stage.requestRender())}])))}setStatus(t,e,r){t.status!==e&&(t.status=e,t.emitter.emit(e,r))}setIsRenderable(t,e){t.isRenderable=e}destroyState(t){this.setStatus(t,"destroyed"),t.emitter.removeAllListeners()}scheduleUpdateState(t){t.updateScheduled||(t.updateScheduled=!0,queueMicrotask(()=>{t.status!=="destroyed"&&(t.updateScheduled=!1,this.updateState(t))}))}}class Fs extends He{constructor(e){super();c(this,"fontFamily");c(this,"descriptors");c(this,"loaded",!1);c(this,"metrics",null);const{fontFamily:r,descriptors:s,metrics:i}=e;i&&(this.metrics={ascender:i.ascender/i.unitsPerEm,descender:i.descender/i.unitsPerEm,lineGap:i.lineGap/i.unitsPerEm}),this.fontFamily=r,this.descriptors={style:"normal",weight:"normal",stretch:"normal",...s}}static convertToCssFontFaceDescriptors(e){return{style:e.style,weight:typeof e.weight=="number"?"".concat(e.weight):e.weight,stretch:e.stretch,unicodeRange:e.unicodeRange,featureSettings:e.featureSettings,display:e.display}}}const Mo={LINE_FEED:10,CARRIAGE_RETURN:13,SPACE:32,TAB:9,ZERO_WIDTH_SPACE:8203,ZERO_WIDTH_NON_JOINER:8204,ZERO_WIDTH_JOINER:8205,LEFT_TO_RIGHT_MARK:8206,RIGHT_TO_LEFT_MARK:8207,LEFT_TO_RIGHT_EMBEDDING:8234,RIGHT_TO_LEFT_EMBEDDING:8235,POP_DIRECTIONAL_FORMATTING:8236,LEFT_TO_RIGHT_OVERRIDE:8237,RIGHT_TO_LEFT_OVERRIDE:8238,LINE_SEPARATOR:8232,PARAGRAPH_SEPARATOR:8233,OBJECT_REPLACEMENT_CHARACTER:65532,REPLACEMENT_CHARACTER:65533,ZERO_WIDTH_NO_BREAK_SPACE:65279,LEFT_TO_RIGHT_ISOLATE:8294,RIGHT_TO_LEFT_ISOLATE:8295,FIRST_STRONG_ISOLATE:8296,POP_DIRECTIONAL_ISOLATE:8297,INHIBIT_SYMMETRIC_SWAPPING:8298,ACTIVATE_SYMMETRIC_SWAPPING:8299,INHIBIT_ARABIC_FORM_SHAPING:8300,ACTIVATE_ARABIC_FORM_SHAPING:8301,NATIONAL_DIGIT_SHAPES:8302,NOMINAL_DIGIT_SHAPES:8303,LEFT_TO_RIGHT_BOUNDARY:8206,RIGHT_TO_LEFT_BOUNDARY:8207};class Lo{}class Fo extends Lo{constructor(e,r){super();c(this,"data");c(this,"glyphMap");c(this,"kernings");this.data=e,this.glyphMap=r;const s=this.kernings={};e.kernings.forEach(i=>{const o=i.second,a=s[o]=s[o]||{};a[i.first]=i.amount}),this.kernings=s}*shapeText(e,r){var o;let s,i;for(;(s=r.peek())&&!s.done;){const a=s.value,l=this.glyphMap.get(a);if(r.next(),l!==void 0){const h=i!==void 0?(((o=this.kernings[l.id])==null?void 0:o[i])||0)+e.letterSpacing:0;i=l.id,yield{mapped:!0,glyphId:l.id,codepoint:a,cluster:r.lastIndex,xAdvance:l.xadvance+h,yAdvance:0,xOffset:l.xoffset+h,yOffset:l.yoffset,xBearing:0,yBearing:0,width:l.width,height:l.height}}else a===Mo.LINE_FEED&&(i=void 0),yield{mapped:!1,codepoint:a,cluster:r.lastIndex}}}}class Qe extends Fs{constructor(e,r){super(r);c(this,"type");c(this,"texture");c(this,"maxCharHeight",0);c(this,"data");c(this,"shaper");c(this,"glyphMap",new Map);const{atlasUrl:s,atlasDataUrl:i,stage:o}=r;this.type=e;const a=o.renderer;F(a instanceof bn,"SDF Font Faces can only be used with the WebGL Renderer"),this.texture=o.txManager.loadTexture("ImageTexture",{src:s,premultiplyAlpha:!1}),this.texture.on("loaded",()=>{this.checkLoaded(),o.requestRender()}),this.texture.ctxTexture.load(),fetch(i).then(async l=>{var f;this.data=await l.json(),F(this.data);let h=0;if(this.data.chars.forEach(u=>{this.glyphMap.set(u.id,u);const p=u.yoffset+u.height;p>h&&(h=p)}),this.maxCharHeight=h,this.shaper=new Fo(this.data,this.glyphMap),!this.metrics)if((f=this.data)!=null&&f.lightningMetrics){const{ascender:u,descender:p,lineGap:v,unitsPerEm:m}=this.data.lightningMetrics;this.metrics={ascender:u/m,descender:p/m,lineGap:v/m}}else throw new Error("Font metrics not found in ".concat(this.type," font ").concat(this.fontFamily,". ")+"Make sure you are using the latest version of the Lightning 3 `msdf-generator` tool to generate your SDF fonts.");this.checkLoaded()}).catch(console.error)}getAtlasEntry(e){const r=this.glyphMap.get(e);if(r===void 0)throw new Error("Glyph ".concat(e," not found in font ").concat(this.fontFamily));return{x:r.x,y:r.y,width:r.width,height:r.height}}checkLoaded(){this.loaded||this.texture.state==="loaded"&&this.data&&(this.loaded=!0,this.emit("loaded"))}}const Po=24;function ko(n,t,e,r,s,i,o,a,l){const h=Math.min(Math.max(o.firstLineIdx,0),a.length),f=0,{metrics:u}=e;F(u,"Font metrics not loaded"),F(e.data,"Font data not loaded");const p=(u.ascender-u.descender)*n;let v=0;r==="middle"?v=(t-p)/2:r==="bottom"&&(v=t-p);const m=s/i,x=e.data.common.base,w=u.ascender*n-x,y=m+w+h*t+v;if(!(l&&y>=l/i))return{sdfX:f,sdfY:y,lineIndex:h}}class vt{constructor(t,e=0){c(this,"iterator");c(this,"peekBuffer",[]);c(this,"_lastIndex");this.iterator=t,this.iterator=t,this._lastIndex=e-1,this.peekBuffer=[]}next(){const t=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return t.done?this._lastIndex=-1:this._lastIndex++,t}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const t=this.iterator.next();return this.peekBuffer.push(t),t}get lastIndex(){return this._lastIndex}}function*bt(n,t=0){let e=t;for(;e<n.length;){const r=n.codePointAt(e);if(r===void 0)throw new Error("Invalid Unicode code point");yield r,e+=r<=65535?1:2}}function No(n,t,e){const r=e.shapeText(t,new vt(bt(n,0),0));let s=0;for(const i of r)i.mapped&&(s+=i.xAdvance);return s}function Do(n,t,e,r,s,i,o,a,l,h,f,u,p,v,m,x,A,w,y){F(m,"Font face must be loaded"),F(m.loaded,"Font face must be loaded"),F(m.data,"Font face must be loaded"),F(m.shaper,"Font face must be loaded");const b=a/m.data.info.size,g=l/b,T=i/b,_=h/b,C=p[n],I=(C==null?void 0:C.codepointIndex)||0,R=(C==null?void 0:C.maxX)||0,B=(C==null?void 0:C.maxY)||0;let S=R,N=B,k=t,P=e,L=0;const D={codepointIndex:-1,bufferOffset:-1,xStart:-1},U=m.shaper,V={letterSpacing:_};let K=U.shapeText(V,new vt(bt(r,I),I)),z,te=-1;const fe=[],oe=o/b,Xe=No(w,V,U);let Re=!0;for(;Re;){const xe=(y===0||n+1<y)&&(u!=="both"||A||P+g+m.maxCharHeight<=oe),pe=xe?T:T-Xe;let Z=0;const q=P+m.maxCharHeight>=v.y1,ee=P<=v.y2,J=q&&ee;for(;(z=K.next())&&!z.done;){const X=z.value;if(n===p.length)p.push({codepointIndex:X.cluster,maxY:N,maxX:S});else if(n>p.length)throw new Error("Unexpected lineCache length");if(X.codepoint===32||X.codepoint===10?D.codepointIndex!==-1&&(D.codepointIndex=-1,Z=k):D.codepointIndex===-1&&(D.codepointIndex=X.cluster,D.bufferOffset=L,D.xStart=Z),X.mapped){const ge=k+X.xOffset+X.width;if(u!=="none"&&ge>=pe&&D.codepointIndex!==-1&&D.xStart>0)if(xe){K=U.shapeText(V,new vt(bt(r,D.codepointIndex),D.codepointIndex)),L=D.bufferOffset;break}else K=U.shapeText(V,new vt(bt(w,0),0)),k=D.xStart,L=D.bufferOffset,u="none";else{const he=k+X.xOffset,de=P+X.yOffset;if(J){te===-1&&(te=L);const Le=m.getAtlasEntry(X.glyphId),Ye=Le.x/m.data.common.scaleW,Ke=Le.y/m.data.common.scaleH,ft=Le.width/m.data.common.scaleW,pt=Le.height/m.data.common.scaleH;f[L++]=he,f[L++]=de,f[L++]=Ye,f[L++]=Ke,f[L++]=he+X.width,f[L++]=de,f[L++]=Ye+ft,f[L++]=Ke,f[L++]=he,f[L++]=de+X.height,f[L++]=Ye,f[L++]=Ke+pt,f[L++]=he+X.width,f[L++]=de+X.height,f[L++]=Ye+ft,f[L++]=Ke+pt}N=Math.max(N,de+X.height),S=Math.max(S,he+X.width),k+=X.xAdvance}}else if(X.codepoint===10){if(xe)break;K=U.shapeText(V,new vt(bt(w,0),0)),u="none"}}te!==-1&&(fe.push({bufferStart:te,bufferEnd:L}),te=-1),k=0,P+=g,n++,D.codepointIndex=-1,Z=0,!x&&u==="both"&&P>v.y2||z&&z.done?Re=!1:xe||(Re=!1)}if(s==="center"){const xe=u==="none"?S:T;for(let pe=0;pe<fe.length;pe++){const Z=fe[pe],q=f[Z.bufferEnd-4]-f[Z.bufferStart],ee=(xe-q)/2;for(let J=Z.bufferStart;J<Z.bufferEnd;J+=4)f[J]+=ee}}else if(s==="right"){const xe=u==="none"?S:T;for(let pe=0;pe<fe.length;pe++){const Z=fe[pe],q=Z.bufferEnd===Z.bufferStart?0:f[Z.bufferEnd-4]-f[Z.bufferStart],ee=xe-q;for(let J=Z.bufferStart;J<Z.bufferEnd;J+=4)f[J]+=ee}}return F(z),{bufferNumFloats:L,bufferNumQuads:L/16,layoutNumCharacters:z.done?r.length-I:z.value.cluster-I+1,fullyProcessed:!!z.done,maxX:S,maxY:N,numLines:p.length}}function Uo(n,t){return Math.ceil(n/t)*t}function Oo(n,t){return Math.floor(n/t)*t}function zo(n,t,e,r,s,i,o,a){const{screen:l,sdf:h}=n;if(!Hi(o))l.x1=0,l.y1=0,l.x2=0,l.y2=0,h.x1=0,h.y1=0,h.x2=0,h.y2=0,n.numLines=0,n.firstLineIdx=0;else{const f=o.x1-t,u=f+(o.x2-o.x1),p=o.y1-e+r,v=Oo(p-i,s||1),m=Uo(p+(o.y2-o.y1)+i,s||1);l.x1=f,l.y1=v,l.x2=u,l.y2=m,h.x1=f/a,h.y1=v/a,h.x2=u/a,h.y2=m/a,n.numLines=Math.ceil((m-v)/s),n.firstLineIdx=s?Math.floor(v/s):0}n.valid=!0}function Ps(n,t){return t*(n.ascender-n.descender+n.lineGap)}const Wo={x:0,y:0,width:0,height:0};class Ho extends Ls{constructor(e){super(e);c(this,"ssdfFontFamilies",{});c(this,"msdfFontFamilies",{});c(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]);c(this,"sdfShader");c(this,"rendererBounds");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,r)=>{e.props.fontFamily=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontWeight:(e,r)=>{e.props.fontWeight=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStyle:(e,r)=>{e.props.fontStyle=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStretch:(e,r)=>{e.props.fontStretch=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontSize:(e,r)=>{e.props.fontSize=r,this.invalidateLayoutCache(e)},text:(e,r)=>{e.props.text=r,this.invalidateLayoutCache(e)},textAlign:(e,r)=>{e.props.textAlign=r,this.invalidateLayoutCache(e)},color:(e,r)=>{e.props.color=r},x:(e,r)=>{e.props.x=r,e.elementBounds.valid&&(this.setElementBoundsX(e),!e.renderWindow.valid&&Br(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},y:(e,r)=>{e.props.y=r,e.elementBounds.valid&&(this.setElementBoundsY(e),!e.renderWindow.valid&&Br(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},contain:(e,r)=>{e.props.contain=r,this.invalidateLayoutCache(e)},width:(e,r)=>{e.props.width=r,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,r)=>{e.props.height=r,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,r)=>{e.props.offsetY=r,this.invalidateLayoutCache(e)},scrollable:(e,r)=>{e.props.scrollable=r,this.invalidateLayoutCache(e)},scrollY:(e,r)=>{e.props.scrollY=r,this.scheduleUpdateState(e)},letterSpacing:(e,r)=>{e.props.letterSpacing=r,this.invalidateLayoutCache(e)},lineHeight:(e,r)=>{e.props.lineHeight=r,e.resLineHeight=void 0,this.invalidateLayoutCache(e)},maxLines:(e,r)=>{e.props.maxLines=r,this.invalidateLayoutCache(e)},textBaseline:(e,r)=>{e.props.textBaseline=r,this.invalidateLayoutCache(e)},verticalAlign:(e,r)=>{e.props.verticalAlign=r,this.invalidateLayoutCache(e)},overflowSuffix:(e,r)=>{e.props.overflowSuffix=r,this.invalidateLayoutCache(e)},debug:(e,r)=>{e.props.debug=r}}}canRenderFont(e){const{fontFamily:r}=e;return r in this.ssdfFontFamilies||r in this.msdfFontFamilies||r==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(e){return e instanceof Qe}addFontFace(e){F(e instanceof Qe);const r=e.fontFamily,s=e.type==="ssdf"?this.ssdfFontFamilies:e.type==="msdf"?this.msdfFontFamilies:void 0;if(!s){console.warn("Invalid font face type: ".concat(e.type));return}let i=s[r];i||(i=new Set,s[r]=i),i.add(e)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new He,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){let{trFontFace:r}=e;const{textH:s,lineCache:i,debugData:o,forceFullLayoutCalc:a}=e;if(o.updateCount++,e.status==="initialState"&&this.setStatus(e,"loading"),!r){if(r=this.resolveFontFace(e.props),e.trFontFace=r,!r){const U="SdfTextRenderer: Could not resolve font face for family: '".concat(e.props.fontFamily,"'");console.error(U),this.setStatus(e,"failed",new Error(U));return}r.texture.setRenderableOwner(e,!0)}if(!r.loaded){r.once("loaded",()=>{this.scheduleUpdateState(e)});return}F(r.data,"Font face data should be loaded"),F(r.metrics,"Font face metrics should be loaded");const{text:l,fontSize:h,x:f,y:u,contain:p,width:v,height:m,verticalAlign:x,scrollable:A,overflowSuffix:w,maxLines:y}=e.props,b=p==="both"&&A?e.props.scrollY:0,{renderWindow:g}=e,T=r.data.info.size,_=h/T;let C=e.resLineHeight;if(C===void 0){const U=e.props.lineHeight;U===void 0?C=Ps(r.metrics,h):C=U,e.resLineHeight=C}const I=C/_;e.distanceRange=_*r.data.distanceField.distanceRange;const R=l.length*Po;let B=e.vertexBuffer;(!B||B.length<R)&&(B=new Float32Array(R*2));const S=e.elementBounds;if(S.valid||(this.setElementBoundsX(e),this.setElementBoundsY(e),S.valid=!0),!a&&g.valid){const U=g.screen;if(f+U.x1<=S.x1&&f+U.x2>=S.x2&&u-b+U.y1<=S.y1&&u-b+U.y2>=S.y2){this.setStatus(e,"loaded");return}g.valid=!1,this.setStatus(e,"loading")}const{offsetY:N,textAlign:k}=e.props;if(!g.valid){if(!Br(S,this.rendererBounds))return;zo(g,f,u,b,C,p==="both"?S.y2-S.y1:0,S,_)}const P=ko(T,I,r,x,N,_,g,i,s);if(!P){this.setStatus(e,"loaded");return}const{letterSpacing:L}=e.props,D=Do(P.lineIndex,P.sdfX,P.sdfY,l,k,v,m,h,C,L,B,p,i,g.sdf,r,a,A,w,y);e.bufferUploaded=!1,e.bufferNumFloats=D.bufferNumFloats,e.bufferNumQuads=D.bufferNumQuads,e.vertexBuffer=B,e.renderWindow=g,o.lastLayoutNumCharacters=D.layoutNumCharacters,o.bufferSize=B.byteLength,D.fullyProcessed&&(e.textW=D.maxX*_,e.textH=D.numLines*I*_),this.setStatus(e,"loaded")}renderQuads(e,r,s,i,o,a){var S,N,k;if(!e.vertexBuffer)return;const l=this.stage.renderer;F(l instanceof bn);const{fontSize:h,color:f,contain:u,scrollable:p,zIndex:v,debug:m}=e.props,x=u==="both"&&p?e.props.scrollY:0,{textW:A=0,textH:w=0,distanceRange:y,vertexBuffer:b,bufferUploaded:g,trFontFace:T,elementBounds:_}=e;let{webGlBuffers:C}=e;if(!C){const P=l.glw,L=4*Float32Array.BYTES_PER_ELEMENT,D=P.createBuffer();F(D),e.webGlBuffers=new Ms([{buffer:D,attributes:{a_position:{name:"a_position",size:2,type:P.FLOAT,normalized:!1,stride:L,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:P.FLOAT,normalized:!1,stride:L,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,F(e.webGlBuffers),C=e.webGlBuffers}if(!g){const P=l.glw,L=(S=C==null?void 0:C.getBuffer("a_textureCoordinate"))!=null?S:null;P.arrayBufferData(L,b,P.STATIC_DRAW),e.bufferUploaded=!0}if(F(T),p&&u==="both"){F(_.valid);const P=zi(_,Wo);s.valid?(e.clippingRect.valid=!0,s=ys(s,P,e.clippingRect)):(e.clippingRect.valid=!0,s=vs(P,e.clippingRect))}const I=new _s(l.glw,l.options,C,this.sdfShader,{transform:r.getFloatArr(),color:Fi(f,i),size:h/(((N=T.data)==null?void 0:N.info.size)||0),scrollY:x,distanceRange:y,debug:m.sdfShaderDebug},i,s,{height:w,width:A},0,v,!1,o,a),R=(k=e.trFontFace)==null?void 0:k.texture;F(R);const B=R.ctxTexture;I.addTexture(B),I.length=e.bufferNumFloats,I.numQuads=e.bufferNumQuads,l.addRenderOp(I)}setIsRenderable(e,r){var s;super.setIsRenderable(e,r),(s=e.trFontFace)==null||s.texture.setRenderableOwner(e,r)}destroyState(e){var r;super.destroyState(e),(r=e.trFontFace)==null||r.texture.setRenderableOwner(e,!1)}resolveFontFace(e){return An.resolveFontFace(this.fontFamilyArray,e)}releaseFontFace(e){e.resLineHeight=void 0,e.trFontFace&&(e.trFontFace.texture.setRenderableOwner(e,!1),e.trFontFace=void 0)}invalidateLayoutCache(e){e.renderWindow.valid=!1,e.elementBounds.valid=!1,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}setElementBoundsX(e){const{x:r,contain:s,width:i}=e.props,{elementBounds:o}=e;o.x1=r,o.x2=s!=="none"?r+i:1/0}setElementBoundsY(e){const{y:r,contain:s,height:i}=e.props,{elementBounds:o}=e;o.y1=r,o.y2=s==="both"?r+i:1/0}}class Fr extends Fs{constructor(e){super(e);c(this,"fontFace");c(this,"fontUrl");const{fontFamily:r,fontUrl:s}=e,i=s.replace(/\(|\)/g,""),o=this.descriptors,a={style:o.style,weight:typeof o.weight=="number"?"".concat(o.weight):o.weight,stretch:o.stretch,unicodeRange:o.unicodeRange,featureSettings:o.featureSettings,display:o.display},l=new FontFace(r,"url(".concat(i,")"),a);l.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error),this.fontFace=l,this.fontUrl=s}}function Go(n,t,e){if(t.metrics)return t.metrics;const r=n.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz");console.warn("Font metrics not provided for Canvas Web font ".concat(t.fontFamily,". ")+"Using fallback values. It is HIGHLY recommended you use the latest version of the Lightning 3 `msdf-generator` tool to extract the default metrics for the font and provide them in the Canvas Web font definition.");let s;return r.actualBoundingBoxDescent&&r.actualBoundingBoxAscent?s={ascender:r.actualBoundingBoxAscent/e,descender:-r.actualBoundingBoxDescent/e,lineGap:.2}:s={ascender:.8,descender:-.2,lineGap:.2},t.metrics=s,s}const Kn=2048;function Qn(n,t,e,r,s){const i=n!=="bottom"?.5*t:0;return e*(r-1)+i+Math.max(e,t)+(s||0)}class Vo{constructor(t,e){c(this,"_canvas");c(this,"_context");c(this,"_settings");this._canvas=t,this._context=e,this._settings=this.mergeDefaults({})}set settings(t){this._settings=this.mergeDefaults(t)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const t=[this._settings.fontFamily],e=[];for(let r=0,s=t.length;r<s;r++)t[r]==="serif"||t[r]==="sans-serif"?e.push(t[r]):e.push('"'.concat(t[r],'"'));return"".concat(this._settings.fontStyle," ").concat(this._settings.fontSize*this.getPrecision(),"px ").concat(e.join(","))}_load(){if(document.fonts){const t=this._getFontSetting();try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(e=>{console.warn("[Lightning] Font load error",e,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("[Lightning] Font not found",t)})}catch(e){console.warn("[Lightning] Can't check font loading for "+t)}}}calculateRenderInfo(){const t={},e=this.getPrecision(),r=this._settings.paddingLeft*e,s=this._settings.paddingRight*e,i=this._settings.fontSize*e;let o=this._settings.offsetY===null?null:this._settings.offsetY*e;const a=this._settings.w*e,l=this._settings.h*e;let h=this._settings.wordWrapWidth*e;const f=this._settings.cutSx*e,u=this._settings.cutEx*e,p=this._settings.cutSy*e,v=this._settings.cutEy*e,m=(this._settings.letterSpacing||0)*e,x=this._settings.textIndent*e,A=this._settings.trFontFace;this.setFontProperties(),F(A);const w=Go(this._context,A,i),y=Ps(w,i)*e,b=this._settings.lineHeight!==null?this._settings.lineHeight*e:y,g=this._settings.maxHeight,T=g!==null&&b>0?Math.floor(g/b):0,_=this._settings.maxLines,C=T>0&&_>0?Math.min(T,_):Math.max(T,_);let I=a||2048/this.getPrecision(),R=I-r;if(R<10&&(I+=10-R,R=10),h||(h=R),this._settings.textOverflow&&!this._settings.wordWrap){let L;switch(this._settings.textOverflow){case"clip":L="";break;case"ellipsis":L=this._settings.overflowSuffix;break;default:L=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,h-x,L)}let B;if(this._settings.wordWrap)B=this.wrapText(this._settings.text,h,m,x);else{B={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const L=B.l.length;for(let D=0;D<L-1;D++)B.n.push(D)}let S=B.l;if(C&&S.length>C){const L=S.slice(0,C);let D=null;if(this._settings.overflowSuffix){const te=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,fe=this.wrapText(L[L.length-1],h-te,m,x);L[L.length-1]="".concat(fe.l[0]).concat(this._settings.overflowSuffix),D=[fe.l.length>1?fe.l[1]:""]}else D=[""];let U;const V=S.length;let K=0;const z=B.n.length;for(U=C;U<V;U++)D[K]+="".concat(D[K]?" ":"").concat(S[U]),U+1<z&&B.n[U+1]&&K++;t.remainingText=D.join("\n"),t.moreTextLines=!0,S=L}else t.moreTextLines=!1,t.remainingText="";let N=0;const k=[];for(let L=0;L<S.length;L++){const D=this.measureText(S[L],m)+(L===0?x:0);k.push(D),N=Math.max(N,D)}t.lineWidths=k,a||(I=N+r+s,R=N);let P;return l?P=l:P=Qn(this._settings.textBaseline,i,b,S.length,o),o===null&&(o=i),t.w=I,t.h=P,t.lines=S,t.precision=e,I||(I=1),P||(P=1),(f||u)&&(I=Math.min(I,u-f)),(p||v)&&(P=Math.min(P,v-p)),t.width=I,t.innerWidth=R,t.height=P,t.fontSize=i,t.cutSx=f,t.cutSy=p,t.cutEx=u,t.cutEy=v,t.lineHeight=b,t.defLineHeight=y,t.lineWidths=k,t.offsetY=o,t.paddingLeft=r,t.paddingRight=s,t.letterSpacing=m,t.textIndent=x,t.metrics=w,t}draw(t,e){const r=this.getPrecision(),s=(e==null?void 0:e.lines)||t.lines,i=(e==null?void 0:e.lineWidths)||t.lineWidths,o=e?Qn(this._settings.textBaseline,t.fontSize,t.lineHeight,e.lines.length,this._settings.offsetY===null?null:this._settings.offsetY*r):t.height;this._canvas.width=Math.min(Math.ceil(t.width+this._settings.textRenderIssueMargin),Kn),this._canvas.height=Math.min(Math.ceil(o),Kn),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy);let a,l;const h=[],{metrics:f}=t,u=f?f.ascender*t.fontSize:t.fontSize,p=(f.ascender-f.descender)*t.fontSize;for(let m=0,x=s.length;m<x;m++)a=m===0?t.textIndent:0,l=m*t.lineHeight+u,this._settings.verticalAlign=="middle"?l+=(t.lineHeight-p)/2:this._settings.verticalAlign=="bottom"&&(l+=t.lineHeight-p),this._settings.textAlign==="right"?a+=t.innerWidth-i[m]:this._settings.textAlign==="center"&&(a+=(t.innerWidth-i[m])/2),a+=t.paddingLeft,h.push({text:s[m],x:a,y:l,w:i[m]});if(this._settings.highlight){const m=this._settings.highlightColor,x=this._settings.highlightHeight*r||t.fontSize*1.5,A=this._settings.highlightOffset*r,w=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*r:t.paddingLeft,y=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*r:t.paddingRight;this._context.fillStyle=Ir(m);for(let b=0;b<h.length;b++){const g=h[b];this._context.fillRect(g.x-w,g.y-t.offsetY+A,g.w+y+w,x)}}let v=null;this._settings.shadow&&(v=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=Ir(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*r,this._context.shadowOffsetY=this._settings.shadowOffsetY*r,this._context.shadowBlur=this._settings.shadowBlur*r),this._context.fillStyle=Ir(this._settings.textColor);for(let m=0,x=h.length;m<x;m++){const A=h[m];if(t.letterSpacing===0)this._context.fillText(A.text,A.x,A.y);else{const w=A.text.split("");let y=A.x;for(let b=0,g=w.length;b<g;b++)this._context.fillText(w[b],y,A.y),y+=this.measureText(w[b],t.letterSpacing)}}v&&(this._context.shadowColor=v[0],this._context.shadowOffsetX=v[1],this._context.shadowOffsetY=v[2],this._context.shadowBlur=v[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy)}wrapWord(t,e,r){const s=this._context.measureText(r).width,i=t.length,o=this._context.measureText(t).width;if(o<=e)return t;let a=Math.floor(e*i/o),l=this._context.measureText(t.substring(0,a)).width+s;if(l>e)for(;a>0&&(l=this._context.measureText(t.substring(0,a)).width+s,l>e);)a-=1;else for(;a<i;)if(l=this._context.measureText(t.substring(0,a)).width+s,l<e)a+=1;else{a-=1;break}return t.substring(0,a)+(e>=s?r:"")}wrapText(t,e,r,s=0){const i=t.split(/\r?\n/g);let o=[];const a=[];for(let l=0;l<i.length;l++){const h=[];let f="",u=e-s;const p=i[l].split(" ");for(let v=0;v<p.length;v++){const m=this.measureText(p[v],r),x=m+this.measureText(" ",r);v===0||x>u?(v>0&&(h.push(f),f=""),f+=p[v],u=e-m-(v===0?s:0)):(u-=x,f+=" ".concat(p[v]))}h.push(f),f="",o=o.concat(h),l<i.length-1&&a.push(o.length)}return{l:o,n:a}}measureText(t,e=0){return e?t.split("").reduce((r,s)=>r+this._context.measureText(s).width+e,0):this._context.measureText(t).width}mergeDefaults(t){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFamily:null,trFontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxHeight:null,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...t}}}const jn=typeof self>"u"?globalThis:self;var ms;const qn=((ms=jn.document)==null?void 0:ms.fonts)||jn.fonts;function $o(n){const{fontFamily:t,fontStyle:e,fontWeight:r,fontStretch:s,fontSize:i}=n;return[e,r,s,"".concat(i,"px"),t].join(" ")}class Zn extends Ls{constructor(e){super(e);c(this,"canvas");c(this,"context");c(this,"fontFamilies",{});c(this,"fontFamilyArray",[this.fontFamilies]);c(this,"loadFont",e=>{const r=$o(e.props),s=An.resolveFontFace(this.fontFamilyArray,e.props);if(F(s,"Could not resolve font face for ".concat(r)),e.fontInfo={fontFace:s,cssString:r,loaded:!1},!e.fontInfo.loaded){qn.load(r).then(this.onFontLoaded.bind(this,e,r)).catch(this.onFontLoadError.bind(this,e,r));return}});typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let r=this.canvas.getContext("2d",{willReadFrequently:!0});r||(this.canvas=document.createElement("canvas"),r=this.canvas.getContext("2d",{willReadFrequently:!0})),F(r),this.context=r,this.addFontFace(new Fr({fontFamily:"sans-serif",descriptors:{},fontUrl:""}))}getPropertySetters(){return{fontFamily:(e,r)=>{e.props.fontFamily=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,r)=>{e.props.fontWeight=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,r)=>{e.props.fontStyle=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,r)=>{e.props.fontStretch=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,r)=>{e.props.fontSize=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,r)=>{e.props.text=r,this.invalidateLayoutCache(e)},textAlign:(e,r)=>{e.props.textAlign=r,this.invalidateLayoutCache(e)},color:(e,r)=>{e.props.color=r,this.invalidateLayoutCache(e)},x:(e,r)=>{e.props.x=r},y:(e,r)=>{e.props.y=r},contain:(e,r)=>{e.props.contain=r,this.invalidateLayoutCache(e)},width:(e,r)=>{e.props.width=r,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,r)=>{e.props.height=r,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,r)=>{e.props.offsetY=r,this.invalidateLayoutCache(e)},scrollY:(e,r)=>{e.props.scrollY=r},letterSpacing:(e,r)=>{e.props.letterSpacing=r,this.invalidateLayoutCache(e)},lineHeight:(e,r)=>{e.props.lineHeight=r,this.invalidateLayoutCache(e)},maxLines:(e,r)=>{e.props.maxLines=r,this.invalidateLayoutCache(e)},textBaseline:(e,r)=>{e.props.textBaseline=r,this.invalidateLayoutCache(e)},verticalAlign:(e,r)=>{e.props.verticalAlign=r,this.invalidateLayoutCache(e)},overflowSuffix:(e,r)=>{e.props.overflowSuffix=r,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof Fr}addFontFace(e){F(e instanceof Fr),e.fontFamily!=="sans-serif"&&qn.add(e.fontFace);const{fontFamilies:r}=this,s=e.fontFace.family;let i=r[s];i||(i=new Set,r[s]=i),i.add(e)}createState(e,r){return{node:r,props:e,status:"initialState",updateScheduled:!1,emitter:new He,textureNode:void 0,lightning2TextRenderer:new Vo(this.canvas,this.context),renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){if(e.status==="initialState"&&this.setStatus(e,"loading"),e.status!=="loaded"){if(!e.fontInfo)return this.loadFont(e);e.fontInfo.loaded&&(e.renderInfo||(e.renderInfo=this.calculateRenderInfo(e),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,this.renderSingleCanvasPage(e)))}}renderSingleCanvasPage(e){F(e.renderInfo);const r=e.node,s=this.stage.txManager.loadTexture("ImageTexture",{src:(function(i,o){return F(o),i.draw(o,{lines:o.lines,lineWidths:o.lineWidths}),this.canvas.width===0||this.canvas.height===0?null:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)}).bind(this,e.lightning2TextRenderer,e.renderInfo)});if(e.textureNode)e.textureNode.texture=s;else{const i=this.stage.createNode({parent:r,texture:s,autosize:!0,alpha:Oi(e.props.color)});e.textureNode=i}this.setStatus(e,"loaded")}calculateRenderInfo(e){var r,s;return e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFamily:e.props.fontFamily,trFontFace:(r=e.fontInfo)==null?void 0:r.fontFace,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:It(e.props.color),offsetY:e.props.offsetY,wordWrap:e.props.contain!=="none",wordWrapWidth:e.props.contain==="none"?void 0:e.props.width,letterSpacing:e.props.letterSpacing,lineHeight:(s=e.props.lineHeight)!=null?s:null,maxLines:e.props.maxLines,maxHeight:e.props.contain==="both"?e.props.height-e.props.offsetY:null,textBaseline:e.props.textBaseline,verticalAlign:e.props.verticalAlign,overflowSuffix:e.props.overflowSuffix,w:e.props.contain!=="none"?e.props.width:void 0},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.renderInfo}renderQuads(){}destroyState(e){e.status!=="destroyed"&&(super.destroyState(e),e.textureNode&&(e.textureNode.destroy(),delete e.textureNode),delete e.renderInfo)}invalidateLayoutCache(e){e.renderInfo=void 0,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,r){var s;r!==((s=e.fontInfo)==null?void 0:s.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,r,s){var i;r!==((i=e.fontInfo)==null?void 0:i.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,console.error("CanvasTextRenderer: Error loading font '".concat(e.fontInfo.cssString,"'"),s),this.scheduleUpdateState(e))}}class Xo{constructor(){c(this,"data",{})}reset(){this.data={}}increment(t){this.data[t]||(this.data[t]=0),this.data[t]++}getData(){return{...this.data}}}class Yo{constructor(t,e){c(this,"stage");c(this,"memUsed",0);c(this,"loadedTextures",new Map);c(this,"criticalThreshold");c(this,"targetThreshold");c(this,"cleanupInterval");c(this,"debugLogging");c(this,"lastCleanupTime",0);c(this,"criticalCleanupRequested",!1);c(this,"frameTime",0);this.stage=t;const{criticalThreshold:r}=e;this.criticalThreshold=Math.round(r);const s=Math.max(0,Math.min(1,e.targetThresholdLevel));if(this.targetThreshold=Math.round(r*s),this.cleanupInterval=e.cleanupInterval,this.debugLogging=e.debugLogging,e.debugLogging){let i=0;setInterval(()=>{i!==this.memUsed&&(i=this.memUsed,console.log("[TextureMemoryManager] Memory used: ".concat(Gn(this.memUsed)," mb / ").concat(Gn(this.criticalThreshold)," mb (").concat((this.memUsed/this.criticalThreshold*100).toFixed(1),"%)")))},1e3)}r===0&&(this.setTextureMemUse=()=>{})}setTextureMemUse(t,e){if(this.loadedTextures.has(t)&&(this.memUsed-=this.loadedTextures.get(t)),e===0){this.loadedTextures.delete(t);return}else this.memUsed+=e,this.loadedTextures.set(t,e);this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}cleanup(){const t=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,this.criticalCleanupRequested=!1,t&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.debugLogging&&console.log("[TextureMemoryManager] Cleaning up textures. Critical: ".concat(t));const e=[...this.loadedTextures.keys()].sort((i,o)=>{const a=i.renderable,l=o.renderable;return a===l?i.lastRenderableChangeTime-o.lastRenderableChangeTime:a?1:l?-1:0}),r=this.targetThreshold,s=this.stage.txManager;for(const i of e)if(i.renderable||(i.ctxTexture.free(),s.removeTextureFromCache(i),this.memUsed<=r))break;this.memUsed>=this.criticalThreshold&&(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),console.warn("[TextureMemoryManager] Memory usage above critical threshold after cleanup: ".concat(this.memUsed)))}getMemoryInfo(){let t=0;const e=[...this.loadedTextures.keys()].reduce((r,s)=>(t+=s.renderable?1:0,r+(s.renderable?this.loadedTextures.get(s):0)),0);return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:e,memUsed:this.memUsed,renderableTexturesLoaded:t,loadedTextures:this.loadedTextures.size}}}const Ko={isWhite:!0,a:1,r:255,g:255,b:255};function Pr(n){if(n===4294967295)return Ko;const t=(n>>>24&255)/255,e=n>>>16&255&255,r=n>>>8&255&255,s=n&255&255;return{isWhite:!1,a:t,r:s,g:r,b:e}}function er({a:n,r:t,g:e,b:r}){return"rgba(".concat(t,",").concat(e,",").concat(r,",").concat(n,")")}class Qo extends Ts{constructor(){super(...arguments);c(this,"image");c(this,"tintCache")}load(){this.textureSource.state==="freed"&&(this.textureSource.setState("loading"),this.onLoadRequest().then(e=>{this.textureSource.setState("loaded",e),this.updateMemSize()}).catch(e=>{this.textureSource.setState("failed",e)}))}free(){this.image=void 0,this.tintCache=void 0,this.textureSource.setState("freed"),this.setTextureMemUse(0)}updateMemSize(){const e=this.tintCache?8:4;if(this.textureSource.dimensions){const{width:r,height:s}=this.textureSource.dimensions;this.setTextureMemUse(r*s*e)}}hasImage(){return this.image!==void 0}getImage(e){var o;const r=this.image;if(F(r,"Attempt to get unloaded image texture"),e.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),r;const s=er(e);if(((o=this.tintCache)==null?void 0:o.key)===s)return this.tintCache.image;const i=this.tintTexture(r,s);return this.tintCache={key:s,image:i},this.updateMemSize(),i}tintTexture(e,r){const{width:s,height:i}=e,o=document.createElement("canvas");o.width=s,o.height=i;const a=o.getContext("2d");return a&&(a.fillStyle=r,a.globalCompositeOperation="copy",a.fillRect(0,0,s,i),a.globalCompositeOperation="multiply",a.drawImage(e,0,0,s,i,0,0,s,i),a.globalCompositeOperation="destination-in",a.drawImage(e,0,0,s,i,0,0,s,i)),o}async onLoadRequest(){const{data:e}=await this.textureSource.getTextureData();if(e instanceof ImageData){const r=document.createElement("canvas");r.width=e.width,r.height=e.height;const s=r.getContext("2d");return s&&s.putImageData(e,0,0),this.image=r,{width:e.width,height:e.height}}else if(e instanceof ImageBitmap)return this.image=e,{width:e.width,height:e.height};return{width:0,height:0}}}function jo(n){var t,e;return n.shader instanceof vn&&n.shader.shType===Bs&&(e=(t=n.shaderProps)==null?void 0:t.radius)!=null?e:0}class qo extends Ss{constructor(e){super(e);c(this,"context");c(this,"canvas");c(this,"pixelRatio");c(this,"clearColor");c(this,"renderToTextureActive",!1);c(this,"activeRttNode",null);c(this,"defShaderCtr");this.mode="canvas",this.shManager.renderer=this;const{canvas:r,pixelRatio:s,clearColor:i}=e;this.canvas=r,this.context=r.getContext("2d"),this.pixelRatio=s,this.clearColor=i?Ui(i):void 0,this.defShaderCtr={type:"DefaultShader",props:{},shader:new vn("DefaultShader"),getResolvedProps:()=>()=>({})}}reset(){this.canvas.width=this.canvas.width;const e=this.context;if(this.clearColor){const[r,s,i,o]=this.clearColor;e.fillStyle="rgba(".concat(r,", ").concat(s,", ").concat(i,", ").concat(o/255,")"),e.fillRect(0,0,this.canvas.width,this.canvas.height)}e.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(e){const r=this.context,{tx:s,ty:i,width:o,height:a,alpha:l,colorTl:h,colorTr:f,colorBr:u,ta:p,tb:v,tc:m,td:x,clippingRect:A}=e;let w=e.texture,y,b;if(w){if(w instanceof ht&&(b=w.props,w=w.parentTexture),y=w.ctxTexture,w.state==="freed"){y.load();return}if(w.state!=="loaded"||!y.hasImage())return}const g=Pr(h),T=p!==1,_=A.width!==0&&A.height!==0,C=h!==f||h!==u,I=e.shader?jo(e):0;if((T||_||I)&&r.save(),_){const R=new Path2D,{x:B,y:S,width:N,height:k}=A;R.rect(B,S,N,k),r.clip(R)}if(T){const R=this.pixelRatio;r.setTransform(p,m,v,x,s*R,i*R),r.scale(R,R),r.translate(-s,-i)}if(I){const R=new Path2D;R.roundRect(s,i,o,a,I),r.clip(R)}if(y){const R=y.getImage(g);r.globalAlpha=l,b?r.drawImage(R,b.x,b.y,b.width,b.height,s,i,o,a):r.drawImage(R,s,i,o,a),r.globalAlpha=1}else if(C){let R=s,B=i,S;h===f?(R=s,B=i+a,S=Pr(u)):(R=s+o,B=i,S=Pr(f));const N=r.createLinearGradient(s,i,R,B);N.addColorStop(0,er(g)),N.addColorStop(1,er(S)),r.fillStyle=N,r.fillRect(s,i,o,a)}else r.fillStyle=er(g),r.fillRect(s,i,o,a);(T||_||I)&&r.restore()}createCtxTexture(e){return new Qo(this.txMemManager,e)}getShaderManager(){return this.shManager}getDefShaderCtr(){return this.defShaderCtr}renderRTTNodes(){}removeRTTNode(e){}renderToTexture(e){}getBufferInfo(){return null}}class Zo extends Kr{constructor(e,r){super(e,r);c(this,"textRenderer");c(this,"trState");c(this,"_textRendererOverride",null);c(this,"onTextLoaded",()=>{const{contain:e}=this,r=this.trState.props.width,s=this.trState.props.height,i=this.trState.textW||0,o=this.trState.textH||0;e==="both"?(this.props.width=r,this.props.height=s):e==="width"?(this.props.width=r,this.props.height=o):e==="none"&&(this.props.width=i,this.props.height=o),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});c(this,"onTextFailed",(e,r)=>{this.emit("failed",{type:"text",error:r})});this._textRendererOverride=r.textRendererOverride;const{resolvedTextRenderer:s,textRendererState:i}=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:r.width,height:r.height,textAlign:r.textAlign,color:r.color,zIndex:r.zIndex,contain:r.contain,scrollable:r.scrollable,scrollY:r.scrollY,offsetY:r.offsetY,letterSpacing:r.letterSpacing,debug:r.debug,fontFamily:r.fontFamily,fontSize:r.fontSize,fontStretch:r.fontStretch,fontStyle:r.fontStyle,fontWeight:r.fontWeight,text:r.text,lineHeight:r.lineHeight,maxLines:r.maxLines,textBaseline:r.textBaseline,verticalAlign:r.verticalAlign,overflowSuffix:r.overflowSuffix});this.textRenderer=s,this.trState=i}get width(){return this.props.width}set width(e){this.props.width=e,this.textRenderer.set.width(this.trState,e),this.contain==="none"&&this.setUpdateType(M.Local)}get height(){return this.props.height}set height(e){this.props.height=e,this.textRenderer.set.height(this.trState,e),this.contain!=="both"&&this.setUpdateType(M.Local)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e,this.textRenderer.destroyState(this.trState);const{resolvedTextRenderer:r,textRendererState:s}=this.resolveTextRendererAndState(this.trState.props);this.textRenderer=r,this.trState=s}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(e){this.textRenderer.set.lineHeight&&this.textRenderer.set.lineHeight(this.trState,e)}get maxLines(){return this.trState.props.maxLines}set maxLines(e){this.textRenderer.set.maxLines&&this.textRenderer.set.maxLines(this.trState,e)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(e){this.textRenderer.set.textBaseline&&this.textRenderer.set.textBaseline(this.trState,e)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(e){this.textRenderer.set.verticalAlign&&this.textRenderer.set.verticalAlign(this.trState,e)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(e){this.textRenderer.set.overflowSuffix&&this.textRenderer.set.overflowSuffix(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,r){super.update(e,r),F(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkRenderProps(){return this.trState.props.text!==""?!0:super.checkRenderProps()}onChangeIsRenderable(e){super.onChangeIsRenderable(e),this.textRenderer.setIsRenderable(this.trState,e)}renderQuads(e){var r;if(F(this.globalTransform),!this.textRenderer.renderQuads){super.renderQuads(e);return}this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode)||(this.parentHasRenderTexture&&((r=this.props.parent)!=null&&r.rtt)&&(this.globalTransform=me.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),F(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions))}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}resolveTextRendererAndState(e){const r=this.stage.resolveTextRenderer(e,this._textRendererOverride),s=r.createState(e,this);return s.emitter.on("loaded",this.onTextLoaded),s.emitter.on("failed",this.onTextFailed),r.scheduleUpdateState(s),{resolvedTextRenderer:r,textRendererState:s}}}function Jo(n){const t={boolean:!0,string:!0,number:!0,undefined:!0},e=Object.keys(n);for(let r=0;r<e.length;r++){const s=e[r];if(!s)continue;const i=n[s],o=typeof i;o==="string"&&i.length>2048&&(console.warn("Custom Data value for ".concat(s," is too long, it will be truncated to 2048 characters")),n[s]=i.substring(0,2048)),t[o]||(console.warn("Custom Data value for ".concat(s," is not a boolean, string, or number, it will be ignored")),delete n[s])}return n}const ea=2e6;class ta{constructor(t){c(this,"options");c(this,"animationManager");c(this,"txManager");c(this,"txMemManager");c(this,"fontManager");c(this,"textRenderers");c(this,"shManager");c(this,"renderer");c(this,"root");c(this,"boundsMargin");c(this,"defShaderCtr");c(this,"eventBus");c(this,"deltaTime",0);c(this,"lastFrameTime",0);c(this,"currentFrameTime",0);c(this,"fpsNumFrames",0);c(this,"fpsElapsedTime",0);c(this,"renderRequested",!1);c(this,"frameEventQueue",[]);c(this,"contextSpy",null);this.options=t;const{canvas:e,clearColor:r,appWidth:s,appHeight:i,boundsMargin:o,enableContextSpy:a,numImageWorkers:l,textureMemory:h,renderMode:f}=t;this.eventBus=t.eventBus,this.txManager=new _o(l),this.txMemManager=new Yo(this,h),this.shManager=new fo,this.animationManager=new To,this.contextSpy=a?new Xo:null;let u=[0,0,0,0];o&&(u=Array.isArray(o)?o:[o,o,o,o]),this.boundsMargin=u;const p={stage:this,canvas:e,pixelRatio:t.devicePhysicalPixelRatio*t.deviceLogicalPixelRatio,clearColor:r!=null?r:4278190080,bufferMemory:ea,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy};f==="canvas"?this.renderer=new qo(p):this.renderer=new bn(p),this.defShaderCtr=this.renderer.getDefShaderCtr(),Pi(f),this.txManager.renderer=this.renderer,this.textRenderers=f==="webgl"?{canvas:new Zn(this),sdf:new Ho(this)}:{canvas:new Zn(this)},this.fontManager=new An(this.textRenderers);const v=new Kr(this,{x:0,y:0,width:s,height:i,alpha:1,autosize:!1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1});this.root=v,qi(this)}updateFrameTime(){const t=Zi();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=t,this.deltaTime=this.lastFrameTime?t-this.lastFrameTime:100/6,this.txManager.frameTime=t,this.txMemManager.frameTime=t,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}updateAnimations(){const{animationManager:t}=this;this.root&&t.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested}drawFrame(){const{renderer:t,renderRequested:e}=this;F(t),this.root.updateType!==0&&this.root.update(this.deltaTime,this.root.clippingRect),t.reset(),this.txMemManager.criticalCleanupRequested&&this.txMemManager.cleanup(),t.rttNodes.length>0&&t.renderRTTNodes(),this.addQuads(this.root),t==null||t.render(),this.calculateFps(),e&&(this.renderRequested=!1)}queueFrameEvent(t,e){this.frameEventQueue.push([t,e])}flushFrameEvents(){for(const[t,e]of this.frameEventQueue)this.eventBus.emit(t,e);this.frameEventQueue=[]}calculateFps(){var e,r,s;const{fpsUpdateInterval:t}=this.options;if(t&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=t)){const i=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:i,contextSpyData:(r=(e=this.contextSpy)==null?void 0:e.getData())!=null?r:null}),(s=this.contextSpy)==null||s.reset()}}addQuads(t){F(this.renderer&&t.globalTransform),t.isRenderable&&t.renderQuads(this.renderer);for(let e=0;e<t.children.length;e++){const r=t.children[e];r&&(r==null?void 0:r.worldAlpha)!==0&&this.addQuads(r)}}requestRender(){this.renderRequested=!0}resolveTextRenderer(t,e=null){let r=e,s=!1;if(r){const o=this.textRenderers[r];o?o.canRenderFont(t)||(console.warn("Cannot use override text renderer '".concat(r,"' for font"),t),r=null,s=!0):(console.warn("Text renderer override '".concat(r,"' not found.")),r=null,s=!0)}if(!r){for(const[o,a]of Object.entries(this.textRenderers))if(o!=="canvas"&&a.canRenderFont(t)){r=o;break}r||(r="canvas")}s&&console.warn("Falling back to text renderer ".concat(String(r)));const i=this.textRenderers[r];return F(i,"resolvedTextRenderer undefined"),i}createShaderCtr(t,e){return this.shManager.loadShader(t,e)}createNode(t){const e=this.resolveNodeDefaults(t);return new Kr(this,e)}createTextNode(t){var s,i,o,a,l,h,f,u,p,v,m,x,A,w,y,b,g,T;const e=(s=t.fontSize)!=null?s:16,r={...this.resolveNodeDefaults(t),text:(i=t.text)!=null?i:"",textRendererOverride:(o=t.textRendererOverride)!=null?o:null,fontSize:e,fontFamily:(a=t.fontFamily)!=null?a:"sans-serif",fontStyle:(l=t.fontStyle)!=null?l:"normal",fontWeight:(h=t.fontWeight)!=null?h:"normal",fontStretch:(f=t.fontStretch)!=null?f:"normal",textAlign:(u=t.textAlign)!=null?u:"left",contain:(p=t.contain)!=null?p:"none",scrollable:(v=t.scrollable)!=null?v:!1,scrollY:(m=t.scrollY)!=null?m:0,offsetY:(x=t.offsetY)!=null?x:0,letterSpacing:(A=t.letterSpacing)!=null?A:0,lineHeight:t.lineHeight,maxLines:(w=t.maxLines)!=null?w:0,textBaseline:(y=t.textBaseline)!=null?y:"alphabetic",verticalAlign:(b=t.verticalAlign)!=null?b:"middle",overflowSuffix:(g=t.overflowSuffix)!=null?g:"...",debug:(T=t.debug)!=null?T:{},shaderProps:null};return new Zo(this,r)}resolveNodeDefaults(t){var l,h,f,u,p,v,m,x,A,w,y,b,g,T,_,C,I,R,B,S,N,k,P,L,D,U,V,K,z,te,fe,oe,Xe,Re,xe,pe,Z,q,ee,J,X,ge,he,de,Le,Ye,Ke,ft,pt;const e=(l=t.color)!=null?l:4294967295,r=(u=(f=(h=t.colorTl)!=null?h:t.colorTop)!=null?f:t.colorLeft)!=null?u:e,s=(m=(v=(p=t.colorTr)!=null?p:t.colorTop)!=null?v:t.colorRight)!=null?m:e,i=(w=(A=(x=t.colorBl)!=null?x:t.colorBottom)!=null?A:t.colorLeft)!=null?w:e,o=(g=(b=(y=t.colorBr)!=null?y:t.colorBottom)!=null?b:t.colorRight)!=null?g:e,a=Jo((T=t.data)!=null?T:{});return{x:(_=t.x)!=null?_:0,y:(C=t.y)!=null?C:0,width:(I=t.width)!=null?I:0,height:(R=t.height)!=null?R:0,alpha:(B=t.alpha)!=null?B:1,autosize:(S=t.autosize)!=null?S:!1,clipping:(N=t.clipping)!=null?N:!1,color:e,colorTop:(k=t.colorTop)!=null?k:e,colorBottom:(P=t.colorBottom)!=null?P:e,colorLeft:(L=t.colorLeft)!=null?L:e,colorRight:(D=t.colorRight)!=null?D:e,colorBl:i,colorBr:o,colorTl:r,colorTr:s,zIndex:(U=t.zIndex)!=null?U:0,zIndexLocked:(V=t.zIndexLocked)!=null?V:0,parent:(K=t.parent)!=null?K:null,texture:(z=t.texture)!=null?z:null,textureOptions:(te=t.textureOptions)!=null?te:{},shader:(fe=t.shader)!=null?fe:this.defShaderCtr,src:(oe=t.src)!=null?oe:null,scale:(Xe=t.scale)!=null?Xe:null,scaleX:(xe=(Re=t.scaleX)!=null?Re:t.scale)!=null?xe:1,scaleY:(Z=(pe=t.scaleY)!=null?pe:t.scale)!=null?Z:1,mount:(q=t.mount)!=null?q:0,mountX:(J=(ee=t.mountX)!=null?ee:t.mount)!=null?J:0,mountY:(ge=(X=t.mountY)!=null?X:t.mount)!=null?ge:0,pivot:(he=t.pivot)!=null?he:.5,pivotX:(Le=(de=t.pivotX)!=null?de:t.pivot)!=null?Le:.5,pivotY:(Ke=(Ye=t.pivotY)!=null?Ye:t.pivot)!=null?Ke:.5,rotation:(ft=t.rotation)!=null?ft:0,rtt:(pt=t.rtt)!=null?pt:!1,data:a}}}class ra extends He{constructor(e,r){var x,A,w,y,b,g,T,_,C;super();c(this,"root");c(this,"canvas");c(this,"settings");c(this,"stage");c(this,"inspector",null);const s={criticalThreshold:((x=e.textureMemory)==null?void 0:x.criticalThreshold)||124e6,targetThresholdLevel:((A=e.textureMemory)==null?void 0:A.targetThresholdLevel)||.5,cleanupInterval:((w=e.textureMemory)==null?void 0:w.cleanupInterval)||3e4,debugLogging:((y=e.textureMemory)==null?void 0:y.debugLogging)||!1},i={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,textureMemory:s,boundsMargin:e.boundsMargin||0,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:(b=e.clearColor)!=null?b:0,fpsUpdateInterval:e.fpsUpdateInterval||0,numImageWorkers:e.numImageWorkers!==void 0?e.numImageWorkers:2,enableContextSpy:(g=e.enableContextSpy)!=null?g:!1,enableInspector:(T=e.enableInspector)!=null?T:!1,renderMode:(_=e.renderMode)!=null?_:"webgl",quadBufferSize:(C=e.quadBufferSize)!=null?C:4*1024*1024};this.settings=i;const{appWidth:o,appHeight:a,deviceLogicalPixelRatio:l,devicePhysicalPixelRatio:h,enableInspector:f}=i,u=o*l,p=a*l,v=document.createElement("canvas");this.canvas=v,v.width=u*h,v.height=p*h,v.style.width="".concat(u,"px"),v.style.height="".concat(p,"px"),this.stage=new ta({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,fpsUpdateInterval:this.settings.fpsUpdateInterval,numImageWorkers:this.settings.numImageWorkers,renderMode:this.settings.renderMode,textureMemory:s,eventBus:this,quadBufferSize:this.settings.quadBufferSize}),this.root=this.stage.root;let m;if(typeof r=="string"?m=document.getElementById(r):m=r,!m)throw new Error("Could not find target element");m.appendChild(v),f&&!xn()&&(this.inspector=new ji(v,i))}createNode(e){F(this.stage,"Stage is not initialized");const r=this.stage.createNode(e);return this.inspector?this.inspector.createNode(r):r}createTextNode(e){const r=this.stage.createTextNode(e);return this.inspector?this.inspector.createTextNode(r):r}destroyNode(e){return this.inspector&&this.inspector.destroyNode(e.id),e.destroy()}createTexture(e,r){return this.stage.txManager.loadTexture(e,r)}createShader(e,r){return this.stage.shManager.loadShader(e,r)}createDynamicShader(e){return this.stage.shManager.loadDynamicShader({effects:e})}createEffect(e,r,s){return{name:s,type:e,props:r}}getNodeById(e){var i;const r=(i=this.stage)==null?void 0:i.root;if(!r)return null;const s=o=>{if(o.id===e)return o;for(const a of o.children){const l=s(a);if(l)return l}return null};return s(r)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){throw new Error("Not implemented")}}let ke,Tn;function na(n={},t="app"){return ke=new ra(n,t),Tn=ke.createShader.bind(ke),ke}function sa(){return!0&&!1}const ia=sa()||!1,le={debug:!1,animationsEnabled:!0,animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100},setActiveElement:()=>{}};function Jn(n){return oa(n)&&n.debug}function Ze(n,t,...e){ia&&(le.debug||Jn(t)||Jn(e[0]))&&console.log(n,t,...e)}const tt=n=>n instanceof Function;function oa(n){return typeof n=="object"}function ar(n){return Array.isArray(n)}function aa(n){return typeof n=="string"}function la(n){return typeof n=="number"}function ca(n){return Number.isInteger(n)}function ha(n){return"destroy"in n&&typeof n.destroy=="function"}function tr(n){return n instanceof We}function da(n,t){for(const e of t)if(e in n)return!0;return!1}function ks(n,t={}){if(ar(n))n.forEach(e=>{ks(e,t)});else if(n)for(const e in n)t[e]===void 0&&(t[e]=n[e]);return t}class ua extends Array{constructor(e){super();c(this,"_parent");this._parent=e}get selected(){const e=this._parent.selected||0;for(let r=e;r<this.length;r++){const s=this[r];if(tr(s))return this._parent.selected=r,s}}get firstChild(){return this[0]}insert(e,r){if(r){this.remove(e);const s=this.indexOf(r);this.splice(s,0,e)}else this.push(e);e.parent=this._parent}remove(e){const r=this.indexOf(e);r>=0&&this.splice(r,1)}}class es extends Array{constructor(e,r={}){var t=(...Jd)=>(super(...Jd),c(this,"onChange"),this);return ar(r)?t(...r):aa(r)?t(r):t(...Object.entries(r).filter(([s,i])=>i).map(([s])=>s)),this.onChange=e,this}has(e){return this.indexOf(e)>=0}is(e){return this.indexOf(e)>=0}add(e){this.has(e)||(this.push(e),this.onChange())}toggle(e,r){r===!0?this.has(e)||this.add(e):r===!1?this.has(e)&&this.remove(e):this.has(e)?this.remove(e):this.add(e)}remove(e){const r=this.indexOf(e);r>=0&&(this.splice(r,1),this.onChange())}}const Oe={Element:"element",TextNode:"textNode",Text:"text"};function fa(n){const t=[];let e=!1,r=0;for(let g=0;g<n.children.length;g++){const T=n.children[g];if(T._type!==Oe.Text&&T.flexItem!==!1){if(T._type===Oe.TextNode&&T.text&&!(T.width||T.height))return!1;T.flexOrder!==void 0&&(e=!0),T.flexGrow!==void 0&&(r+=T.flexGrow),t.push(T)}}e&&t.sort((g,T)=>(g.flexOrder||0)-(T.flexOrder||0));const s=t.length,o=(n.flexDirection||"row")==="row",a=o?"width":"height",l=o?"height":"width",h=o?"marginLeft":"marginTop",f=o?"marginRight":"marginBottom",u=o?"x":"y",p=o?"y":"x",v=n[a]||0,m=n[l]||0,x=n.gap||0,A=n.justifyContent||"flexStart",w=n.alignItems;if(r){const g=t.reduce((_,C)=>_+(C.flexGrow?0:C[a]||0)+(C[h]||0)+(C[f]||0),0),T=(v-g-x*(s-1))/r;for(let _=0;_<t.length;_++){const C=t[_];C.flexGrow!==void 0&&C.flexGrow>0&&(C[a]=C.flexGrow*T)}}let y=0;["center","spaceBetween","spaceEvenly"].includes(A)&&(y=t.reduce((g,T)=>g+(T[a]||0)+(T[h]||0)+(T[f]||0),0));const b=m&&w?g=>{w==="flexStart"?g[p]=0:w==="center"?g[p]=(m-(g[l]||0))/2:w==="flexEnd"&&(g[p]=m-(g[l]||0))}:g=>g;if(A==="flexStart"){let g=0;for(let T=0;T<t.length;T++){const _=t[T];_[u]=g+(_[h]||0),g+=(_[a]||0)+x+(_[h]||0)+(_[f]||0),b(_)}if(n.flexBoundary!=="fixed"){const T=g-x;if(T!==n[a])return n[a]=T,!0}}else if(A==="flexEnd"){let g=v;for(let T=s-1;T>=0;T--){const _=t[T];_[u]=g-(_[a]||0)-(_[f]||0),g-=(_[a]||0)+x+(_[h]||0)+(_[f]||0),b(_)}if(n.flexBoundary!=="fixed"){const T=g-x;if(T!==n[a])return n[a]=T,!0}}else if(A==="center"){let g=(v-(y+x*(s-1)))/2;for(let T=0;T<t.length;T++){const _=t[T];_[u]=g+(_[h]||0),g+=(_[a]||0)+x+(_[h]||0)+(_[f]||0),b(_)}}else if(A==="spaceBetween"){const g=(v-y)/(s-1);let T=0;for(let _=0;_<t.length;_++){const C=t[_];C[u]=T+(C[h]||0),T+=(C[a]||0)+g+(C[h]||0)+(C[f]||0),b(C)}}else if(A==="spaceEvenly"){const g=(v-y)/(s+1);let T=g;for(let _=0;_<t.length;_++){const C=t[_];C[u]=T+(C[h]||0),T+=(C[a]||0)+g+(C[h]||0)+(C[f]||0),b(C)}}return!1}const tn={ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"Enter",l:"Last"," ":"Space",Backspace:"Back",Escape:"Escape"},Ns={Enter:"EnterHold"},ts=(n,t)=>{for(const[e,r]of Object.entries(n))r!=null&&(Array.isArray(r)?r.forEach(s=>{t[s]=e}):t[r]=e)};let rs;const pa=n=>{ga(n,rs),rs=n,le.setActiveElement(n)};let lr=[];const ga=(n,t)=>{var s,i;let e=n;const r=[];for(;e;)(!e.states.has("focus")||e===n)&&(e.states.add("focus"),(s=e.onFocus)==null||s.call(e,n,t),(i=e.onFocusChanged)==null||i.call(e,!0,n,t)),r.push(e),e=e.parent;return lr.forEach(o=>{var a,l;r.includes(o)||(o.states.remove("focus"),(a=o.onBlur)==null||a.call(o,n,t),(l=o.onFocusChanged)==null||l.call(o,!1,n,t))}),lr=r,r},rn=(n,t,e)=>{let r;for(const s of lr){if(r=r||s,t){const o=s["on".concat(t)];if((o==null?void 0:o.call(s,n,s,r))===!0)break}else console.log("Unhandled key event: ".concat(n.key||n.keyCode));const i=e?s.onKeyPress:s.onKeyHold;if((i==null?void 0:i.call(s,n,s,r))===!0)break}return!1},ma=150,De={},xa=(n,t)=>{delete De[n.key||n.keyCode],rn(n,t,!0)},ya=(n,t,e)=>{if(t){const r=t.key||t.keyCode,s=Ns[r],i=tn[r];s?(De[r]&&clearTimeout(De[r]),De[r]=window.setTimeout(()=>xa(t,s),n)):rn(t,i,!1)}if(e){const r=e.key||e.keyCode,s=tn[r];De[r]&&(clearTimeout(De[r]),delete De[r],rn(e,s,!1))}},va=({userKeyMap:n,keyHoldOptions:t,ownerContext:e=r=>{r()}})=>{n&&ts(n,tn),t!=null&&t.userKeyHoldMap&&ts(t.userKeyHoldMap,Ns);const r=(t==null?void 0:t.holdThreshold)||ma,s=ya.bind(null,r),i=a=>e(()=>{s(a,void 0)}),o=a=>e(()=>{s(void 0,a)});return document.addEventListener("keyup",o),document.addEventListener("keydown",i),{cleanup:()=>{document.removeEventListener("keydown",i),document.removeEventListener("keyup",o);for(const[a,l]of Object.entries(De))l&&clearTimeout(l)},focusPath:()=>lr}},Gt=new Set;let kr=!0;function ns(n){const t=[];let e=0;for(const[r,s]of Object.entries(n))t.push({name:"effect".concat(e),type:r,props:s}),e++;return Tn("DynamicShader",{effects:t})}function gt(n=""){return{set(t){la(t)&&(t={width:t,color:255}),this.effects=this.effects?{...this.effects||{},["border".concat(n)]:t}:{["border".concat(n)]:t}},get(){var t;return(t=this.effects)==null?void 0:t["border".concat(n)]}}}const ba=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","width","worldX","worldY","x","y","zIndex","zIndexLocked"],Aa=["absX","absY","autosize","clipping","contain","fontFamily","fontStretch","fontStyle","fontWeight","letterSpacing","maxLines","offsetY","overflowSuffix","rtt","scrollable","scrollY","src","text","textAlign","textBaseline","textOverflow","texture","verticalAlign","wordWrap"];class We extends Object{constructor(t){super(),this._type=t==="text"?Oe.TextNode:Oe.Element,this.rendered=!1,this.lng={},this.children=new ua(this)}get effects(){return this._effects}set effects(t){this._effects=t,this.rendered&&(this.shader=ns(t))}get parent(){return this._parent}set parent(t){var e;this._parent=t,this.rendered&&(this.lng.parent=(e=t==null?void 0:t.lng)!=null?e:null)}set shader(t){let e=t;ar(t)&&(e=Tn(...t)),this.lng.shader=e}_sendToLightningAnimatable(t,e){if(this.transition&&this.rendered&&le.animationsEnabled&&(this.transition===!0||this.transition[t])){const r=this.transition===!0||this.transition[t]===!0?void 0:this.transition[t],s=this.animate({[t]:e},r);return tt(this.onAnimationStarted)&&s.once("animating",i=>{var o;(o=this.onAnimationStarted)==null||o.call(this,i,t,e)}),tt(this.onAnimationFinished)&&s.once("stopped",i=>{var o;(o=this.onAnimationFinished)==null||o.call(this,i,t,e)}),s.start()}this.lng[t]=e}animate(t,e){return F(this.rendered,"Node must be rendered before animating"),this.lng.animate(t,e||this.animationSettings)}chain(t,e){return this._animationRunning&&(this._animationQueue=[],this._animationRunning=!1),e?this._animationQueueSettings=e:this._animationQueueSettings||(this._animationQueueSettings=e||this.animationSettings),e=e||this._animationQueueSettings,this._animationQueue=this._animationQueue||[],this._animationQueue.push({props:t,animationSettings:e}),this}async start(){let t=this._animationQueue.shift();for(;t;)this._animationRunning=!0,await this.animate(t.props,t.animationSettings).start().waitUntilStopped(),t=this._animationQueue.shift();this._animationRunning=!1,this._animationQueueSettings=void 0}setFocus(){if(!this.skipFocus)if(this.rendered){if(this.forwardFocus!==void 0)if(tt(this.forwardFocus)){if(this.forwardFocus.call(this,this)!==!1)return}else{const t=typeof this.forwardFocus=="number"?this.forwardFocus:null;if(t!==null&&t<this.children.length){const e=this.children[t];tr(e)&&e.setFocus();return}}queueMicrotask(()=>pa(this))}else this.autofocus=!0}isTextNode(){return this._type===Oe.TextNode}_layoutOnLoad(){this.lng.on("loaded",(t,e)=>{const{dimensions:r}=e;this.parent.updateLayout(this,r)})}getText(){let t="";for(let e=0;e<this.children.length;e++)t+=this.children[e].text;return t}destroy(){this._queueDelete&&ha(this.lng)&&this.lng.destroy()}set onEvents(t){this._events=t}get onEvents(){return this._events}set style(t){ar(t)?this._style=ks(t):this._style=t;for(const e in this._style)this[e]===void 0&&(this[e]=this._style[e])}get style(){return this._style}get hasChildren(){return this.children.length>0}getChildById(t){return this.children.find(e=>e.id===t)}searchChildrenById(t){for(let e=0;e<this.children.length;e++){const r=this.children[e];if(tr(r)){if(r.id===t)return r;const s=r.searchChildrenById(t);if(s)return s}}}set states(t){this._states=new es(this._stateChanged.bind(this),t),this.rendered&&this._stateChanged()}get states(){return this._states=this._states||new es(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||le.animationSettings}set animationSettings(t){this._animationSettings=t}set hidden(t){this.alpha=t?0:1}get hidden(){return this.alpha===0}requiresLayout(){return this.display==="flex"||this.onBeforeLayout}set updateLayoutOn(t){this.updateLayout()}get updateLayoutOn(){return null}updateLayout(t,e){var r,s;if(this.hasChildren){Ze("Layout: ",this);let i=!1;tt(this.onBeforeLayout)&&(i=this.onBeforeLayout.call(this,this,t,e)||!1),this.display==="flex"?(fa(this)||i)&&((r=this.parent)==null||r.updateLayout()):i&&((s=this.parent)==null||s.updateLayout()),tt(this.onLayout)&&this.onLayout.call(this,this,t,e)}}_stateChanged(){if(Ze("State Changed: ",this,this.states),this.forwardStates){const e=this.states.slice();this.children.forEach(r=>{r.states=e})}const t=this.states;if(this._undoStyles||this.style&&da(this.style,t)){this._undoStyles=this._undoStyles||[];const e={};this._undoStyles.forEach(s=>{e[s]=this.style[s]});const r=t.reduce((s,i)=>{const o=this.style[i];return o&&(s={...s,...o}),s},{});this._undoStyles=Object.keys(r),r.transition!==void 0&&(this.transition=r.transition),Object.assign(this,e,r)}}render(){var s;const t=this,e=this.parent;if(!e){console.warn("Parent not set - no node created for: ",this);return}if(!e.rendered){console.warn("Parent not rendered yet: ",this);return}if(e.requiresLayout()&&!Gt.has(e)&&(Gt.add(e),kr&&(kr=!1,queueMicrotask(()=>{kr=!0;const i=[...Gt];Gt.clear();for(let o=i.length-1;o>=0;o--)i[o].updateLayout()}))),this.rendered)return;this._states&&this._stateChanged();const r=t.lng;if(r.x=r.x||0,r.y=r.y||0,e.rendered&&(r.parent=e.lng),t._effects&&(r.shader=ns(t._effects)),t.isTextNode()){const i=r;if(le.fontSettings)for(const o in le.fontSettings)i[o]===void 0&&(i[o]=le.fontSettings[o]);i.text=i.text||t.getText(),i.textAlign&&!i.contain&&console.warn("Text align requires contain: ",t.getText()),i.contain&&(i.width||(i.width=(e.width||0)-i.x-(i.marginRight||0)),i.contain==="both"&&!i.height&&!i.maxLines?i.height=(e.height||0)-i.y-(i.marginBottom||0):i.maxLines===1&&(i.height=i.height||i.lineHeight||i.fontSize)),Ze("Rendering: ",this,r),t.lng=ke.createTextNode(r),e.requiresLayout()&&(!r.width||!r.height)&&t._layoutOnLoad()}else r.texture||(isNaN(r.width)&&(r.width=(e.width||0)-r.x),isNaN(r.height)&&(r.height=(e.height||0)-r.y),r.rtt&&!r.color&&(r.color=4294967295),!r.color&&!r.src&&(r.color=0)),Ze("Rendering: ",this,r),t.lng=ke.createNode(r);if(t.rendered=!0,t.autosize&&e.requiresLayout()&&t._layoutOnLoad(),t.onFail&&t.lng.on("failed",t.onFail),t.onLoad&&t.lng.on("loaded",t.onLoad),tt(this.onCreate)&&this.onCreate.call(this,t),t.onEvents&&t.onEvents.forEach(([i,o])=>{t.lng.on(i,(a,l)=>o(t,l))}),(s=t.lng)!=null&&s.div&&(t.lng.div.element=t),t._type===Oe.Element)for(let i=0;i<t.children.length;i++){const o=t.children[i];F(o,"Child is undefined"),tr(o)?o.render():o.text&&o._type===Oe.Text&&console.warn("TextNode outside of <Text>: ",o)}t.autofocus&&t.setFocus()}}for(const n of ba)Object.defineProperty(We.prototype,n,{get(){return this.lng[n]},set(t){this._sendToLightningAnimatable(n,t)}});for(const n of Aa)Object.defineProperty(We.prototype,n,{get(){return this.lng[n]},set(t){this.lng[n]=t}});Object.defineProperties(We.prototype,{borderRadius:{set(n){this.effects=this.effects?{...this.effects,radius:{radius:n}}:{radius:{radius:n}}},get(){var n,t;return(t=(n=this.effects)==null?void 0:n.radius)==null?void 0:t.radius}},border:gt(),borderLeft:gt("Left"),borderRight:gt("Right"),borderTop:gt("Top"),borderBottom:gt("Bottom"),linearGradient:{set(n={}){this.effects=this.effects?{...this.effects,linearGradient:n}:{linearGradient:n}},get(){var n;return(n=this.effects)==null?void 0:n.linearGradient}},radialGradient:{set(n={}){this.effects=this.effects?{...this.effects,radialGradient:n}:{radialGradient:n}},get(){var n;return(n=this.effects)==null?void 0:n.radialGradient}},radialProgress:{set(n={}){this.effects=this.effects?{...this.effects,radialProgressGradient:n}:{radialProgressGradient:n}},get(){var n;return(n=this.effects)==null?void 0:n.radialProgress}}});const Q={context:void 0,registry:void 0,getContextId(){return ss(this.context.count)},getNextContextId(){return ss(this.context.count++)}};function ss(n){const t=String(n),e=t.length-1;return Q.context.id+(e?String.fromCharCode(96+e):"")+t}function At(n){Q.context=n}const Ds=(n,t)=>n===t,cr=Symbol("solid-proxy"),Us=Symbol("solid-track"),hr={equals:Ds};let Os=Ys;const _e=1,dr=2,zs={owned:null,cleanups:null,context:null,owner:null},Nr={};var G=null;let Dr=null,Ta=null,$=null,ce=null,Be=null,Tr=0;function Ne(n,t){const e=$,r=G,s=n.length===0,i=t===void 0?r:t,o=s?zs:{owned:null,cleanups:null,context:i?i.context:null,owner:i},a=s?n:()=>n(()=>ie(()=>Sr(o)));G=o,$=null;try{return Me(a,!0)}finally{$=e,G=r}}function H(n,t){t=t?Object.assign({},hr,t):hr;const e={value:n,observers:null,observerSlots:null,comparator:t.equals||void 0},r=s=>(typeof s=="function"&&(s=s(e.value)),Xs(e,s));return[$s.bind(e),r]}function nn(n,t,e){const r=Mt(n,t,!0,_e);et(r)}function Ie(n,t,e){const r=Mt(n,t,!1,_e);et(r)}function Ve(n,t,e){Os=Ia;const r=Mt(n,t,!1,_e);r.user=!0,Be?Be.push(r):et(r)}function j(n,t,e){e=e?Object.assign({},hr,e):hr;const r=Mt(n,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=e.equals||void 0,et(r),$s.bind(r)}function Sa(n){return n&&typeof n=="object"&&"then"in n}function Ws(n,t,e){let r,s,i;arguments.length===2&&typeof t=="object"||arguments.length===1?(r=!0,s=n,i=t||{}):(r=n,s=t,i={});let o=null,a=Nr,l=null,h=!1,f="initialValue"in i,u=typeof r=="function"&&j(r);const p=new Set,[v,m]=(i.storage||H)(i.initialValue),[x,A]=H(void 0),[w,y]=H(void 0,{equals:!1}),[b,g]=H(f?"ready":"unresolved");if(Q.context){l=Q.getNextContextId();let R;i.ssrLoadFrom==="initial"?a=i.initialValue:Q.load&&(R=Q.load(l))&&(a=R)}function T(R,B,S,N){return o===R&&(o=null,N!==void 0&&(f=!0),(R===a||B===a)&&i.onHydrated&&queueMicrotask(()=>i.onHydrated(N,{value:B})),a=Nr,_(B,S)),B}function _(R,B){Me(()=>{B===void 0&&m(()=>R),g(B!==void 0?"errored":f?"ready":"unresolved"),A(B);for(const S of p.keys())S.decrement();p.clear()},!1)}function C(){const R=Ra,B=v(),S=x();if(S!==void 0&&!o)throw S;return $&&!$.user&&R&&nn(()=>{w(),o&&(R.resolved||p.has(R)||(R.increment(),p.add(R)))}),B}function I(R=!0){if(R!==!1&&h)return;h=!1;const B=u?u():r;if(B==null||B===!1){T(o,ie(v));return}const S=a!==Nr?a:ie(()=>s(B,{value:v(),refetching:R}));return Sa(S)?(o=S,"value"in S?(S.status==="success"?T(o,S.value,void 0,B):T(o,void 0,sn(S.value),B),S):(h=!0,queueMicrotask(()=>h=!1),Me(()=>{g(f?"refreshing":"pending"),y()},!1),S.then(N=>T(S,N,void 0,B),N=>T(S,void 0,sn(N),B)))):(T(o,S,void 0,B),S)}return Object.defineProperties(C,{state:{get:()=>b()},error:{get:()=>x()},loading:{get(){const R=b();return R==="pending"||R==="refreshing"}},latest:{get(){if(!f)return C();const R=x();if(R&&!o)throw R;return v()}}}),u?nn(()=>I(!1)):I(!1),[C,{refetch:I,mutate:m}]}function wa(n,t=Ds,e){const r=new Map,s=Mt(i=>{const o=n();for(const[a,l]of r.entries())if(t(a,o)!==t(a,i))for(const h of l.values())h.state=_e,h.pure?ce.push(h):Be.push(h);return o},void 0,!0,_e);return et(s),i=>{const o=$;if(o){let a;(a=r.get(i))?a.add(o):r.set(i,a=new Set([o])),Ae(()=>{a.delete(o),!a.size&&r.delete(i)})}return t(i,s.value)}}function Sn(n){return Me(n,!1)}function ie(n){if($===null)return n();const t=$;$=null;try{return n()}finally{$=t}}function Je(n,t,e){const r=Array.isArray(n);let s,i=e&&e.defer;return o=>{let a;if(r){a=Array(n.length);for(let h=0;h<n.length;h++)a[h]=n[h]()}else a=n();if(i)return i=!1,o;const l=ie(()=>t(a,s,o));return s=a,l}}function Rd(n){Ve(()=>ie(n))}function Ae(n){return G===null||(G.cleanups===null?G.cleanups=[n]:G.cleanups.push(n)),n}function Hs(){return $}function $e(){return G}function wn(n,t){const e=G,r=$;G=n,$=null;try{return Me(t,!0)}catch(s){Rn(s)}finally{G=e,$=r}}function _a(n){const t=$,e=G;return Promise.resolve().then(()=>{$=t,G=e;let r;return Me(n,!1),$=G=null,r?r.done:void 0})}function Gs(n,t){const e=Symbol("context");return{id:e,Provider:Ba(e),defaultValue:n}}function Vs(n){let t;return G&&G.context&&(t=G.context[n.id])!==void 0?t:n.defaultValue}function _n(n){const t=j(n),e=j(()=>on(t()));return e.toArray=()=>{const r=e();return Array.isArray(r)?r:r!=null?[r]:[]},e}let Ra;function $s(){if(this.sources&&this.state)if(this.state===_e)et(this);else{const n=ce;ce=null,Me(()=>fr(this),!1),ce=n}if($){const n=this.observers?this.observers.length:0;$.sources?($.sources.push(this),$.sourceSlots.push(n)):($.sources=[this],$.sourceSlots=[n]),this.observers?(this.observers.push($),this.observerSlots.push($.sources.length-1)):(this.observers=[$],this.observerSlots=[$.sources.length-1])}return this.value}function Xs(n,t,e){let r=n.value;return(!n.comparator||!n.comparator(r,t))&&(n.value=t,n.observers&&n.observers.length&&Me(()=>{for(let s=0;s<n.observers.length;s+=1){const i=n.observers[s],o=Dr&&Dr.running;o&&Dr.disposed.has(i),(o?!i.tState:!i.state)&&(i.pure?ce.push(i):Be.push(i),i.observers&&Ks(i)),o||(i.state=_e)}if(ce.length>1e6)throw ce=[],new Error},!1)),t}function et(n){if(!n.fn)return;Sr(n);const t=Tr;Ca(n,n.value,t)}function Ca(n,t,e){let r;const s=G,i=$;$=G=n;try{r=n.fn(t)}catch(o){return n.pure&&(n.state=_e,n.owned&&n.owned.forEach(Sr),n.owned=null),n.updatedAt=e+1,Rn(o)}finally{$=i,G=s}(!n.updatedAt||n.updatedAt<=e)&&(n.updatedAt!=null&&"observers"in n?Xs(n,r):n.value=r,n.updatedAt=e)}function Mt(n,t,e,r=_e,s){const i={fn:n,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:G,context:G?G.context:null,pure:e};return G===null||G!==zs&&(G.owned?G.owned.push(i):G.owned=[i]),i}function ur(n){if(n.state===0)return;if(n.state===dr)return fr(n);if(n.suspense&&ie(n.suspense.inFallback))return n.suspense.effects.push(n);const t=[n];for(;(n=n.owner)&&(!n.updatedAt||n.updatedAt<Tr);)n.state&&t.push(n);for(let e=t.length-1;e>=0;e--)if(n=t[e],n.state===_e)et(n);else if(n.state===dr){const r=ce;ce=null,Me(()=>fr(n,t[0]),!1),ce=r}}function Me(n,t){if(ce)return n();let e=!1;t||(ce=[]),Be?e=!0:Be=[],Tr++;try{const r=n();return Ea(e),r}catch(r){e||(Be=null),ce=null,Rn(r)}}function Ea(n){if(ce&&(Ys(ce),ce=null),n)return;const t=Be;Be=null,t.length&&Me(()=>Os(t),!1)}function Ys(n){for(let t=0;t<n.length;t++)ur(n[t])}function Ia(n){let t,e=0;for(t=0;t<n.length;t++){const r=n[t];r.user?n[e++]=r:ur(r)}if(Q.context){if(Q.count){Q.effects||(Q.effects=[]),Q.effects.push(...n.slice(0,e));return}else Q.effects&&(n=[...Q.effects,...n],e+=Q.effects.length,delete Q.effects);At()}for(t=0;t<e;t++)ur(n[t])}function fr(n,t){n.state=0;for(let e=0;e<n.sources.length;e+=1){const r=n.sources[e];if(r.sources){const s=r.state;s===_e?r!==t&&(!r.updatedAt||r.updatedAt<Tr)&&ur(r):s===dr&&fr(r,t)}}}function Ks(n){for(let t=0;t<n.observers.length;t+=1){const e=n.observers[t];e.state||(e.state=dr,e.pure?ce.push(e):Be.push(e),e.observers&&Ks(e))}}function Sr(n){let t;if(n.sources)for(;n.sources.length;){const e=n.sources.pop(),r=n.sourceSlots.pop(),s=e.observers;if(s&&s.length){const i=s.pop(),o=e.observerSlots.pop();r<s.length&&(i.sourceSlots[o]=r,s[r]=i,e.observerSlots[r]=o)}}if(n.owned){for(t=n.owned.length-1;t>=0;t--)Sr(n.owned[t]);n.owned=null}if(n.cleanups){for(t=n.cleanups.length-1;t>=0;t--)n.cleanups[t]();n.cleanups=null}n.state=0}function sn(n){return n instanceof Error?n:new Error(typeof n=="string"?n:"Unknown error",{cause:n})}function Rn(n,t=G){throw sn(n)}function on(n){if(typeof n=="function"&&!n.length)return on(n());if(Array.isArray(n)){const t=[];for(let e=0;e<n.length;e++){const r=on(n[e]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return n}function Ba(n,t){return function(r){let s;return Ie(()=>s=ie(()=>(G.context={...G.context,[n]:r.value},_n(()=>r.children))),void 0),s}}const an=Symbol("fallback");function pr(n){for(let t=0;t<n.length;t++)n[t]()}function Ma(n,t,e={}){let r=[],s=[],i=[],o=0,a=t.length>1?[]:null;return Ae(()=>pr(i)),()=>{let l=n()||[],h=l.length,f,u;return l[Us],ie(()=>{let v,m,x,A,w,y,b,g,T;if(h===0)o!==0&&(pr(i),i=[],r=[],s=[],o=0,a&&(a=[])),e.fallback&&(r=[an],s[0]=Ne(_=>(i[0]=_,e.fallback())),o=1);else if(o===0){for(s=new Array(h),u=0;u<h;u++)r[u]=l[u],s[u]=Ne(p);o=h}else{for(x=new Array(h),A=new Array(h),a&&(w=new Array(h)),y=0,b=Math.min(o,h);y<b&&r[y]===l[y];y++);for(b=o-1,g=h-1;b>=y&&g>=y&&r[b]===l[g];b--,g--)x[g]=s[b],A[g]=i[b],a&&(w[g]=a[b]);for(v=new Map,m=new Array(g+1),u=g;u>=y;u--)T=l[u],f=v.get(T),m[u]=f===void 0?-1:f,v.set(T,u);for(f=y;f<=b;f++)T=r[f],u=v.get(T),u!==void 0&&u!==-1?(x[u]=s[f],A[u]=i[f],a&&(w[u]=a[f]),u=m[u],v.set(T,u)):i[f]();for(u=y;u<h;u++)u in x?(s[u]=x[u],i[u]=A[u],a&&(a[u]=w[u],a[u](u))):s[u]=Ne(p);s=s.slice(0,o=h),r=l.slice(0)}return s});function p(v){if(i[u]=v,a){const[m,x]=H(u);return a[u]=x,t(l[u],m)}return t(l[u])}}}function La(n,t,e={}){let r=[],s=[],i=[],o=[],a=0,l;return Ae(()=>pr(i)),()=>{const h=n()||[],f=h.length;return h[Us],ie(()=>{if(f===0)return a!==0&&(pr(i),i=[],r=[],s=[],a=0,o=[]),e.fallback&&(r=[an],s[0]=Ne(p=>(i[0]=p,e.fallback())),a=1),s;for(r[0]===an&&(i[0](),i=[],r=[],s=[],a=0),l=0;l<f;l++)l<r.length&&r[l]!==h[l]?o[l](()=>h[l]):l>=r.length&&(s[l]=Ne(u));for(;l<r.length;l++)i[l]();return a=o.length=i.length=f,r=h.slice(0),s=s.slice(0,a)});function u(p){i[l]=p;const[v,m]=H(h[l]);return o[l]=m,t(v,l)}}}function Qs(n,t){return ie(()=>n(t||{}))}function Vt(){return!0}const ln={get(n,t,e){return t===cr?e:n.get(t)},has(n,t){return t===cr?!0:n.has(t)},set:Vt,deleteProperty:Vt,getOwnPropertyDescriptor(n,t){return{configurable:!0,enumerable:!0,get(){return n.get(t)},set:Vt,deleteProperty:Vt}},ownKeys(n){return n.keys()}};function Ur(n){return(n=typeof n=="function"?n():n)?n:{}}function Fa(){for(let n=0,t=this.length;n<t;++n){const e=this[n]();if(e!==void 0)return e}}function Cn(...n){let t=!1;for(let o=0;o<n.length;o++){const a=n[o];t=t||!!a&&cr in a,n[o]=typeof a=="function"?(t=!0,j(a)):a}if(t)return new Proxy({get(o){for(let a=n.length-1;a>=0;a--){const l=Ur(n[a])[o];if(l!==void 0)return l}},has(o){for(let a=n.length-1;a>=0;a--)if(o in Ur(n[a]))return!0;return!1},keys(){const o=[];for(let a=0;a<n.length;a++)o.push(...Object.keys(Ur(n[a])));return[...new Set(o)]}},ln);const e={},r=Object.create(null);for(let o=n.length-1;o>=0;o--){const a=n[o];if(!a)continue;const l=Object.getOwnPropertyNames(a);for(let h=l.length-1;h>=0;h--){const f=l[h];if(f==="__proto__"||f==="constructor")continue;const u=Object.getOwnPropertyDescriptor(a,f);if(!r[f])r[f]=u.get?{enumerable:!0,configurable:!0,get:Fa.bind(e[f]=[u.get.bind(a)])}:u.value!==void 0?u:void 0;else{const p=e[f];p&&(u.get?p.push(u.get.bind(a)):u.value!==void 0&&p.push(()=>u.value))}}}const s={},i=Object.keys(r);for(let o=i.length-1;o>=0;o--){const a=i[o],l=r[a];l&&l.get?Object.defineProperty(s,a,l):s[a]=l?l.value:void 0}return s}function Pa(n,...t){if(cr in n){const s=new Set(t.length>1?t.flat():t[0]),i=t.map(o=>new Proxy({get(a){return o.includes(a)?n[a]:void 0},has(a){return o.includes(a)&&a in n},keys(){return o.filter(a=>a in n)}},ln));return i.push(new Proxy({get(o){return s.has(o)?void 0:n[o]},has(o){return s.has(o)?!1:o in n},keys(){return Object.keys(n).filter(o=>!s.has(o))}},ln)),i}const e={},r=t.map(()=>({}));for(const s of Object.getOwnPropertyNames(n)){const i=Object.getOwnPropertyDescriptor(n,s),o=!i.get&&!i.set&&i.enumerable&&i.writable&&i.configurable;let a=!1,l=0;for(const h of t)h.includes(s)&&(a=!0,o?r[l][s]=i.value:Object.defineProperty(r[l],s,i)),++l;a||(o?e[s]=i.value:Object.defineProperty(e,s,i))}return[...r,e]}function be(n){let t,e;const r=s=>{const i=Q.context;if(i){const[a,l]=H();Q.count||(Q.count=0),Q.count++,(e||(e=n())).then(h=>{At(i),Q.count--,l(()=>h.default),At()}),t=a}else if(!t){const[a]=Ws(()=>(e||(e=n())).then(l=>l.default));t=a}let o;return j(()=>(o=t())&&ie(()=>{if(!i)return o(s);const a=Q.context;At(i);const l=o(s);return At(a),l}))};return r.preload=()=>e||((e=n()).then(s=>t=()=>s.default),e),r}const ka=n=>"Stale read from <".concat(n,">.");function En(n){const t="fallback"in n&&{fallback:()=>n.fallback};return j(Ma(()=>n.each,n.children,t||void 0))}function Cd(n){const t="fallback"in n&&{fallback:()=>n.fallback};return j(La(()=>n.each,n.children,t||void 0))}function wr(n){const t=n.keyed,e=j(()=>n.when,void 0,{equals:(r,s)=>t?r===s:!r==!s});return j(()=>{const r=e();if(r){const s=n.children;return typeof s=="function"&&s.length>0?ie(()=>s(t?r:()=>{if(!ie(e))throw ka("Show");return n.when})):s}return n.fallback},void 0,void 0)}const Na=void 0,[_r,Da]=H(void 0);le.setActiveElement=Da;function is(n=""){return ca(n)?n:typeof n=="string"?n.startsWith("#")?+(n.replace("#","0x")+(n.length===7?"ff":"")):n.startsWith("0x")?Number(n):+("0x"+(n.length===6?n+"ff":n)):0}function Ua({createElement:n,createTextNode:t,isTextNode:e,replaceText:r,insertNode:s,removeNode:i,setProperty:o,getParentNode:a,getFirstChild:l,getNextSibling:h}){function f(y,b,g,T){if(g!==void 0&&!T&&(T=[]),typeof b!="function")return u(y,b,T,g);Ie(_=>u(y,b(),_,g),T)}function u(y,b,g,T,_){for(;typeof g=="function";)g=g();if(b===g)return g;const C=typeof b,I=T!==void 0;if(C==="string"||C==="number")if(C==="number"&&(b=b.toString()),I){let R=g[0];R&&e(R)?r(R,b):R=t(b),g=m(y,g,T,R)}else g!==""&&typeof g=="string"?r(l(y),g=b):(m(y,g,T,t(b)),g=b);else if(b==null||C==="boolean")g=m(y,g,T);else{if(C==="function")return Ie(()=>{let R=b();for(;typeof R=="function";)R=R();g=u(y,R,g,T)}),()=>g;if(Array.isArray(b)){const R=[];if(p(R,b,_))return Ie(()=>g=u(y,R,g,T,!0)),()=>g;if(R.length===0){const B=m(y,g,T);if(I)return g=B}else Array.isArray(g)?g.length===0?x(y,R,T):v(y,g,R):g==null||g===""?x(y,R):v(y,I&&g||[l(y)],R);g=R}else{if(Array.isArray(g)){if(I)return g=m(y,g,T,b);m(y,g,null,b)}else g==null||g===""||!l(y)?s(y,b):A(y,b,l(y));g=b}}return g}function p(y,b,g){let T=!1;for(let _=0,C=b.length;_<C;_++){let I=b[_],R;if(!(I==null||I===!0||I===!1))if(Array.isArray(I))T=p(y,I)||T;else if((R=typeof I)=="string"||R==="number")y.push(t(I));else if(R==="function")if(g){for(;typeof I=="function";)I=I();T=p(y,Array.isArray(I)?I:[I])||T}else y.push(I),T=!0;else y.push(I)}return T}function v(y,b,g){let T=g.length,_=b.length,C=T,I=0,R=0,B=h(b[_-1]),S=null;for(;I<_||R<C;){if(b[I]===g[R]){I++,R++;continue}for(;b[_-1]===g[C-1];)_--,C--;if(_===I){const N=C<T?R?h(g[R-1]):g[C-R]:B;for(;R<C;)s(y,g[R++],N)}else if(C===R)for(;I<_;)(!S||!S.has(b[I]))&&i(y,b[I]),I++;else if(b[I]===g[C-1]&&g[R]===b[_-1]){const N=h(b[--_]);s(y,g[R++],h(b[I++])),s(y,g[--C],N),b[_]=g[C]}else{if(!S){S=new Map;let k=R;for(;k<C;)S.set(g[k],k++)}const N=S.get(b[I]);if(N!=null)if(R<N&&N<C){let k=I,P=1,L;for(;++k<_&&k<C&&!((L=S.get(b[k]))==null||L!==N+P);)P++;if(P>N-R){const D=b[I];for(;R<N;)s(y,g[R++],D)}else A(y,g[R++],b[I++])}else I++;else i(y,b[I++])}}}function m(y,b,g,T){if(g===void 0){let C;for(;C=l(y);)i(y,C);return T&&s(y,T),""}const _=T||t("");if(b.length){let C=!1;for(let I=b.length-1;I>=0;I--){const R=b[I];if(_!==R){const B=a(R)===y;!C&&!I?B?A(y,_,R):s(y,_,g):B&&i(y,R)}else C=!0}}else s(y,_,g);return[_]}function x(y,b,g){for(let T=0,_=b.length;T<_;T++)s(y,b[T],g)}function A(y,b,g){s(y,b,g),i(y,g)}function w(y,b,g={},T){return b||(b={}),T||Ie(()=>g.children=u(y,b.children,g.children)),Ie(()=>b.ref&&b.ref(y)),Ie(()=>{for(const _ in b){if(_==="children"||_==="ref")continue;const C=b[_];C!==g[_]&&(o(y,_,C,g[_]),g[_]=C)}}),g}return{render(y,b){let g;return Ne(T=>{g=T,f(b,y())}),g},insert:f,spread(y,b,g){typeof b=="function"?Ie(T=>w(y,b(),T,g)):w(y,b,void 0,g)},createElement:n,createTextNode:t,insertNode:s,setProp(y,b,g,T){return o(y,b,g,T),g},mergeProps:Cn,effect:Ie,memo:j,createComponent:Qs,use(y,b,g){return ie(()=>y(b,g))}}}function Oa(n){const t=Ua(n);return t.mergeProps=Cn,t}const js={createElement(n){return new We(n)},createTextNode(n){return{_type:Oe.Text,text:n,parent:void 0}},replaceText(n,t){Ze("Replace Text: ",n,t),n.text=t;const e=n.parent;F(e),e.text=e.getText()},setProperty(n,t,e=!0){n[t]=e},insertNode(n,t,e){Ze("INSERT: ",n,t,e),n.children.insert(t,e),t._queueDelete=!1,t instanceof We?n.rendered&&t.render():n.isTextNode()&&(n.text=n.getText())},isTextNode(n){return n.isTextNode()},removeNode(n,t){Ze("REMOVE: ",n,t),n.children.remove(t),t._queueDelete=!0,t instanceof We&&queueMicrotask(()=>t.destroy())},getParentNode(n){return n.parent},getFirstChild(n){return n.children[0]},getNextSibling(n){const t=n.parent.children||[],e=t.indexOf(n)+1;if(e<t.length)return t[e]}},qs=Oa(js);let Or;const Tt=js.createElement("App"),za=function(n){return qs.render(n,Tt)};function Wa(n=le.rendererOptions,t){return Or=na(n,"app"),Tt.lng=Or.root,Tt.rendered=!0,{renderer:Or,rootNode:Tt,render:za}}const{effect:Ed,memo:In,createComponent:E,createElement:Rr,createTextNode:Id,insertNode:Bd,insert:Ha,spread:Bn,setProp:Ga,mergeProps:Te,use:Va}=qs,W=n=>{const t=Rr("node");return Bn(t,n,!1),t},Y=n=>{const t=Rr("text");return Bn(t,n,!1),t},os="_$DX_DELEGATE";function $a(n,t=window.document){const e=t[os]||(t[os]=new Set);for(let r=0,s=n.length;r<s;r++){const i=n[r];e.has(i)||(e.add(i),t.addEventListener(i,Xa))}}function Xa(n){const t="$$".concat(n.type);let e=n.composedPath&&n.composedPath()[0]||n.target;for(n.target!==e&&Object.defineProperty(n,"target",{configurable:!0,value:e}),Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return e||document}}),Q.registry&&!Q.done&&(Q.done=_$HY.done=!0);e;){const r=e[t];if(r&&!e.disabled){const s=e["".concat(t,"Data")];if(s!==void 0?r.call(e,s,n):r.call(e,n),n.cancelBubble)return}e=e._$host||e.parentNode||e.host}}const Ya=!1;function Zs(){let n=new Set;function t(s){return n.add(s),()=>n.delete(s)}let e=!1;function r(s,i){if(e)return!(e=!1);const o={to:s,options:i,defaultPrevented:!1,preventDefault:()=>o.defaultPrevented=!0};for(const a of n)a.listener({...o,from:a.location,retry:l=>{l&&(e=!0),a.navigate(s,{...i,resolve:!1})}});return!o.defaultPrevented}return{subscribe:t,confirm:r}}let cn;function Mn(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),cn=window.history.state._depth}Mn();function Ka(n){return{...n,_depth:window.history.state&&window.history.state._depth}}function Qa(n,t){let e=!1;return()=>{const r=cn;Mn();const s=r==null?null:cn-r;if(e){e=!1;return}s&&t(s)?(e=!0,window.history.go(-s)):n()}}const ja=/^(?:[a-z0-9]+:)?\/\//i,qa=/^\/+|(\/)\/+$/g,Js="http://sr";function St(n,t=!1){const e=n.replace(qa,"$1");return e?t||/^[?#]/.test(e)?e:"/"+e:""}function rr(n,t,e){if(ja.test(t))return;const r=St(n),s=e&&St(e);let i="";return!s||t.startsWith("/")?i=r:s.toLowerCase().indexOf(r.toLowerCase())!==0?i=r+s:i=s,(i||"/")+St(t,!i)}function Za(n,t){if(n==null)throw new Error(t);return n}function Ja(n,t){return St(n).replace(/\/*(\*.*)?$/g,"")+St(t)}function ei(n){const t={};return n.searchParams.forEach((e,r)=>{t[r]=e}),t}function ti(n,t,e){const[r,s]=n.split("/*",2),i=r.split("/").filter(Boolean),o=i.length;return a=>{const l=a.split("/").filter(Boolean),h=l.length-o;if(h<0||h>0&&s===void 0&&!t)return null;const f={path:o?"":"/",params:{}},u=p=>e===void 0?void 0:e[p];for(let p=0;p<o;p++){const v=i[p],m=l[p],x=v[0]===":",A=x?v.slice(1):v;if(x&&zr(m,u(A)))f.params[A]=m;else if(x||!zr(m,v))return null;f.path+="/".concat(m)}if(s){const p=h?l.slice(-h).join("/"):"";if(zr(p,u(s)))f.params[s]=p;else return null}return f}}function zr(n,t){const e=r=>r.localeCompare(n,void 0,{sensitivity:"base"})===0;return t===void 0?!0:typeof t=="string"?e(t):typeof t=="function"?t(n):Array.isArray(t)?t.some(e):t instanceof RegExp?t.test(n):!1}function el(n){const[t,e]=n.pattern.split("/*",2),r=t.split("/").filter(Boolean);return r.reduce((s,i)=>s+(i.startsWith(":")?2:3),r.length-(e===void 0?0:1))}function ri(n){const t=new Map,e=$e();return new Proxy({},{get(r,s){return t.has(s)||wn(e,()=>t.set(s,j(()=>n()[s]))),t.get(s)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(n())}})}function Ln(n){let t=/(\/?\:[^\/]+)\?/.exec(n);if(!t)return[n];let e=n.slice(0,t.index),r=n.slice(t.index+t[0].length);const s=[e,e+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(r);)s.push(e+=t[1]),r=r.slice(t[0].length);return Ln(r).reduce((i,o)=>[...i,...s.map(a=>a+o)],[])}const tl=100,ni=Gs(),si=Gs(),Fn=()=>Za(Vs(ni),"<A> and 'use' router primitives can be only used inside a Route."),Pn=()=>Fn().navigatorFactory(),ii=()=>Fn().location,rl=(n,t)=>{const e=ii(),r=j(()=>Ln(n()).map(s=>ti(s,void 0,t)));return j(()=>{for(const s of r()){const i=s(e.pathname);if(i)return i}})},nl=()=>Fn().params;function sl(n,t=""){const{component:e,preload:r,load:s,children:i,info:o}=n,a=!i||Array.isArray(i)&&!i.length,l={key:n,component:e,preload:r||s,info:o};return oi(n.path).reduce((h,f)=>{for(const u of Ln(f)){const p=Ja(t,u);let v=a?p:p.split("/*",1)[0];v=v.split("/").map(m=>m.startsWith(":")||m.startsWith("*")?m:encodeURIComponent(m)).join("/"),h.push({...l,originalPath:f,pattern:v,matcher:ti(v,!a,n.matchFilters)})}return h},[])}function il(n,t=0){return{routes:n,score:el(n[n.length-1])*1e4-t,matcher(e){const r=[];for(let s=n.length-1;s>=0;s--){const i=n[s],o=i.matcher(e);if(!o)return null;r.unshift({...o,route:i})}return r}}}function oi(n){return Array.isArray(n)?n:[n]}function ai(n,t="",e=[],r=[]){const s=oi(n);for(let i=0,o=s.length;i<o;i++){const a=s[i];if(a&&typeof a=="object"){a.hasOwnProperty("path")||(a.path="");const l=sl(a,t);for(const h of l){e.push(h);const f=Array.isArray(a.children)&&a.children.length===0;if(a.children&&!f)ai(a.children,h.pattern,e,r);else{const u=il([...e],r.length);r.push(u)}e.pop()}}}return e.length?r:r.sort((i,o)=>o.score-i.score)}function Wr(n,t){for(let e=0,r=n.length;e<r;e++){const s=n[e].matcher(t);if(s)return s}return[]}function ol(n,t){const e=new URL(Js),r=j(l=>{const h=n();try{return new URL(h,e)}catch(f){return console.error("Invalid path ".concat(h)),l}},e,{equals:(l,h)=>l.href===h.href}),s=j(()=>r().pathname),i=j(()=>r().search,!0),o=j(()=>r().hash),a=()=>"";return{get pathname(){return s()},get search(){return i()},get hash(){return o()},get state(){return t()},get key(){return a()},query:ri(Je(i,()=>ei(r())))}}let je;function al(){return je}function ll(n,t,e,r={}){const{signal:[s,i],utils:o={}}=n,a=o.parsePath||(k=>k),l=o.renderPath||(k=>k),h=o.beforeLeave||Zs(),f=rr("",r.base||"");if(f===void 0)throw new Error("".concat(f," is not a valid base path"));f&&!s().value&&i({value:f,replace:!0,scroll:!1});const[u,p]=H(!1);let v;const m=(k,P)=>{P.value===x()&&P.state===w()||(v===void 0&&p(!0),je=k,v=P,_a(()=>{v===P&&(A(v.value),y(v.state),T[1]([]))}).finally(()=>{v===P&&Sn(()=>{je=void 0,k==="navigate"&&S(v),p(!1),v=void 0})}))},[x,A]=H(s().value),[w,y]=H(s().state),b=ol(x,w),g=[],T=H([]),_=j(()=>typeof r.transformUrl=="function"?Wr(t(),r.transformUrl(b.pathname)):Wr(t(),b.pathname)),C=ri(()=>{const k=_(),P={};for(let L=0;L<k.length;L++)Object.assign(P,k[L].params);return P}),I={pattern:f,path:()=>f,outlet:()=>null,resolvePath(k){return rr(f,k)}};return Ie(Je(s,k=>m("native",k),{defer:!0})),{base:I,location:b,params:C,isRouting:u,renderPath:l,parsePath:a,navigatorFactory:B,matches:_,beforeLeave:h,preloadRoute:N,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:T};function R(k,P,L){ie(()=>{if(typeof P=="number"){P&&(o.go?o.go(P):console.warn("Router integration does not support relative routing"));return}const{replace:D,resolve:U,scroll:V,state:K}={replace:!1,resolve:!0,scroll:!0,...L},z=U?k.resolvePath(P):rr("",P);if(z===void 0)throw new Error("Path '".concat(P,"' is not a routable path"));if(g.length>=tl)throw new Error("Too many redirects");const te=x();(z!==te||K!==w())&&(Ya||h.confirm(z,L)&&(g.push({value:te,replace:D,scroll:V,state:w()}),m("navigate",{value:z,state:K})))})}function B(k){return k=k||Vs(si)||I,(P,L)=>R(k,P,L)}function S(k){const P=g[0];P&&(i({...k,replace:P.replace,scroll:P.scroll}),g.length=0)}function N(k,P={}){const L=Wr(t(),k.pathname),D=je;je="preload";for(let U in L){const{route:V,params:K}=L[U];V.component&&V.component.preload&&V.component.preload();const{preload:z}=V;P.preloadData&&z&&wn(e(),()=>z({params:K,location:{pathname:k.pathname,search:k.search,hash:k.hash,query:ei(k),state:null,key:""},intent:"preload"}))}je=D}}function cl(n,t,e,r){const{base:s,location:i,params:o}=n,{pattern:a,component:l,preload:h}=r().route,f=j(()=>r().path);l&&l.preload&&l.preload();const u=h?h({params:o,location:i,intent:je||"initial"}):void 0;return{parent:t,pattern:a,path:f,outlet:()=>l?Qs(l,{params:o,location:i,data:u,get children(){return e()}}):e(),resolvePath(v){return rr(s.path(),v,f())}}}const hl=n=>t=>{const{base:e}=t,r=_n(()=>t.children),s=j(()=>ai(r(),t.base||""));let i;const o=ll(n,s,()=>i,{base:e,singleFlight:t.singleFlight,transformUrl:t.transformUrl});return n.create&&n.create(o),E(ni.Provider,{value:o,get children(){return E(dl,{routerState:o,get root(){return t.root},get preload(){return t.rootPreload||t.rootLoad},get children(){return[In(()=>(i=$e())&&null),E(ul,{routerState:o,get branches(){return s()}})]}})}})};function dl(n){const t=n.routerState.location,e=n.routerState.params,r=j(()=>n.preload&&ie(()=>{n.preload({params:e,location:t,intent:al()||"initial"})}));return E(wr,{get when(){return n.root},keyed:!0,get fallback(){return n.children},children:s=>E(s,{params:e,location:t,get data(){return r()},get children(){return n.children}})})}function ul(n){const t=[];let e;const r=j(Je(n.routerState.matches,(s,i,o)=>{let a=i&&s.length===i.length;const l=[];for(let h=0,f=s.length;h<f;h++){const u=i&&i[h],p=s[h];o&&u&&p.route.key===u.route.key?l[h]=o[h]:(a=!1,t[h]&&t[h](),Ne(v=>{t[h]=v,l[h]=cl(n.routerState,l[h-1]||n.routerState.base,as(()=>r()[h+1]),()=>n.routerState.matches()[h])}))}return t.splice(s.length).forEach(h=>h()),o&&a?o:(e=l[0],l)}));return as(()=>r()&&e)()}const as=n=>()=>E(wr,{get when(){return n()},keyed:!0,children:t=>E(si.Provider,{value:t,get children(){return t.outlet()}})}),ae=n=>{const t=_n(()=>n.children);return Cn(n,{get children(){return t()}})};function fl([n,t],e,r){return[n,r?s=>t(r(s)):t]}function pl(n){if(n==="#")return null;try{return document.querySelector(n)}catch(t){return null}}function gl(n){let t=!1;const e=s=>typeof s=="string"?{value:s}:s,r=fl(H(e(n.get()),{equals:(s,i)=>s.value===i.value&&s.state===i.state}),void 0,s=>(!t&&n.set(s),s));return n.init&&Ae(n.init((s=n.get())=>{t=!0,r[1](e(s)),t=!1})),hl({signal:r,create:n.create,utils:n.utils})}function ml(n,t,e){return n.addEventListener(t,e),()=>n.removeEventListener(t,e)}function xl(n,t){const e=pl("#".concat(n));e?e.scrollIntoView():t&&window.scrollTo(0,0)}const yl=new Map;function vl(n=!0,t=!1,e="/_server",r){return s=>{const i=s.base.path(),o=s.navigatorFactory(s.base);let a={};function l(x){return x.namespaceURI==="http://www.w3.org/2000/svg"}function h(x){if(x.defaultPrevented||x.button!==0||x.metaKey||x.altKey||x.ctrlKey||x.shiftKey)return;const A=x.composedPath().find(_=>_ instanceof Node&&_.nodeName.toUpperCase()==="A");if(!A||t&&!A.hasAttribute("link"))return;const w=l(A),y=w?A.href.baseVal:A.href;if((w?A.target.baseVal:A.target)||!y&&!A.hasAttribute("state"))return;const g=(A.getAttribute("rel")||"").split(/\s+/);if(A.hasAttribute("download")||g&&g.includes("external"))return;const T=w?new URL(y,document.baseURI):new URL(y);if(!(T.origin!==window.location.origin||i&&T.pathname&&!T.pathname.toLowerCase().startsWith(i.toLowerCase())))return[A,T]}function f(x){const A=h(x);if(!A)return;const[w,y]=A,b=s.parsePath(y.pathname+y.search+y.hash),g=w.getAttribute("state");x.preventDefault(),o(b,{resolve:!1,replace:w.hasAttribute("replace"),scroll:!w.hasAttribute("noscroll"),state:g&&JSON.parse(g)})}function u(x){const A=h(x);if(!A)return;const[w,y]=A;a[y.pathname]||s.preloadRoute(y,{preloadData:w.getAttribute("preload")!=="false"})}function p(x){const A=h(x);if(!A)return;const[w,y]=A;a[y.pathname]||(a[y.pathname]=setTimeout(()=>{s.preloadRoute(y,{preloadData:w.getAttribute("preload")!=="false"}),delete a[y.pathname]},200))}function v(x){const A=h(x);if(!A)return;const[,w]=A;a[w.pathname]&&(clearTimeout(a[w.pathname]),delete a[w.pathname])}function m(x){if(x.defaultPrevented)return;let A=x.submitter&&x.submitter.hasAttribute("formaction")?x.submitter.getAttribute("formaction"):x.target.getAttribute("action");if(!A)return;if(!A.startsWith("https://action/")){const y=new URL(A,Js);if(A=s.parsePath(y.pathname+y.search),!A.startsWith(e))return}if(x.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const w=yl.get(A);if(w){x.preventDefault();const y=new FormData(x.target,x.submitter);w.call({r:s,f:x.target},x.target.enctype==="multipart/form-data"?y:new URLSearchParams(y))}}$a(["click","submit"]),document.addEventListener("click",f),n&&(document.addEventListener("mouseover",p),document.addEventListener("mouseout",v),document.addEventListener("focusin",u),document.addEventListener("touchstart",u)),document.addEventListener("submit",m),Ae(()=>{document.removeEventListener("click",f),n&&(document.removeEventListener("mouseover",p),document.removeEventListener("mouseout",v),document.removeEventListener("focusin",u),document.removeEventListener("touchstart",u)),document.removeEventListener("submit",m)})}}function bl(n){const t=n.replace(/^.*?#/,"");if(!t.startsWith("/")){const[,e="/"]=window.location.hash.split("#",2);return"".concat(e,"#").concat(t)}return t}function Al(n){const t=()=>window.location.hash.slice(1),e=Zs();return gl({get:t,set({value:r,replace:s,scroll:i,state:o}){s?window.history.replaceState(Ka(o),"","#"+r):window.history.pushState(o,"","#"+r);const a=r.indexOf("#"),l=a>=0?r.slice(a+1):"";xl(l,i),Mn()},init:r=>ml(window,"hashchange",Qa(r,s=>!e.confirm(s&&s<0?s:t()))),create:vl(n.preload,n.explicitLinks,n.actionBase),utils:{go:r=>window.history.go(r),renderPath:r=>"#".concat(r),parsePath:bl,beforeLeave:e}})(n)}const[li,Tl]=H([]),Sl=(n,t)=>{const e=$e(),r=wn.bind(void 0,e),{cleanup:s,focusPath:i}=va({userKeyMap:n,keyHoldOptions:t,ownerContext:r});Ve(Je(_r,()=>{Tl([...i()])},{defer:!0})),Ae(s)};function wl(n=[]){const t=[];let e;for(e=0;e<n.length;e++){const r=n[e];if(typeof r=="string"&&!r.includes("PAUSE-"))t.push(n[e]);else break}return[t.join(",\b ")].concat(n.slice(e))}function ls(n){return new Promise(t=>{setTimeout(t,n)})}function _l(n,t,e="en-US"){const r=window.speechSynthesis;return new Promise((s,i)=>{const o=new SpeechSynthesisUtterance(n);o.lang=e,o.onend=()=>{s()},o.onerror=a=>{i(a)},t.push(o),r.speak(o)})}function hn(n,t,e=!0){const r=window.speechSynthesis,s=wl(Array.isArray(n)?n:[n]),i=[],o=[];let a=!0;return{series:(async()=>{try{for(;a&&s.length;){const h=await Promise.resolve(s.shift());if(a){if(typeof h=="string"&&h.includes("PAUSE-")){let f=Number(h.split("PAUSE-")[1])*1e3;isNaN(f)&&(f=0),await ls(f)}else if(typeof h=="string"&&h.length){let u=3;for(;a&&u>0;)try{await _l(h,o,t),u=0}catch(p){if(p instanceof SpeechSynthesisErrorEvent)if(p.error==="network")u--,console.warn("Speech synthesis network error. Retries left: ".concat(u)),await ls(500*(3-u));else if(p.error==="canceled"||p.error==="interrupted")u=0;else throw new Error("SpeechSynthesisErrorEvent: ".concat(p.error));else throw p}}else if(typeof h=="function"){const f=hn(h(),t,!1);i.push(f),await f.series}else if(Array.isArray(h)){const f=hn(h,t,!1);i.push(f),await f.series}}else break}}finally{a=!1}})(),get active(){return a},append:h=>{s.push(h)},cancel:()=>{a&&(e&&r.cancel(),i.forEach(h=>{h.cancel()}),a=!1)}}}let $t;function Rl(n,t="en-US"){return $t&&$t.cancel(),$t=hn(n,t),$t}var dn=(n,t)=>{let e;const r=()=>clearTimeout(e);return $e()&&Ae(r),Object.assign((...i)=>{e!==void 0&&r(),e=setTimeout(()=>n(...i),t)},{clear:r})},ci=(n,t)=>{let e=!1,r,s;const i=(...a)=>{s=a,!e&&(e=!0,r=setTimeout(()=>{n(...s),e=!1},t))},o=()=>{clearTimeout(r),e=!1};return $e()&&Ae(o),Object.assign(i,{clear:o})};function Cl(n){let t=0,e=!1;const[r,s]=H(void 0,{equals:!1}),i=n(()=>{e=!0,s()});return()=>(e||(i(),r()),e?(e=!!t,!0):(Hs()&&(t++,Ae(()=>t--)),!1))}let un,wt=[],Ee,fn=!1;const El=3e5;function cs(n,t){const e=dn(n,t);let r;const s=i=>{r=i,e(i)};return s.flush=()=>{e.clear(),n(r)},s.clear=e.clear,s}function mt(n){return n.id||n.name}function Il(n=[]){if(!ne.onFocusChange||!ne.enabled)return;const t=n.every(i=>!i.loading),e=n.filter(i=>!wt.includes(i));if(un(),!t&&ne.onFocusChange){ne.onFocusChange([]);return}wt=n.slice(0);const r=[],s=e.reduce((i,o)=>(o.announce?(i.push([mt(o),"Announce",o.announce]),r.push(o.announce)):o.title?(i.push([mt(o),"Title",o.title]),r.push(o.title)):i.push([mt(o),"No Announce",""]),i),[]);if(e.reverse().reduce((i,o)=>(o.announceContext?(i.push([mt(o),"Context",o.announceContext]),r.push(o.announceContext)):i.push([mt(o),"No Context",""]),i),s),ne.debug&&console.table(s),r.length)return ne.speak(r.reduce((i,o)=>i.concat(o),[]))}function Bl(n){if(!fn)return Ee=Rl(n)}const ne={debug:!1,enabled:!0,cancel:function(){Ee&&Ee.cancel()},clearPrevFocus:function(n=0){wt=wt.slice(0,n),un()},speak:function(n,{append:t=!1,notification:e=!1}={}){return ne.onFocusChange&&ne.enabled&&(ne.onFocusChange.flush(),t&&Ee&&Ee.active?Ee.append(n):(ne.cancel(),Bl(n)),e&&(fn=!0,Ee==null||Ee.series.finally(()=>{fn=!1,ne.refresh()}).catch(console.error))),Ee},refresh:function(n=0){ne.clearPrevFocus(n),ne.onFocusChange&&ne.onFocusChange(ie(()=>li()))},setupTimers:function({focusDebounce:n=400,focusChangeTimeout:t=El}={}){ne.onFocusChange=cs(Il,n),un=cs(()=>{wt=[]},t)}},Ml=()=>(ne.setupTimers(),Ve(Je(li,ne.onFocusChange,{defer:!0})),ne);var Ll=!!Na;function Fl(n){return n!==null&&(typeof n=="object"||typeof n=="function")}function hs(n,...t){return typeof n=="function"?n(...t):n}var Pl=Ll?n=>$e()?Ae(n):n:Ae,kl=()=>{let n=[];const t=()=>n=[];return{push:(...e)=>n.push(...e),execute(e,r,s,i){n.forEach(o=>o(e,r,s,i)),t()},clear:t}};function pn(n,t,e,r){return n.addEventListener(t,e,r),Pl(n.removeEventListener.bind(n,t,e,r))}function hi(n,t){const{push:e,execute:r}=kl();return[(s,i,o)=>{const a=pn(n,s,i,o!=null?o:t);return e(a),a},Ae(r)]}function Nl(n,t=$e()){let e=0,r,s;return()=>(e++,Ae(()=>{e--,queueMicrotask(()=>{!e&&s&&(s(),s=r=void 0)})}),s||Ne(i=>r=n(s=i),t),r)}function Dl(n){const t=$e(),e=Nl(n,t);return()=>Q.context?Ne(n,t):e()}function Ul(n){const t={...n},e={...n},r={},s=o=>{let a=r[o];if(!a){if(!Hs())return t[o];r[o]=a=H(t[o],{internal:!0}),delete t[o]}return a[0]()};for(const o in n)Object.defineProperty(e,o,{get:()=>s(o),enumerable:!0});const i=(o,a)=>{const l=r[o];if(l)return l[1](a);o in t&&(t[o]=hs(a,[t[o]]))};return[e,(o,a)=>{if(Fl(o)){const l=ie(()=>Object.entries(hs(o,e)));Sn(()=>{for(const[h,f]of l)i(h,()=>f)})}else i(o,a);return e}]}var di={passive:!0},Ol={x:0,y:0,isInside:!1,sourceType:null};function zl(n=window,t,e={}){const{touch:r=!0,followTouch:s=!0}=e,[i,o]=hi(n,di),a=l=>t({x:l.pageX,y:l.pageY,sourceType:"mouse"});if(i("mousemove",a),i("dragover",a),r){const l=h=>{h.touches.length&&t({x:h.touches[0].clientX,y:h.touches[0].clientY,sourceType:"touch"})};i("touchstart",l),s&&i("touchmove",l)}return o}function Wl(n=window,t,e={}){const{touch:r=!0}=e,[s,i]=hi(n,di);let o=!1,a=!r;function l(h){this==="mouse"?o=h:a=h,t(o||a)}return s("mouseover",l.bind("mouse",!0)),s("mouseout",l.bind("mouse",!1)),s("mousemove",l.bind("mouse",!0),{passive:!0,once:!0}),r&&(s("touchstart",l.bind("touch",!0)),s("touchend",l.bind("touch",!1))),i}function Hl(n,t={}){const e={...Ol,...t.initialValue},[r,s]=Ul(e),i=o=>{zl(o,s,t),Wl(o,s.bind(void 0,"isInside"),t)};return typeof n!="function"?i(n):Ve(()=>i(n())),r}var Gl=Dl(Hl.bind(void 0,void 0,void 0));function gr(n,t,e="keydown"){return new KeyboardEvent(e,{key:n,keyCode:t,which:t,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0})}const Vl=ci(n=>{const t=n.deltaY;t<0?document.body.dispatchEvent(gr("ArrowUp",38)):t>0&&document.body.dispatchEvent(gr("ArrowDown",40))},250),$l=n=>{var r;const t=_r(),e=((r=le.rendererOptions)==null?void 0:r.deviceLogicalPixelRatio)||1;t&&ui(n.clientX,n.clientY,t.lng.absX*e,t.lng.absY*e,t.width*e,t.height*e)&&(document.dispatchEvent(gr("Enter",13)),setTimeout(()=>document.body.dispatchEvent(gr("Enter",13,"keyup")),1))};function ui(n,t,e,r,s=0,i=0){return n>=e&&n<=e+s&&t>=r&&t<=r+i}function Xl(n,t,e){var o;const r=[],s=((o=le.rendererOptions)==null?void 0:o.deviceLogicalPixelRatio)||1;let i=[n];for(;i.length>0;){const a=[];for(const f of i)f.alpha!==0&&ui(t,e,f.lng.absX*s,f.lng.absY*s,f.width*s,f.height*s)&&a.push(f);const l=a.length;if(l===0)break;l>1&&a.sort((f,u)=>(u.zIndex||0)-(f.zIndex||0));const h=a[0];r.push(h),h.isTextNode()?i=[]:i=h.children}return r}function Yl(n=Tt,t=100){const e=Gl(),r=Cl(s=>ci(s,t));pn(window,"wheel",Vl),pn(window,"click",$l),Ve(()=>{var s;if(r()){const i=Xl(n,e.x,e.y).filter(o=>(o.focus||o.onFocus||o.onEnter)&&!o.skipFocus);if(i.length){let o=i[i.length-1];for(;(s=o.parent)!=null&&s.forwardStates;)o=o.parent;const a=o.parent;(a==null?void 0:a.selected)!==void 0&&(a.selected=a.children.indexOf(o)),o.setFocus()}}})}const[Kl,Ql]=H(""),d={name:"Base Lightning TV",alpha:{primary:1,secondary:.7,tertiary:.1,inactive:.5,full:1,none:0,alpha1:.1,alpha2:.3,alpha3:.5,alpha4:.7,alpha5:.9,alpha6:.95},animation:{duration:{none:0,xfast:100,fast:250,normal:500,slow:750,xslow:900},delay:{none:0,xfast:10,fast:25,normal:50,slow:75,xslow:90},expressive:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},expressiveEntrance:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},expressiveExit:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},standard:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},standardEntrance:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},standardExit:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},utility:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},utilityEntrance:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},utilityExit:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25}},asset:{arrowLeft:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADiNXWtAAAAi0lEQVRIDWNgGAWjIfD//38JID5Fk5AAGqwKxPeA+D/VLQCaaQLEr0CGgwBVLQCa5wbEn0EGwwDVLAAaGA3Ev2AGw2iqWAA0rBiI/8EMRaYptgBoWDeygehsci1gIlcjWfqArqZdEMFcBLSEdpGMZAntkimSJbTLaEiW0K6oQLKEdoUdzJJRemiHAAD4n+yzPWCs7QAAAABJRU5ErkJggg==",arrowRight:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADiNXWtAAAAg0lEQVRIDWNgGAWjIYArBP7//38KiCVwyVMsDjQcBO4BsSrFhmEzAGw8hHgFpEywqaFIDMkCEPMzELtRZCC6ZjQLQNxfQByNro5sPhYLQEL/gLiYbEORNeKwACbcDVPLBGMMOhrmVDSapkFE00imaTKlaUajaVFB28Ju0CXrUQfhDAEAEgHss6NhpLQAAAAASUVORK5CYII=",backspaceOutline:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAAAAXNSR0IArs4c6QAACmpJREFUeF7tnVmoZUcVhv/feY4gBEVEH/KgCCZxCK2itNo4xQQH+kUN0TjEiDGKKBqnaExwBjUaR6KY+NQgiQkOMSYhYEScIopGJOqDE2hHjfP0y4p1Oqdv33v2qr32Prv2Paug6Ye7Vu2qv75TtWvtGohMqUBAAQZ80zUVQAKUEIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypfPsAJJ0NYC92XRHKPB3AAfLv18BuBLAFSR/NKZWswJI0vkA3jCmILsw75sAvIfkR8eo22wAknQSgMvGEGFD8vwxgFeQvGrI+s4CIEnHAPgugHsMWfkNzevDAM4i+Z8h6t88QJLuXOB5yBAVzjxuVeBaAM8ieXNUjzkAdAmA50Yrmv5HKPATACeQ/GNEm6YBkvRyANblZhpHAXsfekpkOGsWIEmPAHA9gDuOo13mWhS4gOSZfdVoEiBJ9wFwA4D7961Y+lUpsK/v7KxVgL4K4ElOCS4l+Uyn7a41k3Q0gMcC2ANgH4CHV1T2OyStx69OzQEk6TwAZztr8lMAx5P8s9N+Y8wk2cTjfQDu66z080h+zml7yKwpgCSdCOByZyX+BuBRJH/otN84M0kWN/s0gOc4Kv8Nko922B1m0gxAkh4I4AcVwcL9JA/UVnjT7CXdHYD9yEzfVUkAjib5uxqNmgCoBAu/CeBhzsJ/kORZTtuNN5Nk70bXAZ0Hy59G8qIawVoB6LMAnu8suE3tH0/y3077NAMg6esAuoaoC0la7M2dJgdI0ssAXOgs8W8BHEvS/s9UoYCkdwN4bYfL5STto7U7TQpQZbDQehzreawHylSpgKSTAVza4XYDyeNqsp4MoB7BwteQfH9N5dL2NgWK3l0vyAdJWhDXnSYBSNLtANh3GO/KwgMk97trlYbbKiDJPpzea5U8JKuYqDIeql0kvQPAG5352ZLMR5L8q9M+zXZQYFcAJOnJAL7sbGWLMFuk2SLOmYIKzB6gEiz8HoB7O7U4meQXnLZp1qGApD8BuOcsh7AewcL3kuyadg4OjSSbhRxH0j4BjJok2Ufga0j+YdQHlcznDlBNsPAa+xpP8r/rEHbxjAKPbRuyHvKFY0Ik6QUALOprPfIT1gHRbAGSdDoA77aSX5Zg4e8nhGfx6FEgWoJn8Zy1QCTplq5vjc3NwnoEC/eQ/HYD8IwC0TbwrA2i2QHUI1h4JskLGoJnUIhWwLMWiGYFkCSLMX2t5WDhlneeLm5Dw5kDntEhkmRhEVvesWNqZgiTdC6AN3W1Svn72oOFkuxF+WcVIQUrai+IKuA5BBHJ453auc1mA1AJFn7Jsf7EKj9ZsLBHw1ZDtI5neAmaBUBzCxaO2cBj5u2FZtlO0l8A3K3ZIaxHsPB8kt5vYn00c/mM0dBj5OmqzAqjOQDUfLBwJ32HbPAh84pCM5seSNJLAHzcWeFJgoVdZRui4YfIo6ucff8uyVY03LW5IawyWPgvW5u77mChV/QIABFfb/kidk0CVKbDth3Huw35dJLeniqiV2/fniDYx1f7vlWTeoUFah6wZQhrqwcqwUKbrtsaH0+6mOQpHsOpbXpCVFPstcJjBZNkmzHv0swQJultAN7iVO375TyafzjtJzcbEaK1w9McQJXBQlvvYmtsfjE5FZUFGAGiSeBpCqDKYKFtmX0qya9Utl0z5gNCNBk8BSA7CtiODNwxjf4trEew8BySNtTNOg0A0aTwtARQTbDQeh3rfawXmn0KQDQ5PC0B9EkAL3LSkAD9X6hWALIJzJ3mNoSdS9I7U3NyuX6zQO+zKOzkEEmaHqDSFdpZM97tOfkSfRvvk0LUDEAFIgseetf85DS+AYgk/bPr1NvRZ2HLg4ektwI4xzmgZCBxYohaBMjWPeenDOcvaIvZ2oez5gAqQ5mtLbb3oa4z+Bb6nTHW1UP92vFIr54vzJ8BcGplGdYKkSRbCXGHSWdh2z1ckp1taGccroxyFt9cznG4iGuDqFmASk9kZxxakNGTckHZBBA1DVCB6BMAXuwhyA4VmGL/+05l6zlsbdt7DJmXU0uXmSQ7JvD2zQ1hiwJJsotRvlVxXO87SU5+heUYDT5Gni5KVhg1D1DphWqCjOYy6RlAYzb0mHn3gWkWABWIaoKMubHwSBpGebGWZNdc2vmUO6a1BhJXFUSSff/yLuOYamvzzwEcVfFr7tWwPXqi6uN2PXWYG0C1Qca1n8RaDlewl3kPRL3gWXo/XBwo1dXWdk/a3jEOnJoVQGUoqw0yvpLkh7oUHvLvTohC8FRANBo8pT3sxLeVJ/M2M4QtiVYTZJzkNPoOiAaBxwHRqPDMFqBS8Jog4yT3YewA0aDwrIBodHhmDVApvG0mtO3PnjTJjTxbIBoFnm0gWgs8pQ06lxY3N4QtCWZBRgPDezdnHvPr+alV2EiaL0DlF2Dbn20bdB40XtHwQ5nOHqAC0SyCjEM1Wkv57AqACkRvBvB2p7hrDzI6yzU7s90EUPNBxtnR4SjwrgGo9EK1Qca8cM4ByU4mkuz++F93ZHELyZX3iW31n+S+sKWZWfNBxkCbNeUq6ekArugo1I0kH1xT8EkBKj1R80HGGkFbtZVkZ3bb2d2r0tUkn1hTh8kBKhB9DMBLnQWfJMjoLFuTZpJsO/ONAB7UUcBLSHqvX781q1YAqg0yfoDkq5psrQYLJeldAF7nKFr1x+wmACq9kAUZLazvvTV4P8kDDlE22kTSQ4uuK9dCF5HuR/I3NYI1A1CBaB+AK50VsAMj7TJeixNl2kYBSccCsB/ZMQ6Brif5GIfdYSZNAVQg8rzsLSphl/Hapby2LDZTUaBcq/56ALb1fOVxLkuinULy4loRmwOoQGQX7T7DWZnPk3y203bXmkl6AIA91isDOBGADV3e1HsJbasA1QYZvUKl3fYKPI2knXFQnZoEqPRCNUHG6oqnwyEFLiJ5Wl89mgWoQFQTZOyrwSb7WUztcSRtu0+v1DRABaKPADijV+3SaZUCNgE5geTNEZnmAFBtkDGix6b4Xld2BNvJcaHUPEClF6oNMoZE2eXOtm3q1ZFha1mfWQBUINoL4Kqurbm7vPEj1bOAqx3udW0kk62+swGoQHQ2gPOGFGAD8roJgF0t+qkx6jorgApElwE4aQwxZp6n3YNxsPyzA7yst/4iSdvEMFqaHUCjKZEZ91IgAeolWzotFEiAkoWQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnT+H0jPT81J3xWWAAAAAElFTkSuQmCC",check:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAOCAYAAAAi2ky3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACtSURBVHgBvdPdDcIgEAfwoy8Nb45QN3AGF2s36Ahu4gpuIDoBfSgfpdoTlCbEWEMh6T8hFzjyg5AAkBHOcQe5UWqspRx435sDpMYj6IYQwwVSEiJ2MKVUBWuzLSLl2HL+uxmNCGFO8yaL7RHxve6qRZoAuS4hxac8735elWVx7jrtMKL1o0Gcat9jhExHSukN/kUIFZ7MpDRtzE1isDRkAUtDvrA8ZI597FUf8gWH9P0b4gko9wAAAABJRU5ErkJggg=="},color:{palette:{},white:"0xffffffff",black:"0x000000ff",grey:"0x929096ff",red:"0xe74c3cff",orange:"0xdc7633ff",yellow:"0xf7dc6fff",green:"0x2ecc71ff",blue:"0x93a9fdff",purple:"0x663399ff",overlay:"0x181819b3",material:"0x181819ff",materialNeutral:"0x181819ff",materialNeutralElevated:"0x373639ff",materialInverse:"0xf8f7faff",materialInverseElevated:"0xffffffff",materialBrand:"0x000033ff",materialBrandElevated:"0x242a65ff",textNeutral:"0xf8f7faff",textNeutralSecondary:"0xf8f7fab3",textNeutralTertiary:"0xf8f7fa1a",textNeutralDisabled:"0xf8f7fa80",textInverse:"0x181819ff",textInverseSecondary:"0x181819b3",textInverseTertiary:"0x1818191a",textInverseDisabled:"0x18181980",textBrand:"0x93a9fdff",textBrandSecondary:"0x93a9fdb3",textBrandTertiary:"0x93a9fd1a",textBrandDisabled:"0x93a9fd80",textPositive:"0x2ecc71ff",textNegative:"0xe74c3cff",textInfo:"0x93a9fdff",textCaution:"0xdc7633ff",fillTransparent:"0xffffff0",fillNeutral:"0xf8f7faff",fillNeutralSecondary:"0xf8f7fab3",fillNeutralTertiary:"0xf8f7fa1a",fillNeutralDisabled:"0xf8f7fa80",fillInverse:"0x181819ff",fillInverseSecondary:"0x181819b3",fillInverseTertiary:"0x1818191a",fillInverseDisabled:"0x18181980",fillBrand:"0x93a9fdff",fillBrandSecondary:"0x93a9fdb3",fillBrandTertiary:"0x93a9fd1a",fillBrandDisabled:"0x93a9fd80",fillPositive:"0x2ecc71ff",fillNegative:"0xe74c3cff",fillInfo:"0x93a9fdff",fillCaution:"0xdc7633ff",strokeNeutral:"0xf8f7faff",strokeNeutralSecondary:"0xf8f7fab3",strokeNeutralTertiary:"0xf8f7fa1a",strokeNeutralDisabled:"0xf8f7fa80",strokeInverse:"0x181819ff",strokeInverseSecondary:"0x181819b3",strokeInverseTertiary:"0x1818191a",strokeInverseDisabled:"0x18181980",strokeBrand:"0x93a9fdff",strokeBrandSecondary:"0x93a9fdb3",strokeBrandTertiary:"0x93a9fd1a",strokeBrandDisabled:"0x93a9fd80",strokePositive:"0x2ecc71ff",strokeNegative:"0xe74c3cff",strokeInfo:"0x93a9fdff",strokeCaution:"0xdc7633ff",interactiveNeutral:"0xffffff1a",interactiveNeutralFocus:"0xffffffff",interactiveNeutralFocusSoft:"0xffffff1a",interactiveInverse:"0x48474b1a",interactiveInverseFocus:"0x48474bff",interactiveInverseFocusSoft:"0x48474b1a",interactiveBrand:"0xbecffe1a",interactiveBrandFocus:"0xbecffeff",interactiveBrandFocusSoft:"0xbecffe1a",shadowNeutral:"0x000000b3",shadowNeutralFocus:"0x000000b3",shadowNeutralFocusSoft:"0x000000b3",shadowNeutralText:"0x000000ff",shadowInverse:"0x000000b3",shadowInverseFocus:"0x000000b3",shadowInverseFocusSoft:"0x000000b3",shadowInverseText:"0x000000ff",shadowBrand:"0x000000b3",shadowBrandFocus:"0x000000b3",shadowBrandFocusSoft:"0x000000b3",shadowBrandText:"0x000000ff"},font:[],layout:{columnCount:10,focusScale:1.2,gutterX:20,gutterY:20,marginX:150,marginY:150,safe:50,screenW:1920,screenH:1080},radius:{none:0,xs:2,sm:4,md:8,lg:16,xl:24},spacer:{none:0,xxs:2,xs:4,sm:8,md:10,lg:20,xl:30,xxl:40,xxxl:50},stroke:{none:0,sm:2,md:4,lg:6,xl:8},typography:{display1:{fontFamily:"Arial",fontSize:75,lineHeight:85,fontWeight:500,verticalAlign:"middle",textBaseline:"bottom"},display2:{fontFamily:"Arial",fontSize:50,lineHeight:60,fontWeight:500,verticalAlign:"middle",textBaseline:"bottom"},display3:{fontFamily:"Arial",fontSize:56,fontWeight:400,lineHeight:68,verticalAlign:"middle",textBaseline:"bottom"},display4:{fontFamily:"Arial",fontSize:48,fontWeight:400,lineHeight:64,verticalAlign:"middle",textBaseline:"bottom"},headline1:{fontFamily:"Arial",fontSize:35,fontWeight:500,lineHeight:48,verticalAlign:"middle",textBaseline:"bottom"},headline2:{fontFamily:"Arial",fontSize:30,fontWeight:500,lineHeight:40,verticalAlign:"middle",textBaseline:"bottom"},headline3:{fontFamily:"Arial",fontSize:25,fontWeight:500,lineHeight:36,verticalAlign:"middle",textBaseline:"bottom"},body1:{fontFamily:"Arial",fontSize:25,fontWeight:300,lineHeight:40,verticalAlign:"middle",textBaseline:"bottom"},body2:{fontFamily:"Arial",fontSize:22,fontWeight:300,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},body3:{fontFamily:"Arial",fontSize:20,fontWeight:300,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},button1:{fontFamily:"Arial",fontSize:25,fontWeight:500,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},button2:{fontFamily:"Arial",fontSize:20,fontWeight:500,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},callout1:{fontFamily:"Arial",fontSize:20,fontWeight:500,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},caption1:{fontFamily:"Arial",fontSize:15,fontWeight:500,lineHeight:24,verticalAlign:"middle",textBaseline:"bottom"},tag1:{fontFamily:"Arial",fontSize:20,fontWeight:500,lineHeight:24,verticalAlign:"middle",textBaseline:"bottom"},footnote1:{fontFamily:"Arial",fontSize:22,fontWeight:300,lineHeight:30,verticalAlign:"middle",textBaseline:"bottom"},subtitle1:{fontFamily:"Arial",fontSize:32,fontWeight:400,lineHeight:36,verticalAlign:"middle",textBaseline:"bottom"},subtitle2:{fontFamily:"Arial",fontSize:28,fontWeight:500,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},navigation:{fontFamily:"Arial",fontSize:28,fontWeight:400,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"}},componentConfig:{Keyboard:{base:{keyProps:{delete:{title:null,icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAAAAXNSR0IArs4c6QAACmpJREFUeF7tnVmoZUcVhv/feY4gBEVEH/KgCCZxCK2itNo4xQQH+kUN0TjEiDGKKBqnaExwBjUaR6KY+NQgiQkOMSYhYEScIopGJOqDE2hHjfP0y4p1Oqdv33v2qr32Prv2Paug6Ye7Vu2qv75TtWvtGohMqUBAAQZ80zUVQAKUEIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypfPsAJJ0NYC92XRHKPB3AAfLv18BuBLAFSR/NKZWswJI0vkA3jCmILsw75sAvIfkR8eo22wAknQSgMvGEGFD8vwxgFeQvGrI+s4CIEnHAPgugHsMWfkNzevDAM4i+Z8h6t88QJLuXOB5yBAVzjxuVeBaAM8ieXNUjzkAdAmA50Yrmv5HKPATACeQ/GNEm6YBkvRyANblZhpHAXsfekpkOGsWIEmPAHA9gDuOo13mWhS4gOSZfdVoEiBJ9wFwA4D7961Y+lUpsK/v7KxVgL4K4ElOCS4l+Uyn7a41k3Q0gMcC2ANgH4CHV1T2OyStx69OzQEk6TwAZztr8lMAx5P8s9N+Y8wk2cTjfQDu66z080h+zml7yKwpgCSdCOByZyX+BuBRJH/otN84M0kWN/s0gOc4Kv8Nko922B1m0gxAkh4I4AcVwcL9JA/UVnjT7CXdHYD9yEzfVUkAjib5uxqNmgCoBAu/CeBhzsJ/kORZTtuNN5Nk70bXAZ0Hy59G8qIawVoB6LMAnu8suE3tH0/y3077NAMg6esAuoaoC0la7M2dJgdI0ssAXOgs8W8BHEvS/s9UoYCkdwN4bYfL5STto7U7TQpQZbDQehzreawHylSpgKSTAVza4XYDyeNqsp4MoB7BwteQfH9N5dL2NgWK3l0vyAdJWhDXnSYBSNLtANh3GO/KwgMk97trlYbbKiDJPpzea5U8JKuYqDIeql0kvQPAG5352ZLMR5L8q9M+zXZQYFcAJOnJAL7sbGWLMFuk2SLOmYIKzB6gEiz8HoB7O7U4meQXnLZp1qGApD8BuOcsh7AewcL3kuyadg4OjSSbhRxH0j4BjJok2Ufga0j+YdQHlcznDlBNsPAa+xpP8r/rEHbxjAKPbRuyHvKFY0Ik6QUALOprPfIT1gHRbAGSdDoA77aSX5Zg4e8nhGfx6FEgWoJn8Zy1QCTplq5vjc3NwnoEC/eQ/HYD8IwC0TbwrA2i2QHUI1h4JskLGoJnUIhWwLMWiGYFkCSLMX2t5WDhlneeLm5Dw5kDntEhkmRhEVvesWNqZgiTdC6AN3W1Svn72oOFkuxF+WcVIQUrai+IKuA5BBHJ453auc1mA1AJFn7Jsf7EKj9ZsLBHw1ZDtI5neAmaBUBzCxaO2cBj5u2FZtlO0l8A3K3ZIaxHsPB8kt5vYn00c/mM0dBj5OmqzAqjOQDUfLBwJ32HbPAh84pCM5seSNJLAHzcWeFJgoVdZRui4YfIo6ucff8uyVY03LW5IawyWPgvW5u77mChV/QIABFfb/kidk0CVKbDth3Huw35dJLeniqiV2/fniDYx1f7vlWTeoUFah6wZQhrqwcqwUKbrtsaH0+6mOQpHsOpbXpCVFPstcJjBZNkmzHv0swQJultAN7iVO375TyafzjtJzcbEaK1w9McQJXBQlvvYmtsfjE5FZUFGAGiSeBpCqDKYKFtmX0qya9Utl0z5gNCNBk8BSA7CtiODNwxjf4trEew8BySNtTNOg0A0aTwtARQTbDQeh3rfawXmn0KQDQ5PC0B9EkAL3LSkAD9X6hWALIJzJ3mNoSdS9I7U3NyuX6zQO+zKOzkEEmaHqDSFdpZM97tOfkSfRvvk0LUDEAFIgseetf85DS+AYgk/bPr1NvRZ2HLg4ektwI4xzmgZCBxYohaBMjWPeenDOcvaIvZ2oez5gAqQ5mtLbb3oa4z+Bb6nTHW1UP92vFIr54vzJ8BcGplGdYKkSRbCXGHSWdh2z1ckp1taGccroxyFt9cznG4iGuDqFmASk9kZxxakNGTckHZBBA1DVCB6BMAXuwhyA4VmGL/+05l6zlsbdt7DJmXU0uXmSQ7JvD2zQ1hiwJJsotRvlVxXO87SU5+heUYDT5Gni5KVhg1D1DphWqCjOYy6RlAYzb0mHn3gWkWABWIaoKMubHwSBpGebGWZNdc2vmUO6a1BhJXFUSSff/yLuOYamvzzwEcVfFr7tWwPXqi6uN2PXWYG0C1Qca1n8RaDlewl3kPRL3gWXo/XBwo1dXWdk/a3jEOnJoVQGUoqw0yvpLkh7oUHvLvTohC8FRANBo8pT3sxLeVJ/M2M4QtiVYTZJzkNPoOiAaBxwHRqPDMFqBS8Jog4yT3YewA0aDwrIBodHhmDVApvG0mtO3PnjTJjTxbIBoFnm0gWgs8pQ06lxY3N4QtCWZBRgPDezdnHvPr+alV2EiaL0DlF2Dbn20bdB40XtHwQ5nOHqAC0SyCjEM1Wkv57AqACkRvBvB2p7hrDzI6yzU7s90EUPNBxtnR4SjwrgGo9EK1Qca8cM4ByU4mkuz++F93ZHELyZX3iW31n+S+sKWZWfNBxkCbNeUq6ekArugo1I0kH1xT8EkBKj1R80HGGkFbtZVkZ3bb2d2r0tUkn1hTh8kBKhB9DMBLnQWfJMjoLFuTZpJsO/ONAB7UUcBLSHqvX781q1YAqg0yfoDkq5psrQYLJeldAF7nKFr1x+wmACq9kAUZLazvvTV4P8kDDlE22kTSQ4uuK9dCF5HuR/I3NYI1A1CBaB+AK50VsAMj7TJeixNl2kYBSccCsB/ZMQ6Brif5GIfdYSZNAVQg8rzsLSphl/Hapby2LDZTUaBcq/56ALb1fOVxLkuinULy4loRmwOoQGQX7T7DWZnPk3y203bXmkl6AIA91isDOBGADV3e1HsJbasA1QYZvUKl3fYKPI2knXFQnZoEqPRCNUHG6oqnwyEFLiJ5Wl89mgWoQFQTZOyrwSb7WUztcSRtu0+v1DRABaKPADijV+3SaZUCNgE5geTNEZnmAFBtkDGix6b4Xld2BNvJcaHUPEClF6oNMoZE2eXOtm3q1ZFha1mfWQBUINoL4Kqurbm7vPEj1bOAqx3udW0kk62+swGoQHQ2gPOGFGAD8roJgF0t+qkx6jorgApElwE4aQwxZp6n3YNxsPyzA7yst/4iSdvEMFqaHUCjKZEZ91IgAeolWzotFEiAkoWQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnT+H0jPT81J3xWWAAAAAElFTkSuQmCC"}}}}}};function jl(){let n,t,e,r=0;const s=1,i={duration:750,easing:"ease-in-out"},o={alpha:s,color:4294967295};function a(l){if(l.startsWith("#")){n.color=is(l),n.src="",n.alpha=1,r=1,t.alpha=0,e.alpha=0;return}else n.color=4294967295,e.alpha=1;if(r===0){n.src=l,r=1;return}if(r===1){t.src=l,r=2,t.alpha=0,t.animate({alpha:s},i).start(),n.animate({alpha:0},i).start();return}r===2&&(n.src=l,r=1,n.alpha=0,n.animate({alpha:s},i).start(),t.animate({alpha:0},i).start())}return Ve(Je(Kl,l=>{a(l)},{defer:!0})),E(W,{width:1920,height:1080,zIndex:-5,get children(){return[E(W,{ref(l){var h=n;typeof h=="function"?h(l):n=l},style:o}),E(W,{ref(l){var h=t;typeof h=="function"?h(l):t=l},style:o,alpha:0}),E(W,{ref(l){var h=e;typeof h=="function"?h(l):e=l},src:"./assets/hero-mask-inverted.png",get color(){return is(d.color.materialBrand)},width:1920,height:1080})]}})}function Xt(n){if(!n||!n[Symbol.iterator])throw new Error("objectFromEntries requires a single iterable argument");const t={};for(const[e,r]of n)t[e]=r;return t}const ql=["focus","disabled"],Zl=["brand","inverse","neutral"];function O({themeKeys:n,base:t,modes:e={},tones:r={},themeStyles:s,modeKeys:i=ql,toneKeys:o=Zl},a=!1){const l=(m,x,A)=>{const w=o.map(y=>{var T,_;const b={};return new Set([].concat.apply([],[(T=m==null?void 0:m[y])!=null?T:{},(_=x==null?void 0:x[y])!=null?_:{}].map(Object.keys))).forEach(C=>{var I,R,B;i.includes(C)||(b[C]=(B=(I=x==null?void 0:x[y])==null?void 0:I[C])!=null?B:(R=m==null?void 0:m[y])==null?void 0:R[C])}),i.forEach(C=>{var I,R;b[C]={...A[C],...(I=m==null?void 0:m[y])==null?void 0:I[C],...(R=x==null?void 0:x[y])==null?void 0:R[C]}}),[y,b]});return Xt(w)},h=(m,x)=>{const A=i.map(y=>[y,{...m==null?void 0:m[y],...x==null?void 0:x[y]}]);return Xt(A)},f=(m,x)=>({...m,...x.base}),u=m=>Xt(Object.entries(n).filter(([x,A])=>m[A]).map(([x,A])=>[x,m[A]])),p=m=>Xt(Object.entries(m).map(([A,w])=>{const y=u(w);return Object.entries(w).filter(([b,g])=>i.includes(b)).forEach(([b,g])=>{y[b]=u(g)}),[A,y]}));return((m,x,A)=>{const w=p(s);a&&console.log(w);const y=f(m,w);a&&console.log(y);const b=h(x,w);a&&console.log(b);const g=l(A,w,b);return a&&console.log(g),{base:{...y,...b},tones:g}})(t,e,r)}function fi(n,t=0){const e=n?"width":"height",r=n?"x":"y";return(s,i,o=0,a)=>{var y,b,g,T;if(!s.children.length)return;const l=s.gap||0,h=s.scroll||"auto",[f,u]=Jl(n,s);let p=(y=s[r])!=null?y:0;const v=(b=i==null?void 0:i[r])!=null?b:0,m=(g=i==null?void 0:i[e])!=null?g:0,x=a===void 0?"none":o>a?"incremental":"decremental";let A=p;const w=(_,C)=>Math.abs(p)+u<_+C;if(h==="auto")s.scrollIndex!=null&&s.scrollIndex>=0?s.selected>=s.scrollIndex?A=x==="incremental"?p-m-l:p+m+l:x==="decremental"&&s.selected===s.scrollIndex-1&&(A=p+m+l):(w(f.position,f.size)||v<Math.abs(p))&&(A=-v+t);else if(h==="always"||h==="edge"&&x==="decremental"&&Math.abs(p)>v)A=-v+t;else if(h==="edge"&&x==="incremental"&&w(v,m))A=p-m-l;else if(h==="edge"&&x==="none"){let _=0;for(;_<s.children.length&&w(v,m);){const I=(T=s.children[_++][e])!=null?T:0;p-=I+l}A=p}s[r]!==A&&(s[r]=A)}}function Jl(n,t){var i,o,a,l,h,f;let e,r;const s=t.children[t.children.length-1];return n?(e={position:(i=s.x)!=null?i:0,size:(o=s.width)!=null?o:0},r=(a=t.width)!=null?a:0):(e={position:(l=s.y)!=null?l:0,size:(h=s.height)!=null?h:0},r=(f=t.height)!=null?f:0),[e,r]}function ze(...n){const t=n.filter(e=>typeof e=="function");if(t.length!==0)return t.length===1?t[0]:function(...e){let r;for(const s of t)if(r=s.apply(this,e),r===!0)return r;return r}}function pi(){if(!this||this.selected===void 0||this.children.length===0)return!1;let n=this.children[this.selected];for(;n!=null&&n.skipFocus;)this.selected++,n=this.children[this.selected];return n instanceof We?(n.setFocus(),!0):!1}function mr(n){return function(){var i,o,a;const t=this.children.length,e=this.wrap,r=this.selected||0;if(t===0)return!1;if(n==="right"||n==="down")do if(this.selected=(this.selected||0)%t+1,this.selected>=t){if(!e){this.selected=void 0;break}this.selected=0}while((i=this.children[this.selected])!=null&&i.skipFocus);else if(n==="left"||n==="up")do if(this.selected=(this.selected||0)%t-1,this.selected<0){if(!e){this.selected=void 0;break}this.selected=t-1}while((o=this.children[this.selected])!=null&&o.skipFocus);if(this.selected===void 0&&(this.selected=r,(a=this.children[this.selected])!=null&&a.states.has("focus")))return!1;const s=this.children[this.selected];if(this.onSelectedChanged&&this.onSelectedChanged.call(this,this,s,this.selected,r),this.plinko&&r!==void 0){const h=this.children[r].selected||0;s.selected=h<s.children.length?h:s.children.length-1}return s.setFocus(),!0}}function ec(n=1){const t=d.layout.screenW,e=d.layout.columnCount,r=d.layout.marginX,s=d.layout.gutterX;(n<1||n>e)&&(console.error("getWidthByUpCount expects an upCount between 1 & ".concat(e,", received ").concat(n,". Defaulting to upCount 1.")),n=1);const i=t-r*2,o=(n-1)*s;return(i-o)/n}function tc(n,t){const e=t();let r,s,i,o;Array.isArray(e)?e.length===2?(r=o=e[0],s=i=e[1]):e.length===3?(r=e[0],s=i=e[1],o=e[2]):[r,i,o,s]=e:r=i=o=s=e,n.onBeforeLayout=(a,l)=>{if(l){n.width=n.children.reduce((u,p)=>u+(p.width||0),0)+s+i;const h=n.children[0];h&&(h.x=s,h.marginLeft=s);let f=0;return n.children.forEach(u=>{u.y=r,u.marginTop=r,f=Math.max(f,u.height||0)}),n.height=f+r+o,!0}}}function rc(n,t){const e=ke.createTexture("ImageTexture",{src:n});return t.reduce((r,s)=>{const{x:i,y:o,width:a,height:l}=s;return r[s.name]=ke.createTexture("SubTexture",{texture:e,x:i,y:o,width:a,height:l}),r},{})}const{Artwork:{defaultTone:Md,...nc}={themeStyles:{}}}=d==null?void 0:d.componentConfig,sc={themeKeys:{fallbackSrc:"fallbackSrc",fillColor:"fillColor",scale:"imageScale",pivotX:"imageScalePivotX",pivotY:"imageScalePivotY",borderRadius:"radius"},base:{fallbackSrc:void 0,fillColor:d.color.overlay,gradientColor:d.color.material,pivotX:.5,pivotY:.5,scale:void 0,borderRadius:d.radius.md},themeStyles:nc};O(sc);const{Badge:{defaultTone:Ld,...kn}={themeStyles:{}}}=d.componentConfig,ic={themeKeys:{color:"backgroundColor",borderRadius:"radius",gap:"contentSpacing"},base:{color:d.color.fillInverseSecondary,borderRadius:d.radius.sm,border:{color:d.color.strokeInverse,width:d.stroke.sm},gap:d.spacer.xs,display:"flex",justifyContent:"spaceEvenly",padding:[d.spacer.md-d.stroke.sm,d.spacer.xs+d.stroke.sm,d.spacer.md+d.stroke.sm,d.spacer.md+d.stroke.sm]},tones:{inverse:{color:d.color.fillNeutralSecondary,borderRadius:d.radius.sm,border:{color:d.color.strokeInverseSecondary,width:d.stroke.sm}},brand:{color:d.color.fillBrand,borderRadius:d.radius.sm,border:{color:d.color.strokeInverseSecondary,width:d.stroke.sm}}},themeStyles:kn},oc={themeKeys:{color:"textColor"},base:{...d.typography.tag1,color:d.color.textNeutral},tones:{inverse:{color:d.color.textInverse},brand:{color:d.color.textNeutral}},themeStyles:kn},ac={themeKeys:{color:"iconColor"},base:{color:d.color.textNeutral},tones:{inverse:{color:d.color.textInverse},brand:{color:d.color.textNeutral}},themeStyles:kn};O(ic);O(ac);O(oc);const{Button:{defaultTone:lc,...cc}={buttonThemeStyles:{}}}=d==null?void 0:d.componentConfig,{Surface:{surfaceDefaultTone:hc,...dc}={surfaceThemeStyles:{}}}=d==null?void 0:d.componentConfig,Nn={...cc,...dc},uc={themeKeys:{borderRadius:"radius",color:"backgroundColor",justifyContent:"justify",itemSpacing:"contentSpacing"},base:{height:d.typography.button1.lineHeight+d.spacer.xl*2,display:"flex",padding:[d.spacer.xxxl,d.spacer.xl],color:d.color.interactiveNeutral,justifyContent:"center",alignItems:"center",flexBoundary:"fixed",borderRadius:d.radius.sm,contentColor:d.color.fillNeutral},modes:{focus:{color:d.color.interactiveNeutralFocus,contentColor:d.color.fillInverse},disabled:{color:d.color.fillNeutralDisabled}},tones:{inverse:{color:d.color.interactiveInverse},brand:{color:d.color.interactiveBrand,focus:{color:d.color.fillNeutral}}},themeStyles:Nn},fc={themeKeys:{color:"contentColor"},base:{color:d.color.textNeutral},modes:{focus:{color:d.color.textInverse},disabled:{color:d.color.textNeutralDisabled}},tones:{inverse:{color:d.color.fillNeutral},brand:{color:d.color.fillBrand,focus:{color:d.color.fillBrand}}},themeStyles:Nn},pc={themeKeys:{color:"textColor"},base:{color:d.color.textNeutral,...d.typography.button1,textAlign:"center",contain:"none"},modes:{focus:{color:d.color.textInverse},disabled:{color:d.color.textNeutralDisabled}},tones:{inverse:{color:d.color.fillNeutral},brand:{color:d.color.fillBrand,focus:{color:d.color.fillBrand}}},themeStyles:Nn},gc=O(uc),mc=O(fc),xc=O(pc),Fd={tone:lc||hc||"neutral",Container:gc,Content:mc,Text:xc},{Checkbox:{defaultTone:Pd,...gi}={themeStyles:{}}}=d==null?void 0:d.componentConfig,yc={themeKeys:{color:"backgroundColor",borderRadius:"radius",border:"border",justifyContent:"justifyContent"},base:{width:d.spacer.xxl,height:d.spacer.xxl,display:"flex",justifyContent:"center",color:d.color.fillNeutral,alignItems:"center",borderRadius:d.spacer.xxl/4,border:{color:d.color.strokeInverse,width:d.stroke.sm}},modes:{disabled:{alpha:d.alpha.inactive}},tones:{brand:{borderRadius:d.spacer.xxl/4,border:{color:d.color.strokeNeutralSecondary,width:d.stroke.sm},color:d.color.fillNeutralSecondary,checked:{borderRadius:d.spacer.xxl/4,border:{color:d.color.strokeNeutralSecondary,width:d.stroke.sm},color:d.color.fillBrand}},neutral:{borderRadius:d.spacer.xxl/4,border:{color:d.color.strokeNeutralSecondary,width:d.stroke.sm},color:d.color.fillInverseSecondary,checked:{borderRadius:d.spacer.xxl/4,border:{color:d.color.strokeNeutralSecondary,width:d.stroke.sm},color:d.color.fillNeutral}},inverse:{borderRadius:d.spacer.xxl/4,border:{color:d.color.strokeInverseSecondary,width:d.stroke.sm},color:d.color.fillNeutralSecondary,checked:{borderRadius:d.spacer.xxl/4,border:{color:d.color.strokeInverseSecondary,width:d.stroke.sm},color:d.color.fillInverse}}},modeKeys:["focus","disabled","checked"],themeStyles:gi},vc={themeKeys:{width:"checkWidth",height:"checkHeight"},base:{width:d.spacer.lg,height:d.spacer.lg,src:d.asset.check},tones:{neutral:{color:d.color.fillInverse},inverse:{color:d.color.fillNeutral},brand:{color:d.color.fillInverse}},themeStyles:gi};O(yc);O(vc);const{Icon:{defaultTone:kd,...bc}={themeStyles:{}}}=d==null?void 0:d.componentConfig,Ac={themeKeys:{color:"color"},base:{width:100,height:100,color:d.color.fillNeutral},tones:{inverse:{color:d.color.fillInverse},brand:{color:d.color.fillBrand}},themeStyles:bc};O(Ac);const{Column:{defaultTone:Tc,...Sc}={themeStyles:{}}}=d==null?void 0:d.componentConfig,wc={themeKeys:{gap:"itemSpacing",scrollIndex:"scrollIndex",transition:"itemTransition"},base:{display:"flex",flexBoundary:"fixed",flexDirection:"column",gap:d.layout.gutterY,transition:{y:{...d.animation.standardEntrance,duration:d.animation.duration.fast}}},themeStyles:Sc},_c=O(wc),Hr={tone:Tc||"neutral",Container:_c},mi=n=>{const t=mr("up"),e=mr("down"),r=j(()=>fi(!1,n.y));return E(W,Te(n,{get onUp(){return ze(n.onUp,t)},get onDown(){return ze(n.onDown,e)},get selected(){return n.selected||0},forwardFocus:pi,get onBeforeLayout(){return ze(n.onBeforeLayout,(s,i)=>r()(s,i))},get onSelectedChanged(){return ze(n.onSelectedChanged,n.scroll!=="none"?r():void 0)},get style(){var s;return[n.style,Hr.Container.tones[(s=n.tone)!=null?s:Hr.tone],Hr.Container.base]}}))},{Input:{defaultTone:Nd,...xi}={themeStyles:{}}}=d==null?void 0:d.componentConfig,Rc={themeKeys:{borderRadius:"radius",color:"backgroundColor",justifyContent:"justify"},base:{width:ec(4),height:100,display:"flex",flexDirection:"column",padding:[d.spacer.xxxl,d.spacer.xl],color:d.color.interactiveNeutral,contentColor:d.color.fillInverse,borderRadius:d.radius.sm,marginX:d.spacer.xxxl,actualTitle:""},themeStyles:xi},Cc={themeKeys:{color:"textColor"},base:{textAlign:"left",color:d.color.textNeutral,...d.typography.button1},themeStyles:xi};O(Rc);O(Cc);const{Key:{defaultTone:Dd,...yi}={themeStyles:{}}}=d==null?void 0:d.componentConfig,Ec={themeKeys:{keySpacing:"keySpacing",borderRadius:"borderRadius",color:"backgroundColor",justifyContent:"justify",baseWidth:"baseWidth",sizes:"sizes",contentColor:"contentColor"},base:{keySpacing:d.spacer.md,height:d.spacer.md*9,paddingX:d.spacer.md,contentColor:d.color.fillNeutral,sizes:{sm:1,md:2,lg:3,xl:4,xxl:5},padding:[d.spacer.md],baseWidth:d.spacer.md*7,color:d.color.interactiveNeutral,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:d.radius.sm},modes:{focus:{color:d.color.interactiveNeutralFocus,contentColor:d.color.fillInverse},disabled:{color:d.color.fillNeutralDisabled,contentColor:d.color.fillNeutralDisabled}},tones:{inverse:{color:d.color.interactiveInverse,focus:{color:d.color.interactiveInverseFocus,contentColor:d.color.fillNeutral}},brand:{focus:{contentColor:d.color.fillNeutral}}},themeStyles:yi},Ic={themeKeys:{color:"textColor"},base:{color:d.color.textNeutral,...d.typography.headline2,textAlign:"center",contain:"none"},modes:{focus:{color:d.color.textInverse},disabled:{color:d.color.textNeutralDisabled}},tones:{inverse:{focus:{color:d.color.textNeutral}}},themeStyles:yi};O(Ec);O(Ic);const{Keyboard:{defaultTone:Ud,...vi}={}}=d==null?void 0:d.componentConfig,{Key:{...Bc}={}}=d==null?void 0:d.componentConfig,Mc={themeKeys:{gap:"keySpacing",width:"screenW",marginX:"marginX",keyHeight:"keyHeight"},base:{gap:d.spacer.md,width:d.layout.screenW,display:"flex",marginX:d.layout.marginX,keyHeight:100,flexBoundary:"contain"},themeStyles:vi},Lc={themeKeys:{gap:"keySpacing",borderRadius:"borderRadius",color:"backgroundColor",justifyContent:"justify",baseWidth:"baseWidth",sizes:"sizes",contentColor:"contentColor"},base:{gap:d.spacer.md,height:d.spacer.md*9,sizes:{sm:1,md:2,lg:3,xl:4,xxl:5},contentColor:d.color.fillNeutral,padding:[d.spacer.xxxl,d.spacer.xl],baseWidth:d.spacer.md*7,color:d.color.interactiveNeutral,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:d.radius.sm},modes:{focus:{color:d.color.interactiveNeutralFocus,contentColor:d.color.fillInverse},disabled:{color:d.color.fillNeutralDisabled,contentColor:d.color.fillNeutralDisabled}},tones:{inverse:{color:d.color.interactiveInverse,focus:{color:d.color.interactiveInverseFocus,contentColor:d.color.fillNeutral}},brand:{focus:{contentColor:d.color.fillNeutral}}},themeStyles:Bc},Fc={themeKeys:{color:"textColor"},base:{color:d.color.textNeutral,...d.typography.headline2},modes:{focus:{color:d.color.textInverse},disabled:{color:d.color.textNeutralDisabled}},tones:{inverse:{focus:{color:d.color.textNeutral}}},themeStyles:vi};O(Mc);O(Lc);O(Fc);const{Row:{defaultTone:Pc,...kc}={themeStyles:{}}}=d==null?void 0:d.componentConfig,Nc={themeKeys:{gap:"itemSpacing",scrollIndex:"scrollIndex",transition:"itemTransition"},base:{display:"flex",flexBoundary:"fixed",flexDirection:"row",gap:d.layout.gutterX,transition:{x:{...d.animation.standardEntrance,duration:d.animation.duration.fast}}},themeStyles:kc},Dc=O(Nc),Gr={tone:Pc,Container:Dc},Uc=n=>{const t=mr("left"),e=mr("right"),r=j(()=>fi(!0,n.x));return E(W,Te(n,{get selected(){return n.selected||0},get onLeft(){return ze(n.onLeft,t)},get onRight(){return ze(n.onRight,e)},forwardFocus:pi,get onBeforeLayout(){return ze(n.onBeforeLayout,(s,i)=>r()(s,i))},get onSelectedChanged(){return ze(n.onSelectedChanged,n.scroll!=="none"?r():void 0)},get style(){var s;return[n.style,Gr.Container.tones[(s=n.tone)!=null?s:Gr.tone],Gr.Container.base]}}))},{Label:{defaultTone:Od,...bi}={themeStyles:{}}}=d==null?void 0:d.componentConfig,Oc={themeKeys:{color:"backgroundColor",borderRadius:"radius"},base:{display:"flex",justifyContent:"center",color:d.color.textNeutral,padding:[d.spacer.md,d.spacer.lg],borderRadius:[d.radius.md,d.radius.md,d.radius.md,d.radius.none],height:d.typography.caption1.lineHeight+d.spacer.md,neutral:{backgroundColor:d.color.fillNeutral}},tones:{inverse:{color:d.color.fillInverse},brand:{color:d.color.fillBrand,focus:{color:d.color.orange}}},themeStyles:bi},zc={themeKeys:{color:"textColor"},base:{...d.typography.caption1,color:d.color.textInverse},tones:{inverse:{color:d.color.textNeutral},brand:{color:d.color.textNeutral}},themeStyles:bi};O(Oc);O(zc);const{Details:{defaultTone:zd,...Ai}={themeStyles:{}}}=d==null?void 0:d.componentConfig,Wc={themeKeys:{alignItems:"alignItems",gap:"contentSpacing",badgeContentSpacing:"badgeContentSpacing",ratingContentSpacing:"ratingContentSpacing"},base:{display:"flex",flexDirection:"row",alignItems:"center",gap:d.spacer.sm,flexBoundary:"contain",badgeContentSpacing:d.spacer.sm,ratingContentSpacing:d.spacer.sm},themeStyles:Ai},Hc={themeKeys:{color:"textColor"},base:{...d.typography.body2,marginRight:d.spacer.lg,color:d.color.textNeutral},tones:{neutral:{disabled:{color:d.color.textNeutralDisabled}},inverse:{color:d.color.textInverse,disabled:{color:d.color.textNeutralDisabled}},brand:{color:d.color.textNeutral,disabled:{color:d.color.textNeutralDisabled}}},themeStyles:Ai};O(Wc);O(Hc);const{Rating:{defaultTone:Wd,...Dn}={themeStyles:{}}}=d==null?void 0:d.componentConfig,Gc={themeKeys:{justifyContent:"justifyContent",gap:"contentSpacing"},base:{display:"flex",flexDirection:"row",justifyContent:"flexStart",gap:d.spacer.sm,alignItems:"center"},themeStyles:Dn},Vc={themeKeys:{color:"textColor"},base:{color:d.color.textNeutral,...d.typography.body2},tones:{neutral:{disabled:{color:d.color.textNeutralDisabled}},inverse:{color:d.color.textInverse,disabled:{color:d.color.textNeutralDisabled}},brand:{color:d.color.textNeutral,disabled:{color:d.color.textNeutralDisabled}}},themeStyles:Dn},$c={themeKeys:{color:"color"},base:{height:d.typography.body2.lineHeight,width:d.typography.body2.lineHeight,color:d.color.fillNeutral,marginRight:d.spacer.sm},themeStyles:Dn};O(Gc);O($c);O(Vc);const{Metadata:{defaultTone:Hd,...Un}={themeStyles:{}}}=d==null?void 0:d.componentConfig,Xc={themeKeys:{justifyContent:"justifyContent",alpha:"alpha"},base:{display:"flex",flexDirection:"column",justifyContent:"flexStart",flexBoundary:"contain",alpha:d.alpha.primary},modes:{disabled:{alpha:d.alpha.inactive}},themeStyles:Un},Yc={themeKeys:{color:"textColor"},base:{maxLines:1,contain:"width",...d.typography.headline3,color:d.color.textNeutral},tones:{neutral:{disabled:{color:d.color.textNeutralDisabled}},inverse:{color:d.color.textInverse,disabled:{color:d.color.textNeutralDisabled}},brand:{color:d.color.textNeutral,disabled:{color:d.color.textNeutralDisabled}}},themeStyles:Un},Kc={themeKeys:{color:"textColor"},base:{contain:"width",maxLines:2,...d.typography.body3,color:d.color.textNeutralSecondary},tones:{neutral:{disabled:{color:d.color.textNeutralDisabled}},inverse:{color:d.color.textInverseSecondary,disabled:{color:d.color.textNeutralDisabled}},brand:{color:d.color.textNeutralSecondary,disabled:{color:d.color.textNeutralDisabled}}},themeStyles:Un};O(Xc);O(Kc);O(Yc);const{ProgressBar:{defaultTone:Gd,...Ti}={themeStyles:{}}}=d==null?void 0:d.componentConfig,Qc={themeKeys:{color:"barColor",borderRadius:"radius"},base:{height:d.spacer.md,color:d.color.fillNeutralTertiary,borderRadius:d.radius.xs},tones:{inverse:{color:d.color.fillInverseTertiary}},themeStyles:Ti},jc={themeKeys:{color:"progressColor",borderRadius:"radius"},base:{borderRadius:d.radius.xs,color:d.color.fillNeutral},tones:{inverse:{color:d.color.fillInverse},brand:{color:d.color.fillBrand}},themeStyles:Ti};O(Qc);O(jc);const{Radio:{defaultTone:Vd,...Si}={themeStyles:{}}}=d==null?void 0:d.componentConfig,qc={themeKeys:{borderRadius:"radius",color:"backgroundColor",colorChecked:"backgroundColorChecked"},base:{color:d.color.fillNeutralSecondary,height:d.spacer.xxl+d.stroke.sm*2,width:d.spacer.xxl+d.stroke.sm*2,borderRadius:d.spacer.xxl/2+d.stroke.sm,border:{color:d.color.strokeNeutralSecondary,width:d.stroke.sm}},tones:{inverse:{border:{color:d.color.strokeInverseSecondary,width:d.stroke.sm}},brand:{border:{color:d.color.fillBrand,width:d.stroke.sm}}},modeKeys:["focus","disabled","checked"],themeStyles:Si},Zc={themeKeys:{width:"knobWidth",height:"knobHeight",borderRadius:"knobRadius",color:"knobColor",colorChecked:"knobColorChecked"},base:{color:d.color.fillInverse,colorChecked:d.color.fillInverse,width:d.spacer.xxl,height:d.spacer.xxl,borderRadius:d.spacer.xxl/2},tones:{inverse:{color:d.color.fillNeutral}},themeStyles:Si};O(qc);O(Zc);const{Tile:{defaultTone:$d,...Cr}={tileThemeStyles:{}}}=d==null?void 0:d.componentConfig,{Surface:{defaultSurfaceTone:Xd,...Jc}={surfaceThemeStyles:{}}}=d==null?void 0:d.componentConfig,eh={themeKeys:{alpha:"alpha",paddingYProgress:"paddingYProgress",paddingYBetweenContent:"paddingYBetweenContent",contentSpacingY:"contentSpacingY",borderRadius:"radius"},base:{width:400,height:240,padding:[40,10],paddingYProgress:d.spacer.xl,paddingYBetweenContent:d.spacer.md,contentSpacingY:d.spacer.md,borderRadius:d.radius.md,alpha:d.alpha.primary},modes:{disabled:{alpha:d.alpha.inactive}},themeStyles:{...Jc,...Cr}},th={themeKeys:{},base:{display:"flex",flexDirection:"column",flexBoundary:"contain",mountY:1},themeStyles:Cr},rh={themeKeys:{},base:{display:"flex",flexDirection:"column",justifyContent:"flexStart"},themeStyles:Cr},nh={themeKeys:{},base:{width:d.spacer.lg*5,height:d.spacer.xxl+d.spacer.md},themeStyles:Cr};O(eh);O(th);O(rh);O(nh);const{Toggle:{defaultTone:Yd,...wi}={themeStyles:{}}}=d==null?void 0:d.componentConfig,Se=d.spacer.xl,Fe=d.spacer.xs,ye=d.stroke.sm,sh={themeKeys:{borderRadius:"strokeRadius",color:"backgroundColor",colorChecked:"backgroundColorChecked"},base:{color:d.color.fillInverseTertiary,colorChecked:d.color.fillNeutral,height:Se+(Fe+ye)*2,width:(ye+Fe*2+Se)*2,borderRadius:Se/2+Fe+ye,border:{color:d.color.fillNeutral,width:ye}},modes:{focus:{},disabled:{borderRadius:Se/2+Fe+ye,border:{color:d.color.fillNeutralDisabled,width:ye},color:d.color.fillInverseDisabled,colorChecked:d.color.fillNeutralDisabled}},tones:{inverse:{borderRadius:Se/2+Fe+ye,border:{color:d.color.fillInverse,width:ye},color:d.color.fillNeutralTertiary,colorChecked:d.color.fillInverse,disabled:{borderRadius:Se/2+Fe+ye,border:{color:d.color.fillInverseDisabled,width:ye},color:d.color.fillNeutralDisabled,colorChecked:d.color.fillInverseDisabled}},brand:{borderRadius:Se/2+Fe+ye,border:{color:d.color.fillBrand,width:ye},color:d.color.fillBrandTertiary,colorChecked:d.color.fillBrand,disabled:{borderRadius:Se/2+Fe+ye,border:{color:d.color.fillNeutralDisabled,width:ye},color:d.color.fillInverseDisabled,colorChecked:d.color.fillNeutralDisabled}}},themeStyles:wi},ih={themeKeys:{width:"knobWidth",height:"knobHeight",padding:"knobPadding",borderRadius:"knobRadius",color:"knobColor",colorChecked:"knobColorChecked"},base:{color:d.color.fillNeutral,colorChecked:d.color.fillInverse,width:Se,height:Se,borderRadius:Se/2,padding:Fe},modes:{focus:{},disabled:{color:d.color.fillNeutralDisabled,colorChecked:d.color.fillInverseDisabled}},tones:{inverse:{color:d.color.fillInverse,colorChecked:d.color.fillNeutral,disabled:{color:d.color.fillInverseDisabled,colorChecked:d.color.fillNeutralDisabled}},brand:{color:d.color.fillBrand,colorChecked:d.color.fillInverse,disabled:{color:d.color.fillNeutralDisabled,colorChecked:d.color.fillInverseDisabled}}},themeStyles:wi};O(sh);O(ih);const oh={color:255,height:180,width:330,x:1900,y:6,mountX:1,alpha:.8,zIndex:100},ue={x:10,fontSize:20,textColor:4143380223},Yt={fontSize:22,textColor:4143380223},[ah,lh]=H(0),[ch,hh]=H(0),[dh,uh]=H(99),[fh,ph]=H(0),[gh,mh]=H(""),[xh,yh]=H(""),[vh,bh]=H(""),[Ah,Th]=H(""),[Sh,wh]=H(0),[_h,Rh]=H(0);let ds=0,us=0;const re=14;function Kt(n){return(n/1024/1024).toFixed(2)+" Mb"}const Ch=n=>{n&&(lh(n),uh(t=>Math.min(n,t)),ph(t=>Math.max(n,t)),us+=n,ds++,hh(Math.round(us/ds)))};function Eh(n){const t=n.txMemManager.getMemoryInfo();mh(Kt(t.criticalThreshold)),yh(Kt(t.targetThreshold)),bh(Kt(t.renderableMemUsed)),Th(Kt(t.memUsed)),wh(t.renderableTexturesLoaded),Rh(t.loadedTextures)}let Vr=0;function Ih(n){n.renderer.on("fpsUpdate",(t,e)=>{const r=typeof e=="number"?e:e.fps;r>5&&(Ch(r),Vr%10===0&&(Eh(t.stage),Vr=0),Vr++)})}const Bh=n=>E(W,Te(n,{style:oh,get children(){return[E(W,{y:6,get children(){return[E(Y,{style:ue,children:"FPS:"}),E(Y,{style:Yt,x:90,get children(){return ah().toString()}})]}}),E(W,{y:6,x:160,get children(){return[E(Y,{style:ue,children:"AVG:"}),E(Y,{style:Yt,x:100,get children(){return ch().toString()}})]}}),E(W,{x:0,y:26,get children(){return[E(Y,{style:ue,children:"MIN:"}),E(Y,{style:Yt,x:90,get children(){return dh().toString()}})]}}),E(W,{x:160,y:26,get children(){return[E(Y,{style:ue,children:"MAX:"}),E(Y,{style:Yt,x:100,get children(){return fh().toString()}})]}}),E(W,{display:"flex",flexDirection:"column",y:58,gap:4,get children(){return[E(W,{height:re,get children(){return[E(Y,{fontSize:re,style:ue,children:"criticalThreshold:"}),E(Y,{fontSize:re,style:ue,x:230,get children(){return gh()}})]}}),E(W,{height:re,get children(){return[E(Y,{fontSize:re,style:ue,children:"targetThreshold:"}),E(Y,{fontSize:re,style:ue,x:230,get children(){return xh()}})]}}),E(W,{height:re,get children(){return[E(Y,{fontSize:re,style:ue,children:"renderableMemUsed:"}),E(Y,{fontSize:re,style:ue,x:230,get children(){return vh()}})]}}),E(W,{height:re,get children(){return[E(Y,{fontSize:re,style:ue,children:"memUsed:"}),E(Y,{fontSize:re,style:ue,x:230,get children(){return Ah()}})]}}),E(W,{height:re,get children(){return[E(Y,{fontSize:re,style:ue,children:"renderableTexturesLoaded:"}),E(Y,{fontSize:re,style:ue,x:230,get children(){return Sh()}})]}}),E(W,{height:re,get children(){return[E(Y,{fontSize:re,style:ue,children:"loadedTextures:"}),E(Y,{fontSize:re,style:ue,x:230,get children(){return _h()}})]}})]}})]}})),gn={Column:{flexDirection:"column",display:"flex",width:140,height:600,y:360,gap:20,zIndex:101,transition:{x:{duration:250,easing:"ease-in-out"}},x:8,focus:{width:500,x:d.layout.marginX}},Gradient:{zIndex:99,color:255,src:"./assets/sidenav.png",alpha:0,width:1200,height:1080,focus:{alpha:1},transition:{alpha:!0}},NavButton:{zIndex:102,height:70,width:100,borderRadius:8,focus:{color:1111638783},active:{width:328,height:70}}},Mh="/solid-demo-app/",Lh=[{name:"experiment",width:81,height:100,x:0,y:0},{name:"trending",width:100,height:56,x:81,y:0},{name:"tv",width:100,height:68,x:181,y:0},{name:"movie",width:94,height:100,x:282,y:0}];function Fh(n){const t=rc(Mh+"assets/icons_white.png",Lh);return E(W,Te(n,{get texture(){return t[n.name]},get width(){return t[n.name].props.width},get height(){return t[n.name].props.height},get x(){return(100-(t[n.name].props.width||0))/2},get y(){return(100-(t[n.name].props.height||0))/2}}))}function Qt(n){return E(W,Te(n,{forwardStates:!0,get style(){return gn.NavButton},get children(){return[E(W,{y:-16,get children(){return E(Fh,{scale:.5,get name(){return n.icon}})}}),E(Y,{style:{fontSize:38,x:116,y:18,height:50,alpha:0,active:{alpha:1}},get children(){return n.children}})]}}))}function Ph(n){let t;const e=Pn();function r(){t.states.add("focus"),this.children.forEach(o=>o.states.add("active")),this.children.selected.setFocus()}function s(){t.states.remove("focus"),this.selected=0,this.children.forEach(o=>o.states.remove("active"))}function i(o){if(rl(()=>o)())return n.focusPage();e(o)}return[E(W,{flexItem:!1,width:300,height:150,x:30,y:15,zIndex:105,get alpha(){return n.showWidgets?1:0},get children(){return[E(Y,{x:80,fontSize:28,color:4143380036,children:"Built With:"}),E(W,{y:22,src:"./assets/solidWord.png",width:280,height:52}),E(W,{x:0,y:110,src:"./assets/tmdb.png",width:80,height:41}),E(Y,{x:90,y:110,contain:"width",width:160,fontSize:12,color:4143380036,children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]}}),E(mi,Te(n,{onFocus:r,onBlur:s,get style(){return gn.Column},scroll:"none",get children(){return[E(Qt,{onEnter:()=>i("/browse/all"),icon:"trending",children:"Trending"}),E(Qt,{icon:"movie",onEnter:()=>i("/browse/movie"),children:"Movies"}),E(Qt,{icon:"tv",onEnter:()=>i("/browse/tv"),children:"TV"}),E(Qt,{icon:"experiment",onEnter:()=>i("/examples"),children:"Examples"})]}})),E(W,{skipFocus:!0,ref(o){var a=t;typeof a=="function"?a(o):t=o},get style(){return gn.Gradient}})]}const kh=n=>{Sl({Announcer:["a"],Menu:["m"],Escape:["Escape",27],Backspace:["Backspace",8],Left:["ArrowLeft",37],Right:["ArrowRight",39],Up:["ArrowUp",38],Down:["ArrowDown",40],Enter:["Enter",13]}),Yl();const t=Ml();t.enabled=!1;const e=Pn();let r,s;Ih({renderer:ke});function i(){return r.states.has("focus")?!1:(s=_r(),r.setFocus())}const[o,a]=H(!0),l=ii(),h=["/browse","/entity"];return Ve(()=>{const f=l.pathname;let u=h.some(p=>f.startsWith(p));f==="/"&&(u=!0),a(u)}),E(W,{ref(f){var u=window.APP;typeof u=="function"?u(f):window.APP=f},onAnnouncer:()=>t.enabled=!t.enabled,onLast:()=>history.back(),onMenu:()=>e("/"),style:{width:1920,height:1080},onBackspace:i,onLeft:i,onRight:()=>r.states.has("focus")&&s.setFocus(),get children(){return[E(jl,{}),E(Bh,{mountX:1,x:1910,y:10,get alpha(){return o()?1:0}}),In(()=>n.children),E(Ph,{ref(f){var u=r;typeof u=="function"?u(f):r=f},focusPage:()=>s.setFocus(),get showWidgets(){return o()}})]}})},xr={Page:{width:1920,height:1080},headlineText:{width:1200,height:240,x:360,y:455,contain:"both",fontSize:66,textAlign:"center"},headlineSubText:{width:960,height:170,x:530,y:655,contain:"both",fontSize:48,textAlign:"center"},itemsContainer:{width:d.layout.screenW,height:800,y:560,x:0,zIndex:2},Thumbnail:{borderRadius:16,width:185,height:278,scale:1,zIndex:2,transition:{scale:{duration:250,easing:"ease-in-out"}},border:{width:0,color:0},focus:{scale:1.1,border:{color:4294967142,width:8}}},FocusRing:{borderRadius:16,width:194,height:286,y:-5,x:-5,zIndex:-1},FPS:{color:255,height:42,width:140,x:20,y:20,zIndex:100},FPSLabel:{x:10,y:0,fontSize:36,textColor:4294967295},FPSValue:{x:90,y:0,fontSize:36,textColor:4294967295},showHeadline:{x:70,y:20},headlineBlur:{width:1920,height:150,x:0,y:0,zIndex:14,alpha:.9,color:255},RowTitle:{height:60,width:300,marginBottom:-40,fontSize:36,color:4042322175,zIndex:2},Row:{display:"flex",justifyContent:"spaceBetween",height:300},Column:{display:"flex",flexDirection:"column",justifyContent:"flexStart",flexBoundary:"contain",gap:64,width:d.layout.screenW-2*d.layout.marginX,x:d.layout.marginX+d.layout.gutterX,y:48,transition:{y:{duration:250,easing:"ease-in-out"}},zIndex:2},Rect:{width:250,height:100,y:10,x:300,color:65535},peopleBio:{...d.typography.body1,fontFamily:"Roboto",fontWeight:"normal",contain:"both",width:780,height:340}},yr={width:120,height:40,mount:.5,color:179,borderRadius:8,borderBottom:{width:2,color:4278254335},border:{width:2,color:4210752051},focus:{color:4210752255,borderRadius:20,borderBottom:{width:0,color:0}}},Nh={color:10918399,height:8,y:2,x:-4,width:yr.width+8},Dh={fontSize:12,y:12,contain:"width",textAlign:"center",color:4143380991,height:yr.height,width:yr.width},Kd={container:yr,topBar:Nh,text:Dh},fs={width:386,height:136,color:1901898751,focus:{color:1513726719},disabled:{color:689783807}},Qd={fontSize:32,contain:"width",textAlign:"center",mountY:-.35,color:4294967295,height:fs.height,width:fs.width,focus:{fontSize:40},disabled:{color:2425393407}};function Uh(n){function t(e){e.color=4294967295}return E(W,Te(n,{color:16711935,onLoad:t,onFail:e=>e.src="failback.png",get style(){return xr.Thumbnail}}))}function Oh(n){const[t,e]=Pa(n,["items"]);return E(Uc,Te(e,{get style(){return xr.Row},get children(){return E(En,{get each(){return t.items},children:r=>E(Uh,r)})}}))}const zh="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyZDE4YjEwMTA0YjdiZTlkNjFiMWYwYjVlMGEwNzM2OCIsInN1YiI6IjYwZTVjMTdlNGNhNjc2MDA3NTA4Njc3MSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.D_nqH9kd-bhhWzeVsTDPYhHnsUaNAuyAa6YATmKHqsA",Wh="https://api.themoviedb.org/3";let _i,Ri;const Hh="w185",Gh={headers:{"Content-Type":"application/json",Authorization:"Bearer "+zh}};function $r(n,t=Hh){return Ri+t+n}function Vh(n,t={}){return _i?mn(n,t):Ci().then(()=>mn(n,t))}function mn(n,t={}){return fetch(Wh+n,{...Gh,...t}).then(e=>e.json())}function Ci(){return mn("/configuration").then(n=>{var t;return _i=n,Ri=(t=n.images)==null?void 0:t.secure_base_url,n})}const $h={get:Vh,loadConfig:Ci};function Xh(n,t){return n.length>t?n.substring(0,t-3)+"...":n}function Yh(n,t=7){let e=[];for(let r=0,s=n.length;r<s;r+=t)e.push(n.slice(r,r+t));return e}function Kh(n=[]){return n.map(t=>({src:$r(t.poster_path||t.profile_path),tileSrc:$r(t.backdrop_path||t.profile_path,"w300"),backdrop:$r(t.backdrop_path,"w1280"),href:"/entity/".concat(t.media_type||"people","/").concat(t.id),shortTitle:Xh(t.title||t.name,30),title:t.title||t.name,data:t,entityInfo:{type:t.media_type||"people",id:t.id},heroContent:{title:t.title||t.name,description:t.overview}}))}let Xr=new Map;const jt=new Map;function Qh(n){return t=>{const e="/trending/".concat(n,"/week?page=").concat(t);if(Xr.has(e))return Xr.get(e);let r=$h.get(e).then(s=>{let i=s.results.filter(l=>!l.adult),o=(jt.has(n)?jt.get(n):[]).concat(Kh(i)),a=Yh(o);return a[a.length-1].length<7?jt.set(n,a.pop()):jt.delete(n),a});return Xr.set(e,r),r}}function jh(n){const[t,e]=H([]),[r,s]=H(1),[i,o]=H(!1),[a]=Ws(r,n);return nn(()=>{const l=a();l&&Sn(()=>{l.length===0&&o(!0),e(h=>[...h,...l])})}),{pages:t,page:r,setPage:s,setPages:e,end:i,setEnd:o}}const Er=900,qh={display:"flex",flexDirection:"column",flexBoundary:"fixed",width:Er,height:220,gap:16},Zh={...d.typography.display2,fontFamily:"Roboto",fontWeight:700,maxLines:1,width:Er,contain:"width"},Jh=n=>E(Y,Te(n,{style:Zh})),ed={...d.typography.body1,fontFamily:"Roboto",fontWeight:400,lineHeight:32,width:Er,maxLines:3,contain:"width"},td={fontSize:16,lineHeight:20},rd=n=>E(Y,Te(n,{style:ed,get children(){return n.children}})),nd=n=>(()=>{var t=Rr("node");return Va(tc,t,()=>[8,13,11,13]),Bn(t,Te(n,{style:{color:"0x00000099",borderRadius:8,border:{width:2,color:"0xffffffff"}}}),!0),Ha(t,E(Y,{style:td,get children(){return n.children}})),t})(),ps={...d.typography.body2,fontFamily:"Roboto",fontWeight:400},sd=n=>E(W,{style:{display:"flex",flexDirection:"row",gap:18,width:Er,height:48},get children(){return[E(W,{y:-4,src:"./assets/stars.png",width:188,height:31}),E(W,{y:-4,flexItem:!1,clipping:!0,get width(){return 188*n.voteAverage/10},height:31,get children(){return E(W,{src:"./assets/stars-full.png",width:188,height:31})}}),E(Y,{style:ps,get children(){return[In(()=>n.voteCount)," reviews"]}}),E(Y,{style:ps,get children(){return n.metaText}}),E(En,{get each(){return n.badges},children:t=>E(nd,{y:-5,children:t})})]}}),id=n=>E(W,Te({id:"contentBlock",style:qh},n,{get children(){return[E(Jh,{get children(){return n.content.title}}),E(rd,{get children(){return n.content.description}}),E(wr,{get when(){return n.content.voteCount},get children(){return E(sd,{get metaText(){return n.content.metaText},get badges(){return n.content.badges},get voteCount(){return n.content.voteCount},get voteAverage(){return n.content.voteAverage}})}})]}})),gs=()=>{const n=nl(),[t,e]=H(0),[r,s]=H({}),i=Pn(),o=wa(()=>0),a=j(()=>jh(Qh(n.filter||"all"))),l=dn(p=>Ql(p),400),h=dn(p=>s(p||{}),200);Ve(Je(_r,p=>{p.backdrop&&l(p.backdrop),p.heroContent&&h(p.heroContent)},{defer:!0}));function f(){var v;(v=this.children.selected)==null||v.setFocus(),e((this.y||0)*-1+24);let p=a().pages().length;this.parent.selected=this.parent.children.indexOf(this),(p===0||this.parent.selected&&this.parent.selected>=p-2)&&a().setPage(m=>m+1)}function u(){let p=this.children.find(v=>v.states.has("focus"));return F(p&&p.href),i(p.href),!0}return E(wr,{get when(){return a().pages().length},get children(){return[E(id,{y:360,x:162,get content(){return r()}}),E(W,{clipping:!0,get style(){return xr.itemsContainer},get children(){return E(mi,{id:"BrowseColumn",plinko:!0,announce:"All Trending - Week",get y(){return t()},scroll:"none",get style(){return xr.Column},get children(){return E(En,{get each(){return a().pages()},children:(p,v)=>E(Oh,{get autofocus(){return o(v())},items:p,width:1620,onFocus:f,onEnter:u})})}})}})]}})},od=()=>(()=>{var n=Rr("node");return Ga(n,"style",{width:1920,height:1080,color:868483072}),n})(),Ce="/solid-demo-app/";function ad(n){n.fontManager.addFontFace(new Qe("msdf",{fontFamily:"Roboto",descriptors:{weight:700},atlasDataUrl:Ce+"fonts/Roboto-Bold.msdf.json",atlasUrl:Ce+"fonts/Roboto-Bold.msdf.png",stage:n})),n.fontManager.addFontFace(new Qe("msdf",{fontFamily:"Roboto",descriptors:{weight:500},atlasDataUrl:Ce+"fonts/Roboto-Medium.msdf.json",atlasUrl:Ce+"fonts/Roboto-Medium.msdf.png",stage:n})),n.fontManager.addFontFace(new Qe("msdf",{fontFamily:"Roboto",descriptors:{weight:400},atlasDataUrl:Ce+"fonts/Roboto-Regular.msdf.json",atlasUrl:Ce+"fonts/Roboto-Regular.msdf.png",stage:n})),n.fontManager.addFontFace(new Qe("msdf",{fontFamily:"Roboto",descriptors:{weight:100},atlasDataUrl:Ce+"fonts/Roboto-Thin.msdf.json",atlasUrl:Ce+"fonts/Roboto-Thin.msdf.png",stage:n})),n.fontManager.addFontFace(new Qe("msdf",{fontFamily:"Arial",descriptors:{weight:500},atlasDataUrl:Ce+"fonts/Roboto-Regular.msdf.json",atlasUrl:Ce+"fonts/Roboto-Regular.msdf.png",stage:n}))}const ld=be(()=>ve(()=>import("./Grid-B0BWaiQc.js"),[])),cd=be(()=>ve(()=>import("./Portal-CZiP1VVH.js"),[])),hd=be(()=>ve(()=>import("./Text-DLSXjv8C.js"),[])),dd=be(()=>ve(()=>import("./Create-4ZjN-hAg.js"),[])),ud=be(()=>ve(()=>import("./Viewport-DJ3s2-hA.js"),[])),fd=be(()=>ve(()=>import("./Buttons-CKBaZSrX.js"),[])),pd=be(()=>ve(()=>import("./Flex-DCcg2ODI.js"),[])),gd=be(()=>ve(()=>import("./FlexSize-C1fIgk_m.js"),[])),md=be(()=>ve(()=>import("./FlexColumnSize-Ba9jeGn1.js"),[])),xd=be(()=>ve(()=>import("./FlexColumn-BPj-z7KY.js"),[])),yd=be(()=>ve(()=>import("./ButtonsMaterial-oKNzcAzY.js"),[])),vd=be(()=>ve(()=>import("./SuperFlex-C1VPEAEH.js"),[])),bd=be(()=>ve(()=>import("./Entity-CcaAllJr.js"),[])),Ad=be(()=>ve(()=>import("./People-L5EiMVYA.js"),[]));le.debug=!1;le.animationsEnabled=!0;le.fontSettings.fontFamily="Roboto";le.fontSettings.color=4143380223;le.fontSettings.fontSize=32;le.rendererOptions={fpsUpdateInterval:200,enableInspector:!0,numImageWorkers:0,deviceLogicalPixelRatio:window.innerHeight/1080};const{renderer:Td,render:Sd}=Wa();ad(Td.stage);Sd(()=>E(Al,{root:n=>E(kh,n),get children(){return[E(ae,{path:"",component:gs}),E(ae,{path:"examples",component:cd}),E(ae,{path:"browse/:filter",component:gs}),E(ae,{path:"grid",component:ld}),E(ae,{path:"text",component:hd}),E(ae,{path:"buttons",component:fd}),E(ae,{path:"flex",component:pd}),E(ae,{path:"create",component:dd}),E(ae,{path:"viewport",component:ud}),E(ae,{path:"flexsize",component:gd}),E(ae,{path:"flexcolumnsize",component:md}),E(ae,{path:"flexcolumn",component:xd}),E(ae,{path:"superflex",component:vd}),E(ae,{path:"buttonsmaterial",component:yd}),E(ae,{path:"entity/people/:id",component:Ad}),E(ae,{path:"entity/:type/:id",component:bd}),E(ae,{path:"*all",component:od})]}}));function jd(){const n=document.getElementById("video");return n.hidden=!1,setTimeout(()=>n.play(),50),n.focus(),n}function qd(){const n=document.getElementById("video");return n.hidden=!0,n.pause(),n}export{$h as A,Kh as B,mi as C,$r as D,nl as E,En as F,id as G,Oh as H,Cd as I,qd as J,jd as K,Da as L,Qd as M,Uc as R,wr as S,Y as T,W as V,_d as __vite_legacy_guard,Ws as a,nn as b,H as c,Sn as d,wa as e,Ve as f,Rd as g,E as h,xr as i,F as j,is as k,In as l,Te as m,_n as n,Je as o,Ae as p,Kd as q,Rr as r,Ql as s,d as t,Pn as u,Va as v,tc as w,Bn as x,Ha as y,Fd as z};
//# sourceMappingURL=index-C62FKGOT.js.map
